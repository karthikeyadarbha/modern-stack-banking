[0m11:14:22.850198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ac7f86ebd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ac7fe2b7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ac817bac90>]}


============================== 11:14:22.950207 | 6ef14966-2dda-4c61-9a55-5649cc9f4286 ==============================
[0m11:14:22.950207 [info ] [MainThread]: Running with dbt=1.11.2
[0m11:14:22.950919 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'write_json': 'True', 'introspect': 'True', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt deps', 'partial_parse': 'True', 'profiles_dir': '/home/codespace/.dbt', 'target_path': 'None', 'log_format': 'default', 'indirect_selection': 'eager', 'fail_fast': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'use_experimental_parser': 'False', 'printer_width': '80', 'quiet': 'False', 'version_check': 'True', 'log_path': 'logs'}
[0m11:14:22.951763 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path /workspaces/modern-stack-banking/Transform/dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m11:14:22.952829 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": false, "command_wall_clock_time": 0.16475806, "process_in_blocks": "28088", "process_kernel_time": 0.201408, "process_mem_max_rss": "101568", "process_out_blocks": "8", "process_user_time": 1.43}
[0m11:14:22.953423 [debug] [MainThread]: Command `dbt deps` failed at 11:14:22.953320 after 0.17 seconds
[0m11:14:22.953919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ac7fec3800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ac7ff4bc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ac7f838d70>]}
[0m11:14:22.954393 [debug] [MainThread]: Flushing usage events
[0m11:14:24.168751 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:15:21.021222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75163110e060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751630ea5670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751630d12360>]}


============================== 11:15:21.024363 | 3e43c08b-b79e-4bd2-99ca-f409c4a7aff7 ==============================
[0m11:15:21.024363 [info ] [MainThread]: Running with dbt=1.11.2
[0m11:15:21.025081 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'introspect': 'True', 'printer_width': '80', 'static_parser': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'warn_error': 'None', 'cache_selected_only': 'False', 'profiles_dir': '/home/codespace/.dbt', 'log_format': 'default', 'no_print': 'None', 'write_json': 'True', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'debug': 'False', 'empty': 'None', 'fail_fast': 'False', 'partial_parse': 'True'}
[0m11:15:21.026924 [info ] [MainThread]: [[33mWARNING[0m][GenericJSONSchemaValidationDeprecation]: Deprecated
functionality
'name' is a required property at top level in file
`/workspaces/modern-stack-banking/Transform/dbt_project.yml` is possibly a
deprecation. This generally means that either we failed to catch this as a more
specific deprecation type OR our JSONSchema had a regression (and this
deprecation was erroneous).
[0m11:15:21.029697 [error] [MainThread]: Encountered an error:
Runtime Error
  Required "name" field not present in project

Error encountered in /workspaces/modern-stack-banking/Transform/dbt_project.yml
[0m11:15:21.030747 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": false, "command_wall_clock_time": 0.07131323, "process_in_blocks": "0", "process_kernel_time": 0.146767, "process_mem_max_rss": "102444", "process_out_blocks": "16", "process_user_time": 1.46767}
[0m11:15:21.031326 [debug] [MainThread]: Command `dbt deps` failed at 11:15:21.031207 after 0.07 seconds
[0m11:15:21.031819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7516304b3f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7516302c1fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7516302c1ee0>]}
[0m11:15:21.032364 [debug] [MainThread]: Flushing usage events
[0m11:15:22.042397 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:16:23.706992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722439ebeb40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722439c9c0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722439879430>]}


============================== 11:16:23.710202 | 4400d6a8-4b7b-411b-afbd-89fde4a67c18 ==============================
[0m11:16:23.710202 [info ] [MainThread]: Running with dbt=1.11.2
[0m11:16:23.710884 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'warn_error': 'None', 'static_parser': 'True', 'log_cache_events': 'False', 'introspect': 'True', 'use_colors': 'True', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'partial_parse': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'cache_selected_only': 'False', 'target_path': 'None', 'debug': 'False', 'quiet': 'False', 'profiles_dir': '/home/codespace/.dbt', 'invocation_command': 'dbt deps', 'empty': 'None', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'version_check': 'True', 'printer_width': '80'}
[0m11:16:23.845553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4400d6a8-4b7b-411b-afbd-89fde4a67c18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7224391b67b0>]}
[0m11:16:23.856611 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:16:23.857457 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:16:23.858547 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.21352075, "process_in_blocks": "0", "process_kernel_time": 0.178666, "process_mem_max_rss": "105216", "process_out_blocks": "8", "process_user_time": 1.550108}
[0m11:16:23.859212 [debug] [MainThread]: Command `dbt deps` succeeded at 11:16:23.859086 after 0.21 seconds
[0m11:16:23.859726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72243a127b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722439182cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722439040860>]}
[0m11:16:23.860237 [debug] [MainThread]: Flushing usage events
[0m11:16:24.888918 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:18:34.018727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74acc5069b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74acc5745dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74acc50698e0>]}


============================== 11:18:34.022008 | 934c75f3-70ca-459d-ae26-9ddb3c796d57 ==============================
[0m11:18:34.022008 [info ] [MainThread]: Running with dbt=1.11.2
[0m11:18:34.022782 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'log_format': 'default', 'partial_parse': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'warn_error': 'None', 'static_parser': 'True', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'indirect_selection': 'eager', 'introspect': 'True', 'fail_fast': 'False', 'debug': 'False', 'empty': 'False', 'use_colors': 'True', 'profiles_dir': '.', 'write_json': 'True', 'use_experimental_parser': 'False', 'target_path': 'None', 'invocation_command': 'dbt run --select sat_txn_features --profiles-dir .', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'log_cache_events': 'False', 'printer_width': '80'}
[0m11:18:34.025353 [error] [MainThread]: Encountered an error:
Runtime Error
  
  dbt encountered an error while trying to read your profiles.yml file.
  
  Runtime Error
    Syntax error near line 2
    ------------------------------
    1  | cat <<EOF > /workspaces/modern-stack-banking/Transform/profiles.yml
    2  | modern_stack_banking:
    3  |   outputs:
    4  |     dev:
    5  |       type: duckdb
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 2, column 21
  
[0m11:18:34.026553 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.011260075, "process_in_blocks": "0", "process_kernel_time": 0.177506, "process_mem_max_rss": "101072", "process_out_blocks": "16", "process_user_time": 1.349247}
[0m11:18:34.027215 [debug] [MainThread]: Command `dbt run` failed at 11:18:34.027082 after 0.01 seconds
[0m11:18:34.027713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74acc5773ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74acc5314380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74acc5069d00>]}
[0m11:18:34.028264 [debug] [MainThread]: Flushing usage events
[0m11:18:35.073563 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:19:38.669452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5d8bd50cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5d8928d4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5d89fee390>]}


============================== 11:19:38.672630 | e6d56eec-b1fc-4310-a546-6eb8e1b1a46e ==============================
[0m11:19:38.672630 [info ] [MainThread]: Running with dbt=1.11.2
[0m11:19:38.673358 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'debug': 'False', 'warn_error': 'None', 'write_json': 'True', 'invocation_command': 'dbt run --select sat_txn_features --profiles-dir .', 'profiles_dir': '.', 'quiet': 'False', 'target_path': 'None', 'printer_width': '80', 'log_format': 'default', 'log_cache_events': 'False', 'use_colors': 'True', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'static_parser': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'empty': 'False', 'introspect': 'True', 'partial_parse': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:19:38.916897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6d56eec-b1fc-4310-a546-6eb8e1b1a46e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5d7d5afaa0>]}
[0m11:19:38.987033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6d56eec-b1fc-4310-a546-6eb8e1b1a46e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5d8bf47440>]}
[0m11:19:38.988610 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m11:19:39.073891 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m11:19:39.074653 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:19:39.075170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e6d56eec-b1fc-4310-a546-6eb8e1b1a46e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5d7d441e50>]}
[0m11:19:39.936647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6d56eec-b1fc-4310-a546-6eb8e1b1a46e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5d7c00e600>]}
[0m11:19:39.972717 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m11:19:39.974283 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m11:19:39.985732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6d56eec-b1fc-4310-a546-6eb8e1b1a46e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5d7d3c35f0>]}
[0m11:19:39.986259 [info ] [MainThread]: Found 472 macros
[0m11:19:39.986755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6d56eec-b1fc-4310-a546-6eb8e1b1a46e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5d7c00e930>]}
[0m11:19:39.987378 [warn ] [MainThread]: The selection criterion 'sat_txn_features' does not match any enabled nodes
[0m11:19:39.988745 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:19:39.989411 [debug] [MainThread]: Command end result
[0m11:19:40.005406 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m11:19:40.006817 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m11:19:40.009891 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m11:19:40.010910 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4039451, "process_in_blocks": "488", "process_kernel_time": 0.223014, "process_mem_max_rss": "175880", "process_out_blocks": "2880", "process_user_time": 2.695169}
[0m11:19:40.011482 [debug] [MainThread]: Command `dbt run` succeeded at 11:19:40.011378 after 1.40 seconds
[0m11:19:40.011977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5d8a106b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5d7d39a3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5d7d4414f0>]}
[0m11:19:40.012443 [debug] [MainThread]: Flushing usage events
[0m11:19:41.041824 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:21:12.382626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x732bbdc7e360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x732bc0185e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x732bbedaae70>]}


============================== 11:21:12.385945 | f50102b1-4dbb-4c6f-aa70-b8b2784c118a ==============================
[0m11:21:12.385945 [info ] [MainThread]: Running with dbt=1.11.2
[0m11:21:12.386614 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'debug': 'False', 'invocation_command': 'dbt run --select sat_txn_features --profiles-dir .', 'version_check': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'warn_error': 'None', 'printer_width': '80', 'use_experimental_parser': 'False', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'profiles_dir': '.', 'target_path': 'None', 'indirect_selection': 'eager', 'empty': 'False', 'write_json': 'True', 'static_parser': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'fail_fast': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:21:12.632812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f50102b1-4dbb-4c6f-aa70-b8b2784c118a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x732bbe1aeae0>]}
[0m11:21:12.704543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f50102b1-4dbb-4c6f-aa70-b8b2784c118a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x732bbdac8320>]}
[0m11:21:12.706273 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m11:21:12.790874 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m11:21:12.844991 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:21:12.845486 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m11:21:12.845938 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:21:12.851280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f50102b1-4dbb-4c6f-aa70-b8b2784c118a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x732bb15a06e0>]}
[0m11:21:12.891119 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m11:21:12.892749 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m11:21:12.903893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f50102b1-4dbb-4c6f-aa70-b8b2784c118a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x732bb1351430>]}
[0m11:21:12.904440 [info ] [MainThread]: Found 472 macros
[0m11:21:12.904942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f50102b1-4dbb-4c6f-aa70-b8b2784c118a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x732bb1344860>]}
[0m11:21:12.905571 [warn ] [MainThread]: The selection criterion 'sat_txn_features' does not match any enabled nodes
[0m11:21:12.906970 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:21:12.908980 [debug] [MainThread]: Command end result
[0m11:21:12.926422 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m11:21:12.928229 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m11:21:12.931628 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m11:21:12.932720 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6130554, "process_in_blocks": "0", "process_kernel_time": 0.238818, "process_mem_max_rss": "175796", "process_out_blocks": "1928", "process_user_time": 1.903551}
[0m11:21:12.933317 [debug] [MainThread]: Command `dbt run` succeeded at 11:21:12.933211 after 0.61 seconds
[0m11:21:12.933832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x732bbe1fa180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x732bbe1699d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x732bbd2f58b0>]}
[0m11:21:12.934328 [debug] [MainThread]: Flushing usage events
[0m11:21:13.973989 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:21:46.763976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744605d2ce00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7446061fa4b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744605d694c0>]}


============================== 11:21:46.767140 | f6d46cf0-0030-4c07-99b6-e28bc674c2b1 ==============================
[0m11:21:46.767140 [info ] [MainThread]: Running with dbt=1.11.2
[0m11:21:46.767816 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run --select path:models/vault/sats --profiles-dir .', 'version_check': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'introspect': 'True', 'log_format': 'default', 'write_json': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'profiles_dir': '.', 'target_path': 'None', 'warn_error': 'None', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'no_print': 'None', 'fail_fast': 'False'}
[0m11:21:47.012195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f6d46cf0-0030-4c07-99b6-e28bc674c2b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74460544bbf0>]}
[0m11:21:47.082615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f6d46cf0-0030-4c07-99b6-e28bc674c2b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74460533c9b0>]}
[0m11:21:47.084206 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m11:21:47.169181 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m11:21:47.223968 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:21:47.224477 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m11:21:47.224919 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:21:47.230224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f6d46cf0-0030-4c07-99b6-e28bc674c2b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7446055876e0>]}
[0m11:21:47.269733 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m11:21:47.271310 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m11:21:47.282419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f6d46cf0-0030-4c07-99b6-e28bc674c2b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7445f9439370>]}
[0m11:21:47.282981 [info ] [MainThread]: Found 472 macros
[0m11:21:47.283452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6d46cf0-0030-4c07-99b6-e28bc674c2b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7445f9739190>]}
[0m11:21:47.284334 [warn ] [MainThread]: The selection criterion 'path:models/vault/sats' does not match any enabled nodes
[0m11:21:47.285752 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:21:47.287790 [debug] [MainThread]: Command end result
[0m11:21:47.306324 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m11:21:47.308218 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m11:21:47.311593 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m11:21:47.312649 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6108266, "process_in_blocks": "0", "process_kernel_time": 0.23294, "process_mem_max_rss": "175720", "process_out_blocks": "1928", "process_user_time": 1.901513}
[0m11:21:47.313266 [debug] [MainThread]: Command `dbt run` succeeded at 11:21:47.313162 after 0.61 seconds
[0m11:21:47.313773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7445f942fbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74460521afc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744605219310>]}
[0m11:21:47.314265 [debug] [MainThread]: Flushing usage events
[0m11:21:48.320731 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:23:06.205411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774fdb16d5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774fdb3fa480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774fda66cbf0>]}


============================== 11:23:06.208730 | 73215605-9454-4bd9-b15b-8adc4f9c0c63 ==============================
[0m11:23:06.208730 [info ] [MainThread]: Running with dbt=1.11.2
[0m11:23:06.209458 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'write_json': 'True', 'partial_parse': 'True', 'empty': 'False', 'profiles_dir': '.', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'warn_error': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'introspect': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'no_print': 'None', 'quiet': 'False', 'use_colors': 'True', 'invocation_command': 'dbt run --select sat_txn_features --profiles-dir .', 'use_experimental_parser': 'False', 'target_path': 'None'}
[0m11:23:06.455181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '73215605-9454-4bd9-b15b-8adc4f9c0c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774fda534a40>]}
[0m11:23:06.525629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '73215605-9454-4bd9-b15b-8adc4f9c0c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774fda66eea0>]}
[0m11:23:06.527244 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m11:23:06.610640 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m11:23:06.665827 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:23:06.666334 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m11:23:06.666795 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:23:06.672152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '73215605-9454-4bd9-b15b-8adc4f9c0c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774fce88c5f0>]}
[0m11:23:06.713404 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m11:23:06.715087 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m11:23:06.726399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '73215605-9454-4bd9-b15b-8adc4f9c0c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774fce639220>]}
[0m11:23:06.726993 [info ] [MainThread]: Found 472 macros
[0m11:23:06.727489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73215605-9454-4bd9-b15b-8adc4f9c0c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774fda4e3da0>]}
[0m11:23:06.728177 [warn ] [MainThread]: The selection criterion 'sat_txn_features' does not match any enabled nodes
[0m11:23:06.729545 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:23:06.731603 [debug] [MainThread]: Command end result
[0m11:23:06.749241 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m11:23:06.751015 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m11:23:06.754387 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m11:23:06.755431 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.61213887, "process_in_blocks": "0", "process_kernel_time": 0.246498, "process_mem_max_rss": "175804", "process_out_blocks": "1928", "process_user_time": 1.898138}
[0m11:23:06.756043 [debug] [MainThread]: Command `dbt run` succeeded at 11:23:06.755939 after 0.61 seconds
[0m11:23:06.756534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774fdace0aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774fda5e3980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774fce73b800>]}
[0m11:23:06.757043 [debug] [MainThread]: Flushing usage events
[0m11:23:07.801260 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:23:13.398591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b164872dc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b164ad21e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b164abb0500>]}


============================== 11:23:13.401821 | 5c9ba89b-026f-4df5-9c01-cfb32e706818 ==============================
[0m11:23:13.401821 [info ] [MainThread]: Running with dbt=1.11.2
[0m11:23:13.402522 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run --select path:models/vault/sats --profiles-dir .', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'partial_parse': 'True', 'log_cache_events': 'False', 'profiles_dir': '.', 'introspect': 'True', 'write_json': 'True', 'printer_width': '80', 'quiet': 'False', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'no_print': 'None', 'target_path': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'indirect_selection': 'eager', 'version_check': 'True', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'debug': 'False'}
[0m11:23:13.646445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c9ba89b-026f-4df5-9c01-cfb32e706818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1647de6e40>]}
[0m11:23:13.717336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c9ba89b-026f-4df5-9c01-cfb32e706818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1647d8ffb0>]}
[0m11:23:13.718992 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m11:23:13.803974 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m11:23:13.858086 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:23:13.858588 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m11:23:13.859031 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:23:13.864342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c9ba89b-026f-4df5-9c01-cfb32e706818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b163c2193d0>]}
[0m11:23:13.903525 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m11:23:13.905125 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m11:23:13.916268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c9ba89b-026f-4df5-9c01-cfb32e706818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b163bf25b80>]}
[0m11:23:13.916837 [info ] [MainThread]: Found 472 macros
[0m11:23:13.917330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c9ba89b-026f-4df5-9c01-cfb32e706818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b163c065250>]}
[0m11:23:13.918213 [warn ] [MainThread]: The selection criterion 'path:models/vault/sats' does not match any enabled nodes
[0m11:23:13.919599 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:23:13.921620 [debug] [MainThread]: Command end result
[0m11:23:13.939113 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m11:23:13.940893 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m11:23:13.944204 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m11:23:13.945248 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6086291, "process_in_blocks": "0", "process_kernel_time": 0.234748, "process_mem_max_rss": "176092", "process_out_blocks": "1920", "process_user_time": 1.89397}
[0m11:23:13.945861 [debug] [MainThread]: Command `dbt run` succeeded at 11:23:13.945754 after 0.61 seconds
[0m11:23:13.946354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b164872dc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1648573f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1648ed5d90>]}
[0m11:23:13.946867 [debug] [MainThread]: Flushing usage events
[0m11:23:14.952183 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:26:48.727341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d3e436cfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d3e4405610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d3e4f54230>]}


============================== 11:26:48.730532 | 99bd6c7f-2eab-48d6-a431-c536a7f5b0b8 ==============================
[0m11:26:48.730532 [info ] [MainThread]: Running with dbt=1.11.2
[0m11:26:48.731227 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt ls --profiles-dir .', 'version_check': 'True', 'partial_parse': 'True', 'quiet': 'False', 'printer_width': '80', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'no_print': 'None', 'indirect_selection': 'eager', 'introspect': 'True', 'empty': 'None', 'profiles_dir': '.', 'target_path': 'None', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'static_parser': 'True', 'debug': 'False', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'log_cache_events': 'False', 'use_colors': 'True'}
[0m11:26:48.976033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '99bd6c7f-2eab-48d6-a431-c536a7f5b0b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d3e433d430>]}
[0m11:26:49.046556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '99bd6c7f-2eab-48d6-a431-c536a7f5b0b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d3e531a4e0>]}
[0m11:26:49.048218 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m11:26:49.131851 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m11:26:49.186335 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m11:26:49.186935 [debug] [MainThread]: Partial parsing: added file: modern_stack_banking://models/Vault/hubs/hubs_transactions.sql
[0m11:26:49.187406 [debug] [MainThread]: Partial parsing: added file: modern_stack_banking://models/Vault/sats/sat_txn_features.sql
[0m11:26:49.475410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99bd6c7f-2eab-48d6-a431-c536a7f5b0b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d3d8298e90>]}
[0m11:26:49.529217 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m11:26:49.530859 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m11:26:49.540988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '99bd6c7f-2eab-48d6-a431-c536a7f5b0b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d3d8298dd0>]}
[0m11:26:49.541516 [info ] [MainThread]: Found 2 models, 472 macros
[0m11:26:49.542026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99bd6c7f-2eab-48d6-a431-c536a7f5b0b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d3e431cdd0>]}
[0m11:26:49.542867 [info ] [MainThread]: modern_stack_banking.Vault.hubs.hubs_transactions
[0m11:26:49.543354 [info ] [MainThread]: modern_stack_banking.Vault.sats.sat_txn_features
[0m11:26:49.544327 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.8791244, "process_in_blocks": "0", "process_kernel_time": 0.241887, "process_mem_max_rss": "180232", "process_out_blocks": "1952", "process_user_time": 2.158996}
[0m11:26:49.544946 [debug] [MainThread]: Command `dbt ls` succeeded at 11:26:49.544840 after 0.88 seconds
[0m11:26:49.545425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d3e50ee930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d3e436cfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d3d827cdd0>]}
[0m11:26:49.545924 [debug] [MainThread]: Flushing usage events
[0m11:26:50.704368 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:29:24.808478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788ce9663260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788ce9a83620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788ce9662ea0>]}


============================== 11:29:24.811741 | fe0db6e6-4124-44a0-b019-243bd8d8401a ==============================
[0m11:29:24.811741 [info ] [MainThread]: Running with dbt=1.11.2
[0m11:29:24.812435 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'fail_fast': 'False', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'profiles_dir': '.', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'invocation_command': 'dbt run --select modern_stack_banking.Vault.sats.sat_txn_features --profiles-dir .', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'quiet': 'False', 'no_print': 'None', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'version_check': 'True', 'debug': 'False', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'cache_selected_only': 'False'}
[0m11:29:25.058586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe0db6e6-4124-44a0-b019-243bd8d8401a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788cebb05a60>]}
[0m11:29:25.131334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fe0db6e6-4124-44a0-b019-243bd8d8401a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788ce9660da0>]}
[0m11:29:25.133150 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m11:29:25.218380 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m11:29:25.294843 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 2 files added, 0 files changed.
[0m11:29:25.295475 [debug] [MainThread]: Partial parsing: added file: modern_stack_banking://models/vault/hubs/hubs_transactions.sql
[0m11:29:25.295989 [debug] [MainThread]: Partial parsing: added file: modern_stack_banking://models/vault/sats/sat_txn_features.sql
[0m11:29:25.296406 [debug] [MainThread]: Partial parsing: deleted file: modern_stack_banking://models/Vault/sats/sat_txn_features.sql
[0m11:29:25.296858 [debug] [MainThread]: Partial parsing: deleted file: modern_stack_banking://models/Vault/hubs/hubs_transactions.sql
[0m11:29:25.576431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe0db6e6-4124-44a0-b019-243bd8d8401a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788cdc1ab7d0>]}
[0m11:29:25.629449 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m11:29:25.631085 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m11:29:25.642515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe0db6e6-4124-44a0-b019-243bd8d8401a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788cdc190f20>]}
[0m11:29:25.643079 [info ] [MainThread]: Found 2 models, 472 macros
[0m11:29:25.643561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe0db6e6-4124-44a0-b019-243bd8d8401a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788cdd0a6ff0>]}
[0m11:29:25.644235 [warn ] [MainThread]: The selection criterion 'modern_stack_banking.Vault.sats.sat_txn_features' does not match any enabled nodes
[0m11:29:25.645613 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:29:25.646292 [debug] [MainThread]: Command end result
[0m11:29:25.664402 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m11:29:25.665839 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m11:29:25.668970 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m11:29:25.669977 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.92398024, "process_in_blocks": "0", "process_kernel_time": 0.245795, "process_mem_max_rss": "180556", "process_out_blocks": "2920", "process_user_time": 2.215155}
[0m11:29:25.670564 [debug] [MainThread]: Command `dbt run` succeeded at 11:29:25.670458 after 0.92 seconds
[0m11:29:25.671069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788ce95a9be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788cdc1b50d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788cdd08a450>]}
[0m11:29:25.671540 [debug] [MainThread]: Flushing usage events
[0m11:29:26.846062 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:29:56.585701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772ae2682180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772ae223ec00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772ae223fe30>]}


============================== 11:29:56.589031 | dbf42725-ff4a-4b12-ada7-c339a282569e ==============================
[0m11:29:56.589031 [info ] [MainThread]: Running with dbt=1.11.2
[0m11:29:56.589776 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'debug': 'False', 'static_parser': 'True', 'quiet': 'False', 'fail_fast': 'False', 'log_format': 'default', 'empty': 'False', 'printer_width': '80', 'invocation_command': 'dbt run --select modern_stack_banking.Vault.sats.sat_txn_features --profiles-dir .', 'profiles_dir': '.', 'cache_selected_only': 'False', 'use_colors': 'True', 'version_check': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'no_print': 'None', 'introspect': 'True', 'write_json': 'True'}
[0m11:29:56.839793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dbf42725-ff4a-4b12-ada7-c339a282569e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772ae2989100>]}
[0m11:29:56.911274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dbf42725-ff4a-4b12-ada7-c339a282569e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772ae46250d0>]}
[0m11:29:56.913013 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m11:29:56.998255 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m11:29:57.075330 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 2 files added, 0 files changed.
[0m11:29:57.075963 [debug] [MainThread]: Partial parsing: added file: modern_stack_banking://models/Vault/hubs/hubs_transactions.sql
[0m11:29:57.076434 [debug] [MainThread]: Partial parsing: added file: modern_stack_banking://models/Vault/sats/sat_txn_features.sql
[0m11:29:57.076883 [debug] [MainThread]: Partial parsing: deleted file: modern_stack_banking://models/vault/hubs/hubs_transactions.sql
[0m11:29:57.077317 [debug] [MainThread]: Partial parsing: deleted file: modern_stack_banking://models/vault/sats/sat_txn_features.sql
[0m11:29:57.348692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dbf42725-ff4a-4b12-ada7-c339a282569e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772ad415d5b0>]}
[0m11:29:57.402795 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m11:29:57.404522 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m11:29:57.416440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dbf42725-ff4a-4b12-ada7-c339a282569e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772ad4170a10>]}
[0m11:29:57.417031 [info ] [MainThread]: Found 2 models, 472 macros
[0m11:29:57.417532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbf42725-ff4a-4b12-ada7-c339a282569e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772ad41bf2f0>]}
[0m11:29:57.419264 [info ] [MainThread]: 
[0m11:29:57.419786 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:29:57.420229 [info ] [MainThread]: 
[0m11:29:57.420845 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:29:57.421868 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m11:29:57.682214 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m11:29:57.682828 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m11:29:57.683292 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:30:00.072565 [debug] [ThreadPool]: SQL status: OK in 2.389 seconds
[0m11:30:00.074208 [debug] [ThreadPool]: On list_argus_vault: Close
[0m11:30:00.075080 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m11:30:00.075729 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m11:30:00.082786 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m11:30:00.083276 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m11:30:00.083755 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:30:00.084956 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:30:00.086300 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m11:30:00.086787 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m11:30:00.087418 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:30:00.087888 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m11:30:00.088326 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m11:30:00.089201 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:30:00.090163 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m11:30:00.090633 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m11:30:00.091100 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m11:30:00.091790 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:30:00.092254 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m11:30:00.097412 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m11:30:00.102983 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m11:30:00.103444 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m11:30:00.103879 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:30:00.104551 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:30:00.105005 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m11:30:00.105419 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m11:30:00.115840 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m11:30:00.117083 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m11:30:00.118348 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m11:30:00.118814 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m11:30:00.119492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbf42725-ff4a-4b12-ada7-c339a282569e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772ad4173f20>]}
[0m11:30:00.120238 [debug] [MainThread]: Using duckdb connection "master"
[0m11:30:00.120755 [debug] [MainThread]: On master: BEGIN
[0m11:30:00.121168 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:30:00.122054 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:30:00.122498 [debug] [MainThread]: On master: COMMIT
[0m11:30:00.122942 [debug] [MainThread]: Using duckdb connection "master"
[0m11:30:00.123343 [debug] [MainThread]: On master: COMMIT
[0m11:30:00.123994 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:30:00.124435 [debug] [MainThread]: On master: Close
[0m11:30:00.126741 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_features
[0m11:30:00.127367 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_features ....................... [RUN]
[0m11:30:00.127943 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_features)
[0m11:30:00.128412 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_features
[0m11:30:00.135941 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_features"
[0m11:30:00.136820 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_features
[0m11:30:00.191317 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_features"
[0m11:30:00.192245 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_features"
[0m11:30:00.192754 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_features: BEGIN
[0m11:30:00.193230 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:30:00.194062 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:30:00.194563 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_features"
[0m11:30:00.195086 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_features: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_features"} */

  
    
    

    create  table
      "argus_vault"."main"."sat_txn_features"
  
    as (
      

WITH silver_data AS (
    -- Reading from our Iceberg Silver layer
    SELECT * FROM iceberg_scan('data/warehouse/db/silver_transactions')
)

SELECT
    -- 1. Link to the Hub (Primary Key)
    MD5(CAST(txn_id AS VARCHAR)) as txn_hash_key,

    -- 2. The Features (Context)
    pca_features,
    is_fraud_label,
    amount,
    
    -- 3. Hash Diff (Standard DV 2.0 for detecting state changes)
    MD5(
        CAST(amount AS VARCHAR) || 
        CAST(is_fraud_label AS VARCHAR) || 
        CAST(pca_features AS VARCHAR)
    ) as hash_diff,

    -- 4. Metadata
    txn_ts as load_date,
    'SPARK_ICEBERG_SILVER' as record_source

FROM silver_data


    );
  
  
  
[0m11:30:00.196281 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_features"} */

  
    
    

    create  table
      "argus_vault"."main"."sat_txn_features"
  
    as (
      

WITH silver_data AS (
    -- Reading from our Iceberg Silver layer
    SELECT * FROM iceberg_scan('data/warehouse/db/silver_transactions')
)

SELECT
    -- 1. Link to the Hub (Primary Key)
    MD5(CAST(txn_id AS VARCHAR)) as txn_hash_key,

    -- 2. The Features (Context)
    pca_features,
    is_fraud_label,
    amount,
    
    -- 3. Hash Diff (Standard DV 2.0 for detecting state changes)
    MD5(
        CAST(amount AS VARCHAR) || 
        CAST(is_fraud_label AS VARCHAR) || 
        CAST(pca_features AS VARCHAR)
    ) as hash_diff,

    -- 4. Metadata
    txn_ts as load_date,
    'SPARK_ICEBERG_SILVER' as record_source

FROM silver_data


    );
  
  
  
[0m11:30:00.196823 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m11:30:00.197439 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_features: ROLLBACK
[0m11:30:00.203452 [debug] [Thread-1 (]: Failed to rollback 'model.modern_stack_banking.sat_txn_features'
[0m11:30:00.203993 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_features: Close
[0m11:30:00.206536 [debug] [Thread-1 (]: Runtime Error in model sat_txn_features (models/Vault/sats/sat_txn_features.sql)
  Failed to read iceberg table. No version was provided and no version-hint could be found, globbing the filesystem to locate the latest version is disabled by default as this is considered unsafe and could result in reading uncommitted data. To enable this use 'SET unsafe_enable_version_guessing = true;'
  
  LINE 15:     SELECT * FROM iceberg_scan('data/warehouse/db/silver_transactions')
                             ^
[0m11:30:00.208209 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbf42725-ff4a-4b12-ada7-c339a282569e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772ad4038bc0>]}
[0m11:30:00.208970 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model main.sat_txn_features .............. [[31mERROR[0m in 0.08s]
[0m11:30:00.209729 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_features
[0m11:30:00.210431 [debug] [Thread-4 (]: Marking all children of 'model.modern_stack_banking.sat_txn_features' to be skipped because of status 'error'.  Reason: Runtime Error in model sat_txn_features (models/Vault/sats/sat_txn_features.sql)
  Failed to read iceberg table. No version was provided and no version-hint could be found, globbing the filesystem to locate the latest version is disabled by default as this is considered unsafe and could result in reading uncommitted data. To enable this use 'SET unsafe_enable_version_guessing = true;'
  
  LINE 15:     SELECT * FROM iceberg_scan('data/warehouse/db/silver_transactions')
                             ^.
[0m11:30:00.212434 [debug] [MainThread]: Using duckdb connection "master"
[0m11:30:00.212979 [debug] [MainThread]: On master: BEGIN
[0m11:30:00.213398 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:30:00.214081 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:30:00.214519 [debug] [MainThread]: On master: COMMIT
[0m11:30:00.214954 [debug] [MainThread]: Using duckdb connection "master"
[0m11:30:00.215399 [debug] [MainThread]: On master: COMMIT
[0m11:30:00.216105 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:30:00.216751 [debug] [MainThread]: On master: Close
[0m11:30:00.217511 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:30:00.217964 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_features' was properly closed.
[0m11:30:00.218655 [info ] [MainThread]: 
[0m11:30:00.219495 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 2.80 seconds (2.80s).
[0m11:30:00.220390 [debug] [MainThread]: Command end result
[0m11:30:00.291965 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m11:30:00.293662 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m11:30:00.299780 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m11:30:00.300246 [info ] [MainThread]: 
[0m11:30:00.300805 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:30:00.301279 [info ] [MainThread]: 
[0m11:30:00.301959 [error] [MainThread]: [31mFailure in model sat_txn_features (models/Vault/sats/sat_txn_features.sql)[0m
[0m11:30:00.302550 [error] [MainThread]:   Runtime Error in model sat_txn_features (models/Vault/sats/sat_txn_features.sql)
  Failed to read iceberg table. No version was provided and no version-hint could be found, globbing the filesystem to locate the latest version is disabled by default as this is considered unsafe and could result in reading uncommitted data. To enable this use 'SET unsafe_enable_version_guessing = true;'
  
  LINE 15:     SELECT * FROM iceberg_scan('data/warehouse/db/silver_transactions')
                             ^
[0m11:30:00.303027 [info ] [MainThread]: 
[0m11:30:00.303520 [info ] [MainThread]:   compiled code at target/compiled/modern_stack_banking/models/Vault/sats/sat_txn_features.sql
[0m11:30:00.303970 [info ] [MainThread]: 
[0m11:30:00.304432 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m11:30:00.305488 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.782399, "process_in_blocks": "1848", "process_kernel_time": 0.423924, "process_mem_max_rss": "305672", "process_out_blocks": "206480", "process_user_time": 4.269665}
[0m11:30:00.306114 [debug] [MainThread]: Command `dbt run` failed at 11:30:00.305982 after 3.78 seconds
[0m11:30:00.306843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772ae2347680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772ae2988a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772ae4761a00>]}
[0m11:30:00.307718 [debug] [MainThread]: Flushing usage events
[0m11:30:01.400647 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:31:31.008154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e480d5fa000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e480c7140b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e480cdaa5a0>]}


============================== 11:31:31.011472 | 13d929d1-d804-4d6e-b1bd-497dfe4944ca ==============================
[0m11:31:31.011472 [info ] [MainThread]: Running with dbt=1.11.2
[0m11:31:31.012245 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'indirect_selection': 'eager', 'warn_error': 'None', 'version_check': 'True', 'introspect': 'True', 'empty': 'False', 'static_parser': 'True', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run --select modern_stack_banking.Vault.sats.sat_txn_features --profiles-dir .', 'printer_width': '80', 'log_format': 'default', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'profiles_dir': '.', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'no_print': 'None', 'use_colors': 'True', 'fail_fast': 'False'}
[0m11:31:31.259727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '13d929d1-d804-4d6e-b1bd-497dfe4944ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e480c63e7b0>]}
[0m11:31:31.330653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '13d929d1-d804-4d6e-b1bd-497dfe4944ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e480c716330>]}
[0m11:31:31.332347 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m11:31:31.417125 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m11:31:31.482406 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m11:31:31.483033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '13d929d1-d804-4d6e-b1bd-497dfe4944ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e480ce627b0>]}
[0m11:31:32.595033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '13d929d1-d804-4d6e-b1bd-497dfe4944ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e480011cec0>]}
[0m11:31:32.651277 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m11:31:32.653124 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m11:31:32.665159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '13d929d1-d804-4d6e-b1bd-497dfe4944ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e48007d4d10>]}
[0m11:31:32.665798 [info ] [MainThread]: Found 2 models, 472 macros
[0m11:31:32.666332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13d929d1-d804-4d6e-b1bd-497dfe4944ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4800a4cfb0>]}
[0m11:31:32.668880 [info ] [MainThread]: 
[0m11:31:32.669747 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:31:32.670547 [info ] [MainThread]: 
[0m11:31:32.671606 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:31:32.673152 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m11:31:32.707771 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m11:31:32.708266 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m11:31:32.708723 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:31:32.800575 [debug] [ThreadPool]: SQL status: OK in 0.092 seconds
[0m11:31:32.802324 [debug] [ThreadPool]: On list_argus_vault: Close
[0m11:31:32.803231 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m11:31:32.803850 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m11:31:32.812811 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m11:31:32.813289 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m11:31:32.813737 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:31:32.815479 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m11:31:32.816857 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m11:31:32.817302 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m11:31:32.817926 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:31:32.818359 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m11:31:32.818791 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m11:31:32.819452 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:31:32.820402 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m11:31:32.820869 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m11:31:32.821286 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m11:31:32.821902 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:31:32.822350 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m11:31:32.827612 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m11:31:32.833467 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m11:31:32.833947 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m11:31:32.834360 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:31:32.835217 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:31:32.835657 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m11:31:32.836103 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m11:31:32.846925 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m11:31:32.848345 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m11:31:32.849620 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m11:31:32.850092 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m11:31:32.850781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13d929d1-d804-4d6e-b1bd-497dfe4944ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e480d015670>]}
[0m11:31:32.851373 [debug] [MainThread]: Using duckdb connection "master"
[0m11:31:32.851852 [debug] [MainThread]: On master: BEGIN
[0m11:31:32.852268 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:31:32.853142 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:31:32.853594 [debug] [MainThread]: On master: COMMIT
[0m11:31:32.854065 [debug] [MainThread]: Using duckdb connection "master"
[0m11:31:32.854473 [debug] [MainThread]: On master: COMMIT
[0m11:31:32.855168 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:31:32.855605 [debug] [MainThread]: On master: Close
[0m11:31:32.857620 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_features
[0m11:31:32.858274 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_features ....................... [RUN]
[0m11:31:32.858863 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_features)
[0m11:31:32.859342 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_features
[0m11:31:32.867246 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_features"
[0m11:31:32.868014 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_features
[0m11:31:32.924402 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_features"
[0m11:31:32.925196 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_features"
[0m11:31:32.925709 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_features: BEGIN
[0m11:31:32.926181 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:31:32.927480 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:31:32.927994 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_features"
[0m11:31:32.928481 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_features: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_features"} */

  
    
    

    create  table
      "argus_vault"."main"."sat_txn_features"
  
    as (
      

WITH silver_data AS (
    -- Reading from our Iceberg Silver layer
    SELECT * FROM iceberg_scan('data/warehouse/db/silver_transactions')
)

SELECT
    -- 1. Link to the Hub (Primary Key)
    MD5(CAST(txn_id AS VARCHAR)) as txn_hash_key,

    -- 2. The Features (Context)
    pca_features,
    is_fraud_label,
    amount,
    
    -- 3. Hash Diff (Standard DV 2.0 for detecting state changes)
    MD5(
        CAST(amount AS VARCHAR) || 
        CAST(is_fraud_label AS VARCHAR) || 
        CAST(pca_features AS VARCHAR)
    ) as hash_diff,

    -- 4. Metadata
    txn_ts as load_date,
    'SPARK_ICEBERG_SILVER' as record_source

FROM silver_data


    );
  
  
  
[0m11:31:32.929769 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_features"} */

  
    
    

    create  table
      "argus_vault"."main"."sat_txn_features"
  
    as (
      

WITH silver_data AS (
    -- Reading from our Iceberg Silver layer
    SELECT * FROM iceberg_scan('data/warehouse/db/silver_transactions')
)

SELECT
    -- 1. Link to the Hub (Primary Key)
    MD5(CAST(txn_id AS VARCHAR)) as txn_hash_key,

    -- 2. The Features (Context)
    pca_features,
    is_fraud_label,
    amount,
    
    -- 3. Hash Diff (Standard DV 2.0 for detecting state changes)
    MD5(
        CAST(amount AS VARCHAR) || 
        CAST(is_fraud_label AS VARCHAR) || 
        CAST(pca_features AS VARCHAR)
    ) as hash_diff,

    -- 4. Metadata
    txn_ts as load_date,
    'SPARK_ICEBERG_SILVER' as record_source

FROM silver_data


    );
  
  
  
[0m11:31:32.930299 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m11:31:32.930935 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_features: ROLLBACK
[0m11:31:32.934934 [debug] [Thread-1 (]: Failed to rollback 'model.modern_stack_banking.sat_txn_features'
[0m11:31:32.935446 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_features: Close
[0m11:31:32.937979 [debug] [Thread-1 (]: Runtime Error in model sat_txn_features (models/Vault/sats/sat_txn_features.sql)
  Could not guess Iceberg table version using 'none' compression and format(s): 'v%s%s.metadata.json,%s%s.metadata.json'
  
  LINE 15:     SELECT * FROM iceberg_scan('data/warehouse/db/silver_transactions')
                             ^
[0m11:31:32.939627 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13d929d1-d804-4d6e-b1bd-497dfe4944ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e47d1e98e00>]}
[0m11:31:32.940387 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model main.sat_txn_features .............. [[31mERROR[0m in 0.08s]
[0m11:31:32.941147 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_features
[0m11:31:32.941857 [debug] [Thread-4 (]: Marking all children of 'model.modern_stack_banking.sat_txn_features' to be skipped because of status 'error'.  Reason: Runtime Error in model sat_txn_features (models/Vault/sats/sat_txn_features.sql)
  Could not guess Iceberg table version using 'none' compression and format(s): 'v%s%s.metadata.json,%s%s.metadata.json'
  
  LINE 15:     SELECT * FROM iceberg_scan('data/warehouse/db/silver_transactions')
                             ^.
[0m11:31:32.943767 [debug] [MainThread]: Using duckdb connection "master"
[0m11:31:32.944227 [debug] [MainThread]: On master: BEGIN
[0m11:31:32.944634 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:31:32.945484 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:31:32.945970 [debug] [MainThread]: On master: COMMIT
[0m11:31:32.946383 [debug] [MainThread]: Using duckdb connection "master"
[0m11:31:32.946818 [debug] [MainThread]: On master: COMMIT
[0m11:31:32.947457 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:31:32.947939 [debug] [MainThread]: On master: Close
[0m11:31:32.948431 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:31:32.948886 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_features' was properly closed.
[0m11:31:32.949307 [info ] [MainThread]: 
[0m11:31:32.949801 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m11:31:32.950570 [debug] [MainThread]: Command end result
[0m11:31:32.969124 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m11:31:32.970734 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m11:31:32.976514 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m11:31:32.976996 [info ] [MainThread]: 
[0m11:31:32.977500 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:31:32.977996 [info ] [MainThread]: 
[0m11:31:32.978506 [error] [MainThread]: [31mFailure in model sat_txn_features (models/Vault/sats/sat_txn_features.sql)[0m
[0m11:31:32.979062 [error] [MainThread]:   Runtime Error in model sat_txn_features (models/Vault/sats/sat_txn_features.sql)
  Could not guess Iceberg table version using 'none' compression and format(s): 'v%s%s.metadata.json,%s%s.metadata.json'
  
  LINE 15:     SELECT * FROM iceberg_scan('data/warehouse/db/silver_transactions')
                             ^
[0m11:31:32.979499 [info ] [MainThread]: 
[0m11:31:32.980029 [info ] [MainThread]:   compiled code at target/compiled/modern_stack_banking/models/Vault/sats/sat_txn_features.sql
[0m11:31:32.980458 [info ] [MainThread]: 
[0m11:31:32.980961 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m11:31:32.981982 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.036324, "process_in_blocks": "0", "process_kernel_time": 0.280099, "process_mem_max_rss": "255076", "process_out_blocks": "2960", "process_user_time": 3.965925}
[0m11:31:32.982566 [debug] [MainThread]: Command `dbt run` failed at 11:31:32.982464 after 2.04 seconds
[0m11:31:32.983086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e480ce63050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e480d5699d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e480d5688c0>]}
[0m11:31:32.983571 [debug] [MainThread]: Flushing usage events
[0m11:31:34.141722 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:33:17.420730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f099239be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f09a1833e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f09859a600>]}


============================== 11:33:17.424004 | badc763d-f39b-4749-9212-354af1688f8f ==============================
[0m11:33:17.424004 [info ] [MainThread]: Running with dbt=1.11.2
[0m11:33:17.424802 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'invocation_command': 'dbt run --select modern_stack_banking.Vault.sats.sat_txn_features --profiles-dir .', 'use_experimental_parser': 'False', 'printer_width': '80', 'static_parser': 'True', 'quiet': 'False', 'profiles_dir': '.', 'version_check': 'True', 'empty': 'False', 'cache_selected_only': 'False', 'introspect': 'True', 'fail_fast': 'False', 'log_format': 'default', 'no_print': 'None', 'target_path': 'None', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'use_colors': 'True', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'write_json': 'True'}
[0m11:33:17.671714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'badc763d-f39b-4749-9212-354af1688f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f09833caa0>]}
[0m11:33:17.742712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'badc763d-f39b-4749-9212-354af1688f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f09844da00>]}
[0m11:33:17.744355 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m11:33:17.829196 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m11:33:17.906215 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:33:17.906899 [debug] [MainThread]: Partial parsing: updated file: modern_stack_banking://models/Vault/sats/sat_txn_features.sql
[0m11:33:18.172563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'badc763d-f39b-4749-9212-354af1688f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f08c3e0e00>]}
[0m11:33:18.226171 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m11:33:18.227822 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m11:33:18.239324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'badc763d-f39b-4749-9212-354af1688f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f098225dc0>]}
[0m11:33:18.239889 [info ] [MainThread]: Found 2 models, 472 macros
[0m11:33:18.240398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'badc763d-f39b-4749-9212-354af1688f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f08c3e05f0>]}
[0m11:33:18.242088 [info ] [MainThread]: 
[0m11:33:18.242604 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:33:18.243090 [info ] [MainThread]: 
[0m11:33:18.243713 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:33:18.244745 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m11:33:18.279349 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m11:33:18.279854 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m11:33:18.280299 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:33:18.373779 [debug] [ThreadPool]: SQL status: OK in 0.093 seconds
[0m11:33:18.375444 [debug] [ThreadPool]: On list_argus_vault: Close
[0m11:33:18.376359 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m11:33:18.376979 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m11:33:18.384407 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m11:33:18.384919 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m11:33:18.385361 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:33:18.386545 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:33:18.387902 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m11:33:18.388345 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m11:33:18.388999 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:33:18.389428 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m11:33:18.389865 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m11:33:18.390558 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:33:18.391496 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m11:33:18.391963 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m11:33:18.392381 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m11:33:18.393045 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:33:18.393484 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m11:33:18.398896 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m11:33:18.404573 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m11:33:18.405070 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m11:33:18.405500 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:33:18.406401 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:33:18.406859 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m11:33:18.407275 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m11:33:18.417930 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m11:33:18.419186 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m11:33:18.420436 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m11:33:18.420898 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m11:33:18.421592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'badc763d-f39b-4749-9212-354af1688f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f0982e7740>]}
[0m11:33:18.422328 [debug] [MainThread]: Using duckdb connection "master"
[0m11:33:18.422789 [debug] [MainThread]: On master: BEGIN
[0m11:33:18.423194 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:33:18.424021 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:33:18.424466 [debug] [MainThread]: On master: COMMIT
[0m11:33:18.424907 [debug] [MainThread]: Using duckdb connection "master"
[0m11:33:18.425318 [debug] [MainThread]: On master: COMMIT
[0m11:33:18.425938 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:33:18.426380 [debug] [MainThread]: On master: Close
[0m11:33:18.428376 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_features
[0m11:33:18.429007 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_features ....................... [RUN]
[0m11:33:18.429564 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_features)
[0m11:33:18.430078 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_features
[0m11:33:18.437741 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_features"
[0m11:33:18.438445 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_features
[0m11:33:18.494564 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_features"
[0m11:33:18.495319 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_features"
[0m11:33:18.495832 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_features: BEGIN
[0m11:33:18.496293 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:33:18.497224 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:33:18.497731 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_features"
[0m11:33:18.498225 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_features: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_features"} */

  
    
    

    create  table
      "argus_vault"."main"."sat_txn_features"
  
    as (
      

WITH silver_data AS (
    -- Reading from our Iceberg Silver layer
    SELECT * FROM iceberg_scan('/workspaces/modern-stack-banking/data/warehouse/db/silver_transactions/metadata/v1.metadata.json')
)

SELECT
    -- 1. Link to the Hub (Primary Key)
    MD5(CAST(txn_id AS VARCHAR)) as txn_hash_key,

    -- 2. The Features (Context)
    pca_features,
    is_fraud_label,
    amount,
    
    -- 3. Hash Diff (Standard DV 2.0 for detecting state changes)
    MD5(
        CAST(amount AS VARCHAR) || 
        CAST(is_fraud_label AS VARCHAR) || 
        CAST(pca_features AS VARCHAR)
    ) as hash_diff,

    -- 4. Metadata
    txn_ts as load_date,
    'SPARK_ICEBERG_SILVER' as record_source

FROM silver_data


    );
  
  
  
[0m11:33:20.443892 [debug] [Thread-1 (]: SQL status: OK in 1.945 seconds
[0m11:33:20.458456 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_features: COMMIT
[0m11:33:20.459012 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_features"
[0m11:33:20.459505 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_features: COMMIT
[0m11:33:21.316843 [debug] [Thread-1 (]: SQL status: OK in 0.857 seconds
[0m11:33:21.319121 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_features: Close
[0m11:33:21.320920 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'badc763d-f39b-4749-9212-354af1688f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f08c3ac7a0>]}
[0m11:33:21.321719 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_features .................. [[32mOK[0m in 2.89s]
[0m11:33:21.322451 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_features
[0m11:33:21.328106 [debug] [MainThread]: Using duckdb connection "master"
[0m11:33:21.328790 [debug] [MainThread]: On master: BEGIN
[0m11:33:21.329261 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:33:21.330312 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:33:21.330802 [debug] [MainThread]: On master: COMMIT
[0m11:33:21.331245 [debug] [MainThread]: Using duckdb connection "master"
[0m11:33:21.331693 [debug] [MainThread]: On master: COMMIT
[0m11:33:21.332364 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:33:21.332855 [debug] [MainThread]: On master: Close
[0m11:33:21.333418 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:33:21.333885 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_features' was properly closed.
[0m11:33:21.334338 [info ] [MainThread]: 
[0m11:33:21.334901 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 3.09 seconds (3.09s).
[0m11:33:21.335771 [debug] [MainThread]: Command end result
[0m11:33:21.404453 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m11:33:21.406190 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m11:33:21.412007 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m11:33:21.412454 [info ] [MainThread]: 
[0m11:33:21.413071 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:33:21.413576 [info ] [MainThread]: 
[0m11:33:21.414124 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m11:33:21.415218 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.0571785, "process_in_blocks": "0", "process_kernel_time": 0.562017, "process_mem_max_rss": "933804", "process_out_blocks": "154000", "process_user_time": 8.601662}
[0m11:33:21.415842 [debug] [MainThread]: Command `dbt run` succeeded at 11:33:21.415737 after 4.06 seconds
[0m11:33:21.416321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f098a4b470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f098a49e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f08476bf80>]}
[0m11:33:21.416831 [debug] [MainThread]: Flushing usage events
[0m11:33:22.532064 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:34:50.862216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73cba5b57920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73cba6c92b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73cba5b57830>]}


============================== 11:34:50.865635 | 0657409f-6867-473e-ad50-b25734337e40 ==============================
[0m11:34:50.865635 [info ] [MainThread]: Running with dbt=1.11.2
[0m11:34:50.866334 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'empty': 'False', 'warn_error': 'None', 'target_path': 'None', 'debug': 'False', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'partial_parse': 'True', 'log_format': 'default', 'introspect': 'True', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'profiles_dir': '.', 'use_colors': 'True', 'fail_fast': 'False', 'write_json': 'True', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run --select modern_stack_banking.Vault.hubs.hubs_transactions --profiles-dir .', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True'}
[0m11:34:51.110729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0657409f-6867-473e-ad50-b25734337e40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73cba4b950a0>]}
[0m11:34:51.181564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0657409f-6867-473e-ad50-b25734337e40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73cb9914b470>]}
[0m11:34:51.183208 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m11:34:51.267408 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m11:34:51.344057 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:34:51.344724 [debug] [MainThread]: Partial parsing: updated file: modern_stack_banking://models/Vault/hubs/hubs_transactions.sql
[0m11:34:51.609036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0657409f-6867-473e-ad50-b25734337e40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73cb9816c2c0>]}
[0m11:34:51.662536 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m11:34:51.664197 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m11:34:51.675574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0657409f-6867-473e-ad50-b25734337e40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73cb98f93a40>]}
[0m11:34:51.676137 [info ] [MainThread]: Found 2 models, 472 macros
[0m11:34:51.676638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0657409f-6867-473e-ad50-b25734337e40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73cb9917ffe0>]}
[0m11:34:51.678293 [info ] [MainThread]: 
[0m11:34:51.678824 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:34:51.679294 [info ] [MainThread]: 
[0m11:34:51.679915 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:34:51.680965 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m11:34:51.716044 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m11:34:51.716543 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m11:34:51.717018 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:34:51.804023 [debug] [ThreadPool]: SQL status: OK in 0.087 seconds
[0m11:34:51.805631 [debug] [ThreadPool]: On list_argus_vault: Close
[0m11:34:51.806512 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m11:34:51.807168 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m11:34:51.814353 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m11:34:51.814847 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m11:34:51.815278 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:34:51.816660 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:34:51.817987 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m11:34:51.818423 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m11:34:51.819031 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:34:51.819457 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m11:34:51.819886 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m11:34:51.820505 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:34:51.821428 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m11:34:51.821887 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m11:34:51.822296 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m11:34:51.822968 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:34:51.823413 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m11:34:51.828820 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m11:34:51.834390 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m11:34:51.834867 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m11:34:51.835275 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:34:51.836113 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:34:51.836548 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m11:34:51.836994 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m11:34:51.847970 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m11:34:51.849313 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m11:34:51.850560 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m11:34:51.851027 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m11:34:51.852014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0657409f-6867-473e-ad50-b25734337e40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73cb9819cf80>]}
[0m11:34:51.852662 [debug] [MainThread]: Using duckdb connection "master"
[0m11:34:51.853133 [debug] [MainThread]: On master: BEGIN
[0m11:34:51.853543 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:34:51.854527 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:34:51.855005 [debug] [MainThread]: On master: COMMIT
[0m11:34:51.855428 [debug] [MainThread]: Using duckdb connection "master"
[0m11:34:51.855863 [debug] [MainThread]: On master: COMMIT
[0m11:34:51.856566 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:34:51.857037 [debug] [MainThread]: On master: Close
[0m11:34:51.859026 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.hubs_transactions
[0m11:34:51.859650 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.hubs_transactions ...................... [RUN]
[0m11:34:51.860240 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.hubs_transactions)
[0m11:34:51.860746 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.hubs_transactions
[0m11:34:51.868611 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.hubs_transactions"
[0m11:34:51.869382 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.hubs_transactions
[0m11:34:51.926048 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.hubs_transactions"
[0m11:34:51.926818 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.hubs_transactions"
[0m11:34:51.927314 [debug] [Thread-1 (]: On model.modern_stack_banking.hubs_transactions: BEGIN
[0m11:34:51.927780 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:34:51.928928 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:34:51.929416 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.hubs_transactions"
[0m11:34:51.929924 [debug] [Thread-1 (]: On model.modern_stack_banking.hubs_transactions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.hubs_transactions"} */

  
    
    

    create  table
      "argus_vault"."main"."hubs_transactions"
  
    as (
      

WITH silver_src AS (
    -- Reusing the same Iceberg source we just validated
    SELECT 
        txn_id,
        txn_ts,
        'SPARK_ICEBERG_SILVER' as record_source
    FROM iceberg_scan('/workspaces/modern-stack-banking/data/warehouse/db/silver_transactions/metadata/v1.metadata.json')
)

SELECT
    -- MD5 Hashing the business key (txn_id) to create the unique anchor
    MD5(CAST(txn_id AS VARCHAR)) as txn_hash_key,
    txn_id,
    txn_ts as load_date,
    record_source
FROM silver_src


    );
  
  
  
[0m11:34:52.246307 [debug] [Thread-1 (]: SQL status: OK in 0.316 seconds
[0m11:34:52.260920 [debug] [Thread-1 (]: On model.modern_stack_banking.hubs_transactions: COMMIT
[0m11:34:52.261490 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.hubs_transactions"
[0m11:34:52.261993 [debug] [Thread-1 (]: On model.modern_stack_banking.hubs_transactions: COMMIT
[0m11:34:52.433571 [debug] [Thread-1 (]: SQL status: OK in 0.171 seconds
[0m11:34:52.435914 [debug] [Thread-1 (]: On model.modern_stack_banking.hubs_transactions: Close
[0m11:34:52.437728 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0657409f-6867-473e-ad50-b25734337e40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73cba794cf20>]}
[0m11:34:52.438512 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.hubs_transactions ................. [[32mOK[0m in 0.58s]
[0m11:34:52.439290 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.hubs_transactions
[0m11:34:52.442492 [debug] [MainThread]: Using duckdb connection "master"
[0m11:34:52.443008 [debug] [MainThread]: On master: BEGIN
[0m11:34:52.443428 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:34:52.444459 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:34:52.444929 [debug] [MainThread]: On master: COMMIT
[0m11:34:52.445348 [debug] [MainThread]: Using duckdb connection "master"
[0m11:34:52.445830 [debug] [MainThread]: On master: COMMIT
[0m11:34:52.446496 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:34:52.446986 [debug] [MainThread]: On master: Close
[0m11:34:52.447492 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:34:52.447927 [debug] [MainThread]: Connection 'model.modern_stack_banking.hubs_transactions' was properly closed.
[0m11:34:52.448349 [info ] [MainThread]: 
[0m11:34:52.448835 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.77 seconds (0.77s).
[0m11:34:52.449602 [debug] [MainThread]: Command end result
[0m11:34:52.524474 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m11:34:52.526151 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m11:34:52.531887 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m11:34:52.532346 [info ] [MainThread]: 
[0m11:34:52.532893 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:34:52.533348 [info ] [MainThread]: 
[0m11:34:52.533853 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m11:34:52.534923 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7372911, "process_in_blocks": "0", "process_kernel_time": 0.34586, "process_mem_max_rss": "398196", "process_out_blocks": "30616", "process_user_time": 3.598332}
[0m11:34:52.535488 [debug] [MainThread]: Command `dbt run` succeeded at 11:34:52.535385 after 1.74 seconds
[0m11:34:52.535982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73cba55a6630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73cba57da660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73cba57d8800>]}
[0m11:34:52.536468 [debug] [MainThread]: Flushing usage events
[0m11:34:53.595872 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:36:51.448647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745e6b401f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745e6b421ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745e6b4035c0>]}


============================== 11:36:51.451854 | 98ed191d-4ab9-4509-906b-5bb7b3ac5593 ==============================
[0m11:36:51.451854 [info ] [MainThread]: Running with dbt=1.11.2
[0m11:36:51.452542 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'log_format': 'default', 'cache_selected_only': 'False', 'profiles_dir': '.', 'write_json': 'True', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'no_print': 'None', 'introspect': 'True', 'invocation_command': 'dbt run --select gold_fraud_analysis --profiles-dir .', 'indirect_selection': 'eager', 'target_path': 'None', 'debug': 'False', 'partial_parse': 'True', 'quiet': 'False', 'version_check': 'True', 'use_colors': 'True', 'printer_width': '80', 'use_experimental_parser': 'False', 'static_parser': 'True', 'log_cache_events': 'False'}
[0m11:36:51.699134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '98ed191d-4ab9-4509-906b-5bb7b3ac5593', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745e6a3056a0>]}
[0m11:36:51.770032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '98ed191d-4ab9-4509-906b-5bb7b3ac5593', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745e6aac3320>]}
[0m11:36:51.771604 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m11:36:51.854852 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m11:36:51.931470 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m11:36:51.932102 [debug] [MainThread]: Partial parsing: added file: modern_stack_banking://models/Gold/gold_fraud_analysis.sql
[0m11:36:52.194550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '98ed191d-4ab9-4509-906b-5bb7b3ac5593', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745e5e478920>]}
[0m11:36:52.248940 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m11:36:52.250530 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m11:36:52.261919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '98ed191d-4ab9-4509-906b-5bb7b3ac5593', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745e5e532f00>]}
[0m11:36:52.262468 [info ] [MainThread]: Found 3 models, 472 macros
[0m11:36:52.263027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98ed191d-4ab9-4509-906b-5bb7b3ac5593', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745e6a1b9910>]}
[0m11:36:52.264687 [info ] [MainThread]: 
[0m11:36:52.265239 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:36:52.265755 [info ] [MainThread]: 
[0m11:36:52.266396 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:36:52.267354 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m11:36:52.302388 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m11:36:52.302918 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m11:36:52.303368 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:36:52.392603 [debug] [ThreadPool]: SQL status: OK in 0.089 seconds
[0m11:36:52.394267 [debug] [ThreadPool]: On list_argus_vault: Close
[0m11:36:52.395140 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m11:36:52.395748 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m11:36:52.403155 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m11:36:52.403633 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m11:36:52.404106 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:36:52.405320 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:36:52.406628 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m11:36:52.407100 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m11:36:52.407769 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:36:52.408208 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m11:36:52.408636 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m11:36:52.409365 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:36:52.410303 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m11:36:52.410766 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m11:36:52.411185 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m11:36:52.411819 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:36:52.412260 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m11:36:52.417533 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m11:36:52.423235 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m11:36:52.423792 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m11:36:52.424204 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:36:52.425298 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:36:52.425757 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m11:36:52.426183 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m11:36:52.436948 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m11:36:52.438293 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m11:36:52.439542 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m11:36:52.440014 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m11:36:52.441069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98ed191d-4ab9-4509-906b-5bb7b3ac5593', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745e5e396ab0>]}
[0m11:36:52.441635 [debug] [MainThread]: Using duckdb connection "master"
[0m11:36:52.442091 [debug] [MainThread]: On master: BEGIN
[0m11:36:52.442499 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:36:52.443319 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:36:52.443779 [debug] [MainThread]: On master: COMMIT
[0m11:36:52.444199 [debug] [MainThread]: Using duckdb connection "master"
[0m11:36:52.444608 [debug] [MainThread]: On master: COMMIT
[0m11:36:52.445286 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:36:52.445741 [debug] [MainThread]: On master: Close
[0m11:36:52.447698 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.gold_fraud_analysis
[0m11:36:52.448310 [info ] [Thread-1 (]: 1 of 1 START sql view model main.gold_fraud_analysis ........................... [RUN]
[0m11:36:52.448895 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.gold_fraud_analysis)
[0m11:36:52.449373 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.gold_fraud_analysis
[0m11:36:52.457145 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.gold_fraud_analysis"
[0m11:36:52.457893 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.gold_fraud_analysis
[0m11:36:52.489489 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.gold_fraud_analysis"
[0m11:36:52.490262 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.gold_fraud_analysis"
[0m11:36:52.490770 [debug] [Thread-1 (]: On model.modern_stack_banking.gold_fraud_analysis: BEGIN
[0m11:36:52.491243 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:36:52.492338 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:36:52.492853 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.gold_fraud_analysis"
[0m11:36:52.493341 [debug] [Thread-1 (]: On model.modern_stack_banking.gold_fraud_analysis: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.gold_fraud_analysis"} */

  
  create view "argus_vault"."main"."gold_fraud_analysis__dbt_tmp" as (
    

WITH transactions AS (
    -- Get the unique IDs from the Hub
    SELECT 
        txn_hash_key,
        txn_id,
        record_source
    FROM "argus_vault"."main"."hubs_transactions"
),

fraud_context AS (
    -- Get the latest state (features/label) from the Satellite
    SELECT 
        txn_hash_key,
        amount,
        is_fraud_label,
        pca_features,
        load_date
    FROM "argus_vault"."main"."sat_txn_features"
    QUALIFY ROW_NUMBER() OVER (PARTITION BY txn_hash_key ORDER BY load_date DESC) = 1
)
SELECT
    t.txn_id,
    c.amount,
    c.is_fraud_label,
    c.pca_features,
    c.load_date as analysis_timestamp,
    t.record_source
FROM transactions t
JOIN fraud_context c ON t.txn_hash_key = c.txn_hash_key
  );

[0m11:36:52.494687 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:36:52.500851 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.gold_fraud_analysis"
[0m11:36:52.501369 [debug] [Thread-1 (]: On model.modern_stack_banking.gold_fraud_analysis: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.gold_fraud_analysis"} */
alter view "argus_vault"."main"."gold_fraud_analysis__dbt_tmp" rename to "gold_fraud_analysis"
[0m11:36:52.502187 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:36:52.512750 [debug] [Thread-1 (]: On model.modern_stack_banking.gold_fraud_analysis: COMMIT
[0m11:36:52.513289 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.gold_fraud_analysis"
[0m11:36:52.513780 [debug] [Thread-1 (]: On model.modern_stack_banking.gold_fraud_analysis: COMMIT
[0m11:36:52.527326 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m11:36:52.533719 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.gold_fraud_analysis"
[0m11:36:52.534238 [debug] [Thread-1 (]: On model.modern_stack_banking.gold_fraud_analysis: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.gold_fraud_analysis"} */

      drop view if exists "argus_vault"."main"."gold_fraud_analysis__dbt_backup" cascade
    
[0m11:36:52.535059 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:36:52.537469 [debug] [Thread-1 (]: On model.modern_stack_banking.gold_fraud_analysis: Close
[0m11:36:52.539145 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98ed191d-4ab9-4509-906b-5bb7b3ac5593', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745e6d048e00>]}
[0m11:36:52.539904 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.gold_fraud_analysis ...................... [[32mOK[0m in 0.09s]
[0m11:36:52.540645 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.gold_fraud_analysis
[0m11:36:52.541991 [debug] [MainThread]: Using duckdb connection "master"
[0m11:36:52.542446 [debug] [MainThread]: On master: BEGIN
[0m11:36:52.542896 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:36:52.543846 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:36:52.544294 [debug] [MainThread]: On master: COMMIT
[0m11:36:52.544730 [debug] [MainThread]: Using duckdb connection "master"
[0m11:36:52.545136 [debug] [MainThread]: On master: COMMIT
[0m11:36:52.545732 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:36:52.546163 [debug] [MainThread]: On master: Close
[0m11:36:52.546649 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:36:52.547074 [debug] [MainThread]: Connection 'model.modern_stack_banking.gold_fraud_analysis' was properly closed.
[0m11:36:52.547495 [info ] [MainThread]: 
[0m11:36:52.547977 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m11:36:52.548757 [debug] [MainThread]: Command end result
[0m11:36:52.634285 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m11:36:52.636452 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m11:36:52.642767 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m11:36:52.643267 [info ] [MainThread]: 
[0m11:36:52.643875 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:36:52.644358 [info ] [MainThread]: 
[0m11:36:52.644910 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m11:36:52.646003 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.259822, "process_in_blocks": "0", "process_kernel_time": 0.27914, "process_mem_max_rss": "260912", "process_out_blocks": "3000", "process_user_time": 3.182002}
[0m11:36:52.646611 [debug] [MainThread]: Command `dbt run` succeeded at 11:36:52.646501 after 1.26 seconds
[0m11:36:52.647146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745e6c359c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745e5e388380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745e5e389a60>]}
[0m11:36:52.647685 [debug] [MainThread]: Flushing usage events
[0m11:36:53.794379 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:39:32.866318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2aec8d5f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2aec5a0bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2aeddc1070>]}


============================== 11:39:32.869501 | 0767f581-92ab-4061-ab7d-496b0ce9fe2d ==============================
[0m11:39:32.869501 [info ] [MainThread]: Running with dbt=1.11.2
[0m11:39:32.870221 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt test --select gold_fraud_analysis --profiles-dir .', 'indirect_selection': 'eager', 'no_print': 'None', 'cache_selected_only': 'False', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'introspect': 'True', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'version_check': 'True', 'partial_parse': 'True', 'profiles_dir': '.', 'empty': 'None', 'quiet': 'False', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'target_path': 'None'}
[0m11:39:33.113850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0767f581-92ab-4061-ab7d-496b0ce9fe2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2aeb8f46b0>]}
[0m11:39:33.184539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0767f581-92ab-4061-ab7d-496b0ce9fe2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2aeba3b590>]}
[0m11:39:33.186145 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m11:39:33.271042 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m11:39:33.350583 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m11:39:33.351289 [debug] [MainThread]: Partial parsing: added file: modern_stack_banking://models/Gold/schema.yml
[0m11:39:33.550246 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m11:39:33.550966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0767f581-92ab-4061-ab7d-496b0ce9fe2d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2adf93d5e0>]}
[0m11:39:33.636656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0767f581-92ab-4061-ab7d-496b0ce9fe2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2add90c380>]}
[0m11:39:33.709225 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m11:39:33.710850 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m11:39:33.731876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0767f581-92ab-4061-ab7d-496b0ce9fe2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2add934320>]}
[0m11:39:33.732426 [info ] [MainThread]: Found 3 models, 5 data tests, 472 macros
[0m11:39:33.732936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0767f581-92ab-4061-ab7d-496b0ce9fe2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2add92a8d0>]}
[0m11:39:33.734865 [info ] [MainThread]: 
[0m11:39:33.735395 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:39:33.735859 [info ] [MainThread]: 
[0m11:39:33.736464 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:39:33.741505 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault_main'
[0m11:39:33.775307 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m11:39:33.775807 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m11:39:33.776248 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:39:33.864622 [debug] [ThreadPool]: SQL status: OK in 0.088 seconds
[0m11:39:33.865257 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m11:39:33.865749 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m11:39:33.877132 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m11:39:33.878735 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m11:39:33.880034 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m11:39:33.880479 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m11:39:33.881836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0767f581-92ab-4061-ab7d-496b0ce9fe2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2add90c9e0>]}
[0m11:39:33.882481 [debug] [MainThread]: Using duckdb connection "master"
[0m11:39:33.882987 [debug] [MainThread]: On master: BEGIN
[0m11:39:33.883427 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:39:33.884726 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:39:33.885199 [debug] [MainThread]: On master: COMMIT
[0m11:39:33.885645 [debug] [MainThread]: Using duckdb connection "master"
[0m11:39:33.886121 [debug] [MainThread]: On master: COMMIT
[0m11:39:33.886851 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:39:33.887318 [debug] [MainThread]: On master: Close
[0m11:39:33.889439 [debug] [Thread-1 (]: Began running node test.modern_stack_banking.accepted_values_gold_fraud_analysis_is_fraud_label__0__1.ec1ac9281b
[0m11:39:33.889998 [info ] [Thread-1 (]: 1 of 5 START test accepted_values_gold_fraud_analysis_is_fraud_label__0__1 ..... [RUN]
[0m11:39:33.890558 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now test.modern_stack_banking.accepted_values_gold_fraud_analysis_is_fraud_label__0__1.ec1ac9281b)
[0m11:39:33.891100 [debug] [Thread-1 (]: Began compiling node test.modern_stack_banking.accepted_values_gold_fraud_analysis_is_fraud_label__0__1.ec1ac9281b
[0m11:39:33.950065 [debug] [Thread-1 (]: Writing injected SQL for node "test.modern_stack_banking.accepted_values_gold_fraud_analysis_is_fraud_label__0__1.ec1ac9281b"
[0m11:39:33.950924 [debug] [Thread-1 (]: Began executing node test.modern_stack_banking.accepted_values_gold_fraud_analysis_is_fraud_label__0__1.ec1ac9281b
[0m11:39:33.970742 [debug] [Thread-1 (]: Writing runtime sql for node "test.modern_stack_banking.accepted_values_gold_fraud_analysis_is_fraud_label__0__1.ec1ac9281b"
[0m11:39:33.971521 [debug] [Thread-1 (]: Using duckdb connection "test.modern_stack_banking.accepted_values_gold_fraud_analysis_is_fraud_label__0__1.ec1ac9281b"
[0m11:39:33.972052 [debug] [Thread-1 (]: On test.modern_stack_banking.accepted_values_gold_fraud_analysis_is_fraud_label__0__1.ec1ac9281b: BEGIN
[0m11:39:33.972522 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:33.974371 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:39:33.974918 [debug] [Thread-1 (]: Using duckdb connection "test.modern_stack_banking.accepted_values_gold_fraud_analysis_is_fraud_label__0__1.ec1ac9281b"
[0m11:39:33.975407 [debug] [Thread-1 (]: On test.modern_stack_banking.accepted_values_gold_fraud_analysis_is_fraud_label__0__1.ec1ac9281b: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "test.modern_stack_banking.accepted_values_gold_fraud_analysis_is_fraud_label__0__1.ec1ac9281b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        is_fraud_label as value_field,
        count(*) as n_records

    from "argus_vault"."main"."gold_fraud_analysis"
    group by is_fraud_label

)

select *
from all_values
where value_field not in (
    '0','1'
)



  
  
      
    ) dbt_internal_test
[0m11:39:34.018360 [debug] [Thread-1 (]: SQL status: OK in 0.042 seconds
[0m11:39:34.023107 [debug] [Thread-1 (]: On test.modern_stack_banking.accepted_values_gold_fraud_analysis_is_fraud_label__0__1.ec1ac9281b: ROLLBACK
[0m11:39:34.024236 [debug] [Thread-1 (]: Failed to rollback 'test.modern_stack_banking.accepted_values_gold_fraud_analysis_is_fraud_label__0__1.ec1ac9281b'
[0m11:39:34.024762 [debug] [Thread-1 (]: On test.modern_stack_banking.accepted_values_gold_fraud_analysis_is_fraud_label__0__1.ec1ac9281b: Close
[0m11:39:34.025524 [info ] [Thread-1 (]: 1 of 5 PASS accepted_values_gold_fraud_analysis_is_fraud_label__0__1 ........... [[32mPASS[0m in 0.13s]
[0m11:39:34.026285 [debug] [Thread-1 (]: Finished running node test.modern_stack_banking.accepted_values_gold_fraud_analysis_is_fraud_label__0__1.ec1ac9281b
[0m11:39:34.026827 [debug] [Thread-1 (]: Began running node test.modern_stack_banking.not_null_gold_fraud_analysis_amount.3f91df14ec
[0m11:39:34.027412 [info ] [Thread-1 (]: 2 of 5 START test not_null_gold_fraud_analysis_amount .......................... [RUN]
[0m11:39:34.027990 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.modern_stack_banking.accepted_values_gold_fraud_analysis_is_fraud_label__0__1.ec1ac9281b, now test.modern_stack_banking.not_null_gold_fraud_analysis_amount.3f91df14ec)
[0m11:39:34.028471 [debug] [Thread-1 (]: Began compiling node test.modern_stack_banking.not_null_gold_fraud_analysis_amount.3f91df14ec
[0m11:39:34.035731 [debug] [Thread-1 (]: Writing injected SQL for node "test.modern_stack_banking.not_null_gold_fraud_analysis_amount.3f91df14ec"
[0m11:39:34.036415 [debug] [Thread-1 (]: Began executing node test.modern_stack_banking.not_null_gold_fraud_analysis_amount.3f91df14ec
[0m11:39:34.039227 [debug] [Thread-1 (]: Writing runtime sql for node "test.modern_stack_banking.not_null_gold_fraud_analysis_amount.3f91df14ec"
[0m11:39:34.039940 [debug] [Thread-1 (]: Using duckdb connection "test.modern_stack_banking.not_null_gold_fraud_analysis_amount.3f91df14ec"
[0m11:39:34.040439 [debug] [Thread-1 (]: On test.modern_stack_banking.not_null_gold_fraud_analysis_amount.3f91df14ec: BEGIN
[0m11:39:34.040930 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:34.041910 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:39:34.042413 [debug] [Thread-1 (]: Using duckdb connection "test.modern_stack_banking.not_null_gold_fraud_analysis_amount.3f91df14ec"
[0m11:39:34.042915 [debug] [Thread-1 (]: On test.modern_stack_banking.not_null_gold_fraud_analysis_amount.3f91df14ec: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "test.modern_stack_banking.not_null_gold_fraud_analysis_amount.3f91df14ec"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select amount
from "argus_vault"."main"."gold_fraud_analysis"
where amount is null



  
  
      
    ) dbt_internal_test
[0m11:39:34.044831 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:39:34.046333 [debug] [Thread-1 (]: On test.modern_stack_banking.not_null_gold_fraud_analysis_amount.3f91df14ec: ROLLBACK
[0m11:39:34.047390 [debug] [Thread-1 (]: Failed to rollback 'test.modern_stack_banking.not_null_gold_fraud_analysis_amount.3f91df14ec'
[0m11:39:34.047900 [debug] [Thread-1 (]: On test.modern_stack_banking.not_null_gold_fraud_analysis_amount.3f91df14ec: Close
[0m11:39:34.048551 [info ] [Thread-1 (]: 2 of 5 PASS not_null_gold_fraud_analysis_amount ................................ [[32mPASS[0m in 0.02s]
[0m11:39:34.049264 [debug] [Thread-1 (]: Finished running node test.modern_stack_banking.not_null_gold_fraud_analysis_amount.3f91df14ec
[0m11:39:34.049800 [debug] [Thread-1 (]: Began running node test.modern_stack_banking.not_null_gold_fraud_analysis_is_fraud_label.507c69683c
[0m11:39:34.050359 [info ] [Thread-1 (]: 3 of 5 START test not_null_gold_fraud_analysis_is_fraud_label .................. [RUN]
[0m11:39:34.050925 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.modern_stack_banking.not_null_gold_fraud_analysis_amount.3f91df14ec, now test.modern_stack_banking.not_null_gold_fraud_analysis_is_fraud_label.507c69683c)
[0m11:39:34.051404 [debug] [Thread-1 (]: Began compiling node test.modern_stack_banking.not_null_gold_fraud_analysis_is_fraud_label.507c69683c
[0m11:39:34.055463 [debug] [Thread-1 (]: Writing injected SQL for node "test.modern_stack_banking.not_null_gold_fraud_analysis_is_fraud_label.507c69683c"
[0m11:39:34.056116 [debug] [Thread-1 (]: Began executing node test.modern_stack_banking.not_null_gold_fraud_analysis_is_fraud_label.507c69683c
[0m11:39:34.058714 [debug] [Thread-1 (]: Writing runtime sql for node "test.modern_stack_banking.not_null_gold_fraud_analysis_is_fraud_label.507c69683c"
[0m11:39:34.059377 [debug] [Thread-1 (]: Using duckdb connection "test.modern_stack_banking.not_null_gold_fraud_analysis_is_fraud_label.507c69683c"
[0m11:39:34.059893 [debug] [Thread-1 (]: On test.modern_stack_banking.not_null_gold_fraud_analysis_is_fraud_label.507c69683c: BEGIN
[0m11:39:34.060354 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:34.061283 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:39:34.061791 [debug] [Thread-1 (]: Using duckdb connection "test.modern_stack_banking.not_null_gold_fraud_analysis_is_fraud_label.507c69683c"
[0m11:39:34.062274 [debug] [Thread-1 (]: On test.modern_stack_banking.not_null_gold_fraud_analysis_is_fraud_label.507c69683c: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "test.modern_stack_banking.not_null_gold_fraud_analysis_is_fraud_label.507c69683c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_fraud_label
from "argus_vault"."main"."gold_fraud_analysis"
where is_fraud_label is null



  
  
      
    ) dbt_internal_test
[0m11:39:34.063979 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:39:34.065458 [debug] [Thread-1 (]: On test.modern_stack_banking.not_null_gold_fraud_analysis_is_fraud_label.507c69683c: ROLLBACK
[0m11:39:34.066513 [debug] [Thread-1 (]: Failed to rollback 'test.modern_stack_banking.not_null_gold_fraud_analysis_is_fraud_label.507c69683c'
[0m11:39:34.067037 [debug] [Thread-1 (]: On test.modern_stack_banking.not_null_gold_fraud_analysis_is_fraud_label.507c69683c: Close
[0m11:39:34.067699 [info ] [Thread-1 (]: 3 of 5 PASS not_null_gold_fraud_analysis_is_fraud_label ........................ [[32mPASS[0m in 0.02s]
[0m11:39:34.068390 [debug] [Thread-1 (]: Finished running node test.modern_stack_banking.not_null_gold_fraud_analysis_is_fraud_label.507c69683c
[0m11:39:34.068923 [debug] [Thread-1 (]: Began running node test.modern_stack_banking.not_null_gold_fraud_analysis_txn_id.50e3216c26
[0m11:39:34.069464 [info ] [Thread-1 (]: 4 of 5 START test not_null_gold_fraud_analysis_txn_id .......................... [RUN]
[0m11:39:34.070036 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.modern_stack_banking.not_null_gold_fraud_analysis_is_fraud_label.507c69683c, now test.modern_stack_banking.not_null_gold_fraud_analysis_txn_id.50e3216c26)
[0m11:39:34.070519 [debug] [Thread-1 (]: Began compiling node test.modern_stack_banking.not_null_gold_fraud_analysis_txn_id.50e3216c26
[0m11:39:34.074470 [debug] [Thread-1 (]: Writing injected SQL for node "test.modern_stack_banking.not_null_gold_fraud_analysis_txn_id.50e3216c26"
[0m11:39:34.075119 [debug] [Thread-1 (]: Began executing node test.modern_stack_banking.not_null_gold_fraud_analysis_txn_id.50e3216c26
[0m11:39:34.077751 [debug] [Thread-1 (]: Writing runtime sql for node "test.modern_stack_banking.not_null_gold_fraud_analysis_txn_id.50e3216c26"
[0m11:39:34.078413 [debug] [Thread-1 (]: Using duckdb connection "test.modern_stack_banking.not_null_gold_fraud_analysis_txn_id.50e3216c26"
[0m11:39:34.078926 [debug] [Thread-1 (]: On test.modern_stack_banking.not_null_gold_fraud_analysis_txn_id.50e3216c26: BEGIN
[0m11:39:34.079382 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:34.080321 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:39:34.080842 [debug] [Thread-1 (]: Using duckdb connection "test.modern_stack_banking.not_null_gold_fraud_analysis_txn_id.50e3216c26"
[0m11:39:34.081318 [debug] [Thread-1 (]: On test.modern_stack_banking.not_null_gold_fraud_analysis_txn_id.50e3216c26: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "test.modern_stack_banking.not_null_gold_fraud_analysis_txn_id.50e3216c26"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select txn_id
from "argus_vault"."main"."gold_fraud_analysis"
where txn_id is null



  
  
      
    ) dbt_internal_test
[0m11:39:34.123841 [debug] [Thread-1 (]: SQL status: OK in 0.042 seconds
[0m11:39:34.126750 [debug] [Thread-1 (]: On test.modern_stack_banking.not_null_gold_fraud_analysis_txn_id.50e3216c26: ROLLBACK
[0m11:39:34.127995 [debug] [Thread-1 (]: Failed to rollback 'test.modern_stack_banking.not_null_gold_fraud_analysis_txn_id.50e3216c26'
[0m11:39:34.128864 [debug] [Thread-1 (]: On test.modern_stack_banking.not_null_gold_fraud_analysis_txn_id.50e3216c26: Close
[0m11:39:34.129800 [info ] [Thread-1 (]: 4 of 5 PASS not_null_gold_fraud_analysis_txn_id ................................ [[32mPASS[0m in 0.06s]
[0m11:39:34.130524 [debug] [Thread-1 (]: Finished running node test.modern_stack_banking.not_null_gold_fraud_analysis_txn_id.50e3216c26
[0m11:39:34.131071 [debug] [Thread-1 (]: Began running node test.modern_stack_banking.unique_gold_fraud_analysis_txn_id.4514579242
[0m11:39:34.131645 [info ] [Thread-1 (]: 5 of 5 START test unique_gold_fraud_analysis_txn_id ............................ [RUN]
[0m11:39:34.132229 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.modern_stack_banking.not_null_gold_fraud_analysis_txn_id.50e3216c26, now test.modern_stack_banking.unique_gold_fraud_analysis_txn_id.4514579242)
[0m11:39:34.132731 [debug] [Thread-1 (]: Began compiling node test.modern_stack_banking.unique_gold_fraud_analysis_txn_id.4514579242
[0m11:39:34.142135 [debug] [Thread-1 (]: Writing injected SQL for node "test.modern_stack_banking.unique_gold_fraud_analysis_txn_id.4514579242"
[0m11:39:34.142841 [debug] [Thread-1 (]: Began executing node test.modern_stack_banking.unique_gold_fraud_analysis_txn_id.4514579242
[0m11:39:34.145520 [debug] [Thread-1 (]: Writing runtime sql for node "test.modern_stack_banking.unique_gold_fraud_analysis_txn_id.4514579242"
[0m11:39:34.146216 [debug] [Thread-1 (]: Using duckdb connection "test.modern_stack_banking.unique_gold_fraud_analysis_txn_id.4514579242"
[0m11:39:34.146727 [debug] [Thread-1 (]: On test.modern_stack_banking.unique_gold_fraud_analysis_txn_id.4514579242: BEGIN
[0m11:39:34.147197 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:34.148170 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:39:34.148685 [debug] [Thread-1 (]: Using duckdb connection "test.modern_stack_banking.unique_gold_fraud_analysis_txn_id.4514579242"
[0m11:39:34.149174 [debug] [Thread-1 (]: On test.modern_stack_banking.unique_gold_fraud_analysis_txn_id.4514579242: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "test.modern_stack_banking.unique_gold_fraud_analysis_txn_id.4514579242"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    txn_id as unique_field,
    count(*) as n_records

from "argus_vault"."main"."gold_fraud_analysis"
where txn_id is not null
group by txn_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m11:39:34.224922 [debug] [Thread-1 (]: SQL status: OK in 0.075 seconds
[0m11:39:34.226990 [debug] [Thread-1 (]: On test.modern_stack_banking.unique_gold_fraud_analysis_txn_id.4514579242: ROLLBACK
[0m11:39:34.228086 [debug] [Thread-1 (]: Failed to rollback 'test.modern_stack_banking.unique_gold_fraud_analysis_txn_id.4514579242'
[0m11:39:34.228578 [debug] [Thread-1 (]: On test.modern_stack_banking.unique_gold_fraud_analysis_txn_id.4514579242: Close
[0m11:39:34.229317 [info ] [Thread-1 (]: 5 of 5 PASS unique_gold_fraud_analysis_txn_id .................................. [[32mPASS[0m in 0.10s]
[0m11:39:34.230053 [debug] [Thread-1 (]: Finished running node test.modern_stack_banking.unique_gold_fraud_analysis_txn_id.4514579242
[0m11:39:34.232710 [debug] [MainThread]: Using duckdb connection "master"
[0m11:39:34.233204 [debug] [MainThread]: On master: BEGIN
[0m11:39:34.233649 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:39:34.234696 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:39:34.235167 [debug] [MainThread]: On master: COMMIT
[0m11:39:34.235613 [debug] [MainThread]: Using duckdb connection "master"
[0m11:39:34.236088 [debug] [MainThread]: On master: COMMIT
[0m11:39:34.236734 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:39:34.237196 [debug] [MainThread]: On master: Close
[0m11:39:34.237745 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:39:34.238181 [debug] [MainThread]: Connection 'test.modern_stack_banking.unique_gold_fraud_analysis_txn_id.4514579242' was properly closed.
[0m11:39:34.238641 [info ] [MainThread]: 
[0m11:39:34.239152 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m11:39:34.240426 [debug] [MainThread]: Command end result
[0m11:39:34.260572 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m11:39:34.262308 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m11:39:34.268961 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m11:39:34.269422 [info ] [MainThread]: 
[0m11:39:34.269961 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:39:34.270429 [info ] [MainThread]: 
[0m11:39:34.270964 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m11:39:34.271598 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m11:39:34.272702 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.469003, "process_in_blocks": "0", "process_kernel_time": 0.33598, "process_mem_max_rss": "535120", "process_out_blocks": "3152", "process_user_time": 3.913534}
[0m11:39:34.273301 [debug] [MainThread]: Command `dbt test` succeeded at 11:39:34.273196 after 1.47 seconds
[0m11:39:34.273809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2adcd68b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2adcd69fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2aeddc09b0>]}
[0m11:39:34.274319 [debug] [MainThread]: Flushing usage events
[0m11:39:35.323595 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:46:12.745860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a764e702f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a764e9d160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a764f5e750>]}


============================== 12:46:12.749089 | aa23ea12-447b-40a8-869b-7c700fc4bab7 ==============================
[0m12:46:12.749089 [info ] [MainThread]: Running with dbt=1.11.2
[0m12:46:12.749783 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'fail_fast': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'warn_error': 'None', 'version_check': 'True', 'introspect': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'printer_width': '80', 'profiles_dir': '.', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select gold_fraud_dashboard --profiles-dir .', 'write_json': 'True', 'debug': 'False', 'empty': 'False', 'use_colors': 'True', 'log_format': 'default'}
[0m12:46:12.996933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa23ea12-447b-40a8-869b-7c700fc4bab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a76556ea20>]}
[0m12:46:13.069001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aa23ea12-447b-40a8-869b-7c700fc4bab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a764794fe0>]}
[0m12:46:13.070694 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m12:46:13.155026 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m12:46:13.259131 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m12:46:13.259779 [debug] [MainThread]: Partial parsing: added file: modern_stack_banking://models/Gold/gold_fraud_dashboard.sql
[0m12:46:13.480406 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.modern_stack_banking.gold_fraud_dashboard' (models/Gold/gold_fraud_dashboard.sql) depends on a node named 'sat_txn_ai_insights' which was not found
[0m12:46:13.481634 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.79827714, "process_in_blocks": "16", "process_kernel_time": 0.229911, "process_mem_max_rss": "178924", "process_out_blocks": "16", "process_user_time": 2.101195}
[0m12:46:13.482280 [debug] [MainThread]: Command `dbt run` failed at 12:46:13.482156 after 0.80 seconds
[0m12:46:13.482814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a764baa9f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a7645c5010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a7645c59a0>]}
[0m12:46:13.483315 [debug] [MainThread]: Flushing usage events
[0m12:46:14.556965 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:47:39.149482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77725920c950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7772570c2360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777256608bf0>]}


============================== 12:47:39.152795 | eb833051-f8bc-4fc2-8f88-53e0be4b7d18 ==============================
[0m12:47:39.152795 [info ] [MainThread]: Running with dbt=1.11.2
[0m12:47:39.153488 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'profiles_dir': '.', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select gold_fraud_dashboard --profiles-dir .', 'partial_parse': 'True', 'quiet': 'False', 'write_json': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'static_parser': 'True', 'printer_width': '80', 'empty': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'log_format': 'default', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False'}
[0m12:47:39.397976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb833051-f8bc-4fc2-8f88-53e0be4b7d18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777259363530>]}
[0m12:47:39.468773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb833051-f8bc-4fc2-8f88-53e0be4b7d18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77724a960680>]}
[0m12:47:39.470390 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m12:47:39.554151 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m12:47:39.657606 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m12:47:39.658239 [debug] [MainThread]: Partial parsing: added file: modern_stack_banking://models/Gold/gold_fraud_dashboard.sql
[0m12:47:39.874949 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.modern_stack_banking.gold_fraud_dashboard' (models/Gold/gold_fraud_dashboard.sql) depends on a node named 'sat_txn_ai_insights' which was not found
[0m12:47:39.876193 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.78918564, "process_in_blocks": "0", "process_kernel_time": 0.214128, "process_mem_max_rss": "178664", "process_out_blocks": "16", "process_user_time": 2.099255}
[0m12:47:39.876842 [debug] [MainThread]: Command `dbt run` failed at 12:47:39.876726 after 0.79 seconds
[0m12:47:39.877373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77725ac83e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77724a56dbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77724a56e330>]}
[0m12:47:39.877921 [debug] [MainThread]: Flushing usage events
[0m12:47:41.038744 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:49:51.727918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77165b47bcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77165ac9a5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77165b27d4f0>]}


============================== 12:49:51.731216 | 1e851241-2d2d-47f9-a0b8-f7253217c96b ==============================
[0m12:49:51.731216 [info ] [MainThread]: Running with dbt=1.11.2
[0m12:49:51.731905 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --select gold_fraud_dashboard --profiles-dir .', 'printer_width': '80', 'introspect': 'True', 'target_path': 'None', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'fail_fast': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'empty': 'False', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'static_parser': 'True', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'partial_parse': 'True', 'version_check': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'profiles_dir': '.', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False'}
[0m12:49:51.978421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e851241-2d2d-47f9-a0b8-f7253217c96b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77165aacdcd0>]}
[0m12:49:52.050210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1e851241-2d2d-47f9-a0b8-f7253217c96b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77164ef65010>]}
[0m12:49:52.052053 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m12:49:52.137871 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m12:49:52.251855 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m12:49:52.252524 [debug] [MainThread]: Partial parsing: added file: modern_stack_banking://models/Vault/sats/sat_txn_ai_insights.sql
[0m12:49:52.253109 [debug] [MainThread]: Partial parsing: added file: modern_stack_banking://models/Gold/gold_fraud_dashboard.sql
[0m12:49:52.539498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e851241-2d2d-47f9-a0b8-f7253217c96b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77164cbe3f20>]}
[0m12:49:52.609941 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m12:49:52.611812 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m12:49:52.624536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e851241-2d2d-47f9-a0b8-f7253217c96b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77164ec4b530>]}
[0m12:49:52.625124 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m12:49:52.625608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e851241-2d2d-47f9-a0b8-f7253217c96b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77164cba05f0>]}
[0m12:49:52.627388 [info ] [MainThread]: 
[0m12:49:52.627946 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:49:52.628393 [info ] [MainThread]: 
[0m12:49:52.629043 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:49:52.630080 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m12:49:52.665238 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m12:49:52.665763 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m12:49:52.666207 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:49:52.752260 [debug] [ThreadPool]: SQL status: OK in 0.086 seconds
[0m12:49:52.753924 [debug] [ThreadPool]: On list_argus_vault: Close
[0m12:49:52.754826 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m12:49:52.755439 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m12:49:52.762808 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m12:49:52.763316 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m12:49:52.763800 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:49:52.765260 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:49:52.766610 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m12:49:52.767103 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m12:49:52.767763 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:49:52.768224 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m12:49:52.768705 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m12:49:52.769389 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:49:52.770358 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m12:49:52.770853 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m12:49:52.771306 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m12:49:52.771967 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:49:52.772436 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m12:49:52.777956 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m12:49:52.784036 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m12:49:52.784494 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m12:49:52.784929 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:49:52.785772 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:49:52.786204 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m12:49:52.786621 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m12:49:52.797425 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m12:49:52.798951 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m12:49:52.800212 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m12:49:52.800684 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m12:49:52.802038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e851241-2d2d-47f9-a0b8-f7253217c96b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77164cbeccb0>]}
[0m12:49:52.802723 [debug] [MainThread]: Using duckdb connection "master"
[0m12:49:52.803166 [debug] [MainThread]: On master: BEGIN
[0m12:49:52.803569 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:49:52.804477 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:49:52.804968 [debug] [MainThread]: On master: COMMIT
[0m12:49:52.805391 [debug] [MainThread]: Using duckdb connection "master"
[0m12:49:52.805818 [debug] [MainThread]: On master: COMMIT
[0m12:49:52.806424 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:49:52.806895 [debug] [MainThread]: On master: Close
[0m12:49:52.808861 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.gold_fraud_dashboard
[0m12:49:52.809483 [info ] [Thread-1 (]: 1 of 1 START sql view model main.gold_fraud_dashboard .......................... [RUN]
[0m12:49:52.810071 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.gold_fraud_dashboard)
[0m12:49:52.810548 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.gold_fraud_dashboard
[0m12:49:52.818638 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.gold_fraud_dashboard"
[0m12:49:52.819325 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.gold_fraud_dashboard
[0m12:49:52.907552 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.gold_fraud_dashboard"
[0m12:49:52.908393 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.gold_fraud_dashboard"
[0m12:49:52.908931 [debug] [Thread-1 (]: On model.modern_stack_banking.gold_fraud_dashboard: BEGIN
[0m12:49:52.909402 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:49:52.910630 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:49:52.911151 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.gold_fraud_dashboard"
[0m12:49:52.911663 [debug] [Thread-1 (]: On model.modern_stack_banking.gold_fraud_dashboard: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.gold_fraud_dashboard"} */

  
  create view "argus_vault"."main"."gold_fraud_dashboard__dbt_tmp" as (
    

WITH hubs AS (
    -- Updated to use the full path
    SELECT 
        txn_hash_key, 
        txn_id, 
        load_date as established_date 
    FROM "argus_vault"."main"."hubs_transactions" 
),

features AS (
    -- Updated to use the full path
    SELECT 
        txn_hash_key, 
        amount, 
        is_fraud_label, 
        pca_features,
        load_date as observation_date
    FROM "argus_vault"."main"."sat_txn_features"
    QUALIFY ROW_NUMBER() OVER (PARTITION BY txn_hash_key ORDER BY load_date DESC) = 1
),

ai_insights AS (
    -- THIS IS THE CRITICAL FIX: Match the folder-based naming
    SELECT 
        txn_hash_key, 
        ai_reason_for_flag,
        load_date as insight_date
    FROM "argus_vault"."main"."sat_txn_ai_insights"
    QUALIFY ROW_NUMBER() OVER (PARTITION BY txn_hash_key ORDER BY load_date DESC) = 1
)

SELECT 
    h.txn_id,
    f.amount,
    f.is_fraud_label,
    CASE 
        WHEN f.is_fraud_label = 1 THEN '🚩 FRAUD'
        ELSE '✅ NORMAL'
    END as fraud_status,
    a.ai_reason_for_flag as forensic_explanation,
    f.pca_features,
    h.established_date
FROM hubs h
LEFT JOIN features f ON h.txn_hash_key = f.txn_hash_key
LEFT JOIN ai_insights a ON h.txn_hash_key = a.txn_hash_key
  );

[0m12:49:52.913104 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.gold_fraud_dashboard"} */

  
  create view "argus_vault"."main"."gold_fraud_dashboard__dbt_tmp" as (
    

WITH hubs AS (
    -- Updated to use the full path
    SELECT 
        txn_hash_key, 
        txn_id, 
        load_date as established_date 
    FROM "argus_vault"."main"."hubs_transactions" 
),

features AS (
    -- Updated to use the full path
    SELECT 
        txn_hash_key, 
        amount, 
        is_fraud_label, 
        pca_features,
        load_date as observation_date
    FROM "argus_vault"."main"."sat_txn_features"
    QUALIFY ROW_NUMBER() OVER (PARTITION BY txn_hash_key ORDER BY load_date DESC) = 1
),

ai_insights AS (
    -- THIS IS THE CRITICAL FIX: Match the folder-based naming
    SELECT 
        txn_hash_key, 
        ai_reason_for_flag,
        load_date as insight_date
    FROM "argus_vault"."main"."sat_txn_ai_insights"
    QUALIFY ROW_NUMBER() OVER (PARTITION BY txn_hash_key ORDER BY load_date DESC) = 1
)

SELECT 
    h.txn_id,
    f.amount,
    f.is_fraud_label,
    CASE 
        WHEN f.is_fraud_label = 1 THEN '🚩 FRAUD'
        ELSE '✅ NORMAL'
    END as fraud_status,
    a.ai_reason_for_flag as forensic_explanation,
    f.pca_features,
    h.established_date
FROM hubs h
LEFT JOIN features f ON h.txn_hash_key = f.txn_hash_key
LEFT JOIN ai_insights a ON h.txn_hash_key = a.txn_hash_key
  );

[0m12:49:52.913679 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:49:52.914311 [debug] [Thread-1 (]: On model.modern_stack_banking.gold_fraud_dashboard: ROLLBACK
[0m12:49:52.918038 [debug] [Thread-1 (]: Failed to rollback 'model.modern_stack_banking.gold_fraud_dashboard'
[0m12:49:52.918550 [debug] [Thread-1 (]: On model.modern_stack_banking.gold_fraud_dashboard: Close
[0m12:49:52.920835 [debug] [Thread-1 (]: Runtime Error in model gold_fraud_dashboard (models/Gold/gold_fraud_dashboard.sql)
  Catalog Error: Table with name sat_txn_ai_insights does not exist!
  Did you mean "sat_txn_features"?
  
  LINE 34:     FROM "argus_vault"."main"."sat_txn_ai_insights"
                    ^
[0m12:49:52.922461 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e851241-2d2d-47f9-a0b8-f7253217c96b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77165d5e0830>]}
[0m12:49:52.923208 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.gold_fraud_dashboard ................. [[31mERROR[0m in 0.11s]
[0m12:49:52.923968 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.gold_fraud_dashboard
[0m12:49:52.924752 [debug] [Thread-4 (]: Marking all children of 'model.modern_stack_banking.gold_fraud_dashboard' to be skipped because of status 'error'.  Reason: Runtime Error in model gold_fraud_dashboard (models/Gold/gold_fraud_dashboard.sql)
  Catalog Error: Table with name sat_txn_ai_insights does not exist!
  Did you mean "sat_txn_features"?
  
  LINE 34:     FROM "argus_vault"."main"."sat_txn_ai_insights"
                    ^.
[0m12:49:52.926739 [debug] [MainThread]: Using duckdb connection "master"
[0m12:49:52.927200 [debug] [MainThread]: On master: BEGIN
[0m12:49:52.927608 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:49:52.928569 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:49:52.929131 [debug] [MainThread]: On master: COMMIT
[0m12:49:52.929552 [debug] [MainThread]: Using duckdb connection "master"
[0m12:49:52.929989 [debug] [MainThread]: On master: COMMIT
[0m12:49:52.930752 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:49:52.931208 [debug] [MainThread]: On master: Close
[0m12:49:52.931731 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:49:52.932142 [debug] [MainThread]: Connection 'model.modern_stack_banking.gold_fraud_dashboard' was properly closed.
[0m12:49:52.932555 [info ] [MainThread]: 
[0m12:49:52.933047 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m12:49:52.933843 [debug] [MainThread]: Command end result
[0m12:49:52.953203 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m12:49:52.954812 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m12:49:52.960494 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m12:49:52.960960 [info ] [MainThread]: 
[0m12:49:52.961481 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:49:52.961967 [info ] [MainThread]: 
[0m12:49:52.962492 [error] [MainThread]: [31mFailure in model gold_fraud_dashboard (models/Gold/gold_fraud_dashboard.sql)[0m
[0m12:49:52.963031 [error] [MainThread]:   Runtime Error in model gold_fraud_dashboard (models/Gold/gold_fraud_dashboard.sql)
  Catalog Error: Table with name sat_txn_ai_insights does not exist!
  Did you mean "sat_txn_features"?
  
  LINE 34:     FROM "argus_vault"."main"."sat_txn_ai_insights"
                    ^
[0m12:49:52.963478 [info ] [MainThread]: 
[0m12:49:52.963990 [info ] [MainThread]:   compiled code at target/compiled/modern_stack_banking/models/Gold/gold_fraud_dashboard.sql
[0m12:49:52.964422 [info ] [MainThread]: 
[0m12:49:52.964905 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:49:52.965908 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3006308, "process_in_blocks": "0", "process_kernel_time": 0.28907, "process_mem_max_rss": "255016", "process_out_blocks": "3120", "process_user_time": 3.254755}
[0m12:49:52.966481 [debug] [MainThread]: Command `dbt run` failed at 12:49:52.966371 after 1.30 seconds
[0m12:49:52.966977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77165ac9a5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77165be7c740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77165bb15df0>]}
[0m12:49:52.967446 [debug] [MainThread]: Flushing usage events
[0m12:49:54.045873 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:52:34.504660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727b54f43ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727b54f42120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727b54f42e70>]}


============================== 12:52:34.507951 | bf01e2c3-d966-45db-899f-3d55652066dc ==============================
[0m12:52:34.507951 [info ] [MainThread]: Running with dbt=1.11.2
[0m12:52:34.508627 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'quiet': 'False', 'fail_fast': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'static_parser': 'True', 'use_experimental_parser': 'False', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'partial_parse': 'True', 'debug': 'False', 'write_json': 'True', 'empty': 'False', 'invocation_command': 'dbt run --select sat_txn_ai_insights --profiles-dir .', 'log_format': 'default', 'warn_error': 'None', 'target_path': 'None', 'introspect': 'True', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'printer_width': '80', 'use_colors': 'True'}
[0m12:52:34.754371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf01e2c3-d966-45db-899f-3d55652066dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727b546a4800>]}
[0m12:52:34.826880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf01e2c3-d966-45db-899f-3d55652066dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727b5474ef60>]}
[0m12:52:34.828756 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m12:52:34.912574 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m12:52:35.016736 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:52:35.017235 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m12:52:35.017687 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:52:35.059435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf01e2c3-d966-45db-899f-3d55652066dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727b54715b80>]}
[0m12:52:35.131104 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m12:52:35.132774 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m12:52:35.145094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf01e2c3-d966-45db-899f-3d55652066dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727b488bcf20>]}
[0m12:52:35.145660 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m12:52:35.146181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf01e2c3-d966-45db-899f-3d55652066dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727b48b6ac90>]}
[0m12:52:35.147963 [info ] [MainThread]: 
[0m12:52:35.148462 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:52:35.148941 [info ] [MainThread]: 
[0m12:52:35.149560 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:52:35.150620 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m12:52:35.186507 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m12:52:35.187037 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m12:52:35.187494 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:52:35.273863 [debug] [ThreadPool]: SQL status: OK in 0.086 seconds
[0m12:52:35.275514 [debug] [ThreadPool]: On list_argus_vault: Close
[0m12:52:35.276386 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m12:52:35.277017 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m12:52:35.284426 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m12:52:35.284920 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m12:52:35.285354 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:52:35.286523 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:52:35.287859 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m12:52:35.288308 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m12:52:35.288928 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:52:35.289369 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m12:52:35.289813 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m12:52:35.290467 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:52:35.291417 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m12:52:35.291891 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m12:52:35.292315 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m12:52:35.293021 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:52:35.293477 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m12:52:35.298951 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m12:52:35.304626 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m12:52:35.305103 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m12:52:35.305511 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:52:35.306371 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:52:35.306839 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m12:52:35.307260 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m12:52:35.318029 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m12:52:35.319514 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m12:52:35.320781 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m12:52:35.321228 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m12:52:35.322543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf01e2c3-d966-45db-899f-3d55652066dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727b48b44950>]}
[0m12:52:35.323241 [debug] [MainThread]: Using duckdb connection "master"
[0m12:52:35.323691 [debug] [MainThread]: On master: BEGIN
[0m12:52:35.324111 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:52:35.325175 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:52:35.325631 [debug] [MainThread]: On master: COMMIT
[0m12:52:35.326086 [debug] [MainThread]: Using duckdb connection "master"
[0m12:52:35.326499 [debug] [MainThread]: On master: COMMIT
[0m12:52:35.327150 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:52:35.327591 [debug] [MainThread]: On master: Close
[0m12:52:35.329607 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m12:52:35.330268 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m12:52:35.330856 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m12:52:35.331341 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m12:52:35.339413 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m12:52:35.340102 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m12:52:35.397527 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m12:52:35.398257 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m12:52:35.398785 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m12:52:35.399253 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:52:35.400253 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:52:35.400777 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m12:52:35.401268 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

  
    
    

    create  table
      "argus_vault"."main"."sat_txn_ai_insights"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Pending AI Review' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '0000'
    );
  
  
  
[0m12:52:35.406188 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m12:52:35.420225 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m12:52:35.420793 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m12:52:35.421278 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m12:52:35.430203 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m12:52:35.432156 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m12:52:35.433845 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf01e2c3-d966-45db-899f-3d55652066dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727b5563bad0>]}
[0m12:52:35.434600 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.10s]
[0m12:52:35.435364 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m12:52:35.436793 [debug] [MainThread]: Using duckdb connection "master"
[0m12:52:35.437250 [debug] [MainThread]: On master: BEGIN
[0m12:52:35.437684 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:52:35.438664 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:52:35.439163 [debug] [MainThread]: On master: COMMIT
[0m12:52:35.439591 [debug] [MainThread]: Using duckdb connection "master"
[0m12:52:35.440059 [debug] [MainThread]: On master: COMMIT
[0m12:52:35.440738 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:52:35.441189 [debug] [MainThread]: On master: Close
[0m12:52:35.441712 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:52:35.442135 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m12:52:35.442563 [info ] [MainThread]: 
[0m12:52:35.443053 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m12:52:35.443854 [debug] [MainThread]: Command end result
[0m12:52:35.463114 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m12:52:35.464725 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m12:52:35.470506 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m12:52:35.470987 [info ] [MainThread]: 
[0m12:52:35.471516 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:52:35.471995 [info ] [MainThread]: 
[0m12:52:35.472476 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:52:35.473493 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0313895, "process_in_blocks": "0", "process_kernel_time": 0.285478, "process_mem_max_rss": "265200", "process_out_blocks": "2112", "process_user_time": 2.95159}
[0m12:52:35.474103 [debug] [MainThread]: Command `dbt run` succeeded at 12:52:35.473999 after 1.03 seconds
[0m12:52:35.474578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727b556d8c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727b54835fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727b54835490>]}
[0m12:52:35.475076 [debug] [MainThread]: Flushing usage events
[0m12:52:36.516761 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:52:44.124980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7295bc87dca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7295bca16120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7295bce11d00>]}


============================== 12:52:44.128351 | 3b9cde4e-9e12-4ef2-839e-be0f90ac6dba ==============================
[0m12:52:44.128351 [info ] [MainThread]: Running with dbt=1.11.2
[0m12:52:44.129031 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'fail_fast': 'False', 'debug': 'False', 'profiles_dir': '.', 'indirect_selection': 'eager', 'target_path': 'None', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select gold_fraud_dashboard --profiles-dir .', 'write_json': 'True', 'printer_width': '80', 'no_print': 'None', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'warn_error': 'None', 'empty': 'False', 'version_check': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'quiet': 'False', 'introspect': 'True'}
[0m12:52:44.372997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b9cde4e-9e12-4ef2-839e-be0f90ac6dba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7295bcfaeb70>]}
[0m12:52:44.443472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3b9cde4e-9e12-4ef2-839e-be0f90ac6dba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7295be0bc7d0>]}
[0m12:52:44.445100 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m12:52:44.528290 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m12:52:44.631919 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:52:44.632425 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m12:52:44.632878 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:52:44.674149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3b9cde4e-9e12-4ef2-839e-be0f90ac6dba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7295b044d3d0>]}
[0m12:52:44.745939 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m12:52:44.747620 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m12:52:44.760006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3b9cde4e-9e12-4ef2-839e-be0f90ac6dba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7295b01c4d40>]}
[0m12:52:44.760561 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m12:52:44.761089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b9cde4e-9e12-4ef2-839e-be0f90ac6dba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7295b01b8290>]}
[0m12:52:44.762839 [info ] [MainThread]: 
[0m12:52:44.763361 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:52:44.763846 [info ] [MainThread]: 
[0m12:52:44.764477 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:52:44.765530 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m12:52:44.801622 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m12:52:44.802152 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m12:52:44.802604 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:52:44.889454 [debug] [ThreadPool]: SQL status: OK in 0.087 seconds
[0m12:52:44.891125 [debug] [ThreadPool]: On list_argus_vault: Close
[0m12:52:44.892000 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m12:52:44.892576 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m12:52:44.899896 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m12:52:44.900363 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m12:52:44.900816 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:52:44.902473 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m12:52:44.903820 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m12:52:44.904265 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m12:52:44.904893 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:52:44.905323 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m12:52:44.905747 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m12:52:44.906415 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:52:44.907339 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m12:52:44.907798 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m12:52:44.908209 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m12:52:44.908857 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:52:44.909296 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m12:52:44.914703 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m12:52:44.920309 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m12:52:44.920785 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m12:52:44.921197 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:52:44.922062 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:52:44.922507 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m12:52:44.922953 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m12:52:44.934629 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m12:52:44.936151 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m12:52:44.937391 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m12:52:44.937846 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m12:52:44.939296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b9cde4e-9e12-4ef2-839e-be0f90ac6dba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7295b044d640>]}
[0m12:52:44.939909 [debug] [MainThread]: Using duckdb connection "master"
[0m12:52:44.940338 [debug] [MainThread]: On master: BEGIN
[0m12:52:44.940761 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:52:44.941612 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:52:44.942079 [debug] [MainThread]: On master: COMMIT
[0m12:52:44.942497 [debug] [MainThread]: Using duckdb connection "master"
[0m12:52:44.942933 [debug] [MainThread]: On master: COMMIT
[0m12:52:44.943526 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:52:44.943982 [debug] [MainThread]: On master: Close
[0m12:52:44.945942 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.gold_fraud_dashboard
[0m12:52:44.946553 [info ] [Thread-1 (]: 1 of 1 START sql view model main.gold_fraud_dashboard .......................... [RUN]
[0m12:52:44.947129 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.gold_fraud_dashboard)
[0m12:52:44.947618 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.gold_fraud_dashboard
[0m12:52:44.955739 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.gold_fraud_dashboard"
[0m12:52:44.956437 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.gold_fraud_dashboard
[0m12:52:44.989152 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.gold_fraud_dashboard"
[0m12:52:44.989899 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.gold_fraud_dashboard"
[0m12:52:44.990389 [debug] [Thread-1 (]: On model.modern_stack_banking.gold_fraud_dashboard: BEGIN
[0m12:52:44.990869 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:52:44.991836 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:52:44.992323 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.gold_fraud_dashboard"
[0m12:52:44.992847 [debug] [Thread-1 (]: On model.modern_stack_banking.gold_fraud_dashboard: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.gold_fraud_dashboard"} */

  
  create view "argus_vault"."main"."gold_fraud_dashboard__dbt_tmp" as (
    

WITH hubs AS (
    -- Updated to use the full path
    SELECT 
        txn_hash_key, 
        txn_id, 
        load_date as established_date 
    FROM "argus_vault"."main"."hubs_transactions" 
),

features AS (
    -- Updated to use the full path
    SELECT 
        txn_hash_key, 
        amount, 
        is_fraud_label, 
        pca_features,
        load_date as observation_date
    FROM "argus_vault"."main"."sat_txn_features"
    QUALIFY ROW_NUMBER() OVER (PARTITION BY txn_hash_key ORDER BY load_date DESC) = 1
),

ai_insights AS (
    -- THIS IS THE CRITICAL FIX: Match the folder-based naming
    SELECT 
        txn_hash_key, 
        ai_reason_for_flag,
        load_date as insight_date
    FROM "argus_vault"."main"."sat_txn_ai_insights"
    QUALIFY ROW_NUMBER() OVER (PARTITION BY txn_hash_key ORDER BY load_date DESC) = 1
)

SELECT 
    h.txn_id,
    f.amount,
    f.is_fraud_label,
    CASE 
        WHEN f.is_fraud_label = 1 THEN '🚩 FRAUD'
        ELSE '✅ NORMAL'
    END as fraud_status,
    a.ai_reason_for_flag as forensic_explanation,
    f.pca_features,
    h.established_date
FROM hubs h
LEFT JOIN features f ON h.txn_hash_key = f.txn_hash_key
LEFT JOIN ai_insights a ON h.txn_hash_key = a.txn_hash_key
  );

[0m12:52:44.994122 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:52:45.000247 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.gold_fraud_dashboard"
[0m12:52:45.000774 [debug] [Thread-1 (]: On model.modern_stack_banking.gold_fraud_dashboard: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.gold_fraud_dashboard"} */
alter view "argus_vault"."main"."gold_fraud_dashboard__dbt_tmp" rename to "gold_fraud_dashboard"
[0m12:52:45.001573 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:52:45.011873 [debug] [Thread-1 (]: On model.modern_stack_banking.gold_fraud_dashboard: COMMIT
[0m12:52:45.012386 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.gold_fraud_dashboard"
[0m12:52:45.012874 [debug] [Thread-1 (]: On model.modern_stack_banking.gold_fraud_dashboard: COMMIT
[0m12:52:45.021659 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m12:52:45.027259 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.gold_fraud_dashboard"
[0m12:52:45.027784 [debug] [Thread-1 (]: On model.modern_stack_banking.gold_fraud_dashboard: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.gold_fraud_dashboard"} */

      drop view if exists "argus_vault"."main"."gold_fraud_dashboard__dbt_backup" cascade
    
[0m12:52:45.028598 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:52:45.030993 [debug] [Thread-1 (]: On model.modern_stack_banking.gold_fraud_dashboard: Close
[0m12:52:45.032611 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b9cde4e-9e12-4ef2-839e-be0f90ac6dba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7295bed28da0>]}
[0m12:52:45.033362 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.gold_fraud_dashboard ..................... [[32mOK[0m in 0.08s]
[0m12:52:45.034107 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.gold_fraud_dashboard
[0m12:52:45.035424 [debug] [MainThread]: Using duckdb connection "master"
[0m12:52:45.035903 [debug] [MainThread]: On master: BEGIN
[0m12:52:45.036316 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:52:45.037298 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:52:45.037765 [debug] [MainThread]: On master: COMMIT
[0m12:52:45.038188 [debug] [MainThread]: Using duckdb connection "master"
[0m12:52:45.038688 [debug] [MainThread]: On master: COMMIT
[0m12:52:45.039425 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:52:45.039925 [debug] [MainThread]: On master: Close
[0m12:52:45.040462 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:52:45.040918 [debug] [MainThread]: Connection 'model.modern_stack_banking.gold_fraud_dashboard' was properly closed.
[0m12:52:45.041391 [info ] [MainThread]: 
[0m12:52:45.041909 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m12:52:45.042745 [debug] [MainThread]: Command end result
[0m12:52:45.064854 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m12:52:45.066504 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m12:52:45.072347 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m12:52:45.072824 [info ] [MainThread]: 
[0m12:52:45.073390 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:52:45.073886 [info ] [MainThread]: 
[0m12:52:45.074408 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:52:45.075449 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0131735, "process_in_blocks": "0", "process_kernel_time": 0.285062, "process_mem_max_rss": "255508", "process_out_blocks": "2120", "process_user_time": 2.924599}
[0m12:52:45.076088 [debug] [MainThread]: Command `dbt run` succeeded at 12:52:45.075977 after 1.01 seconds
[0m12:52:45.076586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7295bc11bfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7295bca148c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7295bcf69af0>]}
[0m12:52:45.077120 [debug] [MainThread]: Flushing usage events
[0m12:52:46.133995 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:59:19.896047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5db98b84a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5dbbffdaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5db98b8470>]}


============================== 12:59:19.899349 | adfc5b70-9dfa-464e-bdb9-7828f8e69df1 ==============================
[0m12:59:19.899349 [info ] [MainThread]: Running with dbt=1.11.2
[0m12:59:19.900108 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'debug': 'False', 'cache_selected_only': 'False', 'quiet': 'False', 'partial_parse': 'True', 'write_json': 'True', 'use_colors': 'True', 'version_check': 'True', 'introspect': 'True', 'log_format': 'default', 'warn_error': 'None', 'indirect_selection': 'eager', 'static_parser': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'target_path': 'None', 'profiles_dir': '.', 'log_cache_events': 'False', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "5142e1f7-4873-4cfd-ab71-c1731ad3861e", "ai_explanation": "The transaction is fraud due to a significant anomaly score (-2.3122265423263) indicating suspicious behavior in multiple PCA factors."} --profiles-dir .', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None'}
[0m12:59:20.149295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'adfc5b70-9dfa-464e-bdb9-7828f8e69df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5dad53b4a0>]}
[0m12:59:20.220401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'adfc5b70-9dfa-464e-bdb9-7828f8e69df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5dad43ac60>]}
[0m12:59:20.222016 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m12:59:20.306698 [debug] [MainThread]: checksum: c54556ce5f4b3bcdaa63e85a86dd5e003bc249ee819bd6d4de7b6eb44417b8c3, vars: {'ai_explanation': 'The transaction is fraud due to a significant anomaly '
                   'score (-2.3122265423263) indicating suspicious behavior in '
                   'multiple PCA factors.',
 'txn_id': '5142e1f7-4873-4cfd-ab71-c1731ad3861e'}, profile: , target: , version: 1.11.2
[0m12:59:20.399762 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m12:59:20.400330 [debug] [MainThread]: previous checksum: c54556ce5f4b3bcdaa63e85a86dd5e003bc249ee819bd6d4de7b6eb44417b8c3, current checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b
[0m12:59:20.400851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'adfc5b70-9dfa-464e-bdb9-7828f8e69df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5dad2a62d0>]}
[0m12:59:21.620766 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m12:59:21.621425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'adfc5b70-9dfa-464e-bdb9-7828f8e69df1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5db913d730>]}
[0m12:59:21.713311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'adfc5b70-9dfa-464e-bdb9-7828f8e69df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5dac1f3110>]}
[0m12:59:21.784371 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m12:59:21.786086 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m12:59:21.798275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'adfc5b70-9dfa-464e-bdb9-7828f8e69df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5dac0d1340>]}
[0m12:59:21.798888 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m12:59:21.799405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'adfc5b70-9dfa-464e-bdb9-7828f8e69df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5dac192390>]}
[0m12:59:21.801207 [info ] [MainThread]: 
[0m12:59:21.801765 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:59:21.802239 [info ] [MainThread]: 
[0m12:59:21.802912 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:59:21.803990 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m12:59:21.838762 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m12:59:21.839246 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m12:59:21.839717 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:59:21.931097 [debug] [ThreadPool]: SQL status: OK in 0.091 seconds
[0m12:59:21.932791 [debug] [ThreadPool]: On list_argus_vault: Close
[0m12:59:21.933694 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m12:59:21.934306 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m12:59:21.941516 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m12:59:21.942038 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m12:59:21.942498 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:59:21.943733 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:59:21.945070 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m12:59:21.945541 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m12:59:21.946188 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:59:21.946644 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m12:59:21.947120 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m12:59:21.947797 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:59:21.948768 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m12:59:21.949244 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m12:59:21.949714 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m12:59:21.950344 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:59:21.950834 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m12:59:21.956284 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m12:59:21.961818 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m12:59:21.962397 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m12:59:21.962868 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:59:21.964033 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:59:21.964507 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m12:59:21.965010 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m12:59:21.976581 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m12:59:21.978008 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m12:59:21.979260 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m12:59:21.979721 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m12:59:21.981194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'adfc5b70-9dfa-464e-bdb9-7828f8e69df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5da4585d90>]}
[0m12:59:21.981805 [debug] [MainThread]: Using duckdb connection "master"
[0m12:59:21.982269 [debug] [MainThread]: On master: BEGIN
[0m12:59:21.982727 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:59:21.983587 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:59:21.984080 [debug] [MainThread]: On master: COMMIT
[0m12:59:21.984533 [debug] [MainThread]: Using duckdb connection "master"
[0m12:59:21.984994 [debug] [MainThread]: On master: COMMIT
[0m12:59:21.985638 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:59:21.986130 [debug] [MainThread]: On master: Close
[0m12:59:21.988194 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m12:59:21.988868 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m12:59:21.989468 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m12:59:21.989981 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m12:59:21.997801 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m12:59:21.998534 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m12:59:22.057943 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m12:59:22.058542 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201125922033614"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'The transaction is fraud due to a significant anomaly score (-2.3122265423263) indicating suspicious behavior in multiple PCA factors.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '5142e1f7-4873-4cfd-ab71-c1731ad3861e'
    );
  
  
  
[0m12:59:22.059063 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:59:22.067469 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m12:59:22.074854 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m12:59:22.075368 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m12:59:22.076062 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:59:22.076547 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m12:59:22.077048 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201125922033614'
      
      
      order by ordinal_position

  
[0m12:59:22.079591 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:59:22.084501 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m12:59:22.085049 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m12:59:22.087945 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:59:22.098017 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m12:59:22.098548 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m12:59:22.101039 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:59:22.102550 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m12:59:22.103082 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m12:59:22.103885 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:59:22.120198 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m12:59:22.120975 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m12:59:22.121478 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201125922033614"
    )
  
[0m12:59:22.122617 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:59:22.132972 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m12:59:22.133507 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m12:59:22.134004 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m12:59:22.148256 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m12:59:22.150278 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m12:59:22.151989 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'adfc5b70-9dfa-464e-bdb9-7828f8e69df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5dba123980>]}
[0m12:59:22.152751 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m12:59:22.153494 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m12:59:22.155077 [debug] [MainThread]: Using duckdb connection "master"
[0m12:59:22.155564 [debug] [MainThread]: On master: BEGIN
[0m12:59:22.156047 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:59:22.157091 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:59:22.157566 [debug] [MainThread]: On master: COMMIT
[0m12:59:22.158042 [debug] [MainThread]: Using duckdb connection "master"
[0m12:59:22.158483 [debug] [MainThread]: On master: COMMIT
[0m12:59:22.159143 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:59:22.159618 [debug] [MainThread]: On master: Close
[0m12:59:22.160186 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:59:22.160613 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m12:59:22.161107 [info ] [MainThread]: 
[0m12:59:22.161593 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m12:59:22.162428 [debug] [MainThread]: Command end result
[0m12:59:22.182623 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m12:59:22.184323 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m12:59:22.190090 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m12:59:22.190560 [info ] [MainThread]: 
[0m12:59:22.191125 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:59:22.191597 [info ] [MainThread]: 
[0m12:59:22.192098 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:59:22.192752 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m12:59:22.193816 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.361641, "process_in_blocks": "0", "process_kernel_time": 0.339668, "process_mem_max_rss": "268472", "process_out_blocks": "3128", "process_user_time": 4.266156}
[0m12:59:22.194415 [debug] [MainThread]: Command `dbt run` succeeded at 12:59:22.194297 after 2.36 seconds
[0m12:59:22.194913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5dba102420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5dba1033b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5dba103830>]}
[0m12:59:22.195410 [debug] [MainThread]: Flushing usage events
[0m12:59:23.252567 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:35:39.388554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a0f0907020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a0f2cbf590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a0f1003590>]}


============================== 16:35:39.393687 | d5ef4b8a-37f4-4ab5-9723-4b2f16392edb ==============================
[0m16:35:39.393687 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:35:39.394359 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'partial_parse': 'True', 'log_format': 'default', 'static_parser': 'True', 'cache_selected_only': 'False', 'introspect': 'True', 'profiles_dir': '.', 'log_cache_events': 'False', 'write_json': 'True', 'warn_error': 'None', 'empty': 'False', 'indirect_selection': 'eager', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'printer_width': '80', 'use_colors': 'True', 'quiet': 'False', 'fail_fast': 'False', 'invocation_command': 'dbt run --select gold_fraud_dashboard --profiles-dir .', 'debug': 'False'}
[0m16:35:39.667009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd5ef4b8a-37f4-4ab5-9723-4b2f16392edb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a0efee30b0>]}
[0m16:35:39.739344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd5ef4b8a-37f4-4ab5-9723-4b2f16392edb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a0f1398a70>]}
[0m16:35:39.741140 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m16:35:39.829714 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:35:39.926110 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:35:39.926736 [debug] [MainThread]: previous checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, current checksum: c54556ce5f4b3bcdaa63e85a86dd5e003bc249ee819bd6d4de7b6eb44417b8c3
[0m16:35:39.927233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd5ef4b8a-37f4-4ab5-9723-4b2f16392edb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a0e41a25a0>]}
[0m16:35:41.156134 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m16:35:41.156830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd5ef4b8a-37f4-4ab5-9723-4b2f16392edb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a0e3f83800>]}
[0m16:35:41.249312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd5ef4b8a-37f4-4ab5-9723-4b2f16392edb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a0eff3d490>]}
[0m16:35:41.320221 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m16:35:41.322212 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m16:35:41.340085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd5ef4b8a-37f4-4ab5-9723-4b2f16392edb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a0e01cd8e0>]}
[0m16:35:41.340751 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m16:35:41.341273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5ef4b8a-37f4-4ab5-9723-4b2f16392edb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a0e3f11820>]}
[0m16:35:41.343128 [info ] [MainThread]: 
[0m16:35:41.343639 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:35:41.344169 [info ] [MainThread]: 
[0m16:35:41.344858 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:35:41.345948 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m16:35:41.628349 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m16:35:41.629025 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m16:35:41.629464 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:46.523423 [debug] [ThreadPool]: SQL status: OK in 4.894 seconds
[0m16:35:46.525206 [debug] [ThreadPool]: On list_argus_vault: Close
[0m16:35:46.526218 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m16:35:46.526844 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m16:35:46.534560 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m16:35:46.535057 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m16:35:46.535490 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:35:46.536746 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:35:46.538161 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m16:35:46.538613 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m16:35:46.539304 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:35:46.539743 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m16:35:46.540196 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m16:35:46.540844 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:35:46.541811 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m16:35:46.542284 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m16:35:46.542701 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m16:35:46.543385 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:35:46.543828 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m16:35:46.549587 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m16:35:46.555893 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m16:35:46.556457 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m16:35:46.556870 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:35:46.557810 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:35:46.558274 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m16:35:46.558698 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m16:35:46.569568 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m16:35:46.571038 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m16:35:46.572299 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m16:35:46.572746 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m16:35:46.574575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5ef4b8a-37f4-4ab5-9723-4b2f16392edb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a0e41a28d0>]}
[0m16:35:46.575255 [debug] [MainThread]: Using duckdb connection "master"
[0m16:35:46.575839 [debug] [MainThread]: On master: BEGIN
[0m16:35:46.576368 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:35:46.577539 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:35:46.578005 [debug] [MainThread]: On master: COMMIT
[0m16:35:46.578432 [debug] [MainThread]: Using duckdb connection "master"
[0m16:35:46.578838 [debug] [MainThread]: On master: COMMIT
[0m16:35:46.579484 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:35:46.579949 [debug] [MainThread]: On master: Close
[0m16:35:46.582412 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.gold_fraud_dashboard
[0m16:35:46.583146 [info ] [Thread-1 (]: 1 of 1 START sql view model main.gold_fraud_dashboard .......................... [RUN]
[0m16:35:46.583740 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.gold_fraud_dashboard)
[0m16:35:46.584266 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.gold_fraud_dashboard
[0m16:35:46.592498 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.gold_fraud_dashboard"
[0m16:35:46.593241 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.gold_fraud_dashboard
[0m16:35:46.624500 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.gold_fraud_dashboard"
[0m16:35:46.625307 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.gold_fraud_dashboard"
[0m16:35:46.625801 [debug] [Thread-1 (]: On model.modern_stack_banking.gold_fraud_dashboard: BEGIN
[0m16:35:46.626284 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:35:46.627646 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:35:46.628156 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.gold_fraud_dashboard"
[0m16:35:46.628656 [debug] [Thread-1 (]: On model.modern_stack_banking.gold_fraud_dashboard: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.gold_fraud_dashboard"} */

  
  create view "argus_vault"."main"."gold_fraud_dashboard__dbt_tmp" as (
    

WITH hubs AS (
    SELECT txn_hash_key, txn_id, load_date as established_date 
    FROM "argus_vault"."main"."hubs_transactions"
),
features AS (
    SELECT txn_hash_key, amount, is_fraud_label, pca_features, load_date
    FROM "argus_vault"."main"."sat_txn_features"
    QUALIFY ROW_NUMBER() OVER (PARTITION BY txn_hash_key ORDER BY load_date DESC) = 1
),
ai_insights AS (
    SELECT txn_hash_key, ai_reason_for_flag, load_date
    FROM "argus_vault"."main"."sat_txn_ai_insights"
    QUALIFY ROW_NUMBER() OVER (PARTITION BY txn_hash_key ORDER BY load_date DESC) = 1
)

SELECT 
    h.txn_id,
    f.amount,
    f.is_fraud_label,
    CASE WHEN f.is_fraud_label = 1 THEN '🚩 FRAUD' ELSE '✅ NORMAL' END as fraud_status,
    a.ai_reason_for_flag as forensic_explanation,
    -- ADD THESE COLUMNS FOR THE GOVERNANCE SCRIPT
    h.established_date,
    a.load_date as insight_date, 
    f.pca_features
FROM hubs h
LEFT JOIN features f ON h.txn_hash_key = f.txn_hash_key
LEFT JOIN ai_insights a ON h.txn_hash_key = a.txn_hash_key
  );

[0m16:35:46.629993 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:35:46.636239 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.gold_fraud_dashboard"
[0m16:35:46.636746 [debug] [Thread-1 (]: On model.modern_stack_banking.gold_fraud_dashboard: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.gold_fraud_dashboard"} */
alter view "argus_vault"."main"."gold_fraud_dashboard" rename to "gold_fraud_dashboard__dbt_backup"
[0m16:35:46.637583 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:35:46.640573 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.gold_fraud_dashboard"
[0m16:35:46.641088 [debug] [Thread-1 (]: On model.modern_stack_banking.gold_fraud_dashboard: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.gold_fraud_dashboard"} */
alter view "argus_vault"."main"."gold_fraud_dashboard__dbt_tmp" rename to "gold_fraud_dashboard"
[0m16:35:46.641927 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:35:46.654376 [debug] [Thread-1 (]: On model.modern_stack_banking.gold_fraud_dashboard: COMMIT
[0m16:35:46.654883 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.gold_fraud_dashboard"
[0m16:35:46.655369 [debug] [Thread-1 (]: On model.modern_stack_banking.gold_fraud_dashboard: COMMIT
[0m16:35:46.659120 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:35:46.665201 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.gold_fraud_dashboard"
[0m16:35:46.665720 [debug] [Thread-1 (]: On model.modern_stack_banking.gold_fraud_dashboard: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.gold_fraud_dashboard"} */

      drop view if exists "argus_vault"."main"."gold_fraud_dashboard__dbt_backup" cascade
    
[0m16:35:46.667731 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:35:46.670241 [debug] [Thread-1 (]: On model.modern_stack_banking.gold_fraud_dashboard: Close
[0m16:35:46.671935 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5ef4b8a-37f4-4ab5-9723-4b2f16392edb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a0e3f28f80>]}
[0m16:35:46.672692 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.gold_fraud_dashboard ..................... [[32mOK[0m in 0.09s]
[0m16:35:46.673437 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.gold_fraud_dashboard
[0m16:35:46.674907 [debug] [MainThread]: Using duckdb connection "master"
[0m16:35:46.675436 [debug] [MainThread]: On master: BEGIN
[0m16:35:46.675954 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:35:46.677291 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:35:46.677747 [debug] [MainThread]: On master: COMMIT
[0m16:35:46.678200 [debug] [MainThread]: Using duckdb connection "master"
[0m16:35:46.678607 [debug] [MainThread]: On master: COMMIT
[0m16:35:46.679273 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:35:46.679713 [debug] [MainThread]: On master: Close
[0m16:35:46.680337 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:35:46.680741 [debug] [MainThread]: Connection 'model.modern_stack_banking.gold_fraud_dashboard' was properly closed.
[0m16:35:46.681208 [info ] [MainThread]: 
[0m16:35:46.681678 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.34 seconds (5.34s).
[0m16:35:46.682489 [debug] [MainThread]: Command end result
[0m16:35:46.702636 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m16:35:46.704401 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m16:35:46.710145 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m16:35:46.710583 [info ] [MainThread]: 
[0m16:35:46.711129 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:35:46.711568 [info ] [MainThread]: 
[0m16:35:46.712055 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:35:46.712681 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:35:46.714083 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.3889704, "process_in_blocks": "246368", "process_kernel_time": 0.439777, "process_mem_max_rss": "259620", "process_out_blocks": "3144", "process_user_time": 4.221061}
[0m16:35:46.714685 [debug] [MainThread]: Command `dbt run` succeeded at 16:35:46.714578 after 7.39 seconds
[0m16:35:46.715201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a0f021eba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a0f0e55610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a0f074aab0>]}
[0m16:35:46.715691 [debug] [MainThread]: Flushing usage events
[0m16:35:47.813757 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:44:01.389871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a11556f6930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1157c45af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1155b137a0>]}


============================== 16:44:01.393279 | 5add57a0-4f14-4eec-97a4-eff364ac9c4d ==============================
[0m16:44:01.393279 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:44:01.393940 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'warn_error': 'None', 'debug': 'False', 'introspect': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'fail_fast': 'False', 'quiet': 'False', 'partial_parse': 'True', 'profiles_dir': '.', 'no_print': 'None', 'version_check': 'True', 'log_format': 'default', 'use_colors': 'True', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "5c6a2982-6fa4-4dcb-89ac-d7d90dd3bc33", "ai_explanation": "Based on PCA factors, this transaction exhibits extreme values in V1-V3 and V13-V16, indicating fraudulent activity."} --profiles-dir .', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m16:44:01.638965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5add57a0-4f14-4eec-97a4-eff364ac9c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1155c68cb0>]}
[0m16:44:01.710022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5add57a0-4f14-4eec-97a4-eff364ac9c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1157854bf0>]}
[0m16:44:01.711761 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m16:44:01.797220 [debug] [MainThread]: checksum: 7acfa76432ee7ad17f3ea5348588822be40c91cb0c492f5a6713cf20f34c8cdb, vars: {'ai_explanation': 'Based on PCA factors, this transaction exhibits extreme '
                   'values in V1-V3 and V13-V16, indicating fraudulent '
                   'activity.',
 'txn_id': '5c6a2982-6fa4-4dcb-89ac-d7d90dd3bc33'}, profile: , target: , version: 1.11.2
[0m16:44:01.891861 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:44:01.892503 [debug] [MainThread]: previous checksum: 7acfa76432ee7ad17f3ea5348588822be40c91cb0c492f5a6713cf20f34c8cdb, current checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b
[0m16:44:01.892990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5add57a0-4f14-4eec-97a4-eff364ac9c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1148f996d0>]}
[0m16:44:03.127712 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m16:44:03.128420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5add57a0-4f14-4eec-97a4-eff364ac9c4d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1148f71760>]}
[0m16:44:03.221527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5add57a0-4f14-4eec-97a4-eff364ac9c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1149124d40>]}
[0m16:44:03.290678 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m16:44:03.292475 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m16:44:03.304846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5add57a0-4f14-4eec-97a4-eff364ac9c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1148116360>]}
[0m16:44:03.305453 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m16:44:03.305941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5add57a0-4f14-4eec-97a4-eff364ac9c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1148052b40>]}
[0m16:44:03.307672 [info ] [MainThread]: 
[0m16:44:03.308183 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:44:03.308611 [info ] [MainThread]: 
[0m16:44:03.309233 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:44:03.310229 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m16:44:03.346013 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m16:44:03.346581 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m16:44:03.347045 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:44:03.434319 [debug] [ThreadPool]: SQL status: OK in 0.087 seconds
[0m16:44:03.435984 [debug] [ThreadPool]: On list_argus_vault: Close
[0m16:44:03.436829 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m16:44:03.437464 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m16:44:03.444804 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m16:44:03.445314 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m16:44:03.445732 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:44:03.447381 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m16:44:03.448758 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m16:44:03.449219 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m16:44:03.449831 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:44:03.450278 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m16:44:03.450685 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m16:44:03.451385 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:44:03.452312 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m16:44:03.452744 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m16:44:03.453183 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m16:44:03.453764 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:44:03.454213 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m16:44:03.459977 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m16:44:03.466126 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m16:44:03.466670 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m16:44:03.467103 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:44:03.468604 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:44:03.469073 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m16:44:03.469494 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m16:44:03.481075 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m16:44:03.482837 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m16:44:03.484200 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m16:44:03.484657 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m16:44:03.486528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5add57a0-4f14-4eec-97a4-eff364ac9c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1148dd3d10>]}
[0m16:44:03.487196 [debug] [MainThread]: Using duckdb connection "master"
[0m16:44:03.487674 [debug] [MainThread]: On master: BEGIN
[0m16:44:03.488141 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:44:03.489162 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:44:03.489619 [debug] [MainThread]: On master: COMMIT
[0m16:44:03.490091 [debug] [MainThread]: Using duckdb connection "master"
[0m16:44:03.490519 [debug] [MainThread]: On master: COMMIT
[0m16:44:03.491168 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:44:03.491624 [debug] [MainThread]: On master: Close
[0m16:44:03.493761 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m16:44:03.494510 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m16:44:03.495161 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m16:44:03.495640 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m16:44:03.503932 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m16:44:03.504706 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m16:44:03.561678 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m16:44:03.562336 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201164403537119"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Based on PCA factors, this transaction exhibits extreme values in V1-V3 and V13-V16, indicating fraudulent activity.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '5c6a2982-6fa4-4dcb-89ac-d7d90dd3bc33'
    );
  
  
  
[0m16:44:03.562823 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:44:03.571665 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m16:44:03.579294 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m16:44:03.579806 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m16:44:03.580809 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:44:03.581322 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m16:44:03.581802 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201164403537119'
      
      
      order by ordinal_position

  
[0m16:44:03.584298 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:44:03.589384 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m16:44:03.589899 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m16:44:03.593170 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:44:03.603352 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m16:44:03.603878 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m16:44:03.606327 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:44:03.608185 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m16:44:03.608713 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m16:44:03.609526 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:44:03.625880 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m16:44:03.626689 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m16:44:03.627214 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201164403537119"
    )
  
[0m16:44:03.628640 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:44:03.639123 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m16:44:03.639642 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m16:44:03.640135 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m16:44:03.655716 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m16:44:03.657898 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m16:44:03.659699 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5add57a0-4f14-4eec-97a4-eff364ac9c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a112bfa7500>]}
[0m16:44:03.660487 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m16:44:03.661227 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m16:44:03.662844 [debug] [MainThread]: Using duckdb connection "master"
[0m16:44:03.663417 [debug] [MainThread]: On master: BEGIN
[0m16:44:03.663948 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:44:03.665051 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:44:03.665532 [debug] [MainThread]: On master: COMMIT
[0m16:44:03.665994 [debug] [MainThread]: Using duckdb connection "master"
[0m16:44:03.666430 [debug] [MainThread]: On master: COMMIT
[0m16:44:03.667099 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:44:03.667564 [debug] [MainThread]: On master: Close
[0m16:44:03.668122 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:44:03.668558 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m16:44:03.669027 [info ] [MainThread]: 
[0m16:44:03.669513 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m16:44:03.670334 [debug] [MainThread]: Command end result
[0m16:44:03.690961 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m16:44:03.692660 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m16:44:03.698449 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m16:44:03.698904 [info ] [MainThread]: 
[0m16:44:03.699466 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:44:03.699949 [info ] [MainThread]: 
[0m16:44:03.700450 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:44:03.701113 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:44:03.702207 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3830264, "process_in_blocks": "0", "process_kernel_time": 0.284528, "process_mem_max_rss": "278992", "process_out_blocks": "3112", "process_user_time": 4.361122}
[0m16:44:03.702804 [debug] [MainThread]: Command `dbt run` succeeded at 16:44:03.702698 after 2.38 seconds
[0m16:44:03.703316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a11554498e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1155cb5dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1154c96de0>]}
[0m16:44:03.703814 [debug] [MainThread]: Flushing usage events
[0m16:44:04.927501 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:44:25.996112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797244a02690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7972443b92e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797244a00d40>]}


============================== 16:44:25.999454 | 5f523cc3-c2f0-4c69-8ea5-84fc2e064855 ==============================
[0m16:44:25.999454 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:44:26.000155 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'introspect': 'True', 'use_experimental_parser': 'False', 'printer_width': '80', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "3020034b-dcc5-4997-a717-b8baf7e7cae4", "ai_explanation": "Based on PCA factors, this transaction is fraud due to extreme V12 and V17 values (-6.56 and -4.78, respectively)."} --profiles-dir .', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'warn_error': 'None', 'version_check': 'True', 'no_print': 'None', 'quiet': 'False', 'fail_fast': 'False', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'log_cache_events': 'False', 'write_json': 'True', 'empty': 'False', 'debug': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'profiles_dir': '.', 'target_path': 'None', 'log_format': 'default'}
[0m16:44:26.245479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f523cc3-c2f0-4c69-8ea5-84fc2e064855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797243a393d0>]}
[0m16:44:26.317843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f523cc3-c2f0-4c69-8ea5-84fc2e064855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7972448e6360>]}
[0m16:44:26.319763 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m16:44:26.404418 [debug] [MainThread]: checksum: ce50d21f1c1aabe4bcdf1732e057561620373ce2af482804f75ff604ab4abc72, vars: {'ai_explanation': 'Based on PCA factors, this transaction is fraud due to '
                   'extreme V12 and V17 values (-6.56 and -4.78, '
                   'respectively).',
 'txn_id': '3020034b-dcc5-4997-a717-b8baf7e7cae4'}, profile: , target: , version: 1.11.2
[0m16:44:26.498715 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:44:26.499332 [debug] [MainThread]: previous checksum: ce50d21f1c1aabe4bcdf1732e057561620373ce2af482804f75ff604ab4abc72, current checksum: 7acfa76432ee7ad17f3ea5348588822be40c91cb0c492f5a6713cf20f34c8cdb
[0m16:44:26.499818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5f523cc3-c2f0-4c69-8ea5-84fc2e064855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79724414a510>]}
[0m16:44:27.727225 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m16:44:27.727906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5f523cc3-c2f0-4c69-8ea5-84fc2e064855', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797237961d60>]}
[0m16:44:27.819778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f523cc3-c2f0-4c69-8ea5-84fc2e064855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79723419a780>]}
[0m16:44:27.889164 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m16:44:27.890850 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m16:44:27.903062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f523cc3-c2f0-4c69-8ea5-84fc2e064855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797237927fb0>]}
[0m16:44:27.903610 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m16:44:27.904099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f523cc3-c2f0-4c69-8ea5-84fc2e064855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7972437a2ab0>]}
[0m16:44:27.905808 [info ] [MainThread]: 
[0m16:44:27.906326 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:44:27.906753 [info ] [MainThread]: 
[0m16:44:27.907367 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:44:27.908362 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m16:44:27.943492 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m16:44:27.944009 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m16:44:27.944464 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:44:28.031597 [debug] [ThreadPool]: SQL status: OK in 0.087 seconds
[0m16:44:28.033285 [debug] [ThreadPool]: On list_argus_vault: Close
[0m16:44:28.034128 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m16:44:28.034710 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m16:44:28.042051 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m16:44:28.042514 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m16:44:28.042953 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:44:28.044310 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:44:28.045644 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m16:44:28.046105 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m16:44:28.047022 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:44:28.047458 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m16:44:28.047867 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m16:44:28.048521 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:44:28.049456 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m16:44:28.049898 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m16:44:28.050340 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m16:44:28.051234 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:44:28.051682 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m16:44:28.057342 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m16:44:28.063257 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m16:44:28.063791 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m16:44:28.064290 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:44:28.065244 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:44:28.065679 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m16:44:28.066135 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m16:44:28.077168 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m16:44:28.078688 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m16:44:28.079976 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m16:44:28.080418 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m16:44:28.081975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f523cc3-c2f0-4c69-8ea5-84fc2e064855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7971cf7004d0>]}
[0m16:44:28.082592 [debug] [MainThread]: Using duckdb connection "master"
[0m16:44:28.083070 [debug] [MainThread]: On master: BEGIN
[0m16:44:28.083500 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:44:28.084481 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:44:28.084971 [debug] [MainThread]: On master: COMMIT
[0m16:44:28.085426 [debug] [MainThread]: Using duckdb connection "master"
[0m16:44:28.085858 [debug] [MainThread]: On master: COMMIT
[0m16:44:28.086510 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:44:28.086989 [debug] [MainThread]: On master: Close
[0m16:44:28.089067 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m16:44:28.089776 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m16:44:28.090392 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m16:44:28.090872 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m16:44:28.099068 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m16:44:28.099787 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m16:44:28.156502 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m16:44:28.157156 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201164428132008"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Based on PCA factors, this transaction is fraud due to extreme V12 and V17 values (-6.56 and -4.78, respectively).' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '3020034b-dcc5-4997-a717-b8baf7e7cae4'
    );
  
  
  
[0m16:44:28.157647 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:44:28.166283 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m16:44:28.174225 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m16:44:28.174763 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m16:44:28.175525 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:44:28.176017 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m16:44:28.176487 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201164428132008'
      
      
      order by ordinal_position

  
[0m16:44:28.179443 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:44:28.184623 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m16:44:28.185162 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m16:44:28.187871 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:44:28.198305 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m16:44:28.198861 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m16:44:28.201742 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:44:28.203328 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m16:44:28.203834 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m16:44:28.204938 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:44:28.221463 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m16:44:28.222306 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m16:44:28.222807 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201164428132008"
    )
  
[0m16:44:28.224255 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:44:28.234786 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m16:44:28.235350 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m16:44:28.235813 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m16:44:28.258150 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m16:44:28.260515 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m16:44:28.262337 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f523cc3-c2f0-4c69-8ea5-84fc2e064855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797246628cb0>]}
[0m16:44:28.263148 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.17s]
[0m16:44:28.263870 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m16:44:28.265655 [debug] [MainThread]: Using duckdb connection "master"
[0m16:44:28.266170 [debug] [MainThread]: On master: BEGIN
[0m16:44:28.266589 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:44:28.267658 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:44:28.268142 [debug] [MainThread]: On master: COMMIT
[0m16:44:28.268558 [debug] [MainThread]: Using duckdb connection "master"
[0m16:44:28.269001 [debug] [MainThread]: On master: COMMIT
[0m16:44:28.269612 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:44:28.270094 [debug] [MainThread]: On master: Close
[0m16:44:28.270593 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:44:28.271023 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m16:44:28.271455 [info ] [MainThread]: 
[0m16:44:28.271932 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m16:44:28.272718 [debug] [MainThread]: Command end result
[0m16:44:28.292123 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m16:44:28.293883 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m16:44:28.299738 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m16:44:28.300209 [info ] [MainThread]: 
[0m16:44:28.300732 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:44:28.301198 [info ] [MainThread]: 
[0m16:44:28.301671 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:44:28.302320 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:44:28.303399 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3701522, "process_in_blocks": "0", "process_kernel_time": 0.303328, "process_mem_max_rss": "278880", "process_out_blocks": "3104", "process_user_time": 4.294182}
[0m16:44:28.304012 [debug] [MainThread]: Command `dbt run` succeeded at 16:44:28.303885 after 2.37 seconds
[0m16:44:28.304498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7972437befc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797244854710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7972444d8ef0>]}
[0m16:44:28.305005 [debug] [MainThread]: Flushing usage events
[0m16:44:29.284360 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:44:49.555901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e2a1cd4e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e2a46d9eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e2a2062870>]}


============================== 16:44:49.559264 | a9dd9ad9-39e5-4fc5-9b41-02607e4f52b6 ==============================
[0m16:44:49.559264 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:44:49.559979 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'quiet': 'False', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'empty': 'False', 'printer_width': '80', 'debug': 'False', 'cache_selected_only': 'False', 'target_path': 'None', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "0b2ff67a-e912-49eb-89b6-46a2e0cf9af6", "ai_explanation": "Fraudulent transaction based on significantly negative PCA scores (V1: -4.40, V10: -4.80)."} --profiles-dir .', 'profiles_dir': '.', 'static_parser': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'fail_fast': 'False'}
[0m16:44:49.804762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9dd9ad9-39e5-4fc5-9b41-02607e4f52b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e2a26aa780>]}
[0m16:44:49.875541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a9dd9ad9-39e5-4fc5-9b41-02607e4f52b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e2a15ccd10>]}
[0m16:44:49.877292 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m16:44:49.962453 [debug] [MainThread]: checksum: 423c9108391d130300c7cf083b11f5c9d3b287318e5693d84928d7e882f2b963, vars: {'ai_explanation': 'Fraudulent transaction based on significantly negative PCA '
                   'scores (V1: -4.40, V10: -4.80).',
 'txn_id': '0b2ff67a-e912-49eb-89b6-46a2e0cf9af6'}, profile: , target: , version: 1.11.2
[0m16:44:50.054873 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:44:50.055488 [debug] [MainThread]: previous checksum: 423c9108391d130300c7cf083b11f5c9d3b287318e5693d84928d7e882f2b963, current checksum: ce50d21f1c1aabe4bcdf1732e057561620373ce2af482804f75ff604ab4abc72
[0m16:44:50.055980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a9dd9ad9-39e5-4fc5-9b41-02607e4f52b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e2959b9880>]}
[0m16:44:51.294330 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m16:44:51.295017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a9dd9ad9-39e5-4fc5-9b41-02607e4f52b6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e2957721b0>]}
[0m16:44:51.386407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a9dd9ad9-39e5-4fc5-9b41-02607e4f52b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e2957794c0>]}
[0m16:44:51.455394 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m16:44:51.457167 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m16:44:51.469499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a9dd9ad9-39e5-4fc5-9b41-02607e4f52b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e294134290>]}
[0m16:44:51.470074 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m16:44:51.470544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9dd9ad9-39e5-4fc5-9b41-02607e4f52b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e295785850>]}
[0m16:44:51.472302 [info ] [MainThread]: 
[0m16:44:51.472792 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:44:51.473257 [info ] [MainThread]: 
[0m16:44:51.473866 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:44:51.474972 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m16:44:51.510448 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m16:44:51.510964 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m16:44:51.511417 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:44:51.600604 [debug] [ThreadPool]: SQL status: OK in 0.089 seconds
[0m16:44:51.602330 [debug] [ThreadPool]: On list_argus_vault: Close
[0m16:44:51.603207 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m16:44:51.603788 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m16:44:51.611192 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m16:44:51.611654 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m16:44:51.612094 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:44:51.613442 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:44:51.614741 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m16:44:51.615198 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m16:44:51.615805 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:44:51.616256 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m16:44:51.616671 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m16:44:51.617329 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:44:51.618252 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m16:44:51.618686 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m16:44:51.619112 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m16:44:51.619694 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:44:51.620152 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m16:44:51.625709 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m16:44:51.631352 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m16:44:51.631883 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m16:44:51.632313 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:44:51.633439 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:44:51.633882 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m16:44:51.634340 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m16:44:51.646350 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m16:44:51.647791 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m16:44:51.649070 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m16:44:51.649512 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m16:44:51.651041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9dd9ad9-39e5-4fc5-9b41-02607e4f52b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e29406bd70>]}
[0m16:44:51.651653 [debug] [MainThread]: Using duckdb connection "master"
[0m16:44:51.652101 [debug] [MainThread]: On master: BEGIN
[0m16:44:51.652501 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:44:51.653370 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:44:51.653811 [debug] [MainThread]: On master: COMMIT
[0m16:44:51.654257 [debug] [MainThread]: Using duckdb connection "master"
[0m16:44:51.654659 [debug] [MainThread]: On master: COMMIT
[0m16:44:51.655347 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:44:51.655782 [debug] [MainThread]: On master: Close
[0m16:44:51.657841 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m16:44:51.658614 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m16:44:51.659246 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m16:44:51.659724 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m16:44:51.667769 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m16:44:51.668526 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m16:44:51.724421 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m16:44:51.725005 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201164451700206"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Fraudulent transaction based on significantly negative PCA scores (V1: -4.40, V10: -4.80).' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '0b2ff67a-e912-49eb-89b6-46a2e0cf9af6'
    );
  
  
  
[0m16:44:51.725499 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:44:51.733789 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m16:44:51.741838 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m16:44:51.742474 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m16:44:51.743304 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:44:51.743808 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m16:44:51.744336 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201164451700206'
      
      
      order by ordinal_position

  
[0m16:44:51.748084 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:44:51.755426 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m16:44:51.756025 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m16:44:51.760392 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:44:51.772130 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m16:44:51.772663 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m16:44:51.775598 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:44:51.777149 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m16:44:51.777652 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m16:44:51.778462 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:44:51.794724 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m16:44:51.795505 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m16:44:51.796016 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201164451700206"
    )
  
[0m16:44:51.797869 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:44:51.808355 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m16:44:51.808860 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m16:44:51.809381 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m16:44:51.824129 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m16:44:51.826182 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m16:44:51.827950 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9dd9ad9-39e5-4fc5-9b41-02607e4f52b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e254cd4980>]}
[0m16:44:51.829167 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.17s]
[0m16:44:51.830203 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m16:44:51.831797 [debug] [MainThread]: Using duckdb connection "master"
[0m16:44:51.832353 [debug] [MainThread]: On master: BEGIN
[0m16:44:51.832817 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:44:51.833809 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:44:51.834269 [debug] [MainThread]: On master: COMMIT
[0m16:44:51.834668 [debug] [MainThread]: Using duckdb connection "master"
[0m16:44:51.835084 [debug] [MainThread]: On master: COMMIT
[0m16:44:51.835690 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:44:51.836142 [debug] [MainThread]: On master: Close
[0m16:44:51.836618 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:44:51.837034 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m16:44:51.837446 [info ] [MainThread]: 
[0m16:44:51.837881 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m16:44:51.838661 [debug] [MainThread]: Command end result
[0m16:44:51.857500 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m16:44:51.859127 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m16:44:51.864712 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m16:44:51.865176 [info ] [MainThread]: 
[0m16:44:51.865691 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:44:51.866154 [info ] [MainThread]: 
[0m16:44:51.866618 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:44:51.867259 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:44:51.868309 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.374693, "process_in_blocks": "0", "process_kernel_time": 0.30822, "process_mem_max_rss": "291040", "process_out_blocks": "3112", "process_user_time": 4.29631}
[0m16:44:51.868890 [debug] [MainThread]: Command `dbt run` succeeded at 16:44:51.868786 after 2.38 seconds
[0m16:44:51.869400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e2a5fcfd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e2a199d220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e2a15b3b00>]}
[0m16:44:51.869881 [debug] [MainThread]: Flushing usage events
[0m16:44:52.760370 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:10:28.231394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ae3ec2f080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ae3ec2efc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ae3ecc6e40>]}


============================== 17:10:28.234758 | 0c46305a-3f9c-4392-a8c6-bc9e83d335d4 ==============================
[0m17:10:28.234758 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:10:28.235475 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "8ad558a6-50e8-4b5d-bb27-abd496a6e397", "ai_explanation": "Fraud detected: V7 and V17 values significantly higher than expected norms."} --profiles-dir .', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'fail_fast': 'False', 'warn_error': 'None', 'version_check': 'True', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'profiles_dir': '.', 'empty': 'False', 'debug': 'False', 'printer_width': '80', 'quiet': 'False', 'no_print': 'None'}
[0m17:10:28.482339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c46305a-3f9c-4392-a8c6-bc9e83d335d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ae3e321fa0>]}
[0m17:10:28.554272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c46305a-3f9c-4392-a8c6-bc9e83d335d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ae3e22c0b0>]}
[0m17:10:28.556147 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:10:28.640612 [debug] [MainThread]: checksum: 245383a282619d00ae374cc9abd1d9629147666434911eec239c44ff6347cfc4, vars: {'ai_explanation': 'Fraud detected: V7 and V17 values significantly higher '
                   'than expected norms.',
 'txn_id': '8ad558a6-50e8-4b5d-bb27-abd496a6e397'}, profile: , target: , version: 1.11.2
[0m17:10:28.733473 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:10:28.734116 [debug] [MainThread]: previous checksum: 245383a282619d00ae374cc9abd1d9629147666434911eec239c44ff6347cfc4, current checksum: 423c9108391d130300c7cf083b11f5c9d3b287318e5693d84928d7e882f2b963
[0m17:10:28.734599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0c46305a-3f9c-4392-a8c6-bc9e83d335d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ae3ec2eae0>]}
[0m17:10:29.966971 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m17:10:29.967655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0c46305a-3f9c-4392-a8c6-bc9e83d335d4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ae3016b080>]}
[0m17:10:30.060113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c46305a-3f9c-4392-a8c6-bc9e83d335d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ae32487ec0>]}
[0m17:10:30.130127 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:10:30.131939 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:10:30.144346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c46305a-3f9c-4392-a8c6-bc9e83d335d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79adf201f3b0>]}
[0m17:10:30.144901 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m17:10:30.145407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c46305a-3f9c-4392-a8c6-bc9e83d335d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79adf21ce5a0>]}
[0m17:10:30.147176 [info ] [MainThread]: 
[0m17:10:30.147673 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:10:30.148134 [info ] [MainThread]: 
[0m17:10:30.148756 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:10:30.149858 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m17:10:30.186450 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m17:10:30.187027 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m17:10:30.187470 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:10:30.275685 [debug] [ThreadPool]: SQL status: OK in 0.088 seconds
[0m17:10:30.277416 [debug] [ThreadPool]: On list_argus_vault: Close
[0m17:10:30.278294 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m17:10:30.278880 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m17:10:30.286373 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:10:30.286846 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m17:10:30.287304 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:10:30.289032 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m17:10:30.290376 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:10:30.290817 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m17:10:30.291468 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:10:30.291893 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:10:30.292357 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m17:10:30.293021 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:10:30.293963 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:10:30.294408 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:10:30.294829 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:10:30.295465 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:10:30.295905 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m17:10:30.301683 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m17:10:30.307680 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:10:30.308254 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m17:10:30.308673 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:10:30.309587 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:10:30.310292 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:10:30.311071 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m17:10:30.324168 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m17:10:30.326084 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m17:10:30.327515 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m17:10:30.328140 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m17:10:30.329992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c46305a-3f9c-4392-a8c6-bc9e83d335d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79adf21eb500>]}
[0m17:10:30.330680 [debug] [MainThread]: Using duckdb connection "master"
[0m17:10:30.331226 [debug] [MainThread]: On master: BEGIN
[0m17:10:30.331785 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:10:30.332865 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:10:30.333344 [debug] [MainThread]: On master: COMMIT
[0m17:10:30.333770 [debug] [MainThread]: Using duckdb connection "master"
[0m17:10:30.334206 [debug] [MainThread]: On master: COMMIT
[0m17:10:30.334822 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:10:30.335284 [debug] [MainThread]: On master: Close
[0m17:10:30.337348 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:10:30.338150 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m17:10:30.338774 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m17:10:30.339305 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m17:10:30.347615 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:10:30.348367 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m17:10:30.405217 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:10:30.405817 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201171030380626"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Fraud detected: V7 and V17 values significantly higher than expected norms.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '8ad558a6-50e8-4b5d-bb27-abd496a6e397'
    );
  
  
  
[0m17:10:30.406351 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:30.415300 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m17:10:30.422986 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:10:30.423513 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m17:10:30.424242 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:10:30.424729 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:10:30.425260 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201171030380626'
      
      
      order by ordinal_position

  
[0m17:10:30.428034 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:10:30.433398 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:10:30.433950 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:10:30.436820 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:10:30.447279 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:10:30.447810 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:10:30.450302 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:10:30.451842 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:10:30.452373 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m17:10:30.453153 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:10:30.469624 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:10:30.470412 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:10:30.470943 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201171030380626"
    )
  
[0m17:10:30.472293 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:10:30.482669 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:10:30.483215 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:10:30.483693 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:10:30.486901 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:10:30.488869 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m17:10:30.490619 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c46305a-3f9c-4392-a8c6-bc9e83d335d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ae30124620>]}
[0m17:10:30.491405 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.15s]
[0m17:10:30.492141 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:10:30.493887 [debug] [MainThread]: Using duckdb connection "master"
[0m17:10:30.494495 [debug] [MainThread]: On master: BEGIN
[0m17:10:30.494995 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:10:30.495949 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:10:30.496517 [debug] [MainThread]: On master: COMMIT
[0m17:10:30.497071 [debug] [MainThread]: Using duckdb connection "master"
[0m17:10:30.497587 [debug] [MainThread]: On master: COMMIT
[0m17:10:30.498255 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:10:30.498696 [debug] [MainThread]: On master: Close
[0m17:10:30.499219 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:10:30.499625 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m17:10:30.500072 [info ] [MainThread]: 
[0m17:10:30.500525 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m17:10:30.501314 [debug] [MainThread]: Command end result
[0m17:10:30.520475 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:10:30.522124 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:10:30.527781 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m17:10:30.528248 [info ] [MainThread]: 
[0m17:10:30.528769 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:10:30.529240 [info ] [MainThread]: 
[0m17:10:30.529707 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:10:30.530347 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:10:30.531388 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3623025, "process_in_blocks": "0", "process_kernel_time": 0.316425, "process_mem_max_rss": "277072", "process_out_blocks": "3104", "process_user_time": 4.290099}
[0m17:10:30.531999 [debug] [MainThread]: Command `dbt run` succeeded at 17:10:30.531872 after 2.36 seconds
[0m17:10:30.532476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ae3e3dd940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ae3e2df200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ae3e2dc830>]}
[0m17:10:30.532977 [debug] [MainThread]: Flushing usage events
[0m17:10:31.519170 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:10:47.272220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2e2f9f3230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2e2f2fd880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2e2f2fea50>]}


============================== 17:10:47.275687 | 9d2e2ab1-99d6-460f-8eb9-300dc49ee942 ==============================
[0m17:10:47.275687 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:10:47.276372 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'target_path': 'None', 'warn_error': 'None', 'cache_selected_only': 'False', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'debug': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "829bd17a-c64c-49a1-b100-c9fb9e8e8145", "ai_explanation": "This transaction is fraud based on anomalous PCA factors exceeding 2x standard deviations."} --profiles-dir .', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'static_parser': 'True', 'no_print': 'None', 'printer_width': '80', 'empty': 'False', 'write_json': 'True', 'profiles_dir': '.', 'introspect': 'True', 'version_check': 'True'}
[0m17:10:47.525965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d2e2ab1-99d6-460f-8eb9-300dc49ee942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2e2ef8ff80>]}
[0m17:10:47.597246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d2e2ab1-99d6-460f-8eb9-300dc49ee942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2e2f686060>]}
[0m17:10:47.599025 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:10:47.682832 [debug] [MainThread]: checksum: b917e49a4aee5352fe649d6cfff8946dcbb4532cd7a4d6115270de0efc8710c0, vars: {'ai_explanation': 'This transaction is fraud based on anomalous PCA factors '
                   'exceeding 2x standard deviations.',
 'txn_id': '829bd17a-c64c-49a1-b100-c9fb9e8e8145'}, profile: , target: , version: 1.11.2
[0m17:10:47.775113 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:10:47.775711 [debug] [MainThread]: previous checksum: b917e49a4aee5352fe649d6cfff8946dcbb4532cd7a4d6115270de0efc8710c0, current checksum: 245383a282619d00ae374cc9abd1d9629147666434911eec239c44ff6347cfc4
[0m17:10:47.776218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9d2e2ab1-99d6-460f-8eb9-300dc49ee942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2e2f9f2ab0>]}
[0m17:10:49.017691 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m17:10:49.018395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9d2e2ab1-99d6-460f-8eb9-300dc49ee942', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2e20176db0>]}
[0m17:10:49.110118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d2e2ab1-99d6-460f-8eb9-300dc49ee942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2e0aefc470>]}
[0m17:10:49.178655 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:10:49.180379 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:10:49.192588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d2e2ab1-99d6-460f-8eb9-300dc49ee942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2e0aefd520>]}
[0m17:10:49.193173 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m17:10:49.193640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d2e2ab1-99d6-460f-8eb9-300dc49ee942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2e0afc4a40>]}
[0m17:10:49.195405 [info ] [MainThread]: 
[0m17:10:49.195898 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:10:49.196358 [info ] [MainThread]: 
[0m17:10:49.196973 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:10:49.198037 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m17:10:49.233348 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m17:10:49.233846 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m17:10:49.234331 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:10:49.319824 [debug] [ThreadPool]: SQL status: OK in 0.085 seconds
[0m17:10:49.321601 [debug] [ThreadPool]: On list_argus_vault: Close
[0m17:10:49.322575 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m17:10:49.323219 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m17:10:49.331140 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:10:49.331617 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m17:10:49.332069 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:10:49.333813 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m17:10:49.335230 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:10:49.335670 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m17:10:49.336342 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:10:49.336770 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:10:49.337212 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m17:10:49.337889 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:10:49.338845 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:10:49.339321 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:10:49.339738 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:10:49.340375 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:10:49.340817 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m17:10:49.346581 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m17:10:49.352608 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:10:49.353168 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m17:10:49.353576 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:10:49.354498 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:10:49.354955 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:10:49.355384 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m17:10:49.366465 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m17:10:49.367953 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m17:10:49.369229 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m17:10:49.369676 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m17:10:49.371361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d2e2ab1-99d6-460f-8eb9-300dc49ee942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2e0ae27d70>]}
[0m17:10:49.371997 [debug] [MainThread]: Using duckdb connection "master"
[0m17:10:49.372439 [debug] [MainThread]: On master: BEGIN
[0m17:10:49.372845 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:10:49.373816 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:10:49.374292 [debug] [MainThread]: On master: COMMIT
[0m17:10:49.374709 [debug] [MainThread]: Using duckdb connection "master"
[0m17:10:49.375132 [debug] [MainThread]: On master: COMMIT
[0m17:10:49.375722 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:10:49.376179 [debug] [MainThread]: On master: Close
[0m17:10:49.378197 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:10:49.378834 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m17:10:49.379420 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m17:10:49.379930 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m17:10:49.388058 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:10:49.388801 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m17:10:49.445767 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:10:49.446364 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201171049421143"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'This transaction is fraud based on anomalous PCA factors exceeding 2x standard deviations.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '829bd17a-c64c-49a1-b100-c9fb9e8e8145'
    );
  
  
  
[0m17:10:49.446868 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:49.455239 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m17:10:49.462799 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:10:49.463335 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m17:10:49.464053 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:10:49.464547 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:10:49.465048 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201171049421143'
      
      
      order by ordinal_position

  
[0m17:10:49.467734 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:10:49.472773 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:10:49.473323 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:10:49.476801 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:10:49.486956 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:10:49.487486 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:10:49.490146 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:10:49.491662 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:10:49.492201 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m17:10:49.492999 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:10:49.509387 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:10:49.510200 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:10:49.510717 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201171049421143"
    )
  
[0m17:10:49.512009 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:10:49.522422 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:10:49.523015 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:10:49.523491 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:10:49.538224 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m17:10:49.540376 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m17:10:49.542149 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d2e2ab1-99d6-460f-8eb9-300dc49ee942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2e31c84e90>]}
[0m17:10:49.542928 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m17:10:49.543646 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:10:49.545163 [debug] [MainThread]: Using duckdb connection "master"
[0m17:10:49.545712 [debug] [MainThread]: On master: BEGIN
[0m17:10:49.546222 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:10:49.547304 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:10:49.547760 [debug] [MainThread]: On master: COMMIT
[0m17:10:49.548209 [debug] [MainThread]: Using duckdb connection "master"
[0m17:10:49.548614 [debug] [MainThread]: On master: COMMIT
[0m17:10:49.549242 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:10:49.549678 [debug] [MainThread]: On master: Close
[0m17:10:49.550204 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:10:49.550608 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m17:10:49.551054 [info ] [MainThread]: 
[0m17:10:49.551504 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m17:10:49.552277 [debug] [MainThread]: Command end result
[0m17:10:49.571194 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:10:49.572977 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:10:49.578691 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m17:10:49.579168 [info ] [MainThread]: 
[0m17:10:49.579699 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:10:49.580168 [info ] [MainThread]: 
[0m17:10:49.580637 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:10:49.581291 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:10:49.582330 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3725371, "process_in_blocks": "0", "process_kernel_time": 0.325678, "process_mem_max_rss": "278800", "process_out_blocks": "3104", "process_user_time": 4.27837}
[0m17:10:49.582940 [debug] [MainThread]: Command `dbt run` succeeded at 17:10:49.582816 after 2.37 seconds
[0m17:10:49.583445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2e300d23c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2e300d3830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2e300d0a40>]}
[0m17:10:49.583962 [debug] [MainThread]: Flushing usage events
[0m17:10:50.470715 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:11:05.614531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7256fdc083e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7256fd30ff20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7256fdf1f0e0>]}


============================== 17:11:05.618726 | e9d53757-0244-46d8-8d32-2b698a349d60 ==============================
[0m17:11:05.618726 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:11:05.619688 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_format': 'default', 'no_print': 'None', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'printer_width': '80', 'debug': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "393d0456-b718-4cbb-9475-8203b721cd1b", "ai_explanation": "Highly anomalous PCA scores across multiple factors indicate fraudulent transaction."} --profiles-dir .', 'write_json': 'True', 'indirect_selection': 'eager', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'version_check': 'True', 'cache_selected_only': 'False', 'quiet': 'False'}
[0m17:11:05.867372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e9d53757-0244-46d8-8d32-2b698a349d60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7256fd35fec0>]}
[0m17:11:05.938159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e9d53757-0244-46d8-8d32-2b698a349d60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7256fda43170>]}
[0m17:11:05.939934 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:11:06.023373 [debug] [MainThread]: checksum: 50ccc20daa05df1faaa26a50c692d26c21867446666fa0d00f79106134670745, vars: {'ai_explanation': 'Highly anomalous PCA scores across multiple factors '
                   'indicate fraudulent transaction.',
 'txn_id': '393d0456-b718-4cbb-9475-8203b721cd1b'}, profile: , target: , version: 1.11.2
[0m17:11:06.115453 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:11:06.116110 [debug] [MainThread]: previous checksum: 50ccc20daa05df1faaa26a50c692d26c21867446666fa0d00f79106134670745, current checksum: b917e49a4aee5352fe649d6cfff8946dcbb4532cd7a4d6115270de0efc8710c0
[0m17:11:06.116577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e9d53757-0244-46d8-8d32-2b698a349d60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7256f14ae540>]}
[0m17:11:07.350603 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m17:11:07.351318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e9d53757-0244-46d8-8d32-2b698a349d60', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7256fd20be60>]}
[0m17:11:07.443369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e9d53757-0244-46d8-8d32-2b698a349d60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7256f1752240>]}
[0m17:11:07.513196 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:11:07.515001 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:11:07.527369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e9d53757-0244-46d8-8d32-2b698a349d60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7256f0019760>]}
[0m17:11:07.527957 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m17:11:07.528436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9d53757-0244-46d8-8d32-2b698a349d60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7256f00e6480>]}
[0m17:11:07.530189 [info ] [MainThread]: 
[0m17:11:07.530687 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:11:07.531149 [info ] [MainThread]: 
[0m17:11:07.531756 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:11:07.532759 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m17:11:07.568493 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m17:11:07.568994 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m17:11:07.569448 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:11:07.657590 [debug] [ThreadPool]: SQL status: OK in 0.088 seconds
[0m17:11:07.659289 [debug] [ThreadPool]: On list_argus_vault: Close
[0m17:11:07.660178 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m17:11:07.660761 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m17:11:07.668072 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:11:07.668535 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m17:11:07.668973 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:11:07.670409 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:11:07.671729 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:11:07.672193 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m17:11:07.672786 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:11:07.673233 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:11:07.673641 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m17:11:07.674293 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:11:07.675220 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:11:07.675675 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:11:07.676117 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:11:07.676755 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:11:07.677228 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m17:11:07.682833 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m17:11:07.688976 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:11:07.689519 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m17:11:07.689951 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:11:07.691217 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:11:07.691657 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:11:07.692123 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m17:11:07.703326 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m17:11:07.704799 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m17:11:07.706106 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m17:11:07.706553 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m17:11:07.708194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9d53757-0244-46d8-8d32-2b698a349d60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7256f00d6a80>]}
[0m17:11:07.708830 [debug] [MainThread]: Using duckdb connection "master"
[0m17:11:07.709288 [debug] [MainThread]: On master: BEGIN
[0m17:11:07.709695 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:11:07.710572 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:11:07.711041 [debug] [MainThread]: On master: COMMIT
[0m17:11:07.711461 [debug] [MainThread]: Using duckdb connection "master"
[0m17:11:07.711867 [debug] [MainThread]: On master: COMMIT
[0m17:11:07.712482 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:11:07.712929 [debug] [MainThread]: On master: Close
[0m17:11:07.715015 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:11:07.715643 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m17:11:07.716402 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m17:11:07.716932 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m17:11:07.724994 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:11:07.725710 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m17:11:07.783106 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:11:07.783655 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201171107758436"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Highly anomalous PCA scores across multiple factors indicate fraudulent transaction.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '393d0456-b718-4cbb-9475-8203b721cd1b'
    );
  
  
  
[0m17:11:07.784175 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:11:07.792277 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m17:11:07.799986 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:11:07.800494 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m17:11:07.801202 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:11:07.801684 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:11:07.802174 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201171107758436'
      
      
      order by ordinal_position

  
[0m17:11:07.805328 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:11:07.810384 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:11:07.810900 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:11:07.813424 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:11:07.823522 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:11:07.824073 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:11:07.826708 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:11:07.828235 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:11:07.828742 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m17:11:07.829572 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:11:07.845855 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:11:07.846657 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:11:07.847178 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201171107758436"
    )
  
[0m17:11:07.848350 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:11:07.858817 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:11:07.859356 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:11:07.859821 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:11:07.874199 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m17:11:07.876266 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m17:11:07.878015 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9d53757-0244-46d8-8d32-2b698a349d60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7256f14505c0>]}
[0m17:11:07.878768 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m17:11:07.879510 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:11:07.880956 [debug] [MainThread]: Using duckdb connection "master"
[0m17:11:07.881491 [debug] [MainThread]: On master: BEGIN
[0m17:11:07.881986 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:11:07.882928 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:11:07.883392 [debug] [MainThread]: On master: COMMIT
[0m17:11:07.883814 [debug] [MainThread]: Using duckdb connection "master"
[0m17:11:07.884248 [debug] [MainThread]: On master: COMMIT
[0m17:11:07.884822 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:11:07.885282 [debug] [MainThread]: On master: Close
[0m17:11:07.885777 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:11:07.886198 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m17:11:07.886616 [info ] [MainThread]: 
[0m17:11:07.887095 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m17:11:07.887852 [debug] [MainThread]: Command end result
[0m17:11:07.906701 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:11:07.908367 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:11:07.914016 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m17:11:07.914457 [info ] [MainThread]: 
[0m17:11:07.914986 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:11:07.915430 [info ] [MainThread]: 
[0m17:11:07.915907 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:11:07.916545 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:11:07.917585 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3672693, "process_in_blocks": "0", "process_kernel_time": 0.321537, "process_mem_max_rss": "275124", "process_out_blocks": "3104", "process_user_time": 4.27199}
[0m17:11:07.918195 [debug] [MainThread]: Command `dbt run` succeeded at 17:11:07.918084 after 2.37 seconds
[0m17:11:07.918666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7256fd2ed880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7256fd2089e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7256f132d5e0>]}
[0m17:11:07.919167 [debug] [MainThread]: Flushing usage events
[0m17:11:08.900489 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:41:29.505637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77083c51f710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77083ce04080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77083c51c5c0>]}


============================== 17:41:29.508970 | b8747ede-829a-4a22-ba6d-52d8c0ff0a06 ==============================
[0m17:41:29.508970 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:41:29.509662 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '.', 'target_path': 'None', 'printer_width': '80', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'log_format': 'default', 'log_cache_events': 'False', 'quiet': 'False', 'debug': 'False', 'static_parser': 'True', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'fail_fast': 'False', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'empty': 'False', 'no_print': 'None', 'version_check': 'True', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "5f3acf03-61e1-4756-a13a-269847053ea7", "ai_explanation": "Based on PCA factors, this transaction is fraud due to unusually high V2 and V11 values."} --profiles-dir .', 'use_colors': 'True', 'warn_error': 'None', 'introspect': 'True'}
[0m17:41:29.755776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8747ede-829a-4a22-ba6d-52d8c0ff0a06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77083ca73c20>]}
[0m17:41:29.827123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b8747ede-829a-4a22-ba6d-52d8c0ff0a06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77083bb448f0>]}
[0m17:41:29.828945 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:41:29.913571 [debug] [MainThread]: checksum: 16ac6db968d8ab980293624bb6552cd76f95efe0e3c3face2d78205d5d7aee77, vars: {'ai_explanation': 'Based on PCA factors, this transaction is fraud due to '
                   'unusually high V2 and V11 values.',
 'txn_id': '5f3acf03-61e1-4756-a13a-269847053ea7'}, profile: , target: , version: 1.11.2
[0m17:41:30.005566 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:41:30.006186 [debug] [MainThread]: previous checksum: 16ac6db968d8ab980293624bb6552cd76f95efe0e3c3face2d78205d5d7aee77, current checksum: 50ccc20daa05df1faaa26a50c692d26c21867446666fa0d00f79106134670745
[0m17:41:30.006640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b8747ede-829a-4a22-ba6d-52d8c0ff0a06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77083c34e900>]}
[0m17:41:31.233833 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m17:41:31.234557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b8747ede-829a-4a22-ba6d-52d8c0ff0a06', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77083bb1f9e0>]}
[0m17:41:31.326350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b8747ede-829a-4a22-ba6d-52d8c0ff0a06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77082c0ff260>]}
[0m17:41:31.396684 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:41:31.398562 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:41:31.411029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8747ede-829a-4a22-ba6d-52d8c0ff0a06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77080f94f7a0>]}
[0m17:41:31.411604 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m17:41:31.412117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8747ede-829a-4a22-ba6d-52d8c0ff0a06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77082c1be420>]}
[0m17:41:31.413870 [info ] [MainThread]: 
[0m17:41:31.414407 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:41:31.414868 [info ] [MainThread]: 
[0m17:41:31.415528 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:41:31.416539 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m17:41:31.452054 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m17:41:31.452588 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m17:41:31.453042 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:41:31.545881 [debug] [ThreadPool]: SQL status: OK in 0.093 seconds
[0m17:41:31.547585 [debug] [ThreadPool]: On list_argus_vault: Close
[0m17:41:31.548466 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m17:41:31.549082 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m17:41:31.556440 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:41:31.556965 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m17:41:31.557421 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:41:31.558829 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:41:31.560212 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:41:31.560672 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m17:41:31.561364 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:41:31.561825 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:41:31.562303 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m17:41:31.562976 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:41:31.563930 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:41:31.564407 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:41:31.564848 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:41:31.565539 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:41:31.566016 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m17:41:31.571617 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m17:41:31.577473 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:41:31.578035 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m17:41:31.578446 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:41:31.579361 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:41:31.579804 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:41:31.580258 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m17:41:31.591469 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m17:41:31.592902 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m17:41:31.594193 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m17:41:31.594629 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m17:41:31.596272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8747ede-829a-4a22-ba6d-52d8c0ff0a06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77080f94fe60>]}
[0m17:41:31.596905 [debug] [MainThread]: Using duckdb connection "master"
[0m17:41:31.597390 [debug] [MainThread]: On master: BEGIN
[0m17:41:31.597823 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:41:31.598684 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:41:31.599169 [debug] [MainThread]: On master: COMMIT
[0m17:41:31.599615 [debug] [MainThread]: Using duckdb connection "master"
[0m17:41:31.600064 [debug] [MainThread]: On master: COMMIT
[0m17:41:31.600754 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:41:31.601235 [debug] [MainThread]: On master: Close
[0m17:41:31.603304 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:41:31.603962 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m17:41:31.604540 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m17:41:31.605058 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m17:41:31.613209 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:41:31.613948 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m17:41:31.670581 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:41:31.671199 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201174131646181"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Based on PCA factors, this transaction is fraud due to unusually high V2 and V11 values.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '5f3acf03-61e1-4756-a13a-269847053ea7'
    );
  
  
  
[0m17:41:31.671695 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:41:31.680396 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m17:41:31.688122 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:41:31.688629 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m17:41:31.689326 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:41:31.689807 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:41:31.690298 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201174131646181'
      
      
      order by ordinal_position

  
[0m17:41:31.693399 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:41:31.698446 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:41:31.698978 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:41:31.701407 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:41:31.711493 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:41:31.712031 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:41:31.714685 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:41:31.716212 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:41:31.716718 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m17:41:31.717498 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:41:31.733752 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:41:31.734550 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:41:31.735061 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201174131646181"
    )
  
[0m17:41:31.736279 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:41:31.746729 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:41:31.747268 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:41:31.747740 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:41:31.763253 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m17:41:31.765237 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m17:41:31.766982 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8747ede-829a-4a22-ba6d-52d8c0ff0a06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77083ca3bdd0>]}
[0m17:41:31.767747 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m17:41:31.768496 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:41:31.769900 [debug] [MainThread]: Using duckdb connection "master"
[0m17:41:31.770479 [debug] [MainThread]: On master: BEGIN
[0m17:41:31.771004 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:41:31.772086 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:41:31.772552 [debug] [MainThread]: On master: COMMIT
[0m17:41:31.773016 [debug] [MainThread]: Using duckdb connection "master"
[0m17:41:31.773457 [debug] [MainThread]: On master: COMMIT
[0m17:41:31.774106 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:41:31.774571 [debug] [MainThread]: On master: Close
[0m17:41:31.775116 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:41:31.775549 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m17:41:31.776017 [info ] [MainThread]: 
[0m17:41:31.776505 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m17:41:31.777330 [debug] [MainThread]: Command end result
[0m17:41:31.797597 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:41:31.799265 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:41:31.804947 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m17:41:31.805410 [info ] [MainThread]: 
[0m17:41:31.805976 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:41:31.806455 [info ] [MainThread]: 
[0m17:41:31.806968 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:41:31.807628 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:41:31.808705 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3651037, "process_in_blocks": "0", "process_kernel_time": 0.313788, "process_mem_max_rss": "282400", "process_out_blocks": "3104", "process_user_time": 4.292078}
[0m17:41:31.809348 [debug] [MainThread]: Command `dbt run` succeeded at 17:41:31.809239 after 2.37 seconds
[0m17:41:31.809850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77083ce04080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77080f949610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77083cc18b30>]}
[0m17:41:31.810401 [debug] [MainThread]: Flushing usage events
[0m17:41:32.986801 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:41:48.546313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7caa68f4e300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7caa68cb9be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7caa6a3ac170>]}


============================== 17:41:48.549634 | a6e86652-4075-4a1b-9ccb-2763fbd30614 ==============================
[0m17:41:48.549634 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:41:48.550385 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '.', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'no_print': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'introspect': 'True', 'use_experimental_parser': 'False', 'debug': 'False', 'empty': 'False', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'log_format': 'default', 'printer_width': '80', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "f81e8531-04f9-4c48-be60-51dd0088dc29", "ai_explanation": "Based on PCA factors, this transaction exhibits significant deviations from normal patterns, indicating fraud."} --profiles-dir .', 'target_path': 'None', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True'}
[0m17:41:48.798405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a6e86652-4075-4a1b-9ccb-2763fbd30614', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7caa6b196ba0>]}
[0m17:41:48.869498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a6e86652-4075-4a1b-9ccb-2763fbd30614', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7caa68842000>]}
[0m17:41:48.871306 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:41:48.956130 [debug] [MainThread]: checksum: b2ad9d77639a66d59016be185c0e9800de387058ccba1fdea47db0d00fe59156, vars: {'ai_explanation': 'Based on PCA factors, this transaction exhibits '
                   'significant deviations from normal patterns, indicating '
                   'fraud.',
 'txn_id': 'f81e8531-04f9-4c48-be60-51dd0088dc29'}, profile: , target: , version: 1.11.2
[0m17:41:49.048290 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:41:49.048868 [debug] [MainThread]: previous checksum: b2ad9d77639a66d59016be185c0e9800de387058ccba1fdea47db0d00fe59156, current checksum: 16ac6db968d8ab980293624bb6552cd76f95efe0e3c3face2d78205d5d7aee77
[0m17:41:49.049395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a6e86652-4075-4a1b-9ccb-2763fbd30614', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7caa68f4eab0>]}
[0m17:41:50.287072 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m17:41:50.287763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a6e86652-4075-4a1b-9ccb-2763fbd30614', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7caa5c7dc2c0>]}
[0m17:41:50.380359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a6e86652-4075-4a1b-9ccb-2763fbd30614', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7caa5c1c9370>]}
[0m17:41:50.458752 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:41:50.460754 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:41:50.473901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a6e86652-4075-4a1b-9ccb-2763fbd30614', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7caa6a67f260>]}
[0m17:41:50.474498 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m17:41:50.474993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6e86652-4075-4a1b-9ccb-2763fbd30614', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7caa5c724b90>]}
[0m17:41:50.476755 [info ] [MainThread]: 
[0m17:41:50.477275 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:41:50.477702 [info ] [MainThread]: 
[0m17:41:50.478335 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:41:50.479374 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m17:41:50.515791 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m17:41:50.516331 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m17:41:50.516765 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:41:50.600280 [debug] [ThreadPool]: SQL status: OK in 0.083 seconds
[0m17:41:50.602006 [debug] [ThreadPool]: On list_argus_vault: Close
[0m17:41:50.602904 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m17:41:50.603587 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m17:41:50.611218 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:41:50.611695 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m17:41:50.612149 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:41:50.613326 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:41:50.614676 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:41:50.615137 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m17:41:50.615734 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:41:50.616184 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:41:50.616592 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m17:41:50.617237 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:41:50.618180 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:41:50.618633 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:41:50.619075 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:41:50.619775 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:41:50.620258 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m17:41:50.625982 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m17:41:50.631818 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:41:50.632391 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m17:41:50.632801 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:41:50.633715 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:41:50.634187 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:41:50.634619 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m17:41:50.645781 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m17:41:50.647294 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m17:41:50.648570 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m17:41:50.649034 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m17:41:50.650603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6e86652-4075-4a1b-9ccb-2763fbd30614', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7caa5c02b350>]}
[0m17:41:50.651228 [debug] [MainThread]: Using duckdb connection "master"
[0m17:41:50.651668 [debug] [MainThread]: On master: BEGIN
[0m17:41:50.652096 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:41:50.652963 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:41:50.653402 [debug] [MainThread]: On master: COMMIT
[0m17:41:50.653818 [debug] [MainThread]: Using duckdb connection "master"
[0m17:41:50.654246 [debug] [MainThread]: On master: COMMIT
[0m17:41:50.654835 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:41:50.655288 [debug] [MainThread]: On master: Close
[0m17:41:50.657340 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:41:50.658017 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m17:41:50.658600 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m17:41:50.659106 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m17:41:50.667510 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:41:50.668251 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m17:41:50.725850 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:41:50.726442 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201174150701301"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Based on PCA factors, this transaction exhibits significant deviations from normal patterns, indicating fraud.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = 'f81e8531-04f9-4c48-be60-51dd0088dc29'
    );
  
  
  
[0m17:41:50.726958 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:41:50.735437 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m17:41:50.743171 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:41:50.743686 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m17:41:50.744399 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:41:50.744873 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:41:50.745362 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201174150701301'
      
      
      order by ordinal_position

  
[0m17:41:50.748650 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:41:50.753698 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:41:50.754228 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:41:50.757055 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:41:50.767219 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:41:50.767734 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:41:50.770150 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:41:50.771675 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:41:50.772204 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m17:41:50.773222 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:41:50.789611 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:41:50.790414 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:41:50.790941 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201174150701301"
    )
  
[0m17:41:50.792205 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:41:50.802659 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:41:50.803195 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:41:50.803662 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:41:50.817605 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m17:41:50.819578 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m17:41:50.821308 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6e86652-4075-4a1b-9ccb-2763fbd30614', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7caa6963bd10>]}
[0m17:41:50.822085 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m17:41:50.822800 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:41:50.824709 [debug] [MainThread]: Using duckdb connection "master"
[0m17:41:50.825261 [debug] [MainThread]: On master: BEGIN
[0m17:41:50.825738 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:41:50.826673 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:41:50.827148 [debug] [MainThread]: On master: COMMIT
[0m17:41:50.827572 [debug] [MainThread]: Using duckdb connection "master"
[0m17:41:50.828028 [debug] [MainThread]: On master: COMMIT
[0m17:41:50.828677 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:41:50.829177 [debug] [MainThread]: On master: Close
[0m17:41:50.829707 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:41:50.830171 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m17:41:50.830711 [info ] [MainThread]: 
[0m17:41:50.831197 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m17:41:50.831994 [debug] [MainThread]: Command end result
[0m17:41:50.850758 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:41:50.852406 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:41:50.858073 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m17:41:50.858524 [info ] [MainThread]: 
[0m17:41:50.859063 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:41:50.859507 [info ] [MainThread]: 
[0m17:41:50.859989 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:41:50.860607 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:41:50.861654 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3779337, "process_in_blocks": "0", "process_kernel_time": 0.307791, "process_mem_max_rss": "277652", "process_out_blocks": "3096", "process_user_time": 4.347685}
[0m17:41:50.862265 [debug] [MainThread]: Command `dbt run` succeeded at 17:41:50.862165 after 2.38 seconds
[0m17:41:50.862728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7caa68866cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7caa5cb4c350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7caa5c7dcbc0>]}
[0m17:41:50.863298 [debug] [MainThread]: Flushing usage events
[0m17:41:51.863515 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:42:07.028600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a820b530e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a820b2b290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a82059a5a0>]}


============================== 17:42:07.032024 | 360c4776-70f6-47a4-a9ce-9451a7aeaf44 ==============================
[0m17:42:07.032024 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:42:07.032704 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'version_check': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'fail_fast': 'False', 'quiet': 'False', 'printer_width': '80', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "ced6a22c-ca18-40df-b5ef-4b518d37bac5", "ai_explanation": "Fraud detected: extreme PCA values indicate manipulation of financial data."} --profiles-dir .', 'log_cache_events': 'False', 'partial_parse': 'True', 'warn_error': 'None', 'debug': 'False', 'write_json': 'True', 'log_format': 'default', 'empty': 'False', 'profiles_dir': '.', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True'}
[0m17:42:07.279319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '360c4776-70f6-47a4-a9ce-9451a7aeaf44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a8201c3d10>]}
[0m17:42:07.351111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '360c4776-70f6-47a4-a9ce-9451a7aeaf44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a820327530>]}
[0m17:42:07.352953 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:42:07.436006 [debug] [MainThread]: checksum: d3c707027b98ebd1d7bb1adcd19c3dfd32648c7f2729051f1cc51444e80804d2, vars: {'ai_explanation': 'Fraud detected: extreme PCA values indicate manipulation '
                   'of financial data.',
 'txn_id': 'ced6a22c-ca18-40df-b5ef-4b518d37bac5'}, profile: , target: , version: 1.11.2
[0m17:42:07.527942 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:42:07.528554 [debug] [MainThread]: previous checksum: d3c707027b98ebd1d7bb1adcd19c3dfd32648c7f2729051f1cc51444e80804d2, current checksum: b2ad9d77639a66d59016be185c0e9800de387058ccba1fdea47db0d00fe59156
[0m17:42:07.529035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '360c4776-70f6-47a4-a9ce-9451a7aeaf44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a820272120>]}
[0m17:42:08.747712 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m17:42:08.748457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '360c4776-70f6-47a4-a9ce-9451a7aeaf44', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a8203268a0>]}
[0m17:42:08.840358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '360c4776-70f6-47a4-a9ce-9451a7aeaf44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a80c521940>]}
[0m17:42:08.913745 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:42:08.915564 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:42:08.927859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '360c4776-70f6-47a4-a9ce-9451a7aeaf44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a80c503950>]}
[0m17:42:08.928433 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m17:42:08.928972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '360c4776-70f6-47a4-a9ce-9451a7aeaf44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a80c5ee420>]}
[0m17:42:08.930739 [info ] [MainThread]: 
[0m17:42:08.931295 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:42:08.931772 [info ] [MainThread]: 
[0m17:42:08.932454 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:42:08.933478 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m17:42:08.969295 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m17:42:08.969894 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m17:42:08.970368 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:42:09.055047 [debug] [ThreadPool]: SQL status: OK in 0.085 seconds
[0m17:42:09.056704 [debug] [ThreadPool]: On list_argus_vault: Close
[0m17:42:09.057596 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m17:42:09.058215 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m17:42:09.065555 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:42:09.066072 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m17:42:09.066523 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:42:09.067933 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:42:09.069256 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:42:09.069720 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m17:42:09.070384 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:42:09.070835 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:42:09.071303 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m17:42:09.071988 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:42:09.072961 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:42:09.073434 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:42:09.073883 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:42:09.074539 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:42:09.075014 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m17:42:09.080744 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m17:42:09.086568 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:42:09.087125 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m17:42:09.087532 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:42:09.088684 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:42:09.089150 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:42:09.089570 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m17:42:09.100309 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m17:42:09.101758 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m17:42:09.103077 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m17:42:09.103520 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m17:42:09.105040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '360c4776-70f6-47a4-a9ce-9451a7aeaf44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a80c40cec0>]}
[0m17:42:09.105634 [debug] [MainThread]: Using duckdb connection "master"
[0m17:42:09.106109 [debug] [MainThread]: On master: BEGIN
[0m17:42:09.106516 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:42:09.107386 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:42:09.107831 [debug] [MainThread]: On master: COMMIT
[0m17:42:09.108297 [debug] [MainThread]: Using duckdb connection "master"
[0m17:42:09.108699 [debug] [MainThread]: On master: COMMIT
[0m17:42:09.109378 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:42:09.109816 [debug] [MainThread]: On master: Close
[0m17:42:09.111899 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:42:09.112551 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m17:42:09.113129 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m17:42:09.113614 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m17:42:09.121713 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:42:09.122450 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m17:42:09.179393 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:42:09.180041 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201174209154804"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Fraud detected: extreme PCA values indicate manipulation of financial data.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = 'ced6a22c-ca18-40df-b5ef-4b518d37bac5'
    );
  
  
  
[0m17:42:09.180538 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:42:09.189233 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m17:42:09.196901 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:42:09.197433 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m17:42:09.198407 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:42:09.198894 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:42:09.199398 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201174209154804'
      
      
      order by ordinal_position

  
[0m17:42:09.201892 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:42:09.206897 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:42:09.207440 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:42:09.209883 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:42:09.220001 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:42:09.220519 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:42:09.222938 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:42:09.224446 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:42:09.224973 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m17:42:09.225751 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:42:09.242157 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:42:09.242949 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:42:09.243456 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201174209154804"
    )
  
[0m17:42:09.244592 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:42:09.255082 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:42:09.255603 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:42:09.256095 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:42:09.269454 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m17:42:09.271481 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m17:42:09.273184 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '360c4776-70f6-47a4-a9ce-9451a7aeaf44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a8145c26f0>]}
[0m17:42:09.273954 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m17:42:09.274680 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:42:09.276087 [debug] [MainThread]: Using duckdb connection "master"
[0m17:42:09.276573 [debug] [MainThread]: On master: BEGIN
[0m17:42:09.277019 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:42:09.277952 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:42:09.278397 [debug] [MainThread]: On master: COMMIT
[0m17:42:09.278810 [debug] [MainThread]: Using duckdb connection "master"
[0m17:42:09.279242 [debug] [MainThread]: On master: COMMIT
[0m17:42:09.279875 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:42:09.280348 [debug] [MainThread]: On master: Close
[0m17:42:09.280859 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:42:09.281310 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m17:42:09.281750 [info ] [MainThread]: 
[0m17:42:09.282289 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m17:42:09.283117 [debug] [MainThread]: Command end result
[0m17:42:09.302406 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:42:09.304047 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:42:09.309730 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m17:42:09.310207 [info ] [MainThread]: 
[0m17:42:09.310757 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:42:09.311262 [info ] [MainThread]: 
[0m17:42:09.311769 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:42:09.312450 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:42:09.313532 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.347587, "process_in_blocks": "0", "process_kernel_time": 0.291589, "process_mem_max_rss": "271416", "process_out_blocks": "3104", "process_user_time": 4.291243}
[0m17:42:09.314127 [debug] [MainThread]: Command `dbt run` succeeded at 17:42:09.314024 after 2.35 seconds
[0m17:42:09.314596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a8232d6090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a81443bd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a80c2ccb90>]}
[0m17:42:09.315108 [debug] [MainThread]: Flushing usage events
[0m17:42:10.316990 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:47:15.654847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c42158b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c3261310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c3986210>]}


============================== 17:47:15.658210 | d7b8ddb4-e044-4028-a5ab-4e9c5798e89d ==============================
[0m17:47:15.658210 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:47:15.658865 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'debug': 'False', 'introspect': 'True', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'partial_parse': 'True', 'static_parser': 'True', 'log_format': 'default', 'profiles_dir': '.', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "0f5daae2-5d7a-42c8-a065-7bfb34c8f326", "ai_explanation": "Fraudulent transaction detected based on anomalous PCA scores exceeding 95th percentile threshold."} --profiles-dir .', 'version_check': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'printer_width': '80', 'empty': 'False', 'no_print': 'None', 'log_cache_events': 'False', 'fail_fast': 'False', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m17:47:15.905170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd7b8ddb4-e044-4028-a5ab-4e9c5798e89d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c3029700>]}
[0m17:47:15.975984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd7b8ddb4-e044-4028-a5ab-4e9c5798e89d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c2fc9460>]}
[0m17:47:15.977674 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:47:16.061480 [debug] [MainThread]: checksum: 7398f76291143ce7272c262f4f93f0b9af54f580468e6e51f157829fc7b79efa, vars: {'ai_explanation': 'Fraudulent transaction detected based on anomalous PCA '
                   'scores exceeding 95th percentile threshold.',
 'txn_id': '0f5daae2-5d7a-42c8-a065-7bfb34c8f326'}, profile: , target: , version: 1.11.2
[0m17:47:16.154407 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:47:16.155029 [debug] [MainThread]: previous checksum: 7398f76291143ce7272c262f4f93f0b9af54f580468e6e51f157829fc7b79efa, current checksum: d3c707027b98ebd1d7bb1adcd19c3dfd32648c7f2729051f1cc51444e80804d2
[0m17:47:16.155493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd7b8ddb4-e044-4028-a5ab-4e9c5798e89d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c394e8a0>]}
[0m17:47:17.375774 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m17:47:17.376474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd7b8ddb4-e044-4028-a5ab-4e9c5798e89d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52b754f860>]}
[0m17:47:17.481675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd7b8ddb4-e044-4028-a5ab-4e9c5798e89d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c31fa810>]}
[0m17:47:17.551335 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:47:17.553070 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:47:17.565248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd7b8ddb4-e044-4028-a5ab-4e9c5798e89d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52b41dade0>]}
[0m17:47:17.565782 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m17:47:17.566263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7b8ddb4-e044-4028-a5ab-4e9c5798e89d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52b71fef60>]}
[0m17:47:17.567990 [info ] [MainThread]: 
[0m17:47:17.568481 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:47:17.568926 [info ] [MainThread]: 
[0m17:47:17.569553 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:47:17.570623 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m17:47:17.605812 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m17:47:17.606321 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m17:47:17.606757 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:47:17.694076 [debug] [ThreadPool]: SQL status: OK in 0.087 seconds
[0m17:47:17.695734 [debug] [ThreadPool]: On list_argus_vault: Close
[0m17:47:17.696588 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m17:47:17.697186 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m17:47:17.704448 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:47:17.704923 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m17:47:17.705348 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:47:17.706462 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:47:17.707750 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:47:17.708200 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m17:47:17.708784 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:47:17.709221 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:47:17.709619 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m17:47:17.710338 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:47:17.711270 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:47:17.711701 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:47:17.712129 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:47:17.712723 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:47:17.713180 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m17:47:17.718793 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m17:47:17.724431 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:47:17.724987 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m17:47:17.725398 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:47:17.726284 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:47:17.726713 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:47:17.727148 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m17:47:17.737984 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m17:47:17.739386 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m17:47:17.740638 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m17:47:17.741091 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m17:47:17.742755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7b8ddb4-e044-4028-a5ab-4e9c5798e89d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52b7191a30>]}
[0m17:47:17.743364 [debug] [MainThread]: Using duckdb connection "master"
[0m17:47:17.743794 [debug] [MainThread]: On master: BEGIN
[0m17:47:17.744218 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:47:17.745176 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:47:17.745617 [debug] [MainThread]: On master: COMMIT
[0m17:47:17.746067 [debug] [MainThread]: Using duckdb connection "master"
[0m17:47:17.746466 [debug] [MainThread]: On master: COMMIT
[0m17:47:17.747070 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:47:17.747496 [debug] [MainThread]: On master: Close
[0m17:47:17.749504 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:47:17.750135 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m17:47:17.750686 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m17:47:17.751197 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m17:47:17.759330 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:47:17.760049 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m17:47:17.815771 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:47:17.816354 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201174717791648"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Fraudulent transaction detected based on anomalous PCA scores exceeding 95th percentile threshold.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '0f5daae2-5d7a-42c8-a065-7bfb34c8f326'
    );
  
  
  
[0m17:47:17.816832 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:17.825769 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m17:47:17.833347 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:47:17.833846 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m17:47:17.834553 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:47:17.835043 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:47:17.835509 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201174717791648'
      
      
      order by ordinal_position

  
[0m17:47:17.838382 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:47:17.843296 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:47:17.843800 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:47:17.846748 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:47:17.856830 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:47:17.857358 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:47:17.860022 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:47:17.861522 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:47:17.862037 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m17:47:17.862789 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:47:17.879016 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:47:17.879782 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:47:17.880290 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201174717791648"
    )
  
[0m17:47:17.881561 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:47:17.891812 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:47:17.892344 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:47:17.892801 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:47:17.906565 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m17:47:17.908531 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m17:47:17.910252 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7b8ddb4-e044-4028-a5ab-4e9c5798e89d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52b71576b0>]}
[0m17:47:17.911047 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m17:47:17.911760 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:47:17.913229 [debug] [MainThread]: Using duckdb connection "master"
[0m17:47:17.913741 [debug] [MainThread]: On master: BEGIN
[0m17:47:17.914213 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:47:17.915113 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:47:17.915550 [debug] [MainThread]: On master: COMMIT
[0m17:47:17.915976 [debug] [MainThread]: Using duckdb connection "master"
[0m17:47:17.916376 [debug] [MainThread]: On master: COMMIT
[0m17:47:17.917052 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:47:17.917501 [debug] [MainThread]: On master: Close
[0m17:47:17.918026 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:47:17.918429 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m17:47:17.918841 [info ] [MainThread]: 
[0m17:47:17.919323 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m17:47:17.920121 [debug] [MainThread]: Command end result
[0m17:47:17.940192 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:47:17.941834 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:47:17.947479 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m17:47:17.947930 [info ] [MainThread]: 
[0m17:47:17.948450 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:47:17.948890 [info ] [MainThread]: 
[0m17:47:17.949381 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:47:17.950014 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:47:17.951062 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3591256, "process_in_blocks": "0", "process_kernel_time": 0.318927, "process_mem_max_rss": "276824", "process_out_blocks": "3112", "process_user_time": 4.26689}
[0m17:47:17.951639 [debug] [MainThread]: Command `dbt run` succeeded at 17:47:17.951537 after 2.36 seconds
[0m17:47:17.952130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c3832ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c2fca540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f528af37bf0>]}
[0m17:47:17.952600 [debug] [MainThread]: Flushing usage events
[0m17:47:19.035874 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:47:35.174170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5f1aa56f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5f1af824b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5f1c0b6fc0>]}


============================== 17:47:35.177457 | 8180cdd7-184e-4779-8618-b713936b117f ==============================
[0m17:47:35.177457 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:47:35.178165 [debug] [MainThread]: running dbt with arguments {'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'quiet': 'False', 'use_colors': 'True', 'profiles_dir': '.', 'empty': 'False', 'fail_fast': 'False', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "d0df9ebd-40d6-4ef1-a733-f8afff939b9e", "ai_explanation": "Based on PCA factors, this transaction exhibits significant anomalies in V7 and V17, indicating fraud."} --profiles-dir .', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'debug': 'False', 'write_json': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'partial_parse': 'True'}
[0m17:47:35.424069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8180cdd7-184e-4779-8618-b713936b117f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5f1a223dd0>]}
[0m17:47:35.494608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8180cdd7-184e-4779-8618-b713936b117f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5f1b30baa0>]}
[0m17:47:35.496307 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:47:35.582376 [debug] [MainThread]: checksum: 0afd5253d090c0df10db2218156dba74be19fe4c03cc8dca5d8f29572f380fdc, vars: {'ai_explanation': 'Based on PCA factors, this transaction exhibits '
                   'significant anomalies in V7 and V17, indicating fraud.',
 'txn_id': 'd0df9ebd-40d6-4ef1-a733-f8afff939b9e'}, profile: , target: , version: 1.11.2
[0m17:47:35.674809 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:47:35.675425 [debug] [MainThread]: previous checksum: 0afd5253d090c0df10db2218156dba74be19fe4c03cc8dca5d8f29572f380fdc, current checksum: 7398f76291143ce7272c262f4f93f0b9af54f580468e6e51f157829fc7b79efa
[0m17:47:35.675894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8180cdd7-184e-4779-8618-b713936b117f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5f1aa56960>]}
[0m17:47:36.897052 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m17:47:36.897722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8180cdd7-184e-4779-8618-b713936b117f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5f1a221070>]}
[0m17:47:36.989053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8180cdd7-184e-4779-8618-b713936b117f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5ed21039e0>]}
[0m17:47:37.058637 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:47:37.060507 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:47:37.073016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8180cdd7-184e-4779-8618-b713936b117f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5ed21c3c20>]}
[0m17:47:37.073566 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m17:47:37.074055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8180cdd7-184e-4779-8618-b713936b117f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5f1a1d3e90>]}
[0m17:47:37.075779 [info ] [MainThread]: 
[0m17:47:37.076300 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:47:37.076743 [info ] [MainThread]: 
[0m17:47:37.077384 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:47:37.078413 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m17:47:37.114768 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m17:47:37.115408 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m17:47:37.115847 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:47:37.202549 [debug] [ThreadPool]: SQL status: OK in 0.087 seconds
[0m17:47:37.204263 [debug] [ThreadPool]: On list_argus_vault: Close
[0m17:47:37.205115 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m17:47:37.205685 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m17:47:37.213065 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:47:37.213536 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m17:47:37.213997 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:47:37.215372 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:47:37.217127 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:47:37.217609 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m17:47:37.218748 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:47:37.219224 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:47:37.219635 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m17:47:37.220538 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:47:37.221488 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:47:37.221967 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:47:37.222415 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:47:37.223149 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:47:37.223593 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m17:47:37.229277 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m17:47:37.235350 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:47:37.235896 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m17:47:37.236340 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:47:37.237248 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:47:37.237694 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:47:37.238149 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m17:47:37.249110 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m17:47:37.250579 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m17:47:37.251846 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m17:47:37.252315 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m17:47:37.253933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8180cdd7-184e-4779-8618-b713936b117f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5f0c3abe00>]}
[0m17:47:37.254552 [debug] [MainThread]: Using duckdb connection "master"
[0m17:47:37.254997 [debug] [MainThread]: On master: BEGIN
[0m17:47:37.255413 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:47:37.256351 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:47:37.256793 [debug] [MainThread]: On master: COMMIT
[0m17:47:37.257242 [debug] [MainThread]: Using duckdb connection "master"
[0m17:47:37.257650 [debug] [MainThread]: On master: COMMIT
[0m17:47:37.258253 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:47:37.258684 [debug] [MainThread]: On master: Close
[0m17:47:37.260766 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:47:37.261417 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m17:47:37.261996 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m17:47:37.262480 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m17:47:37.270653 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:47:37.271402 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m17:47:37.328245 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:47:37.328816 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201174737303850"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Based on PCA factors, this transaction exhibits significant anomalies in V7 and V17, indicating fraud.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = 'd0df9ebd-40d6-4ef1-a733-f8afff939b9e'
    );
  
  
  
[0m17:47:37.329334 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:37.338883 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m17:47:37.346708 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:47:37.347273 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m17:47:37.348031 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:47:37.348536 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:47:37.349052 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201174737303850'
      
      
      order by ordinal_position

  
[0m17:47:37.351934 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:47:37.356963 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:47:37.357512 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:47:37.360130 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:47:37.371138 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:47:37.371710 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:47:37.374482 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:47:37.376077 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:47:37.376610 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m17:47:37.377445 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:47:37.393885 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:47:37.394731 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:47:37.395284 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201174737303850"
    )
  
[0m17:47:37.396694 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:47:37.407129 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:47:37.407666 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:47:37.408192 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:47:37.422154 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m17:47:37.424215 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m17:47:37.425977 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8180cdd7-184e-4779-8618-b713936b117f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5f0c36ed20>]}
[0m17:47:37.426758 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m17:47:37.427526 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:47:37.428994 [debug] [MainThread]: Using duckdb connection "master"
[0m17:47:37.429511 [debug] [MainThread]: On master: BEGIN
[0m17:47:37.429958 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:47:37.430831 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:47:37.431302 [debug] [MainThread]: On master: COMMIT
[0m17:47:37.431719 [debug] [MainThread]: Using duckdb connection "master"
[0m17:47:37.432162 [debug] [MainThread]: On master: COMMIT
[0m17:47:37.432764 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:47:37.433223 [debug] [MainThread]: On master: Close
[0m17:47:37.433770 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:47:37.434485 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m17:47:37.435242 [info ] [MainThread]: 
[0m17:47:37.435738 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m17:47:37.436525 [debug] [MainThread]: Command end result
[0m17:47:37.455694 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:47:37.457351 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:47:37.462995 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m17:47:37.463436 [info ] [MainThread]: 
[0m17:47:37.463976 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:47:37.464431 [info ] [MainThread]: 
[0m17:47:37.464902 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:47:37.465559 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:47:37.466613 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3548408, "process_in_blocks": "0", "process_kernel_time": 0.308534, "process_mem_max_rss": "283652", "process_out_blocks": "3104", "process_user_time": 4.270035}
[0m17:47:37.467220 [debug] [MainThread]: Command `dbt run` succeeded at 17:47:37.467116 after 2.36 seconds
[0m17:47:37.467690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5f1a810fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5f1b02d220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5f1cdc12e0>]}
[0m17:47:37.468191 [debug] [MainThread]: Flushing usage events
[0m17:47:38.442733 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:47:53.797208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79327e26df40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79327e9ee060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79327e6779e0>]}


============================== 17:47:53.800585 | fb7fe83e-4e0d-4605-8dc1-399d87d296c9 ==============================
[0m17:47:53.800585 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:47:53.801250 [debug] [MainThread]: running dbt with arguments {'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'use_colors': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'introspect': 'True', 'fail_fast': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'no_print': 'None', 'log_cache_events': 'False', 'profiles_dir': '.', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "425bd2e6-becb-42de-9221-f3996dc48c18", "ai_explanation": "Fraud detected: extreme PCA scores indicate manipulation of financial data."} --profiles-dir .', 'version_check': 'True', 'debug': 'False', 'quiet': 'False', 'static_parser': 'True', 'target_path': 'None', 'write_json': 'True', 'log_format': 'default'}
[0m17:47:54.050310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb7fe83e-4e0d-4605-8dc1-399d87d296c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793271fb6480>]}
[0m17:47:54.121835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb7fe83e-4e0d-4605-8dc1-399d87d296c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79327d9c3c20>]}
[0m17:47:54.123620 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:47:54.209053 [debug] [MainThread]: checksum: 131b5b067b6881858b2119fa924736ca1ea66dc831b7eda193d8e60074ce7e09, vars: {'ai_explanation': 'Fraud detected: extreme PCA scores indicate manipulation '
                   'of financial data.',
 'txn_id': '425bd2e6-becb-42de-9221-f3996dc48c18'}, profile: , target: , version: 1.11.2
[0m17:47:54.301566 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:47:54.302195 [debug] [MainThread]: previous checksum: 131b5b067b6881858b2119fa924736ca1ea66dc831b7eda193d8e60074ce7e09, current checksum: 0afd5253d090c0df10db2218156dba74be19fe4c03cc8dca5d8f29572f380fdc
[0m17:47:54.302674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fb7fe83e-4e0d-4605-8dc1-399d87d296c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79327e2469c0>]}
[0m17:47:55.538822 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m17:47:55.539507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fb7fe83e-4e0d-4605-8dc1-399d87d296c9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79327da45c70>]}
[0m17:47:55.631246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb7fe83e-4e0d-4605-8dc1-399d87d296c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7932700e5e80>]}
[0m17:47:55.699945 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:47:55.701664 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:47:55.713973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb7fe83e-4e0d-4605-8dc1-399d87d296c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793271cb6090>]}
[0m17:47:55.714524 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m17:47:55.715020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb7fe83e-4e0d-4605-8dc1-399d87d296c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79327daf7b90>]}
[0m17:47:55.716737 [info ] [MainThread]: 
[0m17:47:55.717245 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:47:55.717677 [info ] [MainThread]: 
[0m17:47:55.718297 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:47:55.719376 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m17:47:55.754711 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m17:47:55.755211 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m17:47:55.755638 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:47:55.844320 [debug] [ThreadPool]: SQL status: OK in 0.089 seconds
[0m17:47:55.846068 [debug] [ThreadPool]: On list_argus_vault: Close
[0m17:47:55.846931 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m17:47:55.847502 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m17:47:55.854808 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:47:55.855291 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m17:47:55.855705 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:47:55.856868 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:47:55.858190 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:47:55.858626 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m17:47:55.859273 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:47:55.859695 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:47:55.860123 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m17:47:55.860747 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:47:55.861703 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:47:55.862162 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:47:55.862572 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:47:55.863255 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:47:55.863694 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m17:47:55.869422 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m17:47:55.875175 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:47:55.875709 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m17:47:55.876136 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:47:55.876997 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:47:55.877433 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:47:55.877854 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m17:47:55.888728 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m17:47:55.890162 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m17:47:55.891422 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m17:47:55.891859 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m17:47:55.893525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb7fe83e-4e0d-4605-8dc1-399d87d296c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7932700e6f00>]}
[0m17:47:55.894140 [debug] [MainThread]: Using duckdb connection "master"
[0m17:47:55.894566 [debug] [MainThread]: On master: BEGIN
[0m17:47:55.894972 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:47:55.895823 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:47:55.896283 [debug] [MainThread]: On master: COMMIT
[0m17:47:55.896694 [debug] [MainThread]: Using duckdb connection "master"
[0m17:47:55.897113 [debug] [MainThread]: On master: COMMIT
[0m17:47:55.897705 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:47:55.898157 [debug] [MainThread]: On master: Close
[0m17:47:55.900206 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:47:55.900830 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m17:47:55.901424 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m17:47:55.901899 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m17:47:55.909984 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:47:55.910689 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m17:47:55.966610 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:47:55.967193 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201174755942464"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Fraud detected: extreme PCA scores indicate manipulation of financial data.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '425bd2e6-becb-42de-9221-f3996dc48c18'
    );
  
  
  
[0m17:47:55.967675 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:55.976479 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m17:47:55.984269 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:47:55.984792 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m17:47:55.985509 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:47:55.985997 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:47:55.986474 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201174755942464'
      
      
      order by ordinal_position

  
[0m17:47:55.989018 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:47:55.994128 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:47:55.994637 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:47:55.997168 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:47:56.007480 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:47:56.008012 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:47:56.010514 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:47:56.012062 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:47:56.012561 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m17:47:56.013325 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:47:56.029462 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:47:56.030268 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:47:56.030758 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201174755942464"
    )
  
[0m17:47:56.032241 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:47:56.042516 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:47:56.043043 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:47:56.043508 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:47:56.057271 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m17:47:56.059257 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m17:47:56.060988 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb7fe83e-4e0d-4605-8dc1-399d87d296c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79327da10320>]}
[0m17:47:56.061742 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m17:47:56.062477 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:47:56.063812 [debug] [MainThread]: Using duckdb connection "master"
[0m17:47:56.064350 [debug] [MainThread]: On master: BEGIN
[0m17:47:56.064800 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:47:56.065835 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:47:56.066297 [debug] [MainThread]: On master: COMMIT
[0m17:47:56.066698 [debug] [MainThread]: Using duckdb connection "master"
[0m17:47:56.067116 [debug] [MainThread]: On master: COMMIT
[0m17:47:56.067691 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:47:56.068139 [debug] [MainThread]: On master: Close
[0m17:47:56.068613 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:47:56.069028 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m17:47:56.069441 [info ] [MainThread]: 
[0m17:47:56.069933 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m17:47:56.070725 [debug] [MainThread]: Command end result
[0m17:47:56.089405 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:47:56.091015 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:47:56.096572 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m17:47:56.097020 [info ] [MainThread]: 
[0m17:47:56.097565 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:47:56.098054 [info ] [MainThread]: 
[0m17:47:56.098547 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:47:56.099209 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:47:56.100274 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3658903, "process_in_blocks": "0", "process_kernel_time": 0.312556, "process_mem_max_rss": "273528", "process_out_blocks": "3112", "process_user_time": 4.295425}
[0m17:47:56.100839 [debug] [MainThread]: Command `dbt run` succeeded at 17:47:56.100740 after 2.37 seconds
[0m17:47:56.101329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79327d9c2720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79327db78500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79327e6751f0>]}
[0m17:47:56.101796 [debug] [MainThread]: Flushing usage events
[0m17:47:57.097943 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:50:02.223218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701d050420f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701d04e435f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701d057093d0>]}


============================== 17:50:02.226686 | 10a31b27-ff47-41e2-989f-617d2186d927 ==============================
[0m17:50:02.226686 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:50:02.227405 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "8d2619f8-1573-428c-832d-2a9aa4e066ec", "ai_explanation": "Based on PCA factors, this transaction is fraud due to significantly high V2 and V5 values."} --profiles-dir .', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'write_json': 'True', 'static_parser': 'True', 'warn_error': 'None', 'introspect': 'True', 'target_path': 'None', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'cache_selected_only': 'False', 'quiet': 'False', 'empty': 'False', 'indirect_selection': 'eager', 'version_check': 'True', 'use_colors': 'True', 'profiles_dir': '.', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'log_cache_events': 'False', 'no_print': 'None', 'debug': 'False'}
[0m17:50:02.474545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '10a31b27-ff47-41e2-989f-617d2186d927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701d046c6240>]}
[0m17:50:02.545846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '10a31b27-ff47-41e2-989f-617d2186d927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701d04f76330>]}
[0m17:50:02.547744 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:50:02.631750 [debug] [MainThread]: checksum: 0951a6105793595106c904811177720ec251314608118f1cacfa76b381d9caba, vars: {'ai_explanation': 'Based on PCA factors, this transaction is fraud due to '
                   'significantly high V2 and V5 values.',
 'txn_id': '8d2619f8-1573-428c-832d-2a9aa4e066ec'}, profile: , target: , version: 1.11.2
[0m17:50:02.724396 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:50:02.724997 [debug] [MainThread]: previous checksum: 0951a6105793595106c904811177720ec251314608118f1cacfa76b381d9caba, current checksum: 131b5b067b6881858b2119fa924736ca1ea66dc831b7eda193d8e60074ce7e09
[0m17:50:02.725485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '10a31b27-ff47-41e2-989f-617d2186d927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701cf88b5820>]}
[0m17:50:03.938651 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m17:50:03.939328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '10a31b27-ff47-41e2-989f-617d2186d927', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701d047105c0>]}
[0m17:50:04.030479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '10a31b27-ff47-41e2-989f-617d2186d927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701d0460be90>]}
[0m17:50:04.098996 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:50:04.100694 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:50:04.112904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '10a31b27-ff47-41e2-989f-617d2186d927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701cf8b504a0>]}
[0m17:50:04.113509 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m17:50:04.114004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '10a31b27-ff47-41e2-989f-617d2186d927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701cf8154740>]}
[0m17:50:04.115733 [info ] [MainThread]: 
[0m17:50:04.116261 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:50:04.116697 [info ] [MainThread]: 
[0m17:50:04.117338 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:50:04.118342 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m17:50:04.153531 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m17:50:04.154060 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m17:50:04.154508 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:50:04.241746 [debug] [ThreadPool]: SQL status: OK in 0.087 seconds
[0m17:50:04.243524 [debug] [ThreadPool]: On list_argus_vault: Close
[0m17:50:04.244475 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m17:50:04.245095 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m17:50:04.252617 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:50:04.253116 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m17:50:04.253539 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:50:04.254744 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:50:04.256129 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:50:04.256568 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m17:50:04.257223 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:50:04.257652 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:50:04.258094 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m17:50:04.258812 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:50:04.259763 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:50:04.260228 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:50:04.260635 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:50:04.261256 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:50:04.261694 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m17:50:04.267414 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m17:50:04.273446 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:50:04.274021 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m17:50:04.274462 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:50:04.275384 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:50:04.275839 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:50:04.276307 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m17:50:04.287265 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m17:50:04.288723 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m17:50:04.290038 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m17:50:04.290498 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m17:50:04.292046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '10a31b27-ff47-41e2-989f-617d2186d927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701ce8525730>]}
[0m17:50:04.292625 [debug] [MainThread]: Using duckdb connection "master"
[0m17:50:04.293106 [debug] [MainThread]: On master: BEGIN
[0m17:50:04.293514 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:50:04.294434 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:50:04.294878 [debug] [MainThread]: On master: COMMIT
[0m17:50:04.295331 [debug] [MainThread]: Using duckdb connection "master"
[0m17:50:04.295731 [debug] [MainThread]: On master: COMMIT
[0m17:50:04.296355 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:50:04.296782 [debug] [MainThread]: On master: Close
[0m17:50:04.298882 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:50:04.299543 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m17:50:04.300134 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m17:50:04.300628 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m17:50:04.308749 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:50:04.309534 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m17:50:04.365174 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:50:04.365761 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201175004341183"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Based on PCA factors, this transaction is fraud due to significantly high V2 and V5 values.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '8d2619f8-1573-428c-832d-2a9aa4e066ec'
    );
  
  
  
[0m17:50:04.366285 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:50:04.374748 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m17:50:04.382353 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:50:04.382853 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m17:50:04.383546 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:50:04.384038 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:50:04.384509 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201175004341183'
      
      
      order by ordinal_position

  
[0m17:50:04.387192 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:50:04.392115 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:50:04.392616 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:50:04.395352 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:50:04.405351 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:50:04.405862 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:50:04.408565 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:50:04.410064 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:50:04.410560 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m17:50:04.411347 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:50:04.427401 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:50:04.428168 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:50:04.428666 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201175004341183"
    )
  
[0m17:50:04.429771 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:50:04.440178 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:50:04.440686 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:50:04.441164 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:50:04.455046 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m17:50:04.457132 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m17:50:04.458846 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10a31b27-ff47-41e2-989f-617d2186d927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701d05727ce0>]}
[0m17:50:04.459609 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m17:50:04.460321 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:50:04.461893 [debug] [MainThread]: Using duckdb connection "master"
[0m17:50:04.462453 [debug] [MainThread]: On master: BEGIN
[0m17:50:04.462892 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:50:04.463846 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:50:04.464306 [debug] [MainThread]: On master: COMMIT
[0m17:50:04.464713 [debug] [MainThread]: Using duckdb connection "master"
[0m17:50:04.465146 [debug] [MainThread]: On master: COMMIT
[0m17:50:04.465743 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:50:04.466208 [debug] [MainThread]: On master: Close
[0m17:50:04.466690 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:50:04.467124 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m17:50:04.467542 [info ] [MainThread]: 
[0m17:50:04.468015 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m17:50:04.468768 [debug] [MainThread]: Command end result
[0m17:50:04.488527 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:50:04.490171 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:50:04.495777 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m17:50:04.496235 [info ] [MainThread]: 
[0m17:50:04.496749 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:50:04.497221 [info ] [MainThread]: 
[0m17:50:04.497679 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:50:04.498321 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:50:04.499345 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.338765, "process_in_blocks": "0", "process_kernel_time": 0.30061, "process_mem_max_rss": "270680", "process_out_blocks": "3120", "process_user_time": 4.259964}
[0m17:50:04.499944 [debug] [MainThread]: Command `dbt run` succeeded at 17:50:04.499819 after 2.34 seconds
[0m17:50:04.500418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701d075b9b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701d04764440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701d071cccb0>]}
[0m17:50:04.500889 [debug] [MainThread]: Flushing usage events
[0m17:50:05.440048 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:50:21.950175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f1d66122d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f1d67e62a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f1d8d5a0c0>]}


============================== 17:50:21.953571 | 2c2c0e52-6b2d-4290-b83c-e916699a3975 ==============================
[0m17:50:21.953571 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:50:21.954272 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'debug': 'False', 'target_path': 'None', 'empty': 'False', 'no_print': 'None', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "6a3586cb-da81-40a0-8bc8-8b880264778d", "ai_explanation": "Fraudulent transaction based on PCA analysis: Anomalous V14 value (-4.662576955) indicates manipulation."} --profiles-dir .', 'log_cache_events': 'False', 'profiles_dir': '.', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'warn_error': 'None', 'fail_fast': 'False', 'quiet': 'False', 'printer_width': '80', 'log_format': 'default', 'indirect_selection': 'eager', 'static_parser': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'write_json': 'True'}
[0m17:50:22.200707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c2c0e52-6b2d-4290-b83c-e916699a3975', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f1d5daf260>]}
[0m17:50:22.271856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c2c0e52-6b2d-4290-b83c-e916699a3975', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f1d89690a0>]}
[0m17:50:22.273712 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:50:22.358849 [debug] [MainThread]: checksum: 8780f676d8d3f1d69f9e6ff67ecbaa89c848b8fb98dc0ed2722600740df43588, vars: {'ai_explanation': 'Fraudulent transaction based on PCA analysis: Anomalous '
                   'V14 value (-4.662576955) indicates manipulation.',
 'txn_id': '6a3586cb-da81-40a0-8bc8-8b880264778d'}, profile: , target: , version: 1.11.2
[0m17:50:22.452660 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:50:22.453278 [debug] [MainThread]: previous checksum: 8780f676d8d3f1d69f9e6ff67ecbaa89c848b8fb98dc0ed2722600740df43588, current checksum: 0951a6105793595106c904811177720ec251314608118f1cacfa76b381d9caba
[0m17:50:22.453740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2c2c0e52-6b2d-4290-b83c-e916699a3975', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f1ca08e000>]}
[0m17:50:23.696134 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m17:50:23.696824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2c2c0e52-6b2d-4290-b83c-e916699a3975', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f1c81bb110>]}
[0m17:50:23.790051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c2c0e52-6b2d-4290-b83c-e916699a3975', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f1c8128950>]}
[0m17:50:23.863436 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:50:23.865413 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:50:23.878303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c2c0e52-6b2d-4290-b83c-e916699a3975', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f1c8094e00>]}
[0m17:50:23.878930 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m17:50:23.879447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c2c0e52-6b2d-4290-b83c-e916699a3975', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f1ca178da0>]}
[0m17:50:23.881277 [info ] [MainThread]: 
[0m17:50:23.881798 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:50:23.882289 [info ] [MainThread]: 
[0m17:50:23.882962 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:50:23.884037 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m17:50:23.919317 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m17:50:23.919825 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m17:50:23.920286 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:50:24.009090 [debug] [ThreadPool]: SQL status: OK in 0.089 seconds
[0m17:50:24.010743 [debug] [ThreadPool]: On list_argus_vault: Close
[0m17:50:24.011721 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m17:50:24.012329 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m17:50:24.019618 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:50:24.020100 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m17:50:24.020522 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:50:24.021985 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:50:24.023472 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:50:24.023924 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m17:50:24.024557 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:50:24.025009 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:50:24.025416 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m17:50:24.026057 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:50:24.026986 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:50:24.027426 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:50:24.027829 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:50:24.028496 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:50:24.028951 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m17:50:24.034486 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m17:50:24.040141 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:50:24.040677 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m17:50:24.041110 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:50:24.042227 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:50:24.042664 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:50:24.043112 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m17:50:24.054238 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m17:50:24.055685 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m17:50:24.056963 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m17:50:24.057408 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m17:50:24.058946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c2c0e52-6b2d-4290-b83c-e916699a3975', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f1c80c2900>]}
[0m17:50:24.059634 [debug] [MainThread]: Using duckdb connection "master"
[0m17:50:24.060116 [debug] [MainThread]: On master: BEGIN
[0m17:50:24.060553 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:50:24.061541 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:50:24.062026 [debug] [MainThread]: On master: COMMIT
[0m17:50:24.062484 [debug] [MainThread]: Using duckdb connection "master"
[0m17:50:24.062946 [debug] [MainThread]: On master: COMMIT
[0m17:50:24.063600 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:50:24.064080 [debug] [MainThread]: On master: Close
[0m17:50:24.066197 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:50:24.066831 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m17:50:24.067405 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m17:50:24.067880 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m17:50:24.075977 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:50:24.076687 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m17:50:24.133116 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:50:24.133742 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201175024108529"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Fraudulent transaction based on PCA analysis: Anomalous V14 value (-4.662576955) indicates manipulation.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '6a3586cb-da81-40a0-8bc8-8b880264778d'
    );
  
  
  
[0m17:50:24.134263 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:50:24.143075 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m17:50:24.151006 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:50:24.151545 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m17:50:24.152318 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:50:24.152803 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:50:24.153307 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201175024108529'
      
      
      order by ordinal_position

  
[0m17:50:24.156052 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:50:24.161249 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:50:24.161786 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:50:24.165116 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:50:24.176964 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:50:24.177504 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:50:24.180299 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:50:24.181853 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:50:24.182377 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m17:50:24.183132 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:50:24.199396 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:50:24.200169 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:50:24.200667 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201175024108529"
    )
  
[0m17:50:24.201827 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:50:24.212169 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:50:24.212677 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:50:24.213172 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:50:24.226845 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m17:50:24.228904 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m17:50:24.230682 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c2c0e52-6b2d-4290-b83c-e916699a3975', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f1d6d20b60>]}
[0m17:50:24.231464 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m17:50:24.232195 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:50:24.233620 [debug] [MainThread]: Using duckdb connection "master"
[0m17:50:24.234219 [debug] [MainThread]: On master: BEGIN
[0m17:50:24.234729 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:50:24.235670 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:50:24.236188 [debug] [MainThread]: On master: COMMIT
[0m17:50:24.236635 [debug] [MainThread]: Using duckdb connection "master"
[0m17:50:24.237112 [debug] [MainThread]: On master: COMMIT
[0m17:50:24.237773 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:50:24.238282 [debug] [MainThread]: On master: Close
[0m17:50:24.238801 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:50:24.239240 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m17:50:24.239703 [info ] [MainThread]: 
[0m17:50:24.240227 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m17:50:24.241085 [debug] [MainThread]: Command end result
[0m17:50:24.263088 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:50:24.264949 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:50:24.272230 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m17:50:24.272703 [info ] [MainThread]: 
[0m17:50:24.273318 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:50:24.273793 [info ] [MainThread]: 
[0m17:50:24.274371 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:50:24.275072 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:50:24.276181 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3880496, "process_in_blocks": "0", "process_kernel_time": 0.291911, "process_mem_max_rss": "281004", "process_out_blocks": "3112", "process_user_time": 4.330015}
[0m17:50:24.276795 [debug] [MainThread]: Command `dbt run` succeeded at 17:50:24.276683 after 2.39 seconds
[0m17:50:24.277334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f1da653d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f1c8146c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f1c8146f60>]}
[0m17:50:24.277852 [debug] [MainThread]: Flushing usage events
[0m17:50:25.186988 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:50:41.525699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e48f721e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e493754e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e48f92fc80>]}


============================== 17:50:41.529163 | bff1a53f-c930-4810-a7e4-3365ed58da0e ==============================
[0m17:50:41.529163 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:50:41.529825 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'debug': 'False', 'profiles_dir': '.', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'log_format': 'default', 'log_cache_events': 'False', 'target_path': 'None', 'static_parser': 'True', 'quiet': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'no_print': 'None', 'write_json': 'True', 'introspect': 'True', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'cache_selected_only': 'False', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "b13aa687-6752-4c9b-9fd1-76886a4d4c7e", "ai_explanation": "Based on PCA factors, this transaction is fraud due to unusually high V17 score (6.4435098643744)."} --profiles-dir .', 'fail_fast': 'False'}
[0m17:50:41.779273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bff1a53f-c930-4810-a7e4-3365ed58da0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e48efc5070>]}
[0m17:50:41.851448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bff1a53f-c930-4810-a7e4-3365ed58da0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e48ee92c30>]}
[0m17:50:41.853320 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:50:41.937456 [debug] [MainThread]: checksum: 3c82ae5ee8f02d9e9c797f280383172f92670520b98f89c24fafad3c988b08c6, vars: {'ai_explanation': 'Based on PCA factors, this transaction is fraud due to '
                   'unusually high V17 score (6.4435098643744).',
 'txn_id': 'b13aa687-6752-4c9b-9fd1-76886a4d4c7e'}, profile: , target: , version: 1.11.2
[0m17:50:42.031209 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:50:42.031802 [debug] [MainThread]: previous checksum: 3c82ae5ee8f02d9e9c797f280383172f92670520b98f89c24fafad3c988b08c6, current checksum: 8780f676d8d3f1d69f9e6ff67ecbaa89c848b8fb98dc0ed2722600740df43588
[0m17:50:42.032331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bff1a53f-c930-4810-a7e4-3365ed58da0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e4831a1fa0>]}
[0m17:50:43.269218 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m17:50:43.269893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bff1a53f-c930-4810-a7e4-3365ed58da0e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e48308e660>]}
[0m17:50:43.362743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bff1a53f-c930-4810-a7e4-3365ed58da0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e4801e0d10>]}
[0m17:50:43.432046 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:50:43.433939 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:50:43.446487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bff1a53f-c930-4810-a7e4-3365ed58da0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e48317d3a0>]}
[0m17:50:43.447063 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m17:50:43.447523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bff1a53f-c930-4810-a7e4-3365ed58da0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e48010d880>]}
[0m17:50:43.449297 [info ] [MainThread]: 
[0m17:50:43.449781 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:50:43.450226 [info ] [MainThread]: 
[0m17:50:43.450830 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:50:43.451818 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m17:50:43.487683 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m17:50:43.488274 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m17:50:43.488705 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:50:43.573993 [debug] [ThreadPool]: SQL status: OK in 0.085 seconds
[0m17:50:43.575866 [debug] [ThreadPool]: On list_argus_vault: Close
[0m17:50:43.576769 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m17:50:43.577388 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m17:50:43.584850 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:50:43.585341 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m17:50:43.585757 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:50:43.586960 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:50:43.588302 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:50:43.588740 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m17:50:43.589387 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:50:43.589815 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:50:43.590245 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m17:50:43.590890 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:50:43.591833 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:50:43.592296 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:50:43.592707 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:50:43.593421 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:50:43.593860 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m17:50:43.599337 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m17:50:43.605159 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:50:43.605694 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m17:50:43.606123 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:50:43.607322 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:50:43.607759 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:50:43.608200 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m17:50:43.619523 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m17:50:43.621705 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m17:50:43.623014 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m17:50:43.623445 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m17:50:43.625496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bff1a53f-c930-4810-a7e4-3365ed58da0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e42ad6ba10>]}
[0m17:50:43.626416 [debug] [MainThread]: Using duckdb connection "master"
[0m17:50:43.627137 [debug] [MainThread]: On master: BEGIN
[0m17:50:43.627816 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:50:43.629159 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:50:43.629857 [debug] [MainThread]: On master: COMMIT
[0m17:50:43.630590 [debug] [MainThread]: Using duckdb connection "master"
[0m17:50:43.631304 [debug] [MainThread]: On master: COMMIT
[0m17:50:43.632321 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:50:43.633050 [debug] [MainThread]: On master: Close
[0m17:50:43.635781 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:50:43.636510 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m17:50:43.637147 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m17:50:43.637622 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m17:50:43.645706 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:50:43.646425 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m17:50:43.702555 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:50:43.703115 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201175043678229"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Based on PCA factors, this transaction is fraud due to unusually high V17 score (6.4435098643744).' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = 'b13aa687-6752-4c9b-9fd1-76886a4d4c7e'
    );
  
  
  
[0m17:50:43.703598 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:50:43.712778 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m17:50:43.720792 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:50:43.721345 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m17:50:43.722124 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:50:43.722656 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:50:43.723153 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201175043678229'
      
      
      order by ordinal_position

  
[0m17:50:43.726429 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:50:43.732709 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:50:43.733377 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:50:43.736956 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:50:43.748044 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:50:43.748565 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:50:43.751115 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:50:43.752663 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:50:43.753181 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m17:50:43.754001 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:50:43.770475 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:50:43.771318 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:50:43.771833 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201175043678229"
    )
  
[0m17:50:43.773540 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:50:43.785237 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:50:43.785847 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:50:43.786446 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:50:43.802323 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m17:50:43.804603 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m17:50:43.806545 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bff1a53f-c930-4810-a7e4-3365ed58da0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e42a1dd6d0>]}
[0m17:50:43.807427 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.17s]
[0m17:50:43.808208 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:50:43.809673 [debug] [MainThread]: Using duckdb connection "master"
[0m17:50:43.810155 [debug] [MainThread]: On master: BEGIN
[0m17:50:43.810558 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:50:43.811625 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:50:43.812096 [debug] [MainThread]: On master: COMMIT
[0m17:50:43.812499 [debug] [MainThread]: Using duckdb connection "master"
[0m17:50:43.812887 [debug] [MainThread]: On master: COMMIT
[0m17:50:43.813503 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:50:43.813960 [debug] [MainThread]: On master: Close
[0m17:50:43.814480 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:50:43.814867 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m17:50:43.815321 [info ] [MainThread]: 
[0m17:50:43.815809 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m17:50:43.816627 [debug] [MainThread]: Command end result
[0m17:50:43.836824 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:50:43.839091 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:50:43.845167 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m17:50:43.845647 [info ] [MainThread]: 
[0m17:50:43.846207 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:50:43.846644 [info ] [MainThread]: 
[0m17:50:43.847132 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:50:43.847758 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:50:43.848828 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3860073, "process_in_blocks": "0", "process_kernel_time": 0.297588, "process_mem_max_rss": "278096", "process_out_blocks": "3112", "process_user_time": 4.334875}
[0m17:50:43.849435 [debug] [MainThread]: Command `dbt run` succeeded at 17:50:43.849333 after 2.39 seconds
[0m17:50:43.849942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e48f5d2240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e48fe35cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e48317f920>]}
[0m17:50:43.850431 [debug] [MainThread]: Flushing usage events
[0m17:50:44.819236 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:51:00.229320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0487255b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0484b6210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff049e6c7a0>]}


============================== 17:51:00.232748 | 422039f5-f0e1-468d-bf77-c252a2f343d8 ==============================
[0m17:51:00.232748 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:51:00.233460 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'log_cache_events': 'False', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "85253b14-0829-4324-a149-5e1938f9a0ac", "ai_explanation": "Fraud detected due to anomalous PCA scores, indicating manipulated transaction."} --profiles-dir .', 'log_format': 'default', 'cache_selected_only': 'False', 'quiet': 'False', 'printer_width': '80', 'version_check': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'introspect': 'True', 'fail_fast': 'False', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'no_print': 'None', 'partial_parse': 'True', 'profiles_dir': '.', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'target_path': 'None'}
[0m17:51:00.507728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '422039f5-f0e1-468d-bf77-c252a2f343d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff047e58230>]}
[0m17:51:00.580716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '422039f5-f0e1-468d-bf77-c252a2f343d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff03c339af0>]}
[0m17:51:00.582567 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:51:00.667219 [debug] [MainThread]: checksum: 7281099682133c2bf1a47a4aa64ad86e7050c71ce524a4fe26f441f52a3860c6, vars: {'ai_explanation': 'Fraud detected due to anomalous PCA scores, indicating '
                   'manipulated transaction.',
 'txn_id': '85253b14-0829-4324-a149-5e1938f9a0ac'}, profile: , target: , version: 1.11.2
[0m17:51:00.760378 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:51:00.761001 [debug] [MainThread]: previous checksum: 7281099682133c2bf1a47a4aa64ad86e7050c71ce524a4fe26f441f52a3860c6, current checksum: 3c82ae5ee8f02d9e9c797f280383172f92670520b98f89c24fafad3c988b08c6
[0m17:51:00.762212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '422039f5-f0e1-468d-bf77-c252a2f343d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0488fa9f0>]}
[0m17:51:02.006709 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m17:51:02.007388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '422039f5-f0e1-468d-bf77-c252a2f343d8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff03bfdf800>]}
[0m17:51:02.098940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '422039f5-f0e1-468d-bf77-c252a2f343d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff03bfdfd70>]}
[0m17:51:02.168156 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:51:02.169935 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:51:02.182127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '422039f5-f0e1-468d-bf77-c252a2f343d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0381cd3a0>]}
[0m17:51:02.182679 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m17:51:02.183172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '422039f5-f0e1-468d-bf77-c252a2f343d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff03c1299a0>]}
[0m17:51:02.184890 [info ] [MainThread]: 
[0m17:51:02.185401 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:51:02.185842 [info ] [MainThread]: 
[0m17:51:02.186477 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:51:02.187535 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m17:51:02.222706 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m17:51:02.223213 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m17:51:02.223666 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:51:02.312004 [debug] [ThreadPool]: SQL status: OK in 0.088 seconds
[0m17:51:02.313638 [debug] [ThreadPool]: On list_argus_vault: Close
[0m17:51:02.314501 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m17:51:02.315097 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m17:51:02.322358 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:51:02.322817 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m17:51:02.323313 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:51:02.325042 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m17:51:02.326615 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:51:02.327069 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m17:51:02.327715 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:51:02.328157 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:51:02.328558 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m17:51:02.329186 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:51:02.330148 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:51:02.330592 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:51:02.331024 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:51:02.331656 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:51:02.332113 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m17:51:02.337599 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m17:51:02.343256 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:51:02.343784 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m17:51:02.344208 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:51:02.345116 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:51:02.345546 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:51:02.345991 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m17:51:02.357981 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m17:51:02.359436 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m17:51:02.360690 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m17:51:02.361138 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m17:51:02.362727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '422039f5-f0e1-468d-bf77-c252a2f343d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff03bf190a0>]}
[0m17:51:02.363354 [debug] [MainThread]: Using duckdb connection "master"
[0m17:51:02.363772 [debug] [MainThread]: On master: BEGIN
[0m17:51:02.364203 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:51:02.365184 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:51:02.365621 [debug] [MainThread]: On master: COMMIT
[0m17:51:02.366060 [debug] [MainThread]: Using duckdb connection "master"
[0m17:51:02.366455 [debug] [MainThread]: On master: COMMIT
[0m17:51:02.367043 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:51:02.367467 [debug] [MainThread]: On master: Close
[0m17:51:02.369498 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:51:02.370184 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m17:51:02.370807 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m17:51:02.371345 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m17:51:02.379328 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:51:02.380073 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m17:51:02.436017 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:51:02.436579 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201175102411680"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Fraud detected due to anomalous PCA scores, indicating manipulated transaction.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '85253b14-0829-4324-a149-5e1938f9a0ac'
    );
  
  
  
[0m17:51:02.437083 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:51:02.446179 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m17:51:02.453658 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:51:02.454177 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m17:51:02.454845 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:51:02.455335 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:51:02.455798 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201175102411680'
      
      
      order by ordinal_position

  
[0m17:51:02.458295 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:51:02.463297 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:51:02.463820 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:51:02.466443 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:51:02.476543 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:51:02.477075 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:51:02.479667 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:51:02.481183 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:51:02.481684 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m17:51:02.482472 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:51:02.498694 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:51:02.499523 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:51:02.500032 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201175102411680"
    )
  
[0m17:51:02.501205 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:51:02.511796 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:51:02.512406 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:51:02.512877 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:51:02.531956 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m17:51:02.534154 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m17:51:02.535947 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '422039f5-f0e1-468d-bf77-c252a2f343d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff04ab7d1f0>]}
[0m17:51:02.536712 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m17:51:02.537503 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:51:02.539079 [debug] [MainThread]: Using duckdb connection "master"
[0m17:51:02.539540 [debug] [MainThread]: On master: BEGIN
[0m17:51:02.539964 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:51:02.540953 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:51:02.541597 [debug] [MainThread]: On master: COMMIT
[0m17:51:02.542358 [debug] [MainThread]: Using duckdb connection "master"
[0m17:51:02.543002 [debug] [MainThread]: On master: COMMIT
[0m17:51:02.543591 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:51:02.544047 [debug] [MainThread]: On master: Close
[0m17:51:02.544538 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:51:02.544951 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m17:51:02.545365 [info ] [MainThread]: 
[0m17:51:02.545854 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m17:51:02.546683 [debug] [MainThread]: Command end result
[0m17:51:02.565549 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:51:02.567283 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:51:02.573260 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m17:51:02.574009 [info ] [MainThread]: 
[0m17:51:02.574633 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:51:02.575141 [info ] [MainThread]: 
[0m17:51:02.575642 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:51:02.576320 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:51:02.577413 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.4111753, "process_in_blocks": "0", "process_kernel_time": 0.297079, "process_mem_max_rss": "270480", "process_out_blocks": "3112", "process_user_time": 4.375708}
[0m17:51:02.578009 [debug] [MainThread]: Command `dbt run` succeeded at 17:51:02.577882 after 2.41 seconds
[0m17:51:02.578485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff048be72c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff047d81250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff048e38bf0>]}
[0m17:51:02.578980 [debug] [MainThread]: Flushing usage events
[0m17:51:03.463790 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:51:19.581028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75207c23e1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75207c9221b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75207c9e23c0>]}


============================== 17:51:19.584360 | ffc99b27-10fd-40f1-9ed3-d9f25e24bb43 ==============================
[0m17:51:19.584360 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:51:19.585065 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'cache_selected_only': 'False', 'no_print': 'None', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'target_path': 'None', 'use_colors': 'True', 'profiles_dir': '.', 'log_cache_events': 'False', 'warn_error': 'None', 'debug': 'False', 'write_json': 'True', 'static_parser': 'True', 'fail_fast': 'False', 'empty': 'False', 'partial_parse': 'True', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "470505a0-063e-4bb0-a1f9-e2c95c026cfd", "ai_explanation": "Based on PCA factors, this transaction exhibits significant deviation from normal patterns, indicating fraudulent activity."} --profiles-dir .', 'printer_width': '80', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'use_experimental_parser': 'False'}
[0m17:51:19.833244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ffc99b27-10fd-40f1-9ed3-d9f25e24bb43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75207b9dfd70>]}
[0m17:51:19.903754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ffc99b27-10fd-40f1-9ed3-d9f25e24bb43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75207bc82870>]}
[0m17:51:19.905482 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:51:20.000493 [debug] [MainThread]: checksum: a2210db07e6c9c311ad28d8c879f1a532da927a5c0af69f86dd14761d054363c, vars: {'ai_explanation': 'Based on PCA factors, this transaction exhibits '
                   'significant deviation from normal patterns, indicating '
                   'fraudulent activity.',
 'txn_id': '470505a0-063e-4bb0-a1f9-e2c95c026cfd'}, profile: , target: , version: 1.11.2
[0m17:51:20.103299 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:51:20.103893 [debug] [MainThread]: previous checksum: a2210db07e6c9c311ad28d8c879f1a532da927a5c0af69f86dd14761d054363c, current checksum: 7281099682133c2bf1a47a4aa64ad86e7050c71ce524a4fe26f441f52a3860c6
[0m17:51:20.104395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ffc99b27-10fd-40f1-9ed3-d9f25e24bb43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75207c23e9c0>]}
[0m17:51:21.362828 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m17:51:21.363509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ffc99b27-10fd-40f1-9ed3-d9f25e24bb43', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75206fc57bc0>]}
[0m17:51:21.454976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ffc99b27-10fd-40f1-9ed3-d9f25e24bb43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75206dbfb830>]}
[0m17:51:21.524126 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:51:21.525806 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:51:21.537981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ffc99b27-10fd-40f1-9ed3-d9f25e24bb43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75206dbfad20>]}
[0m17:51:21.538516 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m17:51:21.539000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ffc99b27-10fd-40f1-9ed3-d9f25e24bb43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751fff9ba540>]}
[0m17:51:21.540728 [info ] [MainThread]: 
[0m17:51:21.541231 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:51:21.541669 [info ] [MainThread]: 
[0m17:51:21.542294 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:51:21.543339 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m17:51:21.578665 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m17:51:21.579179 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m17:51:21.579599 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:51:21.665379 [debug] [ThreadPool]: SQL status: OK in 0.086 seconds
[0m17:51:21.667010 [debug] [ThreadPool]: On list_argus_vault: Close
[0m17:51:21.667838 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m17:51:21.668432 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m17:51:21.675614 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:51:21.676098 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m17:51:21.676510 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:51:21.677890 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:51:21.679407 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:51:21.679839 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m17:51:21.680447 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:51:21.680862 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:51:21.681295 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m17:51:21.681991 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:51:21.682892 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:51:21.683353 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:51:21.683755 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:51:21.684356 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:51:21.684783 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m17:51:21.691592 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m17:51:21.697849 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:51:21.698451 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m17:51:21.698866 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:51:21.700023 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:51:21.700474 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:51:21.700942 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m17:51:21.712110 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m17:51:21.713756 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m17:51:21.715101 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m17:51:21.715556 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m17:51:21.717202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ffc99b27-10fd-40f1-9ed3-d9f25e24bb43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751fff81b560>]}
[0m17:51:21.717851 [debug] [MainThread]: Using duckdb connection "master"
[0m17:51:21.718324 [debug] [MainThread]: On master: BEGIN
[0m17:51:21.718723 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:51:21.720042 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:51:21.720484 [debug] [MainThread]: On master: COMMIT
[0m17:51:21.720902 [debug] [MainThread]: Using duckdb connection "master"
[0m17:51:21.721357 [debug] [MainThread]: On master: COMMIT
[0m17:51:21.721977 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:51:21.722420 [debug] [MainThread]: On master: Close
[0m17:51:21.724466 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:51:21.725156 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m17:51:21.725739 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m17:51:21.726261 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m17:51:21.735066 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:51:21.735809 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m17:51:21.791997 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:51:21.792580 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201175121767735"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Based on PCA factors, this transaction exhibits significant deviation from normal patterns, indicating fraudulent activity.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '470505a0-063e-4bb0-a1f9-e2c95c026cfd'
    );
  
  
  
[0m17:51:21.793089 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:51:21.801634 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m17:51:21.809252 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:51:21.809772 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m17:51:21.810466 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:51:21.810964 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:51:21.811433 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201175121767735'
      
      
      order by ordinal_position

  
[0m17:51:21.814846 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:51:21.819875 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:51:21.820407 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:51:21.822935 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:51:21.833008 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:51:21.833527 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:51:21.835906 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:51:21.837426 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:51:21.837949 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m17:51:21.838737 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:51:21.855008 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:51:21.855762 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:51:21.856279 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201175121767735"
    )
  
[0m17:51:21.857452 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:51:21.867711 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:51:21.868241 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:51:21.868701 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:51:21.881833 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m17:51:21.883811 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m17:51:21.885544 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ffc99b27-10fd-40f1-9ed3-d9f25e24bb43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75206fb9d1f0>]}
[0m17:51:21.886316 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m17:51:21.887063 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:51:21.888524 [debug] [MainThread]: Using duckdb connection "master"
[0m17:51:21.889105 [debug] [MainThread]: On master: BEGIN
[0m17:51:21.889577 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:51:21.890497 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:51:21.890954 [debug] [MainThread]: On master: COMMIT
[0m17:51:21.891375 [debug] [MainThread]: Using duckdb connection "master"
[0m17:51:21.891775 [debug] [MainThread]: On master: COMMIT
[0m17:51:21.892436 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:51:21.892875 [debug] [MainThread]: On master: Close
[0m17:51:21.893400 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:51:21.893798 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m17:51:21.894243 [info ] [MainThread]: 
[0m17:51:21.894687 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m17:51:21.895471 [debug] [MainThread]: Command end result
[0m17:51:21.914440 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:51:21.916068 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:51:21.921664 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m17:51:21.922127 [info ] [MainThread]: 
[0m17:51:21.922654 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:51:21.923117 [info ] [MainThread]: 
[0m17:51:21.923588 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:51:21.924246 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:51:21.925310 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.4074328, "process_in_blocks": "0", "process_kernel_time": 0.316103, "process_mem_max_rss": "275588", "process_out_blocks": "3112", "process_user_time": 4.335276}
[0m17:51:21.925890 [debug] [MainThread]: Command `dbt run` succeeded at 17:51:21.925788 after 2.41 seconds
[0m17:51:21.926389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75207bbec290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751ffee92180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75207c445a00>]}
[0m17:51:21.926862 [debug] [MainThread]: Flushing usage events
[0m17:51:22.815827 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:51:38.287276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db7291d2390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db728c24e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db7291d1850>]}


============================== 17:51:38.290759 | 9c6d4166-e20f-4445-975e-e3b05c635bdf ==============================
[0m17:51:38.290759 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:51:38.291519 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'profiles_dir': '.', 'log_cache_events': 'False', 'version_check': 'True', 'log_format': 'default', 'static_parser': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'partial_parse': 'True', 'use_colors': 'True', 'fail_fast': 'False', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'printer_width': '80', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "d567f608-e75f-47c9-8a3a-0f7ce84d0e5f", "ai_explanation": "Transaction flagged for fraud due to significant PCA factor deviations (-10.5)."} --profiles-dir .', 'quiet': 'False', 'no_print': 'None', 'debug': 'False', 'empty': 'False', 'indirect_selection': 'eager', 'warn_error': 'None', 'target_path': 'None'}
[0m17:51:38.553328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c6d4166-e20f-4445-975e-e3b05c635bdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db728299970>]}
[0m17:51:38.646109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9c6d4166-e20f-4445-975e-e3b05c635bdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db7291d1850>]}
[0m17:51:38.647965 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:51:38.733544 [debug] [MainThread]: checksum: d0a4090ad659739e592a7f76e87b2beeed9bca81500bd1345fe2b17dee8be257, vars: {'ai_explanation': 'Transaction flagged for fraud due to significant PCA '
                   'factor deviations (-10.5).',
 'txn_id': 'd567f608-e75f-47c9-8a3a-0f7ce84d0e5f'}, profile: , target: , version: 1.11.2
[0m17:51:38.828584 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:51:38.829204 [debug] [MainThread]: previous checksum: d0a4090ad659739e592a7f76e87b2beeed9bca81500bd1345fe2b17dee8be257, current checksum: a2210db07e6c9c311ad28d8c879f1a532da927a5c0af69f86dd14761d054363c
[0m17:51:38.829649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9c6d4166-e20f-4445-975e-e3b05c635bdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db728afa900>]}
[0m17:51:40.074241 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m17:51:40.074950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9c6d4166-e20f-4445-975e-e3b05c635bdf', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db71c169160>]}
[0m17:51:40.173071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9c6d4166-e20f-4445-975e-e3b05c635bdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db71c38f5f0>]}
[0m17:51:40.243635 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:51:40.245410 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:51:40.257726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9c6d4166-e20f-4445-975e-e3b05c635bdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db710227e90>]}
[0m17:51:40.258312 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m17:51:40.258775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c6d4166-e20f-4445-975e-e3b05c635bdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db7103bbf80>]}
[0m17:51:40.260519 [info ] [MainThread]: 
[0m17:51:40.261030 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:51:40.261464 [info ] [MainThread]: 
[0m17:51:40.262105 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:51:40.263130 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m17:51:40.299657 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m17:51:40.300239 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m17:51:40.300748 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:51:40.395325 [debug] [ThreadPool]: SQL status: OK in 0.094 seconds
[0m17:51:40.397036 [debug] [ThreadPool]: On list_argus_vault: Close
[0m17:51:40.397876 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m17:51:40.398550 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m17:51:40.405898 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:51:40.406383 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m17:51:40.406798 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:51:40.407994 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:51:40.409312 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:51:40.409742 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m17:51:40.410371 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:51:40.410787 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:51:40.411216 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m17:51:40.411834 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:51:40.412765 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:51:40.413221 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:51:40.413631 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:51:40.414312 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:51:40.414739 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m17:51:40.420316 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m17:51:40.425959 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:51:40.426509 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m17:51:40.427038 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:51:40.427953 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:51:40.428388 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:51:40.428829 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m17:51:40.439783 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m17:51:40.441259 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m17:51:40.442538 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m17:51:40.442995 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m17:51:40.445135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c6d4166-e20f-4445-975e-e3b05c635bdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db7103ba990>]}
[0m17:51:40.445734 [debug] [MainThread]: Using duckdb connection "master"
[0m17:51:40.446207 [debug] [MainThread]: On master: BEGIN
[0m17:51:40.446636 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:51:40.447503 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:51:40.447968 [debug] [MainThread]: On master: COMMIT
[0m17:51:40.448409 [debug] [MainThread]: Using duckdb connection "master"
[0m17:51:40.448828 [debug] [MainThread]: On master: COMMIT
[0m17:51:40.449484 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:51:40.449957 [debug] [MainThread]: On master: Close
[0m17:51:40.452068 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:51:40.452701 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m17:51:40.453289 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m17:51:40.453768 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m17:51:40.462114 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:51:40.462828 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m17:51:40.519863 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:51:40.520477 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201175140495204"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Transaction flagged for fraud due to significant PCA factor deviations (-10.5).' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = 'd567f608-e75f-47c9-8a3a-0f7ce84d0e5f'
    );
  
  
  
[0m17:51:40.520983 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:51:40.530086 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m17:51:40.537834 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:51:40.538363 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m17:51:40.539049 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:51:40.539521 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:51:40.540005 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201175140495204'
      
      
      order by ordinal_position

  
[0m17:51:40.542694 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:51:40.547668 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:51:40.548205 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:51:40.550650 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:51:40.560732 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:51:40.561263 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:51:40.564150 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:51:40.565666 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:51:40.566176 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m17:51:40.567217 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:51:40.583493 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:51:40.584266 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:51:40.584748 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201175140495204"
    )
  
[0m17:51:40.585928 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:51:40.596342 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:51:40.596850 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:51:40.597357 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:51:40.611560 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m17:51:40.613570 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m17:51:40.615311 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c6d4166-e20f-4445-975e-e3b05c635bdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db7291fbfb0>]}
[0m17:51:40.616086 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m17:51:40.616786 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:51:40.618610 [debug] [MainThread]: Using duckdb connection "master"
[0m17:51:40.619335 [debug] [MainThread]: On master: BEGIN
[0m17:51:40.619942 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:51:40.621174 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:51:40.621935 [debug] [MainThread]: On master: COMMIT
[0m17:51:40.622632 [debug] [MainThread]: Using duckdb connection "master"
[0m17:51:40.623072 [debug] [MainThread]: On master: COMMIT
[0m17:51:40.623675 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:51:40.624132 [debug] [MainThread]: On master: Close
[0m17:51:40.624622 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:51:40.625049 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m17:51:40.625470 [info ] [MainThread]: 
[0m17:51:40.625932 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m17:51:40.626701 [debug] [MainThread]: Command end result
[0m17:51:40.646838 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:51:40.648534 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:51:40.654287 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m17:51:40.654722 [info ] [MainThread]: 
[0m17:51:40.655256 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:51:40.655696 [info ] [MainThread]: 
[0m17:51:40.656180 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:51:40.656793 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:51:40.657854 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.4339762, "process_in_blocks": "0", "process_kernel_time": 0.311865, "process_mem_max_rss": "274956", "process_out_blocks": "3120", "process_user_time": 4.358194}
[0m17:51:40.658460 [debug] [MainThread]: Command `dbt run` succeeded at 17:51:40.658357 after 2.43 seconds
[0m17:51:40.658949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db728dc0440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db728f300b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db72b040890>]}
[0m17:51:40.659433 [debug] [MainThread]: Flushing usage events
[0m17:51:41.687256 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:51:57.811307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7921a87ed3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7921a9c45730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7921a84a2870>]}


============================== 17:51:57.814717 | 7f1b6ed0-3457-407e-ac10-c1e3184ff938 ==============================
[0m17:51:57.814717 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:51:57.815449 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'partial_parse': 'True', 'log_cache_events': 'False', 'write_json': 'True', 'use_experimental_parser': 'False', 'target_path': 'None', 'cache_selected_only': 'False', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'no_print': 'None', 'static_parser': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'introspect': 'True', 'profiles_dir': '.', 'version_check': 'True', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "e2151f04-5fa3-4eaf-948b-66bb3e3e7cc4", "ai_explanation": "Based on PCA factors, this transaction exhibits significant anomalies in V6 and V10, indicating fraud."} --profiles-dir .', 'printer_width': '80', 'warn_error': 'None', 'quiet': 'False', 'debug': 'False', 'empty': 'False', 'use_colors': 'True'}
[0m17:51:58.063337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f1b6ed0-3457-407e-ac10-c1e3184ff938', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7921a7bbb2c0>]}
[0m17:51:58.134191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7f1b6ed0-3457-407e-ac10-c1e3184ff938', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7921a87ec620>]}
[0m17:51:58.136018 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:51:58.222097 [debug] [MainThread]: checksum: b4a6c452629f0130fbc29d9c71923f605eca82bffb609332562dfca25f0fb536, vars: {'ai_explanation': 'Based on PCA factors, this transaction exhibits '
                   'significant anomalies in V6 and V10, indicating fraud.',
 'txn_id': 'e2151f04-5fa3-4eaf-948b-66bb3e3e7cc4'}, profile: , target: , version: 1.11.2
[0m17:51:58.315763 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:51:58.316413 [debug] [MainThread]: previous checksum: b4a6c452629f0130fbc29d9c71923f605eca82bffb609332562dfca25f0fb536, current checksum: d0a4090ad659739e592a7f76e87b2beeed9bca81500bd1345fe2b17dee8be257
[0m17:51:58.316907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7f1b6ed0-3457-407e-ac10-c1e3184ff938', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79219bfbac30>]}
[0m17:51:59.546310 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m17:51:59.547001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7f1b6ed0-3457-407e-ac10-c1e3184ff938', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79219c0ac1a0>]}
[0m17:51:59.638990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7f1b6ed0-3457-407e-ac10-c1e3184ff938', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7921981df620>]}
[0m17:51:59.708935 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:51:59.710642 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:51:59.722845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7f1b6ed0-3457-407e-ac10-c1e3184ff938', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792147b1e720>]}
[0m17:51:59.723416 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m17:51:59.723878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f1b6ed0-3457-407e-ac10-c1e3184ff938', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79219bf5fb00>]}
[0m17:51:59.725644 [info ] [MainThread]: 
[0m17:51:59.726149 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:51:59.726593 [info ] [MainThread]: 
[0m17:51:59.727205 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:51:59.728183 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m17:51:59.763418 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m17:51:59.763927 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m17:51:59.764373 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:51:59.849973 [debug] [ThreadPool]: SQL status: OK in 0.085 seconds
[0m17:51:59.851675 [debug] [ThreadPool]: On list_argus_vault: Close
[0m17:51:59.852578 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m17:51:59.853206 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m17:51:59.860602 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:51:59.861119 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m17:51:59.861573 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:51:59.862759 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:51:59.864110 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:51:59.864572 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m17:51:59.865243 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:51:59.865691 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:51:59.866165 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m17:51:59.867082 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:51:59.868043 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:51:59.868510 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:51:59.868971 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:51:59.869676 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:51:59.870168 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m17:51:59.875693 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m17:51:59.881367 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:51:59.881949 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m17:51:59.882394 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:51:59.883591 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:51:59.884075 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:51:59.884531 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m17:51:59.895655 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m17:51:59.897157 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m17:51:59.898450 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m17:51:59.898953 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m17:51:59.900655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f1b6ed0-3457-407e-ac10-c1e3184ff938', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792146f17950>]}
[0m17:51:59.901307 [debug] [MainThread]: Using duckdb connection "master"
[0m17:51:59.901724 [debug] [MainThread]: On master: BEGIN
[0m17:51:59.902146 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:51:59.903050 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:51:59.903487 [debug] [MainThread]: On master: COMMIT
[0m17:51:59.903893 [debug] [MainThread]: Using duckdb connection "master"
[0m17:51:59.904319 [debug] [MainThread]: On master: COMMIT
[0m17:51:59.904903 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:51:59.905353 [debug] [MainThread]: On master: Close
[0m17:51:59.907382 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:51:59.908069 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m17:51:59.908675 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m17:51:59.909230 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m17:51:59.917297 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:51:59.918109 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m17:51:59.974327 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:51:59.974931 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201175159950086"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Based on PCA factors, this transaction exhibits significant anomalies in V6 and V10, indicating fraud.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = 'e2151f04-5fa3-4eaf-948b-66bb3e3e7cc4'
    );
  
  
  
[0m17:51:59.975463 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:51:59.983757 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m17:51:59.991367 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:51:59.991924 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m17:51:59.992639 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:51:59.993172 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:51:59.993683 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201175159950086'
      
      
      order by ordinal_position

  
[0m17:51:59.996587 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:52:00.001567 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:52:00.002144 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:52:00.005312 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:52:00.015459 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:52:00.016051 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:52:00.018479 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:52:00.020041 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:52:00.020587 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m17:52:00.021407 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:52:00.037847 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:52:00.038728 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:52:00.039284 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201175159950086"
    )
  
[0m17:52:00.040486 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:52:00.050815 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:52:00.051381 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:52:00.051887 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:52:00.065234 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m17:52:00.067223 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m17:52:00.068961 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f1b6ed0-3457-407e-ac10-c1e3184ff938', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79219bd5d340>]}
[0m17:52:00.069747 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m17:52:00.070523 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:52:00.072162 [debug] [MainThread]: Using duckdb connection "master"
[0m17:52:00.072668 [debug] [MainThread]: On master: BEGIN
[0m17:52:00.073160 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:52:00.074198 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:52:00.074630 [debug] [MainThread]: On master: COMMIT
[0m17:52:00.075061 [debug] [MainThread]: Using duckdb connection "master"
[0m17:52:00.075451 [debug] [MainThread]: On master: COMMIT
[0m17:52:00.076072 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:52:00.076495 [debug] [MainThread]: On master: Close
[0m17:52:00.076992 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:52:00.077383 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m17:52:00.077790 [info ] [MainThread]: 
[0m17:52:00.078252 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m17:52:00.079015 [debug] [MainThread]: Command end result
[0m17:52:00.097606 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:52:00.099235 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:52:00.104729 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m17:52:00.105178 [info ] [MainThread]: 
[0m17:52:00.105685 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:52:00.106137 [info ] [MainThread]: 
[0m17:52:00.106592 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:52:00.107222 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:52:00.108259 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3596706, "process_in_blocks": "0", "process_kernel_time": 0.283312, "process_mem_max_rss": "277004", "process_out_blocks": "3112", "process_user_time": 4.322998}
[0m17:52:00.108844 [debug] [MainThread]: Command `dbt run` succeeded at 17:52:00.108741 after 2.36 seconds
[0m17:52:00.109343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7921a86ded20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792147b3bf80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79219bd68da0>]}
[0m17:52:00.109820 [debug] [MainThread]: Flushing usage events
[0m17:52:00.991701 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:52:16.933102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa996d4f560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa9996a52b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa99661ff50>]}


============================== 17:52:16.936544 | f7c58b2e-8f22-4e3a-a79b-9ffdd9bc7560 ==============================
[0m17:52:16.936544 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:52:16.937277 [debug] [MainThread]: running dbt with arguments {'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'debug': 'False', 'introspect': 'True', 'empty': 'False', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "1367b190-4823-4b0a-85d8-3046fa20d2f5", "ai_explanation": "Fraudulent transaction: PCA factor V3 (-7.423) indicates significant outlier, suggesting manipulation."} --profiles-dir .', 'target_path': 'None', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'quiet': 'False', 'warn_error': 'None', 'no_print': 'None', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'log_cache_events': 'False', 'log_format': 'default', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'fail_fast': 'False', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'use_colors': 'True', 'profiles_dir': '.'}
[0m17:52:17.187760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f7c58b2e-8f22-4e3a-a79b-9ffdd9bc7560', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa9963cb7a0>]}
[0m17:52:17.259718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f7c58b2e-8f22-4e3a-a79b-9ffdd9bc7560', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa9964e6990>]}
[0m17:52:17.261609 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:52:17.346207 [debug] [MainThread]: checksum: 99f39a9a897708adfe564a15e533758dd5a9f4abad5396c010e942ecccec3f63, vars: {'ai_explanation': 'Fraudulent transaction: PCA factor V3 (-7.423) indicates '
                   'significant outlier, suggesting manipulation.',
 'txn_id': '1367b190-4823-4b0a-85d8-3046fa20d2f5'}, profile: , target: , version: 1.11.2
[0m17:52:17.439321 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:52:17.439959 [debug] [MainThread]: previous checksum: 99f39a9a897708adfe564a15e533758dd5a9f4abad5396c010e942ecccec3f63, current checksum: b4a6c452629f0130fbc29d9c71923f605eca82bffb609332562dfca25f0fb536
[0m17:52:17.440492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f7c58b2e-8f22-4e3a-a79b-9ffdd9bc7560', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa996d4ea20>]}
[0m17:52:18.665486 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m17:52:18.666223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f7c58b2e-8f22-4e3a-a79b-9ffdd9bc7560', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa988102660>]}
[0m17:52:18.759686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f7c58b2e-8f22-4e3a-a79b-9ffdd9bc7560', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa98a55a900>]}
[0m17:52:18.833041 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:52:18.834812 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:52:18.847236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f7c58b2e-8f22-4e3a-a79b-9ffdd9bc7560', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa9881f2660>]}
[0m17:52:18.847802 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m17:52:18.848326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7c58b2e-8f22-4e3a-a79b-9ffdd9bc7560', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa98a535340>]}
[0m17:52:18.850124 [info ] [MainThread]: 
[0m17:52:18.850642 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:52:18.851130 [info ] [MainThread]: 
[0m17:52:18.851773 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:52:18.852878 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m17:52:18.888247 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m17:52:18.888764 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m17:52:18.889264 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:52:18.973495 [debug] [ThreadPool]: SQL status: OK in 0.084 seconds
[0m17:52:18.975141 [debug] [ThreadPool]: On list_argus_vault: Close
[0m17:52:18.975990 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m17:52:18.976558 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m17:52:18.983962 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:52:18.984423 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m17:52:18.984839 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:52:18.986282 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:52:18.987612 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:52:18.988064 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m17:52:18.988928 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:52:18.989359 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:52:18.989760 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m17:52:18.990407 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:52:18.991330 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:52:18.991767 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:52:18.992198 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:52:18.992804 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:52:18.993266 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m17:52:18.999066 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m17:52:19.004873 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:52:19.005431 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m17:52:19.005841 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:52:19.006771 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:52:19.007234 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:52:19.007650 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m17:52:19.018731 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m17:52:19.020171 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m17:52:19.021446 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m17:52:19.021896 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m17:52:19.023569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7c58b2e-8f22-4e3a-a79b-9ffdd9bc7560', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa988128140>]}
[0m17:52:19.024204 [debug] [MainThread]: Using duckdb connection "master"
[0m17:52:19.024629 [debug] [MainThread]: On master: BEGIN
[0m17:52:19.025060 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:52:19.025929 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:52:19.026374 [debug] [MainThread]: On master: COMMIT
[0m17:52:19.026789 [debug] [MainThread]: Using duckdb connection "master"
[0m17:52:19.027216 [debug] [MainThread]: On master: COMMIT
[0m17:52:19.027825 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:52:19.028284 [debug] [MainThread]: On master: Close
[0m17:52:19.030374 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:52:19.031024 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m17:52:19.031588 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m17:52:19.032097 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m17:52:19.040189 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:52:19.040902 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m17:52:19.098455 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:52:19.099052 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201175219073810"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Fraudulent transaction: PCA factor V3 (-7.423) indicates significant outlier, suggesting manipulation.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '1367b190-4823-4b0a-85d8-3046fa20d2f5'
    );
  
  
  
[0m17:52:19.099549 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:52:19.107612 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m17:52:19.115187 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:52:19.115690 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m17:52:19.116376 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:52:19.116848 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:52:19.117336 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201175219073810'
      
      
      order by ordinal_position

  
[0m17:52:19.119829 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:52:19.124742 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:52:19.125269 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:52:19.128019 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:52:19.138070 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:52:19.138586 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:52:19.141102 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:52:19.142608 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:52:19.143128 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m17:52:19.143871 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:52:19.160350 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:52:19.161127 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:52:19.161625 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201175219073810"
    )
  
[0m17:52:19.162812 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:52:19.173249 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:52:19.173760 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:52:19.174251 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:52:19.188335 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m17:52:19.190293 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m17:52:19.192014 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7c58b2e-8f22-4e3a-a79b-9ffdd9bc7560', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa99743be90>]}
[0m17:52:19.192766 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m17:52:19.193499 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:52:19.195024 [debug] [MainThread]: Using duckdb connection "master"
[0m17:52:19.195545 [debug] [MainThread]: On master: BEGIN
[0m17:52:19.196055 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:52:19.197084 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:52:19.197596 [debug] [MainThread]: On master: COMMIT
[0m17:52:19.198083 [debug] [MainThread]: Using duckdb connection "master"
[0m17:52:19.198522 [debug] [MainThread]: On master: COMMIT
[0m17:52:19.199201 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:52:19.199670 [debug] [MainThread]: On master: Close
[0m17:52:19.200227 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:52:19.200653 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m17:52:19.201238 [info ] [MainThread]: 
[0m17:52:19.201945 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m17:52:19.202726 [debug] [MainThread]: Command end result
[0m17:52:19.221875 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:52:19.223513 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:52:19.229203 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m17:52:19.229641 [info ] [MainThread]: 
[0m17:52:19.230176 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:52:19.230621 [info ] [MainThread]: 
[0m17:52:19.231107 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:52:19.231765 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:52:19.232809 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3628695, "process_in_blocks": "0", "process_kernel_time": 0.311706, "process_mem_max_rss": "271100", "process_out_blocks": "3120", "process_user_time": 4.305505}
[0m17:52:19.233415 [debug] [MainThread]: Command `dbt run` succeeded at 17:52:19.233314 after 2.36 seconds
[0m17:52:19.233881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa996830770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa996833170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa94a3308c0>]}
[0m17:52:19.234379 [debug] [MainThread]: Flushing usage events
[0m17:52:20.203836 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:52:35.562089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef4c8a4af60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef4caa6dee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef4c8a48350>]}


============================== 17:52:35.565453 | cbb7422b-770e-4424-992a-ada9f373b3e3 ==============================
[0m17:52:35.565453 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:52:35.566134 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "0bd557f1-e12b-4db7-b332-f68d45c2ec54", "ai_explanation": "Unusually high PCA values indicate fraudulent transaction, likely a Ponzi scheme."} --profiles-dir .', 'empty': 'False', 'debug': 'False', 'introspect': 'True', 'static_parser': 'True', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'printer_width': '80', 'target_path': 'None', 'no_print': 'None', 'use_colors': 'True', 'profiles_dir': '.', 'log_format': 'default', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'log_cache_events': 'False', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'write_json': 'True', 'warn_error': 'None'}
[0m17:52:35.812646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cbb7422b-770e-4424-992a-ada9f373b3e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef4c7c03020>]}
[0m17:52:35.884284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cbb7422b-770e-4424-992a-ada9f373b3e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef4c7abe1b0>]}
[0m17:52:35.885992 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:52:35.970793 [debug] [MainThread]: checksum: 53b9da09b52563383a44ad54c3cb4e1355daddf3b327fe2e0ceb8de6e3c94671, vars: {'ai_explanation': 'Unusually high PCA values indicate fraudulent transaction, '
                   'likely a Ponzi scheme.',
 'txn_id': '0bd557f1-e12b-4db7-b332-f68d45c2ec54'}, profile: , target: , version: 1.11.2
[0m17:52:36.063539 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:52:36.064150 [debug] [MainThread]: previous checksum: 53b9da09b52563383a44ad54c3cb4e1355daddf3b327fe2e0ceb8de6e3c94671, current checksum: 99f39a9a897708adfe564a15e533758dd5a9f4abad5396c010e942ecccec3f63
[0m17:52:36.064602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cbb7422b-770e-4424-992a-ada9f373b3e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef4c8356ab0>]}
[0m17:52:37.312342 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m17:52:37.313069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cbb7422b-770e-4424-992a-ada9f373b3e3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef4c7b27d10>]}
[0m17:52:37.405371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cbb7422b-770e-4424-992a-ada9f373b3e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef4b81c33e0>]}
[0m17:52:37.477896 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:52:37.479621 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:52:37.491880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cbb7422b-770e-4424-992a-ada9f373b3e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef4539329f0>]}
[0m17:52:37.492448 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m17:52:37.492972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cbb7422b-770e-4424-992a-ada9f373b3e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef4b81c0f20>]}
[0m17:52:37.494707 [info ] [MainThread]: 
[0m17:52:37.495242 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:52:37.495704 [info ] [MainThread]: 
[0m17:52:37.496349 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:52:37.497344 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m17:52:37.532324 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m17:52:37.532843 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m17:52:37.533316 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:52:37.618121 [debug] [ThreadPool]: SQL status: OK in 0.085 seconds
[0m17:52:37.619787 [debug] [ThreadPool]: On list_argus_vault: Close
[0m17:52:37.620691 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m17:52:37.621307 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m17:52:37.628643 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:52:37.629129 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m17:52:37.629548 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:52:37.630715 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:52:37.632035 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:52:37.632464 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m17:52:37.633137 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:52:37.633563 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:52:37.633985 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m17:52:37.634706 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:52:37.635636 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:52:37.636096 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:52:37.636504 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:52:37.637186 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:52:37.637624 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m17:52:37.643358 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m17:52:37.648944 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:52:37.649484 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m17:52:37.649888 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:52:37.650801 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:52:37.651258 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:52:37.651672 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m17:52:37.662777 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m17:52:37.664218 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m17:52:37.665497 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m17:52:37.665956 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m17:52:37.667632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cbb7422b-770e-4424-992a-ada9f373b3e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef4b81230b0>]}
[0m17:52:37.668304 [debug] [MainThread]: Using duckdb connection "master"
[0m17:52:37.668733 [debug] [MainThread]: On master: BEGIN
[0m17:52:37.669160 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:52:37.670335 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:52:37.670779 [debug] [MainThread]: On master: COMMIT
[0m17:52:37.671227 [debug] [MainThread]: Using duckdb connection "master"
[0m17:52:37.671627 [debug] [MainThread]: On master: COMMIT
[0m17:52:37.672247 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:52:37.672677 [debug] [MainThread]: On master: Close
[0m17:52:37.674742 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:52:37.675477 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m17:52:37.676119 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m17:52:37.676603 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m17:52:37.684574 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:52:37.685309 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m17:52:37.741559 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:52:37.742130 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201175237717228"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Unusually high PCA values indicate fraudulent transaction, likely a Ponzi scheme.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '0bd557f1-e12b-4db7-b332-f68d45c2ec54'
    );
  
  
  
[0m17:52:37.742615 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:52:37.750888 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m17:52:37.758429 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:52:37.758948 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m17:52:37.759618 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:52:37.760118 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:52:37.760581 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201175237717228'
      
      
      order by ordinal_position

  
[0m17:52:37.763412 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:52:37.768499 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:52:37.769042 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:52:37.771534 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:52:37.781870 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:52:37.782431 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:52:37.785274 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:52:37.786798 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:52:37.787321 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m17:52:37.788110 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:52:37.804416 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:52:37.805212 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:52:37.805705 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201175237717228"
    )
  
[0m17:52:37.806848 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:52:37.817161 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:52:37.817673 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:52:37.818152 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:52:37.832096 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m17:52:37.834114 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m17:52:37.835844 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbb7422b-770e-4424-992a-ada9f373b3e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef4c8a708f0>]}
[0m17:52:37.836630 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m17:52:37.837371 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:52:37.838726 [debug] [MainThread]: Using duckdb connection "master"
[0m17:52:37.839266 [debug] [MainThread]: On master: BEGIN
[0m17:52:37.839705 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:52:37.840983 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:52:37.841421 [debug] [MainThread]: On master: COMMIT
[0m17:52:37.841823 [debug] [MainThread]: Using duckdb connection "master"
[0m17:52:37.842242 [debug] [MainThread]: On master: COMMIT
[0m17:52:37.842942 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:52:37.843378 [debug] [MainThread]: On master: Close
[0m17:52:37.843856 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:52:37.844275 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m17:52:37.844687 [info ] [MainThread]: 
[0m17:52:37.845176 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m17:52:37.845976 [debug] [MainThread]: Command end result
[0m17:52:37.865346 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:52:37.866994 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:52:37.872639 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m17:52:37.873091 [info ] [MainThread]: 
[0m17:52:37.873645 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:52:37.874134 [info ] [MainThread]: 
[0m17:52:37.874630 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:52:37.875290 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:52:37.876367 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.376921, "process_in_blocks": "0", "process_kernel_time": 0.298138, "process_mem_max_rss": "282196", "process_out_blocks": "3112", "process_user_time": 4.321523}
[0m17:52:37.876970 [debug] [MainThread]: Command `dbt run` succeeded at 17:52:37.876844 after 2.38 seconds
[0m17:52:37.877456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef4c7e3a0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef4bbbe0080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef4bbbe0920>]}
[0m17:52:37.877953 [debug] [MainThread]: Flushing usage events
[0m17:52:38.761168 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:52:53.896600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e13021d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e130d07a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e12dfc380>]}


============================== 17:52:53.900049 | 0901ec80-e103-4296-9ab4-6b72cc6c344d ==============================
[0m17:52:53.900049 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:52:53.900736 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'write_json': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'quiet': 'False', 'debug': 'False', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'fail_fast': 'False', 'static_parser': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'use_colors': 'True', 'introspect': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'version_check': 'True', 'printer_width': '80', 'warn_error': 'None', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "975cfef5-380f-43d9-853f-27b39d1beb1b", "ai_explanation": "Based on PCA factors, this transaction exhibits unusual patterns, indicating fraud."} --profiles-dir .', 'empty': 'False', 'profiles_dir': '.'}
[0m17:52:54.146227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0901ec80-e103-4296-9ab4-6b72cc6c344d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e125bab10>]}
[0m17:52:54.217305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0901ec80-e103-4296-9ab4-6b72cc6c344d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e12766bd0>]}
[0m17:52:54.219082 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:52:54.304277 [debug] [MainThread]: checksum: a179d8a2a1bfcf558b50d608065303d473b17bd775f699bb137538d977950b10, vars: {'ai_explanation': 'Based on PCA factors, this transaction exhibits unusual '
                   'patterns, indicating fraud.',
 'txn_id': '975cfef5-380f-43d9-853f-27b39d1beb1b'}, profile: , target: , version: 1.11.2
[0m17:52:54.396963 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:52:54.397559 [debug] [MainThread]: previous checksum: a179d8a2a1bfcf558b50d608065303d473b17bd775f699bb137538d977950b10, current checksum: 53b9da09b52563383a44ad54c3cb4e1355daddf3b327fe2e0ceb8de6e3c94671
[0m17:52:54.398039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0901ec80-e103-4296-9ab4-6b72cc6c344d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e12e52900>]}
[0m17:52:55.635975 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m17:52:55.636669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0901ec80-e103-4296-9ab4-6b72cc6c344d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e12623290>]}
[0m17:52:55.729831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0901ec80-e103-4296-9ab4-6b72cc6c344d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dc2503320>]}
[0m17:52:55.800856 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:52:55.802640 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:52:55.815091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0901ec80-e103-4296-9ab4-6b72cc6c344d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e0479e750>]}
[0m17:52:55.815668 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m17:52:55.816169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0901ec80-e103-4296-9ab4-6b72cc6c344d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dc25ea660>]}
[0m17:52:55.817932 [info ] [MainThread]: 
[0m17:52:55.818435 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:52:55.818862 [info ] [MainThread]: 
[0m17:52:55.819490 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:52:55.820472 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m17:52:55.855943 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m17:52:55.856451 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m17:52:55.856904 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:52:55.945620 [debug] [ThreadPool]: SQL status: OK in 0.089 seconds
[0m17:52:55.947307 [debug] [ThreadPool]: On list_argus_vault: Close
[0m17:52:55.948189 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m17:52:55.948768 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m17:52:55.956071 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:52:55.956535 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m17:52:55.956977 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:52:55.958147 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:52:55.959692 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:52:55.960176 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m17:52:55.960804 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:52:55.961282 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:52:55.961726 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m17:52:55.962398 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:52:55.963350 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:52:55.963820 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:52:55.964279 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:52:55.964992 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:52:55.965455 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m17:52:55.970957 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m17:52:55.976510 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:52:55.977091 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m17:52:55.977529 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:52:55.978433 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:52:55.978898 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:52:55.979389 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m17:52:55.990392 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m17:52:55.991853 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m17:52:55.993171 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m17:52:55.993640 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m17:52:55.995386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0901ec80-e103-4296-9ab4-6b72cc6c344d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dc25c3bf0>]}
[0m17:52:55.996045 [debug] [MainThread]: Using duckdb connection "master"
[0m17:52:55.996510 [debug] [MainThread]: On master: BEGIN
[0m17:52:55.996940 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:52:55.997800 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:52:55.998264 [debug] [MainThread]: On master: COMMIT
[0m17:52:55.998675 [debug] [MainThread]: Using duckdb connection "master"
[0m17:52:55.999095 [debug] [MainThread]: On master: COMMIT
[0m17:52:55.999690 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:52:56.000170 [debug] [MainThread]: On master: Close
[0m17:52:56.002289 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:52:56.003234 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m17:52:56.003870 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m17:52:56.004419 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m17:52:56.012422 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:52:56.013243 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m17:52:56.069199 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:52:56.069798 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201175256044959"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Based on PCA factors, this transaction exhibits unusual patterns, indicating fraud.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '975cfef5-380f-43d9-853f-27b39d1beb1b'
    );
  
  
  
[0m17:52:56.070351 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:52:56.079039 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m17:52:56.086691 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:52:56.087264 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m17:52:56.088009 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:52:56.088530 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:52:56.089068 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201175256044959'
      
      
      order by ordinal_position

  
[0m17:52:56.091559 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:52:56.096524 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:52:56.097082 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:52:56.099827 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:52:56.109898 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:52:56.110489 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:52:56.113533 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:52:56.115098 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:52:56.115639 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m17:52:56.116494 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:52:56.133059 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:52:56.133936 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:52:56.134489 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201175256044959"
    )
  
[0m17:52:56.135976 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:52:56.146599 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:52:56.147157 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:52:56.147632 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:52:56.162810 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m17:52:56.165056 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m17:52:56.166941 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0901ec80-e103-4296-9ab4-6b72cc6c344d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e06707860>]}
[0m17:52:56.167747 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m17:52:56.168516 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:52:56.170306 [debug] [MainThread]: Using duckdb connection "master"
[0m17:52:56.170851 [debug] [MainThread]: On master: BEGIN
[0m17:52:56.171368 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:52:56.172441 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:52:56.172954 [debug] [MainThread]: On master: COMMIT
[0m17:52:56.173423 [debug] [MainThread]: Using duckdb connection "master"
[0m17:52:56.173867 [debug] [MainThread]: On master: COMMIT
[0m17:52:56.174589 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:52:56.175131 [debug] [MainThread]: On master: Close
[0m17:52:56.175662 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:52:56.176129 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m17:52:56.176603 [info ] [MainThread]: 
[0m17:52:56.177132 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m17:52:56.177968 [debug] [MainThread]: Command end result
[0m17:52:56.198281 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:52:56.200007 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:52:56.205771 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m17:52:56.206246 [info ] [MainThread]: 
[0m17:52:56.206784 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:52:56.207267 [info ] [MainThread]: 
[0m17:52:56.207759 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:52:56.208433 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:52:56.209543 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3755937, "process_in_blocks": "0", "process_kernel_time": 0.292743, "process_mem_max_rss": "277724", "process_out_blocks": "3120", "process_user_time": 4.320691}
[0m17:52:56.210172 [debug] [MainThread]: Command `dbt run` succeeded at 17:52:56.210064 after 2.38 seconds
[0m17:52:56.210665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e12cb21b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e155ba330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e13a7d1c0>]}
[0m17:52:56.211193 [debug] [MainThread]: Flushing usage events
[0m17:52:57.286552 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:53:13.711891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778182022630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778182127110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7781820204d0>]}


============================== 17:53:13.715260 | 16b04160-c3f9-4695-bc3a-88e042796fff ==============================
[0m17:53:13.715260 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:53:13.715968 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'cache_selected_only': 'False', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'partial_parse': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'quiet': 'False', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'static_parser': 'True', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "1bca29da-2cc2-4877-a68a-3bc72af8f6f1", "ai_explanation": "The transaction is flagged as fraud due to anomalous PCA scores (V3, V7, and V17)."} --profiles-dir .', 'introspect': 'True', 'profiles_dir': '.', 'version_check': 'True', 'use_experimental_parser': 'False', 'no_print': 'None'}
[0m17:53:13.964602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '16b04160-c3f9-4695-bc3a-88e042796fff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7781816daa50>]}
[0m17:53:14.035886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '16b04160-c3f9-4695-bc3a-88e042796fff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7781842150a0>]}
[0m17:53:14.037656 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:53:14.123492 [debug] [MainThread]: checksum: 08f315d3d482beeaf9a50cacd7689a0790d6f0236b8d384bb6f044f58652d160, vars: {'ai_explanation': 'The transaction is flagged as fraud due to anomalous PCA '
                   'scores (V3, V7, and V17).',
 'txn_id': '1bca29da-2cc2-4877-a68a-3bc72af8f6f1'}, profile: , target: , version: 1.11.2
[0m17:53:14.216204 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:53:14.216788 [debug] [MainThread]: previous checksum: 08f315d3d482beeaf9a50cacd7689a0790d6f0236b8d384bb6f044f58652d160, current checksum: a179d8a2a1bfcf558b50d608065303d473b17bd775f699bb137538d977950b10
[0m17:53:14.217272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '16b04160-c3f9-4695-bc3a-88e042796fff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778181e52a20>]}
[0m17:53:15.433984 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m17:53:15.434659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '16b04160-c3f9-4695-bc3a-88e042796fff', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778175849a60>]}
[0m17:53:15.526001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '16b04160-c3f9-4695-bc3a-88e042796fff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7781741aad80>]}
[0m17:53:15.597587 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:53:15.599312 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:53:15.611487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '16b04160-c3f9-4695-bc3a-88e042796fff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77817402e7e0>]}
[0m17:53:15.612053 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m17:53:15.612544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16b04160-c3f9-4695-bc3a-88e042796fff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77817400f950>]}
[0m17:53:15.614281 [info ] [MainThread]: 
[0m17:53:15.614782 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:53:15.615250 [info ] [MainThread]: 
[0m17:53:15.615862 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:53:15.616852 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m17:53:15.652479 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m17:53:15.653001 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m17:53:15.653450 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:53:15.738268 [debug] [ThreadPool]: SQL status: OK in 0.085 seconds
[0m17:53:15.740004 [debug] [ThreadPool]: On list_argus_vault: Close
[0m17:53:15.740934 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m17:53:15.741543 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m17:53:15.749097 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:53:15.749570 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m17:53:15.750015 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:53:15.751507 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:53:15.752868 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:53:15.753356 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m17:53:15.754352 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:53:15.754795 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:53:15.755241 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m17:53:15.755878 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:53:15.756841 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:53:15.757307 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:53:15.757754 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:53:15.758401 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:53:15.758838 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m17:53:15.764795 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m17:53:15.771825 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:53:15.772391 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m17:53:15.772795 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:53:15.773751 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:53:15.774215 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:53:15.774635 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m17:53:15.785638 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m17:53:15.787115 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m17:53:15.788394 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m17:53:15.788837 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m17:53:15.790517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16b04160-c3f9-4695-bc3a-88e042796fff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77816150ff80>]}
[0m17:53:15.791159 [debug] [MainThread]: Using duckdb connection "master"
[0m17:53:15.791618 [debug] [MainThread]: On master: BEGIN
[0m17:53:15.792042 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:53:15.792992 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:53:15.793446 [debug] [MainThread]: On master: COMMIT
[0m17:53:15.793872 [debug] [MainThread]: Using duckdb connection "master"
[0m17:53:15.794297 [debug] [MainThread]: On master: COMMIT
[0m17:53:15.794901 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:53:15.795357 [debug] [MainThread]: On master: Close
[0m17:53:15.797354 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:53:15.798014 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m17:53:15.798575 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m17:53:15.799088 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m17:53:15.807279 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:53:15.808014 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m17:53:15.865702 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:53:15.866406 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201175315840433"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'The transaction is flagged as fraud due to anomalous PCA scores (V3, V7, and V17).' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '1bca29da-2cc2-4877-a68a-3bc72af8f6f1'
    );
  
  
  
[0m17:53:15.866961 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:53:15.875583 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m17:53:15.883408 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:53:15.883936 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m17:53:15.884624 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:53:15.885127 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:53:15.885600 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201175315840433'
      
      
      order by ordinal_position

  
[0m17:53:15.888277 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:53:15.893325 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:53:15.893845 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:53:15.897176 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:53:15.907599 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:53:15.908138 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:53:15.910516 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:53:15.912041 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:53:15.912549 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m17:53:15.913353 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:53:15.929844 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:53:15.930639 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:53:15.931152 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201175315840433"
    )
  
[0m17:53:15.932276 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:53:15.942744 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:53:15.943290 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:53:15.943756 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:53:15.956772 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m17:53:15.958834 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m17:53:15.960580 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16b04160-c3f9-4695-bc3a-88e042796fff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77818253fce0>]}
[0m17:53:15.961353 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m17:53:15.962092 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:53:15.963550 [debug] [MainThread]: Using duckdb connection "master"
[0m17:53:15.964070 [debug] [MainThread]: On master: BEGIN
[0m17:53:15.964539 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:53:15.965511 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:53:15.965980 [debug] [MainThread]: On master: COMMIT
[0m17:53:15.966402 [debug] [MainThread]: Using duckdb connection "master"
[0m17:53:15.966806 [debug] [MainThread]: On master: COMMIT
[0m17:53:15.967480 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:53:15.967966 [debug] [MainThread]: On master: Close
[0m17:53:15.968459 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:53:15.968854 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m17:53:15.969312 [info ] [MainThread]: 
[0m17:53:15.969760 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m17:53:15.970540 [debug] [MainThread]: Command end result
[0m17:53:15.989621 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:53:15.991246 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:53:15.996851 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m17:53:15.997299 [info ] [MainThread]: 
[0m17:53:15.997842 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:53:15.998309 [info ] [MainThread]: 
[0m17:53:15.998770 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:53:15.999431 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:53:16.000466 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3516197, "process_in_blocks": "0", "process_kernel_time": 0.284155, "process_mem_max_rss": "272012", "process_out_blocks": "3112", "process_user_time": 4.306889}
[0m17:53:16.001066 [debug] [MainThread]: Command `dbt run` succeeded at 17:53:16.000963 after 2.35 seconds
[0m17:53:16.001540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77818193af90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778182575ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778181ec3560>]}
[0m17:53:16.002050 [debug] [MainThread]: Flushing usage events
[0m17:53:16.972622 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:53:33.091760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738410a74590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738410ecb800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73841171a630>]}


============================== 17:53:33.095301 | 2589b907-e66a-4011-a430-922ccebeb4c7 ==============================
[0m17:53:33.095301 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:53:33.095971 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'warn_error': 'None', 'use_colors': 'True', 'quiet': 'False', 'partial_parse': 'True', 'log_cache_events': 'False', 'empty': 'False', 'no_print': 'None', 'target_path': 'None', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "dca1ceca-5fdd-48d9-8863-496b3f9f3ba3", "ai_explanation": "High V7 (-4.72) and low V1 (0.45) indicate suspicious transaction pattern."} --profiles-dir .', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'indirect_selection': 'eager', 'version_check': 'True', 'log_format': 'default', 'profiles_dir': '.', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'cache_selected_only': 'False', 'debug': 'False', 'printer_width': '80', 'static_parser': 'True'}
[0m17:53:33.344490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2589b907-e66a-4011-a430-922ccebeb4c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73841081eae0>]}
[0m17:53:33.416507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2589b907-e66a-4011-a430-922ccebeb4c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738411861f10>]}
[0m17:53:33.418336 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:53:33.503990 [debug] [MainThread]: checksum: a34c5c488d5946b0bab5bc6ca80bbd8407f44443be743947d89645e41e9a798f, vars: {'ai_explanation': 'High V7 (-4.72) and low V1 (0.45) indicate suspicious '
                   'transaction pattern.',
 'txn_id': 'dca1ceca-5fdd-48d9-8863-496b3f9f3ba3'}, profile: , target: , version: 1.11.2
[0m17:53:33.597045 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:53:33.597648 [debug] [MainThread]: previous checksum: a34c5c488d5946b0bab5bc6ca80bbd8407f44443be743947d89645e41e9a798f, current checksum: 08f315d3d482beeaf9a50cacd7689a0790d6f0236b8d384bb6f044f58652d160
[0m17:53:33.598134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2589b907-e66a-4011-a430-922ccebeb4c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738404ba6ab0>]}
[0m17:53:34.822455 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m17:53:34.823153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2589b907-e66a-4011-a430-922ccebeb4c7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738404978290>]}
[0m17:53:34.914993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2589b907-e66a-4011-a430-922ccebeb4c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7384049e7110>]}
[0m17:53:34.984485 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:53:34.986473 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:53:34.998948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2589b907-e66a-4011-a430-922ccebeb4c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738404026cc0>]}
[0m17:53:34.999503 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m17:53:34.999990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2589b907-e66a-4011-a430-922ccebeb4c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7384049e71a0>]}
[0m17:53:35.001722 [info ] [MainThread]: 
[0m17:53:35.002234 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:53:35.002669 [info ] [MainThread]: 
[0m17:53:35.003295 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:53:35.004365 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m17:53:35.039483 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m17:53:35.039999 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m17:53:35.040441 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:53:35.123483 [debug] [ThreadPool]: SQL status: OK in 0.083 seconds
[0m17:53:35.125167 [debug] [ThreadPool]: On list_argus_vault: Close
[0m17:53:35.126089 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m17:53:35.126700 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m17:53:35.134053 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:53:35.134550 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m17:53:35.135020 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:53:35.136457 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:53:35.137791 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:53:35.138272 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m17:53:35.138949 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:53:35.139402 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:53:35.139848 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m17:53:35.140536 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:53:35.141489 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:53:35.141974 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:53:35.142415 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:53:35.143129 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:53:35.143595 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m17:53:35.149407 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m17:53:35.155399 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:53:35.155955 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m17:53:35.156373 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:53:35.157301 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:53:35.157738 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:53:35.158186 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m17:53:35.169176 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m17:53:35.170621 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m17:53:35.171877 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m17:53:35.172344 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m17:53:35.173961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2589b907-e66a-4011-a430-922ccebeb4c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73840403fb00>]}
[0m17:53:35.174537 [debug] [MainThread]: Using duckdb connection "master"
[0m17:53:35.174977 [debug] [MainThread]: On master: BEGIN
[0m17:53:35.175385 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:53:35.176285 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:53:35.176725 [debug] [MainThread]: On master: COMMIT
[0m17:53:35.177181 [debug] [MainThread]: Using duckdb connection "master"
[0m17:53:35.177583 [debug] [MainThread]: On master: COMMIT
[0m17:53:35.178185 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:53:35.178668 [debug] [MainThread]: On master: Close
[0m17:53:35.180744 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:53:35.181469 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m17:53:35.182084 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m17:53:35.182564 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m17:53:35.190624 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:53:35.191348 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m17:53:35.247675 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:53:35.248248 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201175335223337"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'High V7 (-4.72) and low V1 (0.45) indicate suspicious transaction pattern.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = 'dca1ceca-5fdd-48d9-8863-496b3f9f3ba3'
    );
  
  
  
[0m17:53:35.248734 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:53:35.257284 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m17:53:35.264795 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:53:35.265318 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m17:53:35.266005 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:53:35.266486 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:53:35.266969 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201175335223337'
      
      
      order by ordinal_position

  
[0m17:53:35.269623 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:53:35.274543 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:53:35.275075 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:53:35.278283 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:53:35.288286 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:53:35.288813 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:53:35.291737 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:53:35.293261 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:53:35.293769 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m17:53:35.294559 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:53:35.310729 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:53:35.311511 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:53:35.312017 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201175335223337"
    )
  
[0m17:53:35.313453 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:53:35.323778 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:53:35.324361 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:53:35.324818 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:53:35.337838 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m17:53:35.339853 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m17:53:35.341620 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2589b907-e66a-4011-a430-922ccebeb4c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738404949940>]}
[0m17:53:35.342409 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m17:53:35.343143 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:53:35.344518 [debug] [MainThread]: Using duckdb connection "master"
[0m17:53:35.345067 [debug] [MainThread]: On master: BEGIN
[0m17:53:35.345531 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:53:35.346597 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:53:35.347056 [debug] [MainThread]: On master: COMMIT
[0m17:53:35.347468 [debug] [MainThread]: Using duckdb connection "master"
[0m17:53:35.347865 [debug] [MainThread]: On master: COMMIT
[0m17:53:35.348469 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:53:35.348897 [debug] [MainThread]: On master: Close
[0m17:53:35.349412 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:53:35.349807 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m17:53:35.350253 [info ] [MainThread]: 
[0m17:53:35.350715 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m17:53:35.351498 [debug] [MainThread]: Command end result
[0m17:53:35.370512 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:53:35.372184 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:53:35.377855 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m17:53:35.378313 [info ] [MainThread]: 
[0m17:53:35.378826 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:53:35.379292 [info ] [MainThread]: 
[0m17:53:35.379756 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:53:35.380398 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:53:35.381458 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3530207, "process_in_blocks": "0", "process_kernel_time": 0.323112, "process_mem_max_rss": "273904", "process_out_blocks": "3120", "process_user_time": 4.270614}
[0m17:53:35.382075 [debug] [MainThread]: Command `dbt run` succeeded at 17:53:35.381970 after 2.35 seconds
[0m17:53:35.382550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738410a15cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7384041b88f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738404d32ba0>]}
[0m17:53:35.383066 [debug] [MainThread]: Flushing usage events
[0m17:53:36.353428 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:53:52.453000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be393379fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be3934e2e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be3933795e0>]}


============================== 17:53:52.456348 | 4b6d75f4-3d00-4201-aba6-f2423cf5781c ==============================
[0m17:53:52.456348 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:53:52.457007 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error': 'None', 'log_cache_events': 'False', 'static_parser': 'True', 'indirect_selection': 'eager', 'version_check': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "0ddc86ae-88a9-44fe-b7fb-0c615218fbee", "ai_explanation": "Fraud detected: significant deviations from norms in PCA factors V3 and V10."} --profiles-dir .', 'introspect': 'True', 'fail_fast': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'printer_width': '80', 'empty': 'False', 'quiet': 'False', 'use_colors': 'True', 'log_format': 'default', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'use_experimental_parser': 'False', 'profiles_dir': '.', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'write_json': 'True'}
[0m17:53:52.706091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b6d75f4-3d00-4201-aba6-f2423cf5781c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be392a2e030>]}
[0m17:53:52.777622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b6d75f4-3d00-4201-aba6-f2423cf5781c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be394bf48f0>]}
[0m17:53:52.779396 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:53:52.864735 [debug] [MainThread]: checksum: dd8866c746ef72ef41e06c916421c7ef577c26ee83f5dd7ea8e97a7a4384cc59, vars: {'ai_explanation': 'Fraud detected: significant deviations from norms in PCA '
                   'factors V3 and V10.',
 'txn_id': '0ddc86ae-88a9-44fe-b7fb-0c615218fbee'}, profile: , target: , version: 1.11.2
[0m17:53:52.956159 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:53:52.956726 [debug] [MainThread]: previous checksum: dd8866c746ef72ef41e06c916421c7ef577c26ee83f5dd7ea8e97a7a4384cc59, current checksum: a34c5c488d5946b0bab5bc6ca80bbd8407f44443be743947d89645e41e9a798f
[0m17:53:52.957229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4b6d75f4-3d00-4201-aba6-f2423cf5781c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be386db7350>]}
[0m17:53:54.207733 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m17:53:54.208461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4b6d75f4-3d00-4201-aba6-f2423cf5781c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be386f73c20>]}
[0m17:53:54.302036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b6d75f4-3d00-4201-aba6-f2423cf5781c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be384107890>]}
[0m17:53:54.370844 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:53:54.372682 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:53:54.385128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b6d75f4-3d00-4201-aba6-f2423cf5781c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be336b32750>]}
[0m17:53:54.385679 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m17:53:54.386212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b6d75f4-3d00-4201-aba6-f2423cf5781c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be3841e7bf0>]}
[0m17:53:54.387937 [info ] [MainThread]: 
[0m17:53:54.388459 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:53:54.388945 [info ] [MainThread]: 
[0m17:53:54.389594 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:53:54.390574 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m17:53:54.425938 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m17:53:54.426444 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m17:53:54.426880 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:53:54.518635 [debug] [ThreadPool]: SQL status: OK in 0.092 seconds
[0m17:53:54.520486 [debug] [ThreadPool]: On list_argus_vault: Close
[0m17:53:54.522053 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m17:53:54.522780 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m17:53:54.530532 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:53:54.531092 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m17:53:54.531517 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:53:54.533191 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m17:53:54.534636 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:53:54.535108 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m17:53:54.535758 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:53:54.536389 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:53:54.536851 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m17:53:54.537605 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:53:54.538625 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:53:54.539131 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:53:54.539581 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:53:54.540284 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:53:54.540762 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m17:53:54.546806 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m17:53:54.553307 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:53:54.553964 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m17:53:54.554436 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:53:54.556173 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m17:53:54.556672 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:53:54.557193 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m17:53:54.570024 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m17:53:54.572584 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m17:53:54.574829 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m17:53:54.575574 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m17:53:54.577989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b6d75f4-3d00-4201-aba6-f2423cf5781c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be3841c65a0>]}
[0m17:53:54.578831 [debug] [MainThread]: Using duckdb connection "master"
[0m17:53:54.579470 [debug] [MainThread]: On master: BEGIN
[0m17:53:54.580093 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:53:54.581707 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m17:53:54.582362 [debug] [MainThread]: On master: COMMIT
[0m17:53:54.582995 [debug] [MainThread]: Using duckdb connection "master"
[0m17:53:54.583586 [debug] [MainThread]: On master: COMMIT
[0m17:53:54.584431 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:53:54.584869 [debug] [MainThread]: On master: Close
[0m17:53:54.588040 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:53:54.588795 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m17:53:54.589494 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m17:53:54.590017 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m17:53:54.598564 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:53:54.599309 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m17:53:54.656603 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:53:54.657197 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201175354632224"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Fraud detected: significant deviations from norms in PCA factors V3 and V10.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '0ddc86ae-88a9-44fe-b7fb-0c615218fbee'
    );
  
  
  
[0m17:53:54.657681 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:53:54.666222 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m17:53:54.674040 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:53:54.674556 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m17:53:54.675288 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:53:54.675773 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:53:54.676329 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201175354632224'
      
      
      order by ordinal_position

  
[0m17:53:54.678819 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:53:54.683855 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:53:54.684395 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:53:54.687312 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:53:54.697751 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:53:54.698297 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:53:54.701434 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:53:54.703028 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:53:54.703555 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m17:53:54.704424 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:53:54.721246 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:53:54.722089 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:53:54.722593 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201175354632224"
    )
  
[0m17:53:54.724193 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:53:54.735007 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:53:54.735530 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:53:54.736021 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:53:54.740342 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:53:54.742385 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m17:53:54.744168 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b6d75f4-3d00-4201-aba6-f2423cf5781c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be393a3be00>]}
[0m17:53:54.744969 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.15s]
[0m17:53:54.745699 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:53:54.747150 [debug] [MainThread]: Using duckdb connection "master"
[0m17:53:54.747611 [debug] [MainThread]: On master: BEGIN
[0m17:53:54.748058 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:53:54.749035 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:53:54.749475 [debug] [MainThread]: On master: COMMIT
[0m17:53:54.749888 [debug] [MainThread]: Using duckdb connection "master"
[0m17:53:54.750328 [debug] [MainThread]: On master: COMMIT
[0m17:53:54.750981 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:53:54.751415 [debug] [MainThread]: On master: Close
[0m17:53:54.751906 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:53:54.752333 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m17:53:54.752754 [info ] [MainThread]: 
[0m17:53:54.753226 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m17:53:54.754023 [debug] [MainThread]: Command end result
[0m17:53:54.773328 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:53:54.774984 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:53:54.780618 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m17:53:54.781072 [info ] [MainThread]: 
[0m17:53:54.781583 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:53:54.782044 [info ] [MainThread]: 
[0m17:53:54.782504 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:53:54.783137 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:53:54.784189 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3936973, "process_in_blocks": "0", "process_kernel_time": 0.3368, "process_mem_max_rss": "285064", "process_out_blocks": "3112", "process_user_time": 4.332844}
[0m17:53:54.784759 [debug] [MainThread]: Command `dbt run` succeeded at 17:53:54.784658 after 2.39 seconds
[0m17:53:54.785257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be395729460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be3939160f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be386f73c20>]}
[0m17:53:54.785732 [debug] [MainThread]: Flushing usage events
[0m17:53:55.760760 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:54:11.592341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70dacb4242f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70dacd979e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70dacb5f1490>]}


============================== 17:54:11.595618 | 712bc35b-5f8e-4e07-bf23-cbd4acd61ac4 ==============================
[0m17:54:11.595618 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:54:11.596346 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'no_print': 'None', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "c4b4cc9e-2ce4-4b60-9f7d-2184a925ef8f", "ai_explanation": "Transaction flagged as fraud due to abnormally low PCA V10 score (-6.99)."} --profiles-dir .', 'debug': 'False', 'introspect': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'static_parser': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'profiles_dir': '.', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'log_cache_events': 'False', 'fail_fast': 'False', 'target_path': 'None', 'printer_width': '80', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'quiet': 'False'}
[0m17:54:11.845523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '712bc35b-5f8e-4e07-bf23-cbd4acd61ac4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70dacab4a120>]}
[0m17:54:11.917239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '712bc35b-5f8e-4e07-bf23-cbd4acd61ac4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70dacab008f0>]}
[0m17:54:11.918967 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:54:12.003415 [debug] [MainThread]: checksum: ffe1b5e83ea23ab2ea30ed4eea94cadad022adf0838f0f3c8f2b2c8f33f5d163, vars: {'ai_explanation': 'Transaction flagged as fraud due to abnormally low PCA V10 '
                   'score (-6.99).',
 'txn_id': 'c4b4cc9e-2ce4-4b60-9f7d-2184a925ef8f'}, profile: , target: , version: 1.11.2
[0m17:54:12.096860 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:54:12.097478 [debug] [MainThread]: previous checksum: ffe1b5e83ea23ab2ea30ed4eea94cadad022adf0838f0f3c8f2b2c8f33f5d163, current checksum: dd8866c746ef72ef41e06c916421c7ef577c26ee83f5dd7ea8e97a7a4384cc59
[0m17:54:12.097999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '712bc35b-5f8e-4e07-bf23-cbd4acd61ac4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70dabecd1010>]}
[0m17:54:13.338392 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m17:54:13.339108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '712bc35b-5f8e-4e07-bf23-cbd4acd61ac4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70dabcba1be0>]}
[0m17:54:13.432647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '712bc35b-5f8e-4e07-bf23-cbd4acd61ac4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70dabcbf6ed0>]}
[0m17:54:13.502884 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:54:13.504778 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:54:13.517835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '712bc35b-5f8e-4e07-bf23-cbd4acd61ac4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70da72929400>]}
[0m17:54:13.518465 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m17:54:13.518990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '712bc35b-5f8e-4e07-bf23-cbd4acd61ac4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70dabee4b110>]}
[0m17:54:13.520747 [info ] [MainThread]: 
[0m17:54:13.521297 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:54:13.521768 [info ] [MainThread]: 
[0m17:54:13.522452 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:54:13.523460 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m17:54:13.559549 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m17:54:13.560130 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m17:54:13.560553 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:54:13.651075 [debug] [ThreadPool]: SQL status: OK in 0.090 seconds
[0m17:54:13.652752 [debug] [ThreadPool]: On list_argus_vault: Close
[0m17:54:13.653641 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m17:54:13.654250 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m17:54:13.661611 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:54:13.662090 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m17:54:13.662516 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:54:13.663889 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:54:13.665211 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:54:13.665641 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m17:54:13.666266 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:54:13.666687 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:54:13.667112 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m17:54:13.667785 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:54:13.668706 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:54:13.669161 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:54:13.669565 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:54:13.670214 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:54:13.670647 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m17:54:13.676339 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m17:54:13.682491 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:54:13.683058 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m17:54:13.683470 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:54:13.684375 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:54:13.684814 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:54:13.685270 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m17:54:13.696388 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m17:54:13.697868 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m17:54:13.699166 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m17:54:13.699610 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m17:54:13.701169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '712bc35b-5f8e-4e07-bf23-cbd4acd61ac4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70dabcbc1af0>]}
[0m17:54:13.701797 [debug] [MainThread]: Using duckdb connection "master"
[0m17:54:13.702252 [debug] [MainThread]: On master: BEGIN
[0m17:54:13.702644 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:54:13.703510 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:54:13.703961 [debug] [MainThread]: On master: COMMIT
[0m17:54:13.704376 [debug] [MainThread]: Using duckdb connection "master"
[0m17:54:13.704770 [debug] [MainThread]: On master: COMMIT
[0m17:54:13.705441 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:54:13.705863 [debug] [MainThread]: On master: Close
[0m17:54:13.707956 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:54:13.708599 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m17:54:13.709204 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m17:54:13.709695 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m17:54:13.717941 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:54:13.718662 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m17:54:13.775493 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:54:13.776091 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201175413750881"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Transaction flagged as fraud due to abnormally low PCA V10 score (-6.99).' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = 'c4b4cc9e-2ce4-4b60-9f7d-2184a925ef8f'
    );
  
  
  
[0m17:54:13.776584 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:13.785432 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m17:54:13.793266 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:54:13.793770 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m17:54:13.794486 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:54:13.794997 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:54:13.795474 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201175413750881'
      
      
      order by ordinal_position

  
[0m17:54:13.798899 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:54:13.804073 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:54:13.804598 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:54:13.807804 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:54:13.818321 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:54:13.818847 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:54:13.821274 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:54:13.822794 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:54:13.823322 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m17:54:13.824165 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:54:13.840672 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:54:13.841470 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:54:13.841998 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201175413750881"
    )
  
[0m17:54:13.843165 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:54:13.853559 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:54:13.854090 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:54:13.854558 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:54:13.869705 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m17:54:13.871689 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m17:54:13.873428 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '712bc35b-5f8e-4e07-bf23-cbd4acd61ac4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70dacb93bda0>]}
[0m17:54:13.874209 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m17:54:13.874953 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:54:13.876376 [debug] [MainThread]: Using duckdb connection "master"
[0m17:54:13.876901 [debug] [MainThread]: On master: BEGIN
[0m17:54:13.877406 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:54:13.878352 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:54:13.878807 [debug] [MainThread]: On master: COMMIT
[0m17:54:13.879275 [debug] [MainThread]: Using duckdb connection "master"
[0m17:54:13.879701 [debug] [MainThread]: On master: COMMIT
[0m17:54:13.880346 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:54:13.880793 [debug] [MainThread]: On master: Close
[0m17:54:13.881347 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:54:13.881766 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m17:54:13.882256 [info ] [MainThread]: 
[0m17:54:13.882764 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m17:54:13.883615 [debug] [MainThread]: Command end result
[0m17:54:13.904139 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:54:13.905793 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:54:13.911466 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m17:54:13.911940 [info ] [MainThread]: 
[0m17:54:13.912505 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:54:13.913012 [info ] [MainThread]: 
[0m17:54:13.913524 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:54:13.914207 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:54:13.915316 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3861048, "process_in_blocks": "0", "process_kernel_time": 0.323111, "process_mem_max_rss": "282744", "process_out_blocks": "3112", "process_user_time": 4.332672}
[0m17:54:13.915937 [debug] [MainThread]: Command `dbt run` succeeded at 17:54:13.915803 after 2.39 seconds
[0m17:54:13.916428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70dacab2fc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70dacbd41fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70da72837c50>]}
[0m17:54:13.916938 [debug] [MainThread]: Flushing usage events
[0m17:54:14.893552 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:54:31.575626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76836f8562d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76836fff24b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76836f53a510>]}


============================== 17:54:31.579060 | 5f4a57c7-fdda-4914-a374-3062767b5794 ==============================
[0m17:54:31.579060 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:54:31.579763 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'introspect': 'True', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'warn_error': 'None', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'partial_parse': 'True', 'write_json': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'printer_width': '80', 'static_parser': 'True', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "280e6229-30ac-4615-b8ba-e54f758ba17b", "ai_explanation": "Fraud detected: transactions PCA score (-10.833164469314) indicates significant deviation from normalcy."} --profiles-dir .', 'target_path': 'None', 'profiles_dir': '.', 'version_check': 'True', 'use_colors': 'True', 'log_format': 'default', 'cache_selected_only': 'False', 'no_print': 'None', 'use_experimental_parser': 'False'}
[0m17:54:31.827279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f4a57c7-fdda-4914-a374-3062767b5794', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76836eff2d50>]}
[0m17:54:31.898613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f4a57c7-fdda-4914-a374-3062767b5794', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768371ba1220>]}
[0m17:54:31.900378 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:54:31.985482 [debug] [MainThread]: checksum: ba58ea9751b468502db682469769b82d952045a1da95eb700028768ee1b01941, vars: {'ai_explanation': 'Fraud detected: transactions PCA score (-10.833164469314) '
                   'indicates significant deviation from normalcy.',
 'txn_id': '280e6229-30ac-4615-b8ba-e54f758ba17b'}, profile: , target: , version: 1.11.2
[0m17:54:32.079351 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:54:32.079977 [debug] [MainThread]: previous checksum: ba58ea9751b468502db682469769b82d952045a1da95eb700028768ee1b01941, current checksum: ffe1b5e83ea23ab2ea30ed4eea94cadad022adf0838f0f3c8f2b2c8f33f5d163
[0m17:54:32.080449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5f4a57c7-fdda-4914-a374-3062767b5794', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7683632c25d0>]}
[0m17:54:33.322461 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m17:54:33.323195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5f4a57c7-fdda-4914-a374-3062767b5794', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768361161e50>]}
[0m17:54:33.414685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f4a57c7-fdda-4914-a374-3062767b5794', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76834af2b7a0>]}
[0m17:54:33.483869 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:54:33.485840 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:54:33.498477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f4a57c7-fdda-4914-a374-3062767b5794', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76834af03b00>]}
[0m17:54:33.499071 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m17:54:33.499557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f4a57c7-fdda-4914-a374-3062767b5794', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76836316ed20>]}
[0m17:54:33.501350 [info ] [MainThread]: 
[0m17:54:33.501858 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:54:33.502320 [info ] [MainThread]: 
[0m17:54:33.502971 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:54:33.504080 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m17:54:33.539600 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m17:54:33.540153 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m17:54:33.540616 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:54:33.628969 [debug] [ThreadPool]: SQL status: OK in 0.088 seconds
[0m17:54:33.630644 [debug] [ThreadPool]: On list_argus_vault: Close
[0m17:54:33.631506 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m17:54:33.632105 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m17:54:33.639600 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:54:33.640079 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m17:54:33.640516 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:54:33.642379 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m17:54:33.643723 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:54:33.644183 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m17:54:33.645051 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:54:33.645483 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:54:33.645891 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m17:54:33.646550 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:54:33.647476 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:54:33.647932 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:54:33.648352 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:54:33.648975 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:54:33.649414 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m17:54:33.655191 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m17:54:33.661170 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:54:33.661705 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m17:54:33.662135 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:54:33.663024 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:54:33.663462 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:54:33.663881 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m17:54:33.674679 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m17:54:33.676120 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m17:54:33.677378 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m17:54:33.677814 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m17:54:33.679448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f4a57c7-fdda-4914-a374-3062767b5794', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76834af2a270>]}
[0m17:54:33.680088 [debug] [MainThread]: Using duckdb connection "master"
[0m17:54:33.680515 [debug] [MainThread]: On master: BEGIN
[0m17:54:33.680938 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:54:33.681869 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:54:33.682344 [debug] [MainThread]: On master: COMMIT
[0m17:54:33.682755 [debug] [MainThread]: Using duckdb connection "master"
[0m17:54:33.683178 [debug] [MainThread]: On master: COMMIT
[0m17:54:33.683763 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:54:33.684215 [debug] [MainThread]: On master: Close
[0m17:54:33.686258 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:54:33.686892 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m17:54:33.687471 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m17:54:33.687986 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m17:54:33.696157 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:54:33.696867 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m17:54:33.753708 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:54:33.754292 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201175433729352"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Fraud detected: transactions PCA score (-10.833164469314) indicates significant deviation from normalcy.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '280e6229-30ac-4615-b8ba-e54f758ba17b'
    );
  
  
  
[0m17:54:33.754776 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:33.763527 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m17:54:33.771298 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:54:33.771804 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m17:54:33.772504 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:54:33.772994 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:54:33.773457 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201175433729352'
      
      
      order by ordinal_position

  
[0m17:54:33.776202 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:54:33.781245 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:54:33.781752 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:54:33.784447 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:54:33.794577 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:54:33.795105 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:54:33.797489 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:54:33.799006 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:54:33.799509 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m17:54:33.800522 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:54:33.816878 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:54:33.817670 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:54:33.818192 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201175433729352"
    )
  
[0m17:54:33.819367 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:54:33.829805 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:54:33.830341 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:54:33.830799 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:54:33.844052 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m17:54:33.846123 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m17:54:33.847865 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f4a57c7-fdda-4914-a374-3062767b5794', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76836116f1a0>]}
[0m17:54:33.848647 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m17:54:33.849388 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:54:33.850734 [debug] [MainThread]: Using duckdb connection "master"
[0m17:54:33.851228 [debug] [MainThread]: On master: BEGIN
[0m17:54:33.851636 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:54:33.852523 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:54:33.852991 [debug] [MainThread]: On master: COMMIT
[0m17:54:33.853408 [debug] [MainThread]: Using duckdb connection "master"
[0m17:54:33.853806 [debug] [MainThread]: On master: COMMIT
[0m17:54:33.854430 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:54:33.854858 [debug] [MainThread]: On master: Close
[0m17:54:33.855376 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:54:33.855777 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m17:54:33.856229 [info ] [MainThread]: 
[0m17:54:33.856683 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m17:54:33.857465 [debug] [MainThread]: Command end result
[0m17:54:33.876635 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:54:33.878271 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:54:33.883924 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m17:54:33.884363 [info ] [MainThread]: 
[0m17:54:33.884880 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:54:33.885343 [info ] [MainThread]: 
[0m17:54:33.885801 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:54:33.886434 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:54:33.887487 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3746223, "process_in_blocks": "0", "process_kernel_time": 0.288856, "process_mem_max_rss": "281316", "process_out_blocks": "3120", "process_user_time": 4.32392}
[0m17:54:33.888104 [debug] [MainThread]: Command `dbt run` succeeded at 17:54:33.887995 after 2.38 seconds
[0m17:54:33.888581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76836f33a300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76836117d730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768371a2d010>]}
[0m17:54:33.889077 [debug] [MainThread]: Flushing usage events
[0m17:54:34.889747 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:54:49.824105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdb057e35c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdb057b53a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdb056ab380>]}


============================== 17:54:49.827454 | d9514638-9dfc-4622-82ce-3a0c33f5efc3 ==============================
[0m17:54:49.827454 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:54:49.828151 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'profiles_dir': '.', 'printer_width': '80', 'no_print': 'None', 'use_colors': 'True', 'write_json': 'True', 'version_check': 'True', 'log_format': 'default', 'warn_error': 'None', 'target_path': 'None', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'fail_fast': 'False', 'introspect': 'True', 'quiet': 'False', 'debug': 'False', 'static_parser': 'True', 'empty': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "a80fb08a-156f-4095-8f91-804a2e5b1cd2", "ai_explanation": "Transaction exhibits significant PCA factor anomalies, indicative of fraudulent activity."} --profiles-dir .', 'indirect_selection': 'eager'}
[0m17:54:50.076850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd9514638-9dfc-4622-82ce-3a0c33f5efc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdb04ed56d0>]}
[0m17:54:50.148091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd9514638-9dfc-4622-82ce-3a0c33f5efc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdb04ddcd10>]}
[0m17:54:50.149929 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:54:50.235307 [debug] [MainThread]: checksum: ab7849d2038db4e792ee8ba7acafb5e9671b893b34b97331a7b811addfbdc080, vars: {'ai_explanation': 'Transaction exhibits significant PCA factor anomalies, '
                   'indicative of fraudulent activity.',
 'txn_id': 'a80fb08a-156f-4095-8f91-804a2e5b1cd2'}, profile: , target: , version: 1.11.2
[0m17:54:50.329001 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:54:50.329609 [debug] [MainThread]: previous checksum: ab7849d2038db4e792ee8ba7acafb5e9671b893b34b97331a7b811addfbdc080, current checksum: ba58ea9751b468502db682469769b82d952045a1da95eb700028768ee1b01941
[0m17:54:50.330106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd9514638-9dfc-4622-82ce-3a0c33f5efc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdaf908ab10>]}
[0m17:54:51.582058 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m17:54:51.582718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd9514638-9dfc-4622-82ce-3a0c33f5efc3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdaf81d7b60>]}
[0m17:54:51.674124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd9514638-9dfc-4622-82ce-3a0c33f5efc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdaf80b4350>]}
[0m17:54:51.744310 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:54:51.746076 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:54:51.758547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd9514638-9dfc-4622-82ce-3a0c33f5efc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdaf8094b60>]}
[0m17:54:51.759147 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m17:54:51.759645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9514638-9dfc-4622-82ce-3a0c33f5efc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdaf80db5f0>]}
[0m17:54:51.761474 [info ] [MainThread]: 
[0m17:54:51.762029 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:54:51.762478 [info ] [MainThread]: 
[0m17:54:51.763150 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:54:51.764218 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m17:54:51.799660 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m17:54:51.800231 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m17:54:51.800721 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:54:51.889610 [debug] [ThreadPool]: SQL status: OK in 0.089 seconds
[0m17:54:51.891383 [debug] [ThreadPool]: On list_argus_vault: Close
[0m17:54:51.892299 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m17:54:51.892879 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m17:54:51.900400 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:54:51.900869 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m17:54:51.901313 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:54:51.902466 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:54:51.903798 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:54:51.904251 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m17:54:51.904842 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:54:51.905284 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:54:51.905688 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m17:54:51.906339 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:54:51.907281 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:54:51.907721 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:54:51.908163 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:54:51.908851 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:54:51.909324 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m17:54:51.914974 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m17:54:51.920684 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:54:51.921242 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m17:54:51.921651 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:54:51.922533 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:54:51.922981 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:54:51.923406 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m17:54:51.934591 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m17:54:51.936017 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m17:54:51.937280 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m17:54:51.937718 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m17:54:51.939267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9514638-9dfc-4622-82ce-3a0c33f5efc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdaf80b7b60>]}
[0m17:54:51.939888 [debug] [MainThread]: Using duckdb connection "master"
[0m17:54:51.940380 [debug] [MainThread]: On master: BEGIN
[0m17:54:51.940800 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:54:51.941757 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:54:51.942235 [debug] [MainThread]: On master: COMMIT
[0m17:54:51.942686 [debug] [MainThread]: Using duckdb connection "master"
[0m17:54:51.943131 [debug] [MainThread]: On master: COMMIT
[0m17:54:51.943762 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:54:51.944242 [debug] [MainThread]: On master: Close
[0m17:54:51.946312 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:54:51.947028 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m17:54:51.947598 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m17:54:51.948104 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m17:54:51.955999 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:54:51.956708 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m17:54:52.012942 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:54:52.013498 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201175451988575"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Transaction exhibits significant PCA factor anomalies, indicative of fraudulent activity.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = 'a80fb08a-156f-4095-8f91-804a2e5b1cd2'
    );
  
  
  
[0m17:54:52.014000 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:52.023155 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m17:54:52.030870 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:54:52.031408 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m17:54:52.032118 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:54:52.032595 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:54:52.033079 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201175451988575'
      
      
      order by ordinal_position

  
[0m17:54:52.035575 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:54:52.040501 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:54:52.041037 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:54:52.044410 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:54:52.054590 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:54:52.055143 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:54:52.058303 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:54:52.059798 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:54:52.060320 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m17:54:52.061084 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:54:52.077339 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:54:52.078113 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:54:52.078599 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201175451988575"
    )
  
[0m17:54:52.079753 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:54:52.090195 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:54:52.090693 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:54:52.091168 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:54:52.104971 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m17:54:52.107091 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m17:54:52.108881 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9514638-9dfc-4622-82ce-3a0c33f5efc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdb07a94fb0>]}
[0m17:54:52.109686 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m17:54:52.110426 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:54:52.111768 [debug] [MainThread]: Using duckdb connection "master"
[0m17:54:52.112298 [debug] [MainThread]: On master: BEGIN
[0m17:54:52.112745 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:54:52.113679 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:54:52.114147 [debug] [MainThread]: On master: COMMIT
[0m17:54:52.114581 [debug] [MainThread]: Using duckdb connection "master"
[0m17:54:52.115018 [debug] [MainThread]: On master: COMMIT
[0m17:54:52.115619 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:54:52.116078 [debug] [MainThread]: On master: Close
[0m17:54:52.116590 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:54:52.117023 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m17:54:52.117501 [info ] [MainThread]: 
[0m17:54:52.117979 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m17:54:52.118791 [debug] [MainThread]: Command end result
[0m17:54:52.139153 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:54:52.140843 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:54:52.146600 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m17:54:52.147062 [info ] [MainThread]: 
[0m17:54:52.147623 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:54:52.148110 [info ] [MainThread]: 
[0m17:54:52.148632 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:54:52.149319 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:54:52.150399 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3885894, "process_in_blocks": "0", "process_kernel_time": 0.318101, "process_mem_max_rss": "281000", "process_out_blocks": "3112", "process_user_time": 4.307751}
[0m17:54:52.151020 [debug] [MainThread]: Command `dbt run` succeeded at 17:54:52.150890 after 2.39 seconds
[0m17:54:52.151520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdb0560e300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdb0560e000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdaf932c9e0>]}
[0m17:54:52.152058 [debug] [MainThread]: Flushing usage events
[0m17:54:53.126146 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:55:09.197559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71383f913260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713840e46e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71383f7060f0>]}


============================== 17:55:09.201257 | 3d798458-24a7-4092-87c0-2b68a68466c2 ==============================
[0m17:55:09.201257 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:55:09.201967 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'cache_selected_only': 'False', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "a1bf618c-1f12-4fe8-8d6a-8cd2391bf0b9", "ai_explanation": "This transaction is flagged as fraud due to a PCA score of -10.001, indicating significant anomaly."} --profiles-dir .', 'debug': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'introspect': 'True', 'write_json': 'True', 'use_experimental_parser': 'False', 'printer_width': '80', 'quiet': 'False', 'warn_error': 'None', 'log_cache_events': 'False', 'target_path': 'None', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'log_format': 'default', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'static_parser': 'True', 'no_print': 'None', 'profiles_dir': '.', 'empty': 'False', 'send_anonymous_usage_stats': 'True'}
[0m17:55:09.452843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d798458-24a7-4092-87c0-2b68a68466c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71384209e1e0>]}
[0m17:55:09.524299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3d798458-24a7-4092-87c0-2b68a68466c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71383f111730>]}
[0m17:55:09.526096 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:55:09.610028 [debug] [MainThread]: checksum: 436315e0ac66e3f170c85d0f6c7b13ec59b6b8973182e34f2fd856744e1ea69b, vars: {'ai_explanation': 'This transaction is flagged as fraud due to a PCA score of '
                   '-10.001, indicating significant anomaly.',
 'txn_id': 'a1bf618c-1f12-4fe8-8d6a-8cd2391bf0b9'}, profile: , target: , version: 1.11.2
[0m17:55:09.702780 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:55:09.703420 [debug] [MainThread]: previous checksum: 436315e0ac66e3f170c85d0f6c7b13ec59b6b8973182e34f2fd856744e1ea69b, current checksum: ab7849d2038db4e792ee8ba7acafb5e9671b893b34b97331a7b811addfbdc080
[0m17:55:09.703880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3d798458-24a7-4092-87c0-2b68a68466c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71383f93e8d0>]}
[0m17:55:10.946967 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m17:55:10.947676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3d798458-24a7-4092-87c0-2b68a68466c2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713833227230>]}
[0m17:55:11.039508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d798458-24a7-4092-87c0-2b68a68466c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71383f1e6480>]}
[0m17:55:11.109943 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:55:11.111658 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:55:11.123936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d798458-24a7-4092-87c0-2b68a68466c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7137daf168d0>]}
[0m17:55:11.124500 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m17:55:11.125046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d798458-24a7-4092-87c0-2b68a68466c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713833266900>]}
[0m17:55:11.126789 [info ] [MainThread]: 
[0m17:55:11.127343 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:55:11.127815 [info ] [MainThread]: 
[0m17:55:11.128493 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:55:11.129549 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m17:55:11.164855 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m17:55:11.165356 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m17:55:11.165790 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:55:11.254358 [debug] [ThreadPool]: SQL status: OK in 0.088 seconds
[0m17:55:11.256026 [debug] [ThreadPool]: On list_argus_vault: Close
[0m17:55:11.256862 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m17:55:11.257467 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m17:55:11.264703 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:55:11.265181 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m17:55:11.265603 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:55:11.267273 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m17:55:11.268607 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:55:11.269057 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m17:55:11.269666 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:55:11.270108 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:55:11.270506 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m17:55:11.271131 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:55:11.272047 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:55:11.272477 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:55:11.272876 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:55:11.273474 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:55:11.273893 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m17:55:11.279505 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m17:55:11.285151 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:55:11.285677 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m17:55:11.286107 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:55:11.287013 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:55:11.287478 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:55:11.287967 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m17:55:11.299989 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m17:55:11.301416 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m17:55:11.302690 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m17:55:11.303172 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m17:55:11.304823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d798458-24a7-4092-87c0-2b68a68466c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7138301172f0>]}
[0m17:55:11.305461 [debug] [MainThread]: Using duckdb connection "master"
[0m17:55:11.305870 [debug] [MainThread]: On master: BEGIN
[0m17:55:11.306283 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:55:11.307133 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:55:11.307561 [debug] [MainThread]: On master: COMMIT
[0m17:55:11.307983 [debug] [MainThread]: Using duckdb connection "master"
[0m17:55:11.308376 [debug] [MainThread]: On master: COMMIT
[0m17:55:11.308981 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:55:11.309398 [debug] [MainThread]: On master: Close
[0m17:55:11.311450 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:55:11.312164 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m17:55:11.312753 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m17:55:11.313251 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m17:55:11.321068 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:55:11.321780 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m17:55:11.377664 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:55:11.378238 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201175511353427"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'This transaction is flagged as fraud due to a PCA score of -10.001, indicating significant anomaly.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = 'a1bf618c-1f12-4fe8-8d6a-8cd2391bf0b9'
    );
  
  
  
[0m17:55:11.378717 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:55:11.387734 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m17:55:11.395388 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:55:11.395901 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m17:55:11.396616 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:55:11.397115 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:55:11.397578 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201175511353427'
      
      
      order by ordinal_position

  
[0m17:55:11.400192 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:55:11.405166 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:55:11.405670 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:55:11.408116 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:55:11.418130 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:55:11.418643 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:55:11.421022 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:55:11.422543 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:55:11.423074 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m17:55:11.424133 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:55:11.440292 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:55:11.441061 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:55:11.441554 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201175511353427"
    )
  
[0m17:55:11.442906 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:55:11.453311 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:55:11.453813 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:55:11.454342 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:55:11.467845 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m17:55:11.469838 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m17:55:11.471599 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d798458-24a7-4092-87c0-2b68a68466c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71384021fd10>]}
[0m17:55:11.472390 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m17:55:11.473135 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:55:11.475226 [debug] [MainThread]: Using duckdb connection "master"
[0m17:55:11.475735 [debug] [MainThread]: On master: BEGIN
[0m17:55:11.476217 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:55:11.477278 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:55:11.477713 [debug] [MainThread]: On master: COMMIT
[0m17:55:11.478157 [debug] [MainThread]: Using duckdb connection "master"
[0m17:55:11.478552 [debug] [MainThread]: On master: COMMIT
[0m17:55:11.479167 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:55:11.479595 [debug] [MainThread]: On master: Close
[0m17:55:11.480109 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:55:11.480502 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m17:55:11.480940 [info ] [MainThread]: 
[0m17:55:11.481428 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m17:55:11.482254 [debug] [MainThread]: Command end result
[0m17:55:11.503686 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:55:11.505388 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:55:11.511061 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m17:55:11.511496 [info ] [MainThread]: 
[0m17:55:11.512064 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:55:11.512534 [info ] [MainThread]: 
[0m17:55:11.513049 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:55:11.513695 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:55:11.514779 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3803308, "process_in_blocks": "0", "process_kernel_time": 0.313324, "process_mem_max_rss": "274016", "process_out_blocks": "3112", "process_user_time": 4.287385}
[0m17:55:11.515379 [debug] [MainThread]: Command `dbt run` succeeded at 17:55:11.515276 after 2.38 seconds
[0m17:55:11.515849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71383f451400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71383eff2ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7137daf2f9b0>]}
[0m17:55:11.516353 [debug] [MainThread]: Flushing usage events
[0m17:55:12.519868 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:55:30.315685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70452ed0ab10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70452f20bf80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70452f20aea0>]}


============================== 17:55:30.319161 | 10f9d735-b39a-46f5-b0b4-f7b378306d18 ==============================
[0m17:55:30.319161 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:55:30.319859 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'indirect_selection': 'eager', 'profiles_dir': '.', 'target_path': 'None', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'no_print': 'None', 'static_parser': 'True', 'version_check': 'True', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "1640789b-fe56-4ddb-922d-704f6b21b549", "ai_explanation": "Fraud likely due to significant PCA scores: V3 (-4.49), V5 (-6.97), and V12 (-6.98) indicate suspicious activity."} --profiles-dir .', 'printer_width': '80', 'write_json': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'introspect': 'True', 'warn_error': 'None', 'log_format': 'default', 'quiet': 'False'}
[0m17:55:30.567732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '10f9d735-b39a-46f5-b0b4-f7b378306d18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70452dfee990>]}
[0m17:55:30.638675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '10f9d735-b39a-46f5-b0b4-f7b378306d18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70452e424290>]}
[0m17:55:30.640443 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:55:30.725368 [debug] [MainThread]: checksum: 24cfc3a04886182e6dcc80ef2464a1d3d4d2f67fc93fb078ff49421cb66d70a0, vars: {'ai_explanation': 'Fraud likely due to significant PCA scores: V3 (-4.49), V5 '
                   '(-6.97), and V12 (-6.98) indicate suspicious activity.',
 'txn_id': '1640789b-fe56-4ddb-922d-704f6b21b549'}, profile: , target: , version: 1.11.2
[0m17:55:30.818883 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:55:30.819524 [debug] [MainThread]: previous checksum: 24cfc3a04886182e6dcc80ef2464a1d3d4d2f67fc93fb078ff49421cb66d70a0, current checksum: 436315e0ac66e3f170c85d0f6c7b13ec59b6b8973182e34f2fd856744e1ea69b
[0m17:55:30.820019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '10f9d735-b39a-46f5-b0b4-f7b378306d18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7045223b4cb0>]}
[0m17:55:32.048423 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m17:55:32.049131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '10f9d735-b39a-46f5-b0b4-f7b378306d18', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7045221877d0>]}
[0m17:55:32.140882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '10f9d735-b39a-46f5-b0b4-f7b378306d18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7045201189b0>]}
[0m17:55:32.209753 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:55:32.211594 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:55:32.223971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '10f9d735-b39a-46f5-b0b4-f7b378306d18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70452002bbc0>]}
[0m17:55:32.224523 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m17:55:32.225004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '10f9d735-b39a-46f5-b0b4-f7b378306d18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7045201e1760>]}
[0m17:55:32.226741 [info ] [MainThread]: 
[0m17:55:32.227277 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:55:32.227722 [info ] [MainThread]: 
[0m17:55:32.228355 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:55:32.229418 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m17:55:32.264539 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m17:55:32.265081 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m17:55:32.265518 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:55:32.351094 [debug] [ThreadPool]: SQL status: OK in 0.085 seconds
[0m17:55:32.352766 [debug] [ThreadPool]: On list_argus_vault: Close
[0m17:55:32.353627 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m17:55:32.354232 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m17:55:32.361559 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:55:32.362035 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m17:55:32.362449 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:55:32.363590 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:55:32.364878 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:55:32.365341 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m17:55:32.365941 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:55:32.366360 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:55:32.366754 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m17:55:32.367459 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:55:32.368380 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:55:32.368811 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:55:32.369231 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:55:32.369873 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:55:32.370327 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m17:55:32.375829 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m17:55:32.381402 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:55:32.381952 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m17:55:32.382358 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:55:32.383228 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:55:32.383660 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:55:32.384099 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m17:55:32.395035 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m17:55:32.396428 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m17:55:32.397684 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m17:55:32.398135 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m17:55:32.399634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '10f9d735-b39a-46f5-b0b4-f7b378306d18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704520026ae0>]}
[0m17:55:32.400235 [debug] [MainThread]: Using duckdb connection "master"
[0m17:55:32.400659 [debug] [MainThread]: On master: BEGIN
[0m17:55:32.401086 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:55:32.401980 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:55:32.402432 [debug] [MainThread]: On master: COMMIT
[0m17:55:32.402846 [debug] [MainThread]: Using duckdb connection "master"
[0m17:55:32.403268 [debug] [MainThread]: On master: COMMIT
[0m17:55:32.403857 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:55:32.404308 [debug] [MainThread]: On master: Close
[0m17:55:32.406354 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:55:32.407002 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m17:55:32.407555 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m17:55:32.408051 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m17:55:32.415907 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:55:32.416665 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m17:55:32.472733 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:55:32.473300 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201175532448422"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Fraud likely due to significant PCA scores: V3 (-4.49), V5 (-6.97), and V12 (-6.98) indicate suspicious activity.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '1640789b-fe56-4ddb-922d-704f6b21b549'
    );
  
  
  
[0m17:55:32.473779 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:55:32.481493 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m17:55:32.488943 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:55:32.489440 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m17:55:32.490142 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:55:32.490618 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:55:32.491108 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201175532448422'
      
      
      order by ordinal_position

  
[0m17:55:32.493579 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:55:32.498613 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:55:32.499150 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:55:32.501975 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:55:32.512361 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:55:32.512936 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:55:32.515720 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:55:32.517355 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:55:32.517865 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m17:55:32.518646 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:55:32.535277 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:55:32.536113 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:55:32.536622 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201175532448422"
    )
  
[0m17:55:32.538633 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:55:32.549073 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:55:32.549585 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:55:32.550068 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:55:32.563663 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m17:55:32.565784 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m17:55:32.567539 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10f9d735-b39a-46f5-b0b4-f7b378306d18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7044e16cecc0>]}
[0m17:55:32.568306 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m17:55:32.569047 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:55:32.570585 [debug] [MainThread]: Using duckdb connection "master"
[0m17:55:32.571088 [debug] [MainThread]: On master: BEGIN
[0m17:55:32.571520 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:55:32.572458 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:55:32.572893 [debug] [MainThread]: On master: COMMIT
[0m17:55:32.573320 [debug] [MainThread]: Using duckdb connection "master"
[0m17:55:32.573711 [debug] [MainThread]: On master: COMMIT
[0m17:55:32.574399 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:55:32.574828 [debug] [MainThread]: On master: Close
[0m17:55:32.575335 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:55:32.575726 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m17:55:32.576162 [info ] [MainThread]: 
[0m17:55:32.576601 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m17:55:32.577368 [debug] [MainThread]: Command end result
[0m17:55:32.596126 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:55:32.597731 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:55:32.603315 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m17:55:32.603748 [info ] [MainThread]: 
[0m17:55:32.604277 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:55:32.604711 [info ] [MainThread]: 
[0m17:55:32.605193 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:55:32.605797 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:55:32.606835 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3541627, "process_in_blocks": "0", "process_kernel_time": 0.309136, "process_mem_max_rss": "273996", "process_out_blocks": "3120", "process_user_time": 4.292246}
[0m17:55:32.607430 [debug] [MainThread]: Command `dbt run` succeeded at 17:55:32.607330 after 2.35 seconds
[0m17:55:32.607897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70452ec03e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70452f061d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70452f060800>]}
[0m17:55:32.608395 [debug] [MainThread]: Flushing usage events
[0m17:55:33.584205 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:55:50.043188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713766814a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713765e4df70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713766817350>]}


============================== 17:55:50.046869 | 7cd29db6-a0f3-406b-a5ba-3c5b0acf9fc3 ==============================
[0m17:55:50.046869 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:55:50.047622 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'printer_width': '80', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "90f61120-0d96-46f7-9870-4b99b10b3640", "ai_explanation": "The transaction is flagged as fraud due to extreme PCA scores (V3, V4, and V14)."} --profiles-dir .', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'log_format': 'default', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'profiles_dir': '.', 'partial_parse': 'True', 'version_check': 'True', 'quiet': 'False', 'no_print': 'None', 'static_parser': 'True', 'introspect': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'fail_fast': 'False', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'warn_error': 'None', 'use_colors': 'True'}
[0m17:55:50.299662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7cd29db6-a0f3-406b-a5ba-3c5b0acf9fc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7137666a6fc0>]}
[0m17:55:50.370679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7cd29db6-a0f3-406b-a5ba-3c5b0acf9fc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7137657d3470>]}
[0m17:55:50.372441 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:55:50.458483 [debug] [MainThread]: checksum: 84064407c226426de311c348d81657dffe04f4197f16efbf380c653bcef0fe1e, vars: {'ai_explanation': 'The transaction is flagged as fraud due to extreme PCA '
                   'scores (V3, V4, and V14).',
 'txn_id': '90f61120-0d96-46f7-9870-4b99b10b3640'}, profile: , target: , version: 1.11.2
[0m17:55:50.553184 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:55:50.553774 [debug] [MainThread]: previous checksum: 84064407c226426de311c348d81657dffe04f4197f16efbf380c653bcef0fe1e, current checksum: 24cfc3a04886182e6dcc80ef2464a1d3d4d2f67fc93fb078ff49421cb66d70a0
[0m17:55:50.554276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7cd29db6-a0f3-406b-a5ba-3c5b0acf9fc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7137599b64b0>]}
[0m17:55:51.804646 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m17:55:51.805367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7cd29db6-a0f3-406b-a5ba-3c5b0acf9fc3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7137597939e0>]}
[0m17:55:51.899434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7cd29db6-a0f3-406b-a5ba-3c5b0acf9fc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713759735100>]}
[0m17:55:51.968705 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:55:51.970490 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:55:51.982847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7cd29db6-a0f3-406b-a5ba-3c5b0acf9fc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71375972d4c0>]}
[0m17:55:51.983418 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m17:55:51.983887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7cd29db6-a0f3-406b-a5ba-3c5b0acf9fc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713759791be0>]}
[0m17:55:51.985643 [info ] [MainThread]: 
[0m17:55:51.986158 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:55:51.986596 [info ] [MainThread]: 
[0m17:55:51.987222 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:55:51.988228 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m17:55:52.028960 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m17:55:52.029511 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m17:55:52.029976 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:55:52.121705 [debug] [ThreadPool]: SQL status: OK in 0.092 seconds
[0m17:55:52.123860 [debug] [ThreadPool]: On list_argus_vault: Close
[0m17:55:52.125219 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m17:55:52.125986 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m17:55:52.135102 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:55:52.135868 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m17:55:52.136640 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:55:52.138141 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:55:52.139511 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:55:52.139967 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m17:55:52.140592 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:55:52.141058 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:55:52.141465 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m17:55:52.142121 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:55:52.143056 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:55:52.143504 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:55:52.143927 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:55:52.144518 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:55:52.144972 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m17:55:52.150580 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m17:55:52.156651 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:55:52.157238 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m17:55:52.157655 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:55:52.158636 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:55:52.159100 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:55:52.159525 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m17:55:52.170505 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m17:55:52.172043 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m17:55:52.173338 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m17:55:52.173788 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m17:55:52.175548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7cd29db6-a0f3-406b-a5ba-3c5b0acf9fc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7137581c4260>]}
[0m17:55:52.176312 [debug] [MainThread]: Using duckdb connection "master"
[0m17:55:52.177044 [debug] [MainThread]: On master: BEGIN
[0m17:55:52.177529 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:55:52.178505 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:55:52.179106 [debug] [MainThread]: On master: COMMIT
[0m17:55:52.179543 [debug] [MainThread]: Using duckdb connection "master"
[0m17:55:52.179966 [debug] [MainThread]: On master: COMMIT
[0m17:55:52.180563 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:55:52.181029 [debug] [MainThread]: On master: Close
[0m17:55:52.183159 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:55:52.184093 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m17:55:52.184957 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m17:55:52.185457 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m17:55:52.193688 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:55:52.194443 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m17:55:52.251531 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:55:52.252197 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201175552226787"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'The transaction is flagged as fraud due to extreme PCA scores (V3, V4, and V14).' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '90f61120-0d96-46f7-9870-4b99b10b3640'
    );
  
  
  
[0m17:55:52.252693 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:55:52.261631 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m17:55:52.269666 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:55:52.270225 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m17:55:52.270986 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:55:52.271467 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:55:52.271955 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201175552226787'
      
      
      order by ordinal_position

  
[0m17:55:52.274627 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:55:52.279771 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:55:52.280308 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:55:52.282872 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:55:52.293170 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:55:52.293691 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:55:52.296149 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:55:52.297667 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:55:52.298189 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m17:55:52.298997 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:55:52.315390 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:55:52.316210 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:55:52.316706 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201175552226787"
    )
  
[0m17:55:52.318264 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:55:52.328666 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:55:52.329202 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:55:52.329675 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:55:52.345472 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m17:55:52.347531 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m17:55:52.349267 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7cd29db6-a0f3-406b-a5ba-3c5b0acf9fc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7137683d5010>]}
[0m17:55:52.350039 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m17:55:52.350754 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:55:52.352440 [debug] [MainThread]: Using duckdb connection "master"
[0m17:55:52.352984 [debug] [MainThread]: On master: BEGIN
[0m17:55:52.353439 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:55:52.354322 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:55:52.354760 [debug] [MainThread]: On master: COMMIT
[0m17:55:52.355201 [debug] [MainThread]: Using duckdb connection "master"
[0m17:55:52.355629 [debug] [MainThread]: On master: COMMIT
[0m17:55:52.356237 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:55:52.356679 [debug] [MainThread]: On master: Close
[0m17:55:52.357195 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:55:52.357605 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m17:55:52.358108 [info ] [MainThread]: 
[0m17:55:52.358569 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m17:55:52.359402 [debug] [MainThread]: Command end result
[0m17:55:52.378406 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:55:52.380042 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:55:52.385661 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m17:55:52.386146 [info ] [MainThread]: 
[0m17:55:52.386665 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:55:52.387128 [info ] [MainThread]: 
[0m17:55:52.387591 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:55:52.388229 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:55:52.389304 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.4120994, "process_in_blocks": "0", "process_kernel_time": 0.294537, "process_mem_max_rss": "277576", "process_out_blocks": "3120", "process_user_time": 4.345667}
[0m17:55:52.389903 [debug] [MainThread]: Command `dbt run` succeeded at 17:55:52.389800 after 2.41 seconds
[0m17:55:52.390405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71376662e1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713765e31850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713766817350>]}
[0m17:55:52.390896 [debug] [MainThread]: Flushing usage events
[0m17:55:54.392286 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:56:10.038551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a18fb5f1e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a18fcf877a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a18fb6f7920>]}


============================== 17:56:10.041937 | cd4c7542-3e82-416a-8aee-c32ddbc7d65e ==============================
[0m17:56:10.041937 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:56:10.042650 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'indirect_selection': 'eager', 'static_parser': 'True', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'use_colors': 'True', 'printer_width': '80', 'no_print': 'None', 'log_format': 'default', 'profiles_dir': '.', 'quiet': 'False', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "53d2c870-a8ca-4ade-91af-3d9d1f0354ec", "ai_explanation": "The transaction is flagged for fraud due to anomalous PCA scores (V3 and V14)."} --profiles-dir .', 'debug': 'False', 'fail_fast': 'False', 'write_json': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True'}
[0m17:56:10.292987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd4c7542-3e82-416a-8aee-c32ddbc7d65e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a18fb414e00>]}
[0m17:56:10.365875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd4c7542-3e82-416a-8aee-c32ddbc7d65e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a18fb444530>]}
[0m17:56:10.367821 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:56:10.460303 [debug] [MainThread]: checksum: 9cbbdda8dde68536b3e63a2d764848e58239466d7906e03abe30ff50e6444ccd, vars: {'ai_explanation': 'The transaction is flagged for fraud due to anomalous PCA '
                   'scores (V3 and V14).',
 'txn_id': '53d2c870-a8ca-4ade-91af-3d9d1f0354ec'}, profile: , target: , version: 1.11.2
[0m17:56:10.560537 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:56:10.561164 [debug] [MainThread]: previous checksum: 9cbbdda8dde68536b3e63a2d764848e58239466d7906e03abe30ff50e6444ccd, current checksum: 84064407c226426de311c348d81657dffe04f4197f16efbf380c653bcef0fe1e
[0m17:56:10.561635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cd4c7542-3e82-416a-8aee-c32ddbc7d65e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a18fbc42840>]}
[0m17:56:11.803449 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m17:56:11.804149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cd4c7542-3e82-416a-8aee-c32ddbc7d65e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a18fb415f40>]}
[0m17:56:11.895425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd4c7542-3e82-416a-8aee-c32ddbc7d65e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a18ed535370>]}
[0m17:56:11.966128 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:56:11.967983 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:56:11.980619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd4c7542-3e82-416a-8aee-c32ddbc7d65e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a188f3b96a0>]}
[0m17:56:11.981225 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m17:56:11.981692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd4c7542-3e82-416a-8aee-c32ddbc7d65e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a188f3f7bc0>]}
[0m17:56:11.983477 [info ] [MainThread]: 
[0m17:56:11.984005 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:56:11.984447 [info ] [MainThread]: 
[0m17:56:11.985092 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:56:11.986142 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m17:56:12.021156 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m17:56:12.021640 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m17:56:12.022106 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:56:12.109872 [debug] [ThreadPool]: SQL status: OK in 0.088 seconds
[0m17:56:12.111648 [debug] [ThreadPool]: On list_argus_vault: Close
[0m17:56:12.112511 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m17:56:12.113099 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m17:56:12.120482 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:56:12.120965 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m17:56:12.121388 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:56:12.122836 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:56:12.124181 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:56:12.124613 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m17:56:12.125260 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:56:12.125679 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:56:12.126111 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m17:56:12.126741 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:56:12.127669 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:56:12.128125 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:56:12.128534 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:56:12.129153 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:56:12.129583 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m17:56:12.135256 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m17:56:12.140962 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:56:12.141498 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m17:56:12.141901 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:56:12.142860 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:56:12.143337 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:56:12.143758 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m17:56:12.154993 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m17:56:12.156501 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m17:56:12.157769 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m17:56:12.158232 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m17:56:12.159797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd4c7542-3e82-416a-8aee-c32ddbc7d65e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a18ed559280>]}
[0m17:56:12.160430 [debug] [MainThread]: Using duckdb connection "master"
[0m17:56:12.160870 [debug] [MainThread]: On master: BEGIN
[0m17:56:12.161304 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:56:12.162189 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:56:12.162632 [debug] [MainThread]: On master: COMMIT
[0m17:56:12.163092 [debug] [MainThread]: Using duckdb connection "master"
[0m17:56:12.163497 [debug] [MainThread]: On master: COMMIT
[0m17:56:12.164137 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:56:12.164579 [debug] [MainThread]: On master: Close
[0m17:56:12.166756 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:56:12.167497 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m17:56:12.168112 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m17:56:12.168608 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m17:56:12.176708 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:56:12.177452 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m17:56:12.234532 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:56:12.235175 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201175612209864"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'The transaction is flagged for fraud due to anomalous PCA scores (V3 and V14).' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '53d2c870-a8ca-4ade-91af-3d9d1f0354ec'
    );
  
  
  
[0m17:56:12.235672 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:56:12.244393 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m17:56:12.252013 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:56:12.252550 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m17:56:12.253354 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:56:12.253869 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:56:12.254363 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201175612209864'
      
      
      order by ordinal_position

  
[0m17:56:12.259727 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:56:12.264905 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:56:12.265442 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:56:12.268677 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:56:12.279005 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:56:12.279524 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:56:12.281841 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:56:12.283350 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:56:12.283849 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m17:56:12.284606 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:56:12.300789 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:56:12.301567 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:56:12.302072 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201175612209864"
    )
  
[0m17:56:12.303624 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:56:12.314847 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:56:12.315374 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:56:12.315825 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:56:12.330034 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m17:56:12.332166 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m17:56:12.333859 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd4c7542-3e82-416a-8aee-c32ddbc7d65e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a18ed59af00>]}
[0m17:56:12.334621 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m17:56:12.335346 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:56:12.337017 [debug] [MainThread]: Using duckdb connection "master"
[0m17:56:12.337528 [debug] [MainThread]: On master: BEGIN
[0m17:56:12.338025 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:56:12.339003 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:56:12.339438 [debug] [MainThread]: On master: COMMIT
[0m17:56:12.339842 [debug] [MainThread]: Using duckdb connection "master"
[0m17:56:12.340283 [debug] [MainThread]: On master: COMMIT
[0m17:56:12.340869 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:56:12.341350 [debug] [MainThread]: On master: Close
[0m17:56:12.341837 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:56:12.342274 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m17:56:12.342690 [info ] [MainThread]: 
[0m17:56:12.343169 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m17:56:12.343949 [debug] [MainThread]: Command end result
[0m17:56:12.363010 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:56:12.364668 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:56:12.370479 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m17:56:12.370941 [info ] [MainThread]: 
[0m17:56:12.371475 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:56:12.371934 [info ] [MainThread]: 
[0m17:56:12.372411 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:56:12.373050 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:56:12.374094 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.398363, "process_in_blocks": "0", "process_kernel_time": 0.298065, "process_mem_max_rss": "281888", "process_out_blocks": "3104", "process_user_time": 4.353139}
[0m17:56:12.374676 [debug] [MainThread]: Command `dbt run` succeeded at 17:56:12.374574 after 2.40 seconds
[0m17:56:12.375170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a18fbcb0530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a18ed5fb200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a18fbc43020>]}
[0m17:56:12.375644 [debug] [MainThread]: Flushing usage events
[0m17:56:13.353972 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:56:28.780314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779975ee6360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779975d046b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779975ee6570>]}


============================== 17:56:28.783733 | 847e666e-51a8-4c61-a3e7-c884cd6f6d68 ==============================
[0m17:56:28.783733 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:56:28.784456 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'introspect': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'profiles_dir': '.', 'use_experimental_parser': 'False', 'version_check': 'True', 'empty': 'False', 'use_colors': 'True', 'warn_error': 'None', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "9ef47ded-750c-4b47-ac2b-5a8dcfc5bcc0", "ai_explanation": "Fraud detected: anomalous PCA factors indicate suspicious transaction activity."} --profiles-dir .', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'debug': 'False', 'quiet': 'False', 'partial_parse': 'True', 'static_parser': 'True', 'write_json': 'True', 'no_print': 'None', 'log_format': 'default'}
[0m17:56:29.034295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '847e666e-51a8-4c61-a3e7-c884cd6f6d68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779974f39fd0>]}
[0m17:56:29.105978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '847e666e-51a8-4c61-a3e7-c884cd6f6d68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7799750ec4a0>]}
[0m17:56:29.107732 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:56:29.199421 [debug] [MainThread]: checksum: 46aa2b3a347e7d3ca93974080ccad796385526669644f1bda9da52e057fcd758, vars: {'ai_explanation': 'Fraud detected: anomalous PCA factors indicate suspicious '
                   'transaction activity.',
 'txn_id': '9ef47ded-750c-4b47-ac2b-5a8dcfc5bcc0'}, profile: , target: , version: 1.11.2
[0m17:56:29.296150 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:56:29.296750 [debug] [MainThread]: previous checksum: 46aa2b3a347e7d3ca93974080ccad796385526669644f1bda9da52e057fcd758, current checksum: 9cbbdda8dde68536b3e63a2d764848e58239466d7906e03abe30ff50e6444ccd
[0m17:56:29.297280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '847e666e-51a8-4c61-a3e7-c884cd6f6d68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77997573ebd0>]}
[0m17:56:30.524570 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m17:56:30.525290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '847e666e-51a8-4c61-a3e7-c884cd6f6d68', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779975768800>]}
[0m17:56:30.619261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '847e666e-51a8-4c61-a3e7-c884cd6f6d68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779968fbbda0>]}
[0m17:56:30.689880 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:56:30.691697 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:56:30.704399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '847e666e-51a8-4c61-a3e7-c884cd6f6d68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779974f39e80>]}
[0m17:56:30.704991 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m17:56:30.705475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '847e666e-51a8-4c61-a3e7-c884cd6f6d68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779968f9a600>]}
[0m17:56:30.707302 [info ] [MainThread]: 
[0m17:56:30.707802 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:56:30.708267 [info ] [MainThread]: 
[0m17:56:30.708885 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:56:30.709987 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m17:56:30.746902 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m17:56:30.747521 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m17:56:30.748145 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:56:30.838168 [debug] [ThreadPool]: SQL status: OK in 0.090 seconds
[0m17:56:30.839955 [debug] [ThreadPool]: On list_argus_vault: Close
[0m17:56:30.840877 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m17:56:30.841637 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m17:56:30.849465 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:56:30.849983 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m17:56:30.850435 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:56:30.852465 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m17:56:30.853933 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:56:30.854390 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m17:56:30.855063 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:56:30.855504 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:56:30.855960 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m17:56:30.856657 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:56:30.857627 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:56:30.858110 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:56:30.858540 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:56:30.859166 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:56:30.859632 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m17:56:30.865350 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m17:56:30.871296 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:56:30.871844 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m17:56:30.872321 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:56:30.873515 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:56:30.873991 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:56:30.874446 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m17:56:30.886262 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m17:56:30.887884 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m17:56:30.889231 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m17:56:30.889686 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m17:56:30.891330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '847e666e-51a8-4c61-a3e7-c884cd6f6d68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7799681e1a00>]}
[0m17:56:30.891992 [debug] [MainThread]: Using duckdb connection "master"
[0m17:56:30.892425 [debug] [MainThread]: On master: BEGIN
[0m17:56:30.892829 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:56:30.893829 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:56:30.894313 [debug] [MainThread]: On master: COMMIT
[0m17:56:30.894731 [debug] [MainThread]: Using duckdb connection "master"
[0m17:56:30.895170 [debug] [MainThread]: On master: COMMIT
[0m17:56:30.895857 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:56:30.896357 [debug] [MainThread]: On master: Close
[0m17:56:30.898447 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:56:30.899128 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m17:56:30.899696 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m17:56:30.900225 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m17:56:30.908596 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:56:30.909336 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m17:56:30.965833 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:56:30.966428 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201175630941310"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Fraud detected: anomalous PCA factors indicate suspicious transaction activity.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '9ef47ded-750c-4b47-ac2b-5a8dcfc5bcc0'
    );
  
  
  
[0m17:56:30.966939 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:56:30.976080 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m17:56:30.983715 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:56:30.984251 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m17:56:30.984954 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:56:30.985438 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:56:30.985905 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201175630941310'
      
      
      order by ordinal_position

  
[0m17:56:30.988405 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:56:30.993470 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:56:30.994012 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:56:30.997255 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:56:31.007429 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:56:31.007975 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:56:31.010331 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:56:31.011830 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:56:31.012352 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m17:56:31.013112 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:56:31.029479 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:56:31.030265 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:56:31.030772 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201175630941310"
    )
  
[0m17:56:31.031899 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:56:31.042204 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:56:31.042706 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:56:31.043193 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:56:31.057388 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m17:56:31.059330 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m17:56:31.061037 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '847e666e-51a8-4c61-a3e7-c884cd6f6d68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779968f4deb0>]}
[0m17:56:31.061791 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m17:56:31.062515 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:56:31.063956 [debug] [MainThread]: Using duckdb connection "master"
[0m17:56:31.064484 [debug] [MainThread]: On master: BEGIN
[0m17:56:31.064950 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:56:31.065870 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:56:31.066337 [debug] [MainThread]: On master: COMMIT
[0m17:56:31.066754 [debug] [MainThread]: Using duckdb connection "master"
[0m17:56:31.067183 [debug] [MainThread]: On master: COMMIT
[0m17:56:31.067778 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:56:31.068242 [debug] [MainThread]: On master: Close
[0m17:56:31.068734 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:56:31.069161 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m17:56:31.069578 [info ] [MainThread]: 
[0m17:56:31.070058 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m17:56:31.070834 [debug] [MainThread]: Command end result
[0m17:56:31.090356 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:56:31.092030 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:56:31.097635 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m17:56:31.098091 [info ] [MainThread]: 
[0m17:56:31.098604 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:56:31.099062 [info ] [MainThread]: 
[0m17:56:31.099526 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:56:31.100153 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:56:31.101201 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3838453, "process_in_blocks": "0", "process_kernel_time": 0.288213, "process_mem_max_rss": "281420", "process_out_blocks": "3112", "process_user_time": 4.345974}
[0m17:56:31.101783 [debug] [MainThread]: Command `dbt run` succeeded at 17:56:31.101682 after 2.38 seconds
[0m17:56:31.102277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779977f2e0c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779968f6f800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779974fc5eb0>]}
[0m17:56:31.102754 [debug] [MainThread]: Flushing usage events
[0m17:56:32.078809 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:56:47.637031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b7d8427cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b7d891f170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b7d83fa240>]}


============================== 17:56:47.640362 | 4f375e88-7b04-4887-bed9-bd71bdfc558b ==============================
[0m17:56:47.640362 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:56:47.641054 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "932ad6cd-3fca-4760-8f7e-091989327fed", "ai_explanation": "Fraud detected: extreme PCA scores indicate significant deviations from normal patterns."} --profiles-dir .', 'empty': 'False', 'write_json': 'True', 'profiles_dir': '.', 'warn_error': 'None', 'static_parser': 'True', 'indirect_selection': 'eager', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'log_format': 'default', 'partial_parse': 'True', 'fail_fast': 'False', 'printer_width': '80', 'log_cache_events': 'False', 'debug': 'False', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'no_print': 'None'}
[0m17:56:47.893358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f375e88-7b04-4887-bed9-bd71bdfc558b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b7d739f740>]}
[0m17:56:47.966035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f375e88-7b04-4887-bed9-bd71bdfc558b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b7d87f9fa0>]}
[0m17:56:47.967838 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:56:48.054342 [debug] [MainThread]: checksum: e66145d8c20892371925cf78f9f63c377d73faff9d4ce39718e642092c4e7b69, vars: {'ai_explanation': 'Fraud detected: extreme PCA scores indicate significant '
                   'deviations from normal patterns.',
 'txn_id': '932ad6cd-3fca-4760-8f7e-091989327fed'}, profile: , target: , version: 1.11.2
[0m17:56:48.147622 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:56:48.148255 [debug] [MainThread]: previous checksum: e66145d8c20892371925cf78f9f63c377d73faff9d4ce39718e642092c4e7b69, current checksum: 46aa2b3a347e7d3ca93974080ccad796385526669644f1bda9da52e057fcd758
[0m17:56:48.148713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4f375e88-7b04-4887-bed9-bd71bdfc558b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b7d7eeab40>]}
[0m17:56:49.421519 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m17:56:49.422213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4f375e88-7b04-4887-bed9-bd71bdfc558b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b7cb774da0>]}
[0m17:56:49.518158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f375e88-7b04-4887-bed9-bd71bdfc558b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b7c81b3020>]}
[0m17:56:49.589980 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:56:49.591818 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:56:49.604236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f375e88-7b04-4887-bed9-bd71bdfc558b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b7c8197620>]}
[0m17:56:49.604793 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m17:56:49.605282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f375e88-7b04-4887-bed9-bd71bdfc558b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b7d74ba6c0>]}
[0m17:56:49.607028 [info ] [MainThread]: 
[0m17:56:49.607515 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:56:49.607963 [info ] [MainThread]: 
[0m17:56:49.608577 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:56:49.609644 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m17:56:49.644737 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m17:56:49.645257 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m17:56:49.645705 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:56:49.736192 [debug] [ThreadPool]: SQL status: OK in 0.090 seconds
[0m17:56:49.737828 [debug] [ThreadPool]: On list_argus_vault: Close
[0m17:56:49.738696 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m17:56:49.739290 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m17:56:49.746493 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:56:49.746972 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m17:56:49.747394 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:56:49.748542 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:56:49.749832 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:56:49.750287 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m17:56:49.750869 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:56:49.751307 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:56:49.751706 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m17:56:49.752363 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:56:49.753280 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:56:49.753733 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:56:49.754165 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:56:49.754843 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:56:49.755302 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m17:56:49.760933 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m17:56:49.766707 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:56:49.767268 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m17:56:49.767675 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:56:49.768799 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:56:49.769262 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:56:49.769681 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m17:56:49.780832 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m17:56:49.782299 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m17:56:49.783585 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m17:56:49.784076 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m17:56:49.786128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f375e88-7b04-4887-bed9-bd71bdfc558b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b7c81c0fe0>]}
[0m17:56:49.786737 [debug] [MainThread]: Using duckdb connection "master"
[0m17:56:49.787221 [debug] [MainThread]: On master: BEGIN
[0m17:56:49.787631 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:56:49.788549 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:56:49.789094 [debug] [MainThread]: On master: COMMIT
[0m17:56:49.789597 [debug] [MainThread]: Using duckdb connection "master"
[0m17:56:49.790097 [debug] [MainThread]: On master: COMMIT
[0m17:56:49.790691 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:56:49.791176 [debug] [MainThread]: On master: Close
[0m17:56:49.793391 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:56:49.794045 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m17:56:49.794651 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m17:56:49.795166 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m17:56:49.803204 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:56:49.803932 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m17:56:49.860229 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:56:49.860884 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201175649835726"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Fraud detected: extreme PCA scores indicate significant deviations from normal patterns.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '932ad6cd-3fca-4760-8f7e-091989327fed'
    );
  
  
  
[0m17:56:49.861525 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:56:49.869624 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m17:56:49.877446 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:56:49.877981 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m17:56:49.878671 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:56:49.879170 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:56:49.879637 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201175649835726'
      
      
      order by ordinal_position

  
[0m17:56:49.882656 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:56:49.887717 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:56:49.888262 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:56:49.890844 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:56:49.900986 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:56:49.901495 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:56:49.903966 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:56:49.905469 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:56:49.905991 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m17:56:49.907040 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:56:49.923367 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:56:49.924171 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:56:49.924667 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201175649835726"
    )
  
[0m17:56:49.925986 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:56:49.936477 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:56:49.937023 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:56:49.937488 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:56:49.951425 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m17:56:49.953636 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m17:56:49.955433 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f375e88-7b04-4887-bed9-bd71bdfc558b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b7d85efe00>]}
[0m17:56:49.956236 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m17:56:49.956984 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:56:49.958608 [debug] [MainThread]: Using duckdb connection "master"
[0m17:56:49.959130 [debug] [MainThread]: On master: BEGIN
[0m17:56:49.959586 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:56:49.960711 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:56:49.961191 [debug] [MainThread]: On master: COMMIT
[0m17:56:49.961613 [debug] [MainThread]: Using duckdb connection "master"
[0m17:56:49.962043 [debug] [MainThread]: On master: COMMIT
[0m17:56:49.962644 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:56:49.963107 [debug] [MainThread]: On master: Close
[0m17:56:49.963604 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:56:49.964036 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m17:56:49.964474 [info ] [MainThread]: 
[0m17:56:49.964955 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m17:56:49.965734 [debug] [MainThread]: Command end result
[0m17:56:49.985273 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:56:49.987126 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:56:49.993096 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m17:56:49.993542 [info ] [MainThread]: 
[0m17:56:49.994095 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:56:49.994544 [info ] [MainThread]: 
[0m17:56:49.995036 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:56:49.995663 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:56:49.996730 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.4225924, "process_in_blocks": "0", "process_kernel_time": 0.322419, "process_mem_max_rss": "273708", "process_out_blocks": "3104", "process_user_time": 4.392838}
[0m17:56:49.997356 [debug] [MainThread]: Command `dbt run` succeeded at 17:56:49.997244 after 2.42 seconds
[0m17:56:49.997840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b7d8427cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b7dbd57d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b7cb6494f0>]}
[0m17:56:49.998384 [debug] [MainThread]: Flushing usage events
[0m17:56:50.976489 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:57:08.006006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708117579d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708117554d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708116f8b2c0>]}


============================== 17:57:08.009432 | 00826ecc-b5e4-4898-ac03-e539083841a3 ==============================
[0m17:57:08.009432 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:57:08.010109 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'log_format': 'default', 'debug': 'False', 'introspect': 'True', 'printer_width': '80', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '.', 'static_parser': 'True', 'write_json': 'True', 'empty': 'False', 'use_colors': 'True', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "6033db24-7396-4ac2-91a4-155c6dd0ef2a", "ai_explanation": "This transaction is flagged for fraud due to anomalous PCA scores (V3, V7, and V14) indicating manipulation."} --profiles-dir .', 'partial_parse': 'True', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'version_check': 'True', 'target_path': 'None', 'no_print': 'None', 'log_cache_events': 'False', 'indirect_selection': 'eager'}
[0m17:57:08.260533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '00826ecc-b5e4-4898-ac03-e539083841a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708116ca0290>]}
[0m17:57:08.331848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '00826ecc-b5e4-4898-ac03-e539083841a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70810b141a30>]}
[0m17:57:08.333660 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:57:08.419458 [debug] [MainThread]: checksum: 4b453683b3632418c7bdafed101d16bb12931a7df9b8552696d13796d54e4545, vars: {'ai_explanation': 'This transaction is flagged for fraud due to anomalous PCA '
                   'scores (V3, V7, and V14) indicating manipulation.',
 'txn_id': '6033db24-7396-4ac2-91a4-155c6dd0ef2a'}, profile: , target: , version: 1.11.2
[0m17:57:08.514079 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:57:08.514680 [debug] [MainThread]: previous checksum: 4b453683b3632418c7bdafed101d16bb12931a7df9b8552696d13796d54e4545, current checksum: e66145d8c20892371925cf78f9f63c377d73faff9d4ce39718e642092c4e7b69
[0m17:57:08.515159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '00826ecc-b5e4-4898-ac03-e539083841a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708116d08b00>]}
[0m17:57:09.733429 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m17:57:09.734115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '00826ecc-b5e4-4898-ac03-e539083841a3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708116d3af60>]}
[0m17:57:09.825258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '00826ecc-b5e4-4898-ac03-e539083841a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7081081b70e0>]}
[0m17:57:09.893413 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:57:09.895122 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:57:09.907225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '00826ecc-b5e4-4898-ac03-e539083841a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70810afd1040>]}
[0m17:57:09.907773 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m17:57:09.908263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00826ecc-b5e4-4898-ac03-e539083841a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7081081de3c0>]}
[0m17:57:09.909987 [info ] [MainThread]: 
[0m17:57:09.910476 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:57:09.910900 [info ] [MainThread]: 
[0m17:57:09.911510 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:57:09.912559 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m17:57:09.947858 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m17:57:09.948364 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m17:57:09.948802 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:57:10.037338 [debug] [ThreadPool]: SQL status: OK in 0.088 seconds
[0m17:57:10.038994 [debug] [ThreadPool]: On list_argus_vault: Close
[0m17:57:10.039815 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m17:57:10.040416 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m17:57:10.047684 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:57:10.048206 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m17:57:10.048621 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:57:10.049782 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:57:10.051113 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:57:10.051546 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m17:57:10.052183 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:57:10.052614 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:57:10.053050 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m17:57:10.053668 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:57:10.054589 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:57:10.055045 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:57:10.055465 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:57:10.056128 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:57:10.056561 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m17:57:10.062130 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m17:57:10.067850 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:57:10.068433 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m17:57:10.068834 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:57:10.069683 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:57:10.070135 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:57:10.070548 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m17:57:10.081446 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m17:57:10.082836 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m17:57:10.084129 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m17:57:10.084565 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m17:57:10.086092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00826ecc-b5e4-4898-ac03-e539083841a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7081081dc380>]}
[0m17:57:10.086691 [debug] [MainThread]: Using duckdb connection "master"
[0m17:57:10.087141 [debug] [MainThread]: On master: BEGIN
[0m17:57:10.087594 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:57:10.088459 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:57:10.088894 [debug] [MainThread]: On master: COMMIT
[0m17:57:10.089338 [debug] [MainThread]: Using duckdb connection "master"
[0m17:57:10.089734 [debug] [MainThread]: On master: COMMIT
[0m17:57:10.090399 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:57:10.090827 [debug] [MainThread]: On master: Close
[0m17:57:10.092971 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:57:10.093666 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m17:57:10.094297 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m17:57:10.094783 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m17:57:10.102740 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:57:10.103463 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m17:57:10.161989 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:57:10.162587 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201175710136976"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'This transaction is flagged for fraud due to anomalous PCA scores (V3, V7, and V14) indicating manipulation.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '6033db24-7396-4ac2-91a4-155c6dd0ef2a'
    );
  
  
  
[0m17:57:10.163104 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:57:10.172329 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m17:57:10.180168 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:57:10.180680 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m17:57:10.181406 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:57:10.181876 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:57:10.182366 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201175710136976'
      
      
      order by ordinal_position

  
[0m17:57:10.184868 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:57:10.189789 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:57:10.190316 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:57:10.192738 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:57:10.202747 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:57:10.203276 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:57:10.206444 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:57:10.207942 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:57:10.208449 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m17:57:10.209221 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:57:10.225438 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:57:10.226212 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:57:10.226708 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201175710136976"
    )
  
[0m17:57:10.228119 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:57:10.238535 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:57:10.239055 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:57:10.239520 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:57:10.252866 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m17:57:10.254883 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m17:57:10.256633 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00826ecc-b5e4-4898-ac03-e539083841a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70810ad4fce0>]}
[0m17:57:10.257412 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m17:57:10.258153 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:57:10.259593 [debug] [MainThread]: Using duckdb connection "master"
[0m17:57:10.260085 [debug] [MainThread]: On master: BEGIN
[0m17:57:10.260495 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:57:10.261402 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:57:10.261840 [debug] [MainThread]: On master: COMMIT
[0m17:57:10.262278 [debug] [MainThread]: Using duckdb connection "master"
[0m17:57:10.262674 [debug] [MainThread]: On master: COMMIT
[0m17:57:10.263285 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:57:10.263763 [debug] [MainThread]: On master: Close
[0m17:57:10.264300 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:57:10.264714 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m17:57:10.265189 [info ] [MainThread]: 
[0m17:57:10.265637 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m17:57:10.266427 [debug] [MainThread]: Command end result
[0m17:57:10.285405 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:57:10.287041 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:57:10.292705 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m17:57:10.293166 [info ] [MainThread]: 
[0m17:57:10.293681 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:57:10.294146 [info ] [MainThread]: 
[0m17:57:10.294610 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:57:10.295249 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:57:10.296319 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.354306, "process_in_blocks": "0", "process_kernel_time": 0.316601, "process_mem_max_rss": "277808", "process_out_blocks": "3112", "process_user_time": 4.304391}
[0m17:57:10.296936 [debug] [MainThread]: Command `dbt run` succeeded at 17:57:10.296816 after 2.36 seconds
[0m17:57:10.297418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708116dc7950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708116e10170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708116e13da0>]}
[0m17:57:10.297902 [debug] [MainThread]: Flushing usage events
[0m17:57:11.300953 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:57:28.478839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7463efc434a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7463ef107da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7463efc42810>]}


============================== 17:57:28.482286 | 3fe46ed3-9f12-4bf0-bbfc-3785ad420e2e ==============================
[0m17:57:28.482286 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:57:28.482974 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'use_experimental_parser': 'False', 'write_json': 'True', 'version_check': 'True', 'static_parser': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'debug': 'False', 'partial_parse': 'True', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'profiles_dir': '.', 'log_format': 'default', 'quiet': 'False', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'target_path': 'None', 'introspect': 'True', 'no_print': 'None', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "80ce6e78-0718-494d-a163-e26bd84cc630", "ai_explanation": "The transaction is fraudulent due to extremely negative PCA scores (V1: -3.6, V7: -9.94, etc.)."} --profiles-dir .', 'use_colors': 'True'}
[0m17:57:28.739785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3fe46ed3-9f12-4bf0-bbfc-3785ad420e2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7463e352f3e0>]}
[0m17:57:28.810827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3fe46ed3-9f12-4bf0-bbfc-3785ad420e2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7463f17b4740>]}
[0m17:57:28.812535 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:57:28.897762 [debug] [MainThread]: checksum: f398311e9bb0cdd77c42fd8552e436d38736bcfe5d0d1504009f53d3774b7ca9, vars: {'ai_explanation': 'The transaction is fraudulent due to extremely negative '
                   'PCA scores (V1: -3.6, V7: -9.94, etc.).',
 'txn_id': '80ce6e78-0718-494d-a163-e26bd84cc630'}, profile: , target: , version: 1.11.2
[0m17:57:28.991930 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:57:28.992514 [debug] [MainThread]: previous checksum: f398311e9bb0cdd77c42fd8552e436d38736bcfe5d0d1504009f53d3774b7ca9, current checksum: 4b453683b3632418c7bdafed101d16bb12931a7df9b8552696d13796d54e4545
[0m17:57:28.992992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3fe46ed3-9f12-4bf0-bbfc-3785ad420e2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7463e32a1e20>]}
[0m17:57:30.236880 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m17:57:30.237564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3fe46ed3-9f12-4bf0-bbfc-3785ad420e2e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7463e0160230>]}
[0m17:57:30.329750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3fe46ed3-9f12-4bf0-bbfc-3785ad420e2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7463e015f7a0>]}
[0m17:57:30.399871 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:57:30.401661 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:57:30.414048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3fe46ed3-9f12-4bf0-bbfc-3785ad420e2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74638afbc620>]}
[0m17:57:30.414603 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m17:57:30.415089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fe46ed3-9f12-4bf0-bbfc-3785ad420e2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7463e013e120>]}
[0m17:57:30.416804 [info ] [MainThread]: 
[0m17:57:30.417308 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:57:30.417730 [info ] [MainThread]: 
[0m17:57:30.418357 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:57:30.419362 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m17:57:30.455225 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m17:57:30.455747 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m17:57:30.456226 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:57:30.544862 [debug] [ThreadPool]: SQL status: OK in 0.089 seconds
[0m17:57:30.546625 [debug] [ThreadPool]: On list_argus_vault: Close
[0m17:57:30.547515 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m17:57:30.548110 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m17:57:30.555411 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:57:30.555872 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m17:57:30.556312 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:57:30.557501 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:57:30.558799 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:57:30.559245 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m17:57:30.559835 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:57:30.560279 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:57:30.560678 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m17:57:30.561383 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:57:30.562317 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:57:30.562751 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:57:30.563179 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:57:30.563836 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:57:30.564306 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m17:57:30.569879 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m17:57:30.575783 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:57:30.576335 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m17:57:30.576730 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:57:30.577609 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:57:30.578066 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:57:30.578476 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m17:57:30.589275 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m17:57:30.590674 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m17:57:30.591925 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m17:57:30.592363 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m17:57:30.593830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fe46ed3-9f12-4bf0-bbfc-3785ad420e2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7463e01e3d10>]}
[0m17:57:30.594441 [debug] [MainThread]: Using duckdb connection "master"
[0m17:57:30.594877 [debug] [MainThread]: On master: BEGIN
[0m17:57:30.595317 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:57:30.596186 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:57:30.596639 [debug] [MainThread]: On master: COMMIT
[0m17:57:30.597101 [debug] [MainThread]: Using duckdb connection "master"
[0m17:57:30.597517 [debug] [MainThread]: On master: COMMIT
[0m17:57:30.598133 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:57:30.598572 [debug] [MainThread]: On master: Close
[0m17:57:30.600579 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:57:30.601223 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m17:57:30.601779 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m17:57:30.602289 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m17:57:30.610281 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:57:30.611000 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m17:57:30.666833 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:57:30.667400 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201175730642704"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'The transaction is fraudulent due to extremely negative PCA scores (V1: -3.6, V7: -9.94, etc.).' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '80ce6e78-0718-494d-a163-e26bd84cc630'
    );
  
  
  
[0m17:57:30.667887 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:57:30.677887 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m17:57:30.685788 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:57:30.686329 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m17:57:30.687348 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:57:30.687826 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:57:30.688315 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201175730642704'
      
      
      order by ordinal_position

  
[0m17:57:30.691287 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:57:30.696459 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:57:30.697000 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:57:30.699572 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:57:30.709952 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:57:30.710477 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:57:30.713272 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:57:30.714806 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:57:30.715326 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m17:57:30.716136 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:57:30.732342 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:57:30.733133 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:57:30.733624 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201175730642704"
    )
  
[0m17:57:30.734737 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:57:30.745038 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:57:30.745544 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:57:30.746018 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:57:30.761938 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m17:57:30.763871 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m17:57:30.765593 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fe46ed3-9f12-4bf0-bbfc-3785ad420e2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7463f1cb1340>]}
[0m17:57:30.766351 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m17:57:30.767073 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:57:30.768705 [debug] [MainThread]: Using duckdb connection "master"
[0m17:57:30.769249 [debug] [MainThread]: On master: BEGIN
[0m17:57:30.769716 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:57:30.770677 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:57:30.771150 [debug] [MainThread]: On master: COMMIT
[0m17:57:30.771566 [debug] [MainThread]: Using duckdb connection "master"
[0m17:57:30.772015 [debug] [MainThread]: On master: COMMIT
[0m17:57:30.772611 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:57:30.773067 [debug] [MainThread]: On master: Close
[0m17:57:30.773552 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:57:30.773969 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m17:57:30.774400 [info ] [MainThread]: 
[0m17:57:30.774852 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m17:57:30.775640 [debug] [MainThread]: Command end result
[0m17:57:30.794693 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:57:30.796314 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:57:30.801998 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m17:57:30.802433 [info ] [MainThread]: 
[0m17:57:30.802960 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:57:30.803405 [info ] [MainThread]: 
[0m17:57:30.803862 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:57:30.804499 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:57:30.805528 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3900058, "process_in_blocks": "0", "process_kernel_time": 0.286866, "process_mem_max_rss": "274960", "process_out_blocks": "3104", "process_user_time": 4.336627}
[0m17:57:30.806139 [debug] [MainThread]: Command `dbt run` succeeded at 17:57:30.806035 after 2.39 seconds
[0m17:57:30.806646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7463f3853d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7463ef2768a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7463eefcb440>]}
[0m17:57:30.807153 [debug] [MainThread]: Flushing usage events
[0m17:57:31.781780 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:57:48.990841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bf8e3ce900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bf8db45550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bf8db45d30>]}


============================== 17:57:48.994217 | 1dc7fadb-e7c1-4ac2-92c5-f54f01969bc5 ==============================
[0m17:57:48.994217 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:57:48.994892 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'static_parser': 'True', 'debug': 'False', 'profiles_dir': '.', 'empty': 'False', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'warn_error': 'None', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "36ebc0a3-4d7b-481d-8b7c-ce38f76c7d8d", "ai_explanation": "Based on PCA factors, this transaction is fraud due to significant V1 (-4.5956) and V10 (-11.1413) scores."} --profiles-dir .', 'use_colors': 'True', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'use_experimental_parser': 'False', 'quiet': 'False', 'version_check': 'True', 'indirect_selection': 'eager', 'no_print': 'None', 'printer_width': '80', 'write_json': 'True'}
[0m17:57:49.239314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1dc7fadb-e7c1-4ac2-92c5-f54f01969bc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bf8d187740>]}
[0m17:57:49.310130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1dc7fadb-e7c1-4ac2-92c5-f54f01969bc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bf8d4501d0>]}
[0m17:57:49.311789 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:57:49.396696 [debug] [MainThread]: checksum: 165fe54175b20e6f2e10daa0de93f4e5f1bdd4d580ba0602bdfb85ac3e279314, vars: {'ai_explanation': 'Based on PCA factors, this transaction is fraud due to '
                   'significant V1 (-4.5956) and V10 (-11.1413) scores.',
 'txn_id': '36ebc0a3-4d7b-481d-8b7c-ce38f76c7d8d'}, profile: , target: , version: 1.11.2
[0m17:57:49.489248 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:57:49.489827 [debug] [MainThread]: previous checksum: 165fe54175b20e6f2e10daa0de93f4e5f1bdd4d580ba0602bdfb85ac3e279314, current checksum: f398311e9bb0cdd77c42fd8552e436d38736bcfe5d0d1504009f53d3774b7ca9
[0m17:57:49.490316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1dc7fadb-e7c1-4ac2-92c5-f54f01969bc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bf8dd169c0>]}
[0m17:57:50.708571 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m17:57:50.709255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1dc7fadb-e7c1-4ac2-92c5-f54f01969bc5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bf8138a9f0>]}
[0m17:57:50.801391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1dc7fadb-e7c1-4ac2-92c5-f54f01969bc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bf801dd100>]}
[0m17:57:50.870242 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:57:50.871938 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:57:50.884041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1dc7fadb-e7c1-4ac2-92c5-f54f01969bc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bf8000bd40>]}
[0m17:57:50.884592 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m17:57:50.885076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1dc7fadb-e7c1-4ac2-92c5-f54f01969bc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bf815801d0>]}
[0m17:57:50.886791 [info ] [MainThread]: 
[0m17:57:50.887297 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:57:50.887719 [info ] [MainThread]: 
[0m17:57:50.888335 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:57:50.889371 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m17:57:50.925246 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m17:57:50.925744 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m17:57:50.926218 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:57:51.014133 [debug] [ThreadPool]: SQL status: OK in 0.088 seconds
[0m17:57:51.015793 [debug] [ThreadPool]: On list_argus_vault: Close
[0m17:57:51.016677 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m17:57:51.017379 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m17:57:51.024933 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:57:51.025398 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m17:57:51.025813 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:57:51.027320 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:57:51.028668 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:57:51.029121 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m17:57:51.029754 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:57:51.030206 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:57:51.030607 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m17:57:51.031254 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:57:51.032190 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:57:51.032626 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:57:51.033048 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:57:51.033646 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:57:51.034103 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m17:57:51.039747 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m17:57:51.045728 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:57:51.046315 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m17:57:51.046764 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:57:51.047994 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:57:51.048458 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:57:51.048936 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m17:57:51.060025 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m17:57:51.061569 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m17:57:51.062869 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m17:57:51.063360 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m17:57:51.065109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1dc7fadb-e7c1-4ac2-92c5-f54f01969bc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bf81314dd0>]}
[0m17:57:51.065797 [debug] [MainThread]: Using duckdb connection "master"
[0m17:57:51.066325 [debug] [MainThread]: On master: BEGIN
[0m17:57:51.066800 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:57:51.067865 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:57:51.068403 [debug] [MainThread]: On master: COMMIT
[0m17:57:51.068821 [debug] [MainThread]: Using duckdb connection "master"
[0m17:57:51.069246 [debug] [MainThread]: On master: COMMIT
[0m17:57:51.069960 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:57:51.070447 [debug] [MainThread]: On master: Close
[0m17:57:51.072686 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:57:51.073442 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m17:57:51.074113 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m17:57:51.074630 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m17:57:51.082853 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:57:51.083615 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m17:57:51.140062 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:57:51.140615 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201175751115638"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Based on PCA factors, this transaction is fraud due to significant V1 (-4.5956) and V10 (-11.1413) scores.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '36ebc0a3-4d7b-481d-8b7c-ce38f76c7d8d'
    );
  
  
  
[0m17:57:51.141133 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:57:51.149358 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m17:57:51.156848 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:57:51.157366 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m17:57:51.158274 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:57:51.158754 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:57:51.159260 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201175751115638'
      
      
      order by ordinal_position

  
[0m17:57:51.161886 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:57:51.166841 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:57:51.167368 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:57:51.169778 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:57:51.179747 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:57:51.180278 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:57:51.182664 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:57:51.184172 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:57:51.184666 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m17:57:51.185473 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:57:51.201691 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:57:51.202488 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:57:51.203000 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201175751115638"
    )
  
[0m17:57:51.204491 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:57:51.214967 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:57:51.215474 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:57:51.215972 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:57:51.229981 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m17:57:51.231898 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m17:57:51.233644 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dc7fadb-e7c1-4ac2-92c5-f54f01969bc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bf81465610>]}
[0m17:57:51.234415 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m17:57:51.235144 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:57:51.236549 [debug] [MainThread]: Using duckdb connection "master"
[0m17:57:51.237084 [debug] [MainThread]: On master: BEGIN
[0m17:57:51.237523 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:57:51.238435 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:57:51.238873 [debug] [MainThread]: On master: COMMIT
[0m17:57:51.239309 [debug] [MainThread]: Using duckdb connection "master"
[0m17:57:51.239705 [debug] [MainThread]: On master: COMMIT
[0m17:57:51.240306 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:57:51.240732 [debug] [MainThread]: On master: Close
[0m17:57:51.241244 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:57:51.241637 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m17:57:51.242069 [info ] [MainThread]: 
[0m17:57:51.242510 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m17:57:51.243274 [debug] [MainThread]: Command end result
[0m17:57:51.262149 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:57:51.263776 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:57:51.269434 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m17:57:51.269870 [info ] [MainThread]: 
[0m17:57:51.270406 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:57:51.270843 [info ] [MainThread]: 
[0m17:57:51.271326 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:57:51.271953 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:57:51.272988 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3441508, "process_in_blocks": "0", "process_kernel_time": 0.294583, "process_mem_max_rss": "277828", "process_out_blocks": "3104", "process_user_time": 4.280879}
[0m17:57:51.273560 [debug] [MainThread]: Command `dbt run` succeeded at 17:57:51.273460 after 2.34 seconds
[0m17:57:51.274040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bf8e3ce900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bf8f276b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bf8e23ce30>]}
[0m17:57:51.274530 [debug] [MainThread]: Flushing usage events
[0m17:57:52.306239 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:58:07.522902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796104344230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79610525c170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796106434620>]}


============================== 17:58:07.526358 | 05bc0005-453b-4847-b12c-4c3643e37272 ==============================
[0m17:58:07.526358 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:58:07.527029 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'write_json': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'warn_error': 'None', 'empty': 'False', 'use_colors': 'True', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "26ac4d54-0e0e-4e66-b57f-2c36fea9e201", "ai_explanation": "The transaction exhibits significantly high PCA scores, indicating a high likelihood of fraud."} --profiles-dir .', 'fail_fast': 'False', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'version_check': 'True', 'partial_parse': 'True', 'no_print': 'None', 'log_format': 'default', 'debug': 'False', 'printer_width': '80', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'static_parser': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'introspect': 'True'}
[0m17:58:07.771628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '05bc0005-453b-4847-b12c-4c3643e37272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7961035636e0>]}
[0m17:58:07.842101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '05bc0005-453b-4847-b12c-4c3643e37272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7961061c91f0>]}
[0m17:58:07.843784 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:58:07.928410 [debug] [MainThread]: checksum: d7a90e4e4a38aedf96803ac90df6ea2f8b23629c94fa2e6630a4775f1f0eb42e, vars: {'ai_explanation': 'The transaction exhibits significantly high PCA scores, '
                   'indicating a high likelihood of fraud.',
 'txn_id': '26ac4d54-0e0e-4e66-b57f-2c36fea9e201'}, profile: , target: , version: 1.11.2
[0m17:58:08.021247 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:58:08.021831 [debug] [MainThread]: previous checksum: d7a90e4e4a38aedf96803ac90df6ea2f8b23629c94fa2e6630a4775f1f0eb42e, current checksum: 165fe54175b20e6f2e10daa0de93f4e5f1bdd4d580ba0602bdfb85ac3e279314
[0m17:58:08.022336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '05bc0005-453b-4847-b12c-4c3643e37272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7960f78b2510>]}
[0m17:58:09.251013 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m17:58:09.251684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '05bc0005-453b-4847-b12c-4c3643e37272', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79610465c080>]}
[0m17:58:09.343402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '05bc0005-453b-4847-b12c-4c3643e37272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7960f578de80>]}
[0m17:58:09.411719 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:58:09.413409 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:58:09.425574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '05bc0005-453b-4847-b12c-4c3643e37272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7960f57ff260>]}
[0m17:58:09.426148 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m17:58:09.426623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05bc0005-453b-4847-b12c-4c3643e37272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7961035e2390>]}
[0m17:58:09.428372 [info ] [MainThread]: 
[0m17:58:09.428860 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:58:09.429324 [info ] [MainThread]: 
[0m17:58:09.429941 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:58:09.430993 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m17:58:09.466356 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m17:58:09.466903 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m17:58:09.467355 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:58:09.553499 [debug] [ThreadPool]: SQL status: OK in 0.086 seconds
[0m17:58:09.555197 [debug] [ThreadPool]: On list_argus_vault: Close
[0m17:58:09.556099 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m17:58:09.556667 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m17:58:09.563957 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:58:09.564424 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m17:58:09.564853 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:58:09.566043 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:58:09.567376 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:58:09.567813 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m17:58:09.568483 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:58:09.568907 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:58:09.569344 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m17:58:09.570055 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:58:09.571007 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:58:09.571455 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:58:09.571867 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:58:09.572580 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:58:09.573049 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m17:58:09.578753 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m17:58:09.584655 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:58:09.585225 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m17:58:09.585637 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:58:09.586565 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:58:09.587024 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:58:09.587441 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m17:58:09.598654 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m17:58:09.600372 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m17:58:09.601686 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m17:58:09.602155 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m17:58:09.603723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05bc0005-453b-4847-b12c-4c3643e37272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7960f57fe180>]}
[0m17:58:09.604374 [debug] [MainThread]: Using duckdb connection "master"
[0m17:58:09.604867 [debug] [MainThread]: On master: BEGIN
[0m17:58:09.605346 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:58:09.606330 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:58:09.606766 [debug] [MainThread]: On master: COMMIT
[0m17:58:09.607216 [debug] [MainThread]: Using duckdb connection "master"
[0m17:58:09.607615 [debug] [MainThread]: On master: COMMIT
[0m17:58:09.608241 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:58:09.608671 [debug] [MainThread]: On master: Close
[0m17:58:09.610713 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:58:09.611399 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m17:58:09.612002 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m17:58:09.612492 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m17:58:09.620655 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:58:09.621394 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m17:58:09.679689 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:58:09.680280 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201175809654520"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'The transaction exhibits significantly high PCA scores, indicating a high likelihood of fraud.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '26ac4d54-0e0e-4e66-b57f-2c36fea9e201'
    );
  
  
  
[0m17:58:09.680768 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:58:09.688721 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m17:58:09.696197 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:58:09.696706 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m17:58:09.697396 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:58:09.697874 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:58:09.698363 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201175809654520'
      
      
      order by ordinal_position

  
[0m17:58:09.701507 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:58:09.706476 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:58:09.707039 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:58:09.710426 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:58:09.720626 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:58:09.721170 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:58:09.723596 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:58:09.725120 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:58:09.725627 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m17:58:09.726862 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:58:09.743167 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:58:09.743949 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:58:09.744449 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201175809654520"
    )
  
[0m17:58:09.745884 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:58:09.757276 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:58:09.757789 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:58:09.758279 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:58:09.771709 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m17:58:09.773820 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m17:58:09.775553 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05bc0005-453b-4847-b12c-4c3643e37272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79610472be00>]}
[0m17:58:09.776325 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m17:58:09.777059 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:58:09.778900 [debug] [MainThread]: Using duckdb connection "master"
[0m17:58:09.779431 [debug] [MainThread]: On master: BEGIN
[0m17:58:09.779878 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:58:09.780818 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:58:09.781281 [debug] [MainThread]: On master: COMMIT
[0m17:58:09.781697 [debug] [MainThread]: Using duckdb connection "master"
[0m17:58:09.782159 [debug] [MainThread]: On master: COMMIT
[0m17:58:09.782779 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:58:09.783270 [debug] [MainThread]: On master: Close
[0m17:58:09.783761 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:58:09.784209 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m17:58:09.784631 [info ] [MainThread]: 
[0m17:58:09.785120 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m17:58:09.785891 [debug] [MainThread]: Command end result
[0m17:58:09.804892 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:58:09.806540 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:58:09.812230 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m17:58:09.812691 [info ] [MainThread]: 
[0m17:58:09.813235 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:58:09.813684 [info ] [MainThread]: 
[0m17:58:09.814172 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:58:09.814794 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:58:09.815849 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.358231, "process_in_blocks": "0", "process_kernel_time": 0.308928, "process_mem_max_rss": "280504", "process_out_blocks": "3104", "process_user_time": 4.278614}
[0m17:58:09.816485 [debug] [MainThread]: Command `dbt run` succeeded at 17:58:09.816381 after 2.36 seconds
[0m17:58:09.817001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796104344230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7960f77f4680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796103562720>]}
[0m17:58:09.817495 [debug] [MainThread]: Flushing usage events
[0m17:58:10.816467 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:58:26.383041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718513968e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718510b39400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71850fea2720>]}


============================== 17:58:26.386437 | bcf02f6a-fed3-4ae2-9dfd-b320949903a5 ==============================
[0m17:58:26.386437 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:58:26.387139 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '.', 'use_experimental_parser': 'False', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'indirect_selection': 'eager', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'introspect': 'True', 'warn_error': 'None', 'quiet': 'False', 'log_format': 'default', 'version_check': 'True', 'fail_fast': 'False', 'debug': 'False', 'empty': 'False', 'static_parser': 'True', 'use_colors': 'True', 'printer_width': '80', 'no_print': 'None', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "d673793b-5ad7-4c4a-92a2-b07703055095", "ai_explanation": "This transaction is flagged for fraud due to anomalous PCA scores (all negative)."} --profiles-dir .', 'cache_selected_only': 'False', 'partial_parse': 'True'}
[0m17:58:26.638723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bcf02f6a-fed3-4ae2-9dfd-b320949903a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71850fc52420>]}
[0m17:58:26.710021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bcf02f6a-fed3-4ae2-9dfd-b320949903a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718511027a40>]}
[0m17:58:26.711711 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:58:26.795317 [debug] [MainThread]: checksum: 6be208c5cbebb8007a928a14601206cfd36d4990bbda64442604ecd184b0e440, vars: {'ai_explanation': 'This transaction is flagged for fraud due to anomalous PCA '
                   'scores (all negative).',
 'txn_id': 'd673793b-5ad7-4c4a-92a2-b07703055095'}, profile: , target: , version: 1.11.2
[0m17:58:26.888502 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:58:26.889126 [debug] [MainThread]: previous checksum: 6be208c5cbebb8007a928a14601206cfd36d4990bbda64442604ecd184b0e440, current checksum: d7a90e4e4a38aedf96803ac90df6ea2f8b23629c94fa2e6630a4775f1f0eb42e
[0m17:58:26.889587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bcf02f6a-fed3-4ae2-9dfd-b320949903a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71850fe058e0>]}
[0m17:58:28.122569 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m17:58:28.123273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bcf02f6a-fed3-4ae2-9dfd-b320949903a5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718503d91280>]}
[0m17:58:28.216258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bcf02f6a-fed3-4ae2-9dfd-b320949903a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718503d800e0>]}
[0m17:58:28.286090 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:58:28.287869 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:58:28.300331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bcf02f6a-fed3-4ae2-9dfd-b320949903a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7184c3a84200>]}
[0m17:58:28.300892 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m17:58:28.301408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcf02f6a-fed3-4ae2-9dfd-b320949903a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718503db7f20>]}
[0m17:58:28.303168 [info ] [MainThread]: 
[0m17:58:28.303653 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:58:28.304107 [info ] [MainThread]: 
[0m17:58:28.304706 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:58:28.305759 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m17:58:28.341078 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m17:58:28.341568 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m17:58:28.342015 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:58:28.426862 [debug] [ThreadPool]: SQL status: OK in 0.085 seconds
[0m17:58:28.428575 [debug] [ThreadPool]: On list_argus_vault: Close
[0m17:58:28.429504 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m17:58:28.430105 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m17:58:28.437396 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:58:28.437854 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m17:58:28.438296 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:58:28.439428 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:58:28.440737 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:58:28.441190 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m17:58:28.441794 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:58:28.442244 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:58:28.442644 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m17:58:28.443284 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:58:28.444215 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:58:28.444648 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:58:28.445072 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:58:28.445666 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:58:28.446122 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m17:58:28.451800 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m17:58:28.457495 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:58:28.458040 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m17:58:28.458454 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:58:28.459310 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:58:28.459744 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:58:28.460190 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m17:58:28.470716 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m17:58:28.472130 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m17:58:28.473377 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m17:58:28.473810 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m17:58:28.475536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcf02f6a-fed3-4ae2-9dfd-b320949903a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7184c3a1c5c0>]}
[0m17:58:28.476109 [debug] [MainThread]: Using duckdb connection "master"
[0m17:58:28.476529 [debug] [MainThread]: On master: BEGIN
[0m17:58:28.476978 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:58:28.477903 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:58:28.478357 [debug] [MainThread]: On master: COMMIT
[0m17:58:28.478760 [debug] [MainThread]: Using duckdb connection "master"
[0m17:58:28.479174 [debug] [MainThread]: On master: COMMIT
[0m17:58:28.479851 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:58:28.480304 [debug] [MainThread]: On master: Close
[0m17:58:28.482354 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:58:28.483012 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m17:58:28.483574 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m17:58:28.484069 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m17:58:28.492311 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:58:28.493034 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m17:58:28.550251 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:58:28.550868 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201175828525477"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'This transaction is flagged for fraud due to anomalous PCA scores (all negative).' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = 'd673793b-5ad7-4c4a-92a2-b07703055095'
    );
  
  
  
[0m17:58:28.551381 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:58:28.560339 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m17:58:28.568311 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:58:28.568833 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m17:58:28.569535 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:58:28.570024 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:58:28.570491 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201175828525477'
      
      
      order by ordinal_position

  
[0m17:58:28.573376 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:58:28.578445 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:58:28.578979 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:58:28.581415 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:58:28.591546 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:58:28.592079 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:58:28.594613 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:58:28.596130 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:58:28.596626 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m17:58:28.597398 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:58:28.613799 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:58:28.614571 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:58:28.615072 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201175828525477"
    )
  
[0m17:58:28.616535 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:58:28.627000 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:58:28.627511 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:58:28.627990 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:58:28.640853 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m17:58:28.642817 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m17:58:28.644578 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcf02f6a-fed3-4ae2-9dfd-b320949903a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718501d6b1d0>]}
[0m17:58:28.645338 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m17:58:28.646071 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:58:28.647575 [debug] [MainThread]: Using duckdb connection "master"
[0m17:58:28.648106 [debug] [MainThread]: On master: BEGIN
[0m17:58:28.648538 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:58:28.649706 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:58:28.650185 [debug] [MainThread]: On master: COMMIT
[0m17:58:28.650597 [debug] [MainThread]: Using duckdb connection "master"
[0m17:58:28.651025 [debug] [MainThread]: On master: COMMIT
[0m17:58:28.651632 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:58:28.652090 [debug] [MainThread]: On master: Close
[0m17:58:28.652593 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:58:28.653012 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m17:58:28.653438 [info ] [MainThread]: 
[0m17:58:28.653879 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m17:58:28.654646 [debug] [MainThread]: Command end result
[0m17:58:28.675507 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:58:28.677238 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:58:28.683043 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m17:58:28.683503 [info ] [MainThread]: 
[0m17:58:28.684065 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:58:28.684530 [info ] [MainThread]: 
[0m17:58:28.685043 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:58:28.685685 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:58:28.686773 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3672328, "process_in_blocks": "0", "process_kernel_time": 0.281404, "process_mem_max_rss": "279252", "process_out_blocks": "3104", "process_user_time": 4.321145}
[0m17:58:28.687396 [debug] [MainThread]: Command `dbt run` succeeded at 17:58:28.687290 after 2.37 seconds
[0m17:58:28.687890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718510b79d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718510b78b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7184c2ec4d70>]}
[0m17:58:28.688414 [debug] [MainThread]: Flushing usage events
[0m17:58:29.663907 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:58:45.480210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea95df70da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea95e1c8380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea95dc867b0>]}


============================== 17:58:45.483635 | 4a3c5de9-c4ce-4822-bda6-e7065511f45a ==============================
[0m17:58:45.483635 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:58:45.484319 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'profiles_dir': '.', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'empty': 'False', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "4f78ba2c-af84-43cc-ac3c-0b7feb65e45f", "ai_explanation": " txn is flagged as fraud due to significantly anomalous PCA factors (V7-V17)."} --profiles-dir .', 'printer_width': '80', 'version_check': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'introspect': 'True', 'no_print': 'None', 'fail_fast': 'False', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'partial_parse': 'True', 'use_colors': 'True', 'static_parser': 'True', 'cache_selected_only': 'False', 'quiet': 'False', 'target_path': 'None', 'debug': 'False'}
[0m17:58:45.729924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a3c5de9-c4ce-4822-bda6-e7065511f45a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea951f8af60>]}
[0m17:58:45.800282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4a3c5de9-c4ce-4822-bda6-e7065511f45a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea95e926060>]}
[0m17:58:45.802039 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:58:45.886304 [debug] [MainThread]: checksum: 70da50751fb95521e9cead55fdd9ae3bd18f7b2cbc2b8301b5807edf0fc19ea5, vars: {'ai_explanation': ' txn is flagged as fraud due to significantly anomalous '
                   'PCA factors (V7-V17).',
 'txn_id': '4f78ba2c-af84-43cc-ac3c-0b7feb65e45f'}, profile: , target: , version: 1.11.2
[0m17:58:45.978342 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:58:45.978959 [debug] [MainThread]: previous checksum: 70da50751fb95521e9cead55fdd9ae3bd18f7b2cbc2b8301b5807edf0fc19ea5, current checksum: 6be208c5cbebb8007a928a14601206cfd36d4990bbda64442604ecd184b0e440
[0m17:58:45.979448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4a3c5de9-c4ce-4822-bda6-e7065511f45a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea951cb5d00>]}
[0m17:58:47.203956 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m17:58:47.204640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4a3c5de9-c4ce-4822-bda6-e7065511f45a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea95ea582c0>]}
[0m17:58:47.296578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a3c5de9-c4ce-4822-bda6-e7065511f45a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea951f88860>]}
[0m17:58:47.365940 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:58:47.367752 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:58:47.380488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a3c5de9-c4ce-4822-bda6-e7065511f45a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea951cb6180>]}
[0m17:58:47.381071 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m17:58:47.381548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a3c5de9-c4ce-4822-bda6-e7065511f45a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea950129940>]}
[0m17:58:47.383323 [info ] [MainThread]: 
[0m17:58:47.383827 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:58:47.384294 [info ] [MainThread]: 
[0m17:58:47.384899 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:58:47.385887 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m17:58:47.421531 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m17:58:47.422047 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m17:58:47.422477 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:58:47.509364 [debug] [ThreadPool]: SQL status: OK in 0.087 seconds
[0m17:58:47.511072 [debug] [ThreadPool]: On list_argus_vault: Close
[0m17:58:47.511991 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m17:58:47.512585 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m17:58:47.520145 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:58:47.520608 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m17:58:47.521063 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:58:47.523042 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m17:58:47.524438 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:58:47.524876 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m17:58:47.525502 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:58:47.525970 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:58:47.526398 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m17:58:47.527085 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:58:47.528037 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:58:47.528483 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:58:47.528893 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:58:47.529548 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:58:47.530087 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m17:58:47.535940 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m17:58:47.542114 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:58:47.542655 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m17:58:47.543102 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:58:47.544146 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:58:47.544592 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:58:47.545035 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m17:58:47.556199 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m17:58:47.557766 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m17:58:47.559101 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m17:58:47.559539 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m17:58:47.561128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a3c5de9-c4ce-4822-bda6-e7065511f45a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea939927650>]}
[0m17:58:47.561761 [debug] [MainThread]: Using duckdb connection "master"
[0m17:58:47.562226 [debug] [MainThread]: On master: BEGIN
[0m17:58:47.562633 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:58:47.563881 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:58:47.564382 [debug] [MainThread]: On master: COMMIT
[0m17:58:47.564804 [debug] [MainThread]: Using duckdb connection "master"
[0m17:58:47.565240 [debug] [MainThread]: On master: COMMIT
[0m17:58:47.565950 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:58:47.566386 [debug] [MainThread]: On master: Close
[0m17:58:47.568428 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:58:47.569087 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m17:58:47.569646 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m17:58:47.570155 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m17:58:47.578419 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:58:47.579143 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m17:58:47.635790 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:58:47.636373 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201175847611491"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    ' txn is flagged as fraud due to significantly anomalous PCA factors (V7-V17).' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '4f78ba2c-af84-43cc-ac3c-0b7feb65e45f'
    );
  
  
  
[0m17:58:47.636857 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:58:47.645221 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m17:58:47.652784 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:58:47.653304 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m17:58:47.653986 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:58:47.654474 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:58:47.654955 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201175847611491'
      
      
      order by ordinal_position

  
[0m17:58:47.657487 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:58:47.662470 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:58:47.662996 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:58:47.665663 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:58:47.675671 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:58:47.676195 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:58:47.678763 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:58:47.680270 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:58:47.680767 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m17:58:47.681791 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:58:47.697987 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:58:47.698756 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:58:47.699269 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201175847611491"
    )
  
[0m17:58:47.700610 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:58:47.710891 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:58:47.711417 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:58:47.711875 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:58:47.725596 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m17:58:47.727743 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m17:58:47.729471 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a3c5de9-c4ce-4822-bda6-e7065511f45a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea95eb23d40>]}
[0m17:58:47.730227 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m17:58:47.730940 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:58:47.732415 [debug] [MainThread]: Using duckdb connection "master"
[0m17:58:47.732980 [debug] [MainThread]: On master: BEGIN
[0m17:58:47.733427 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:58:47.734461 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:58:47.734902 [debug] [MainThread]: On master: COMMIT
[0m17:58:47.735348 [debug] [MainThread]: Using duckdb connection "master"
[0m17:58:47.735749 [debug] [MainThread]: On master: COMMIT
[0m17:58:47.736374 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:58:47.736805 [debug] [MainThread]: On master: Close
[0m17:58:47.737319 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:58:47.737712 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m17:58:47.738148 [info ] [MainThread]: 
[0m17:58:47.738594 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m17:58:47.739372 [debug] [MainThread]: Command end result
[0m17:58:47.758489 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:58:47.760171 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:58:47.765838 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m17:58:47.766300 [info ] [MainThread]: 
[0m17:58:47.766818 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:58:47.767283 [info ] [MainThread]: 
[0m17:58:47.767741 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:58:47.768373 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:58:47.769407 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.352219, "process_in_blocks": "0", "process_kernel_time": 0.30179, "process_mem_max_rss": "284788", "process_out_blocks": "3120", "process_user_time": 4.285418}
[0m17:58:47.770004 [debug] [MainThread]: Command `dbt run` succeeded at 17:58:47.769876 after 2.35 seconds
[0m17:58:47.770469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea95e27d3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea95e27dd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea951bb7f80>]}
[0m17:58:47.770969 [debug] [MainThread]: Flushing usage events
[0m17:58:48.745367 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:59:04.116842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1449af23f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1449233560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a144b950920>]}


============================== 17:59:04.120311 | 13ad6415-4c02-4469-bc05-80cd80417c3a ==============================
[0m17:59:04.120311 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:59:04.121026 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'static_parser': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False', 'cache_selected_only': 'False', 'printer_width': '80', 'warn_error': 'None', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "3514dfba-8c7a-4f1c-9ead-94aa71378bc4", "ai_explanation": "Fraud detected: Outlier PCA scores indicate suspicious transaction manipulation."} --profiles-dir .', 'no_print': 'None', 'write_json': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'log_format': 'default', 'profiles_dir': '.', 'partial_parse': 'True', 'log_cache_events': 'False', 'introspect': 'True', 'empty': 'False', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'target_path': 'None', 'log_path': '/workspaces/modern-stack-banking/Transform/logs'}
[0m17:59:04.370693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '13ad6415-4c02-4469-bc05-80cd80417c3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1449aa6ea0>]}
[0m17:59:04.442142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '13ad6415-4c02-4469-bc05-80cd80417c3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1448ae73b0>]}
[0m17:59:04.443971 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:59:04.527785 [debug] [MainThread]: checksum: ce74371079a121a55148eba3c8eb0deeae1f11c464e990f81136ebde365589af, vars: {'ai_explanation': 'Fraud detected: Outlier PCA scores indicate suspicious '
                   'transaction manipulation.',
 'txn_id': '3514dfba-8c7a-4f1c-9ead-94aa71378bc4'}, profile: , target: , version: 1.11.2
[0m17:59:04.620180 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:59:04.620740 [debug] [MainThread]: previous checksum: ce74371079a121a55148eba3c8eb0deeae1f11c464e990f81136ebde365589af, current checksum: 70da50751fb95521e9cead55fdd9ae3bd18f7b2cbc2b8301b5807edf0fc19ea5
[0m17:59:04.621218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '13ad6415-4c02-4469-bc05-80cd80417c3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1448ae6c00>]}
[0m17:59:05.841740 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m17:59:05.842497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '13ad6415-4c02-4469-bc05-80cd80417c3a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a143c107800>]}
[0m17:59:05.933972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '13ad6415-4c02-4469-bc05-80cd80417c3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a143c1ecd40>]}
[0m17:59:06.004905 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:59:06.006784 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:59:06.019308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '13ad6415-4c02-4469-bc05-80cd80417c3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a143c02bd40>]}
[0m17:59:06.019930 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m17:59:06.020475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13ad6415-4c02-4469-bc05-80cd80417c3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a143c126d80>]}
[0m17:59:06.022264 [info ] [MainThread]: 
[0m17:59:06.022812 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:59:06.023324 [info ] [MainThread]: 
[0m17:59:06.024012 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:59:06.025130 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m17:59:06.061245 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m17:59:06.061748 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m17:59:06.062210 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:59:06.150894 [debug] [ThreadPool]: SQL status: OK in 0.089 seconds
[0m17:59:06.152579 [debug] [ThreadPool]: On list_argus_vault: Close
[0m17:59:06.153445 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m17:59:06.154034 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m17:59:06.161374 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:59:06.161846 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m17:59:06.162292 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:59:06.163963 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m17:59:06.165299 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:59:06.165735 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m17:59:06.166389 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:59:06.166813 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:59:06.167250 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m17:59:06.167872 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:59:06.168800 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:59:06.169266 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:59:06.169678 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:59:06.170312 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:59:06.170765 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m17:59:06.176542 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m17:59:06.182284 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:59:06.182817 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m17:59:06.183243 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:59:06.184136 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:59:06.184566 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:59:06.184997 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m17:59:06.196635 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m17:59:06.198138 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m17:59:06.199404 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m17:59:06.199842 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m17:59:06.201415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13ad6415-4c02-4469-bc05-80cd80417c3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a143c1ed730>]}
[0m17:59:06.202084 [debug] [MainThread]: Using duckdb connection "master"
[0m17:59:06.202573 [debug] [MainThread]: On master: BEGIN
[0m17:59:06.203030 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:59:06.203974 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:59:06.204444 [debug] [MainThread]: On master: COMMIT
[0m17:59:06.204896 [debug] [MainThread]: Using duckdb connection "master"
[0m17:59:06.205360 [debug] [MainThread]: On master: COMMIT
[0m17:59:06.206001 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:59:06.206456 [debug] [MainThread]: On master: Close
[0m17:59:06.208547 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:59:06.209281 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m17:59:06.209862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m17:59:06.210407 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m17:59:06.218373 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:59:06.219125 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m17:59:06.274889 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:59:06.275511 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201175906250589"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Fraud detected: Outlier PCA scores indicate suspicious transaction manipulation.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '3514dfba-8c7a-4f1c-9ead-94aa71378bc4'
    );
  
  
  
[0m17:59:06.276024 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:59:06.284367 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m17:59:06.292106 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:59:06.292620 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m17:59:06.293335 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:59:06.293814 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:59:06.294305 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201175906250589'
      
      
      order by ordinal_position

  
[0m17:59:06.296858 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:59:06.301968 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:59:06.302478 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:59:06.305008 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:59:06.315248 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:59:06.315765 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:59:06.318229 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:59:06.319761 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:59:06.320287 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m17:59:06.321068 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:59:06.337356 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:59:06.338167 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:59:06.338657 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201175906250589"
    )
  
[0m17:59:06.339843 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:59:06.350127 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:59:06.350633 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:59:06.351110 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:59:06.364785 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m17:59:06.366845 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m17:59:06.368647 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13ad6415-4c02-4469-bc05-80cd80417c3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1449a3be90>]}
[0m17:59:06.369456 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m17:59:06.370185 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:59:06.371618 [debug] [MainThread]: Using duckdb connection "master"
[0m17:59:06.372166 [debug] [MainThread]: On master: BEGIN
[0m17:59:06.372651 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:59:06.373682 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:59:06.374176 [debug] [MainThread]: On master: COMMIT
[0m17:59:06.374624 [debug] [MainThread]: Using duckdb connection "master"
[0m17:59:06.375082 [debug] [MainThread]: On master: COMMIT
[0m17:59:06.375697 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:59:06.376182 [debug] [MainThread]: On master: Close
[0m17:59:06.376702 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:59:06.377156 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m17:59:06.377615 [info ] [MainThread]: 
[0m17:59:06.378156 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m17:59:06.379013 [debug] [MainThread]: Command end result
[0m17:59:06.400339 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:59:06.402046 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:59:06.407747 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m17:59:06.408223 [info ] [MainThread]: 
[0m17:59:06.408814 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:59:06.409336 [info ] [MainThread]: 
[0m17:59:06.409868 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:59:06.410569 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:59:06.411669 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.357563, "process_in_blocks": "0", "process_kernel_time": 0.307694, "process_mem_max_rss": "273780", "process_out_blocks": "3112", "process_user_time": 4.295847}
[0m17:59:06.412295 [debug] [MainThread]: Command `dbt run` succeeded at 17:59:06.412186 after 2.36 seconds
[0m17:59:06.412789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1449af23f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a143cd49c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1448d8f770>]}
[0m17:59:06.413327 [debug] [MainThread]: Flushing usage events
[0m17:59:07.352564 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:59:25.352847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727331305fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727330ea2330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727330a6cd10>]}


============================== 17:59:25.356428 | be7e006e-bd9d-4124-b958-d90d95c056de ==============================
[0m17:59:25.356428 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:59:25.357157 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'use_experimental_parser': 'False', 'target_path': 'None', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "129ba378-5d21-4748-a97b-f57e230eaca7", "ai_explanation": "Fraud detected due to significantly negative PCA scores (V7, V10, V17) indicating anomalous activity."} --profiles-dir .', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'profiles_dir': '.', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'use_colors': 'True', 'write_json': 'True', 'empty': 'False', 'version_check': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'quiet': 'False', 'introspect': 'True', 'partial_parse': 'True'}
[0m17:59:25.614060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be7e006e-bd9d-4124-b958-d90d95c056de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727333591f40>]}
[0m17:59:25.688538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be7e006e-bd9d-4124-b958-d90d95c056de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72733345d250>]}
[0m17:59:25.690551 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:59:25.778497 [debug] [MainThread]: checksum: 30f2dea30fb220ec459d9d69f1ad5898be1460e79ea346cd5acc9cb2a4af95ee, vars: {'ai_explanation': 'Fraud detected due to significantly negative PCA scores '
                   '(V7, V10, V17) indicating anomalous activity.',
 'txn_id': '129ba378-5d21-4748-a97b-f57e230eaca7'}, profile: , target: , version: 1.11.2
[0m17:59:25.873998 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:59:25.874610 [debug] [MainThread]: previous checksum: 30f2dea30fb220ec459d9d69f1ad5898be1460e79ea346cd5acc9cb2a4af95ee, current checksum: ce74371079a121a55148eba3c8eb0deeae1f11c464e990f81136ebde365589af
[0m17:59:25.875133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'be7e006e-bd9d-4124-b958-d90d95c056de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727324bb9f40>]}
[0m17:59:27.125991 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m17:59:27.126689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'be7e006e-bd9d-4124-b958-d90d95c056de', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727324b5f530>]}
[0m17:59:27.219706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be7e006e-bd9d-4124-b958-d90d95c056de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72732412b530>]}
[0m17:59:27.290346 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:59:27.292082 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:59:27.304363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be7e006e-bd9d-4124-b958-d90d95c056de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727324033b00>]}
[0m17:59:27.304940 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m17:59:27.305417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be7e006e-bd9d-4124-b958-d90d95c056de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7273249d5ca0>]}
[0m17:59:27.307158 [info ] [MainThread]: 
[0m17:59:27.307647 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:59:27.308108 [info ] [MainThread]: 
[0m17:59:27.308716 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:59:27.309727 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m17:59:27.345730 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m17:59:27.346282 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m17:59:27.346757 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:59:27.441165 [debug] [ThreadPool]: SQL status: OK in 0.094 seconds
[0m17:59:27.442838 [debug] [ThreadPool]: On list_argus_vault: Close
[0m17:59:27.443795 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m17:59:27.444440 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m17:59:27.452060 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:59:27.452534 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m17:59:27.453004 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:59:27.454284 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:59:27.455638 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:59:27.456118 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m17:59:27.456763 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:59:27.457218 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:59:27.457620 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m17:59:27.458295 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:59:27.459236 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:59:27.459687 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:59:27.460127 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:59:27.460715 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:59:27.461177 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m17:59:27.466893 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m17:59:27.472893 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:59:27.473462 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m17:59:27.473871 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:59:27.475418 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m17:59:27.475858 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:59:27.476307 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m17:59:27.488231 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m17:59:27.489756 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m17:59:27.491091 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m17:59:27.491543 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m17:59:27.493341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be7e006e-bd9d-4124-b958-d90d95c056de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727324033c80>]}
[0m17:59:27.494015 [debug] [MainThread]: Using duckdb connection "master"
[0m17:59:27.494500 [debug] [MainThread]: On master: BEGIN
[0m17:59:27.494906 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:59:27.495907 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:59:27.496373 [debug] [MainThread]: On master: COMMIT
[0m17:59:27.496791 [debug] [MainThread]: Using duckdb connection "master"
[0m17:59:27.497218 [debug] [MainThread]: On master: COMMIT
[0m17:59:27.497835 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:59:27.498294 [debug] [MainThread]: On master: Close
[0m17:59:27.500431 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:59:27.501100 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m17:59:27.501674 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m17:59:27.502181 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m17:59:27.510540 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:59:27.511322 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m17:59:27.568528 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:59:27.569185 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201175927543618"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Fraud detected due to significantly negative PCA scores (V7, V10, V17) indicating anomalous activity.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '129ba378-5d21-4748-a97b-f57e230eaca7'
    );
  
  
  
[0m17:59:27.569675 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:59:27.579596 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m17:59:27.587641 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:59:27.588203 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m17:59:27.589397 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:59:27.589881 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:59:27.590385 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201175927543618'
      
      
      order by ordinal_position

  
[0m17:59:27.593230 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:59:27.598565 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:59:27.599109 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:59:27.601892 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:59:27.612286 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:59:27.612806 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:59:27.615358 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:59:27.616878 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:59:27.617407 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m17:59:27.618208 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:59:27.634500 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:59:27.635300 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:59:27.635802 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201175927543618"
    )
  
[0m17:59:27.637373 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:59:27.647745 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:59:27.648272 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:59:27.648738 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:59:27.662989 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m17:59:27.665008 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m17:59:27.666748 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be7e006e-bd9d-4124-b958-d90d95c056de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7272d7bf2690>]}
[0m17:59:27.667530 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m17:59:27.668270 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:59:27.670117 [debug] [MainThread]: Using duckdb connection "master"
[0m17:59:27.670656 [debug] [MainThread]: On master: BEGIN
[0m17:59:27.671174 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:59:27.672153 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:59:27.672603 [debug] [MainThread]: On master: COMMIT
[0m17:59:27.673100 [debug] [MainThread]: Using duckdb connection "master"
[0m17:59:27.673526 [debug] [MainThread]: On master: COMMIT
[0m17:59:27.674191 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:59:27.674657 [debug] [MainThread]: On master: Close
[0m17:59:27.675288 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:59:27.675719 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m17:59:27.676231 [info ] [MainThread]: 
[0m17:59:27.676694 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m17:59:27.677552 [debug] [MainThread]: Command end result
[0m17:59:27.698662 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:59:27.700430 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:59:27.706393 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m17:59:27.706841 [info ] [MainThread]: 
[0m17:59:27.707427 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:59:27.707876 [info ] [MainThread]: 
[0m17:59:27.708419 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:59:27.709103 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:59:27.710223 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.4218848, "process_in_blocks": "0", "process_kernel_time": 0.303357, "process_mem_max_rss": "285400", "process_out_blocks": "3112", "process_user_time": 4.402645}
[0m17:59:27.710839 [debug] [MainThread]: Command `dbt run` succeeded at 17:59:27.710731 after 2.42 seconds
[0m17:59:27.711372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7273318e1f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7273318e3a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7273309057c0>]}
[0m17:59:27.711882 [debug] [MainThread]: Flushing usage events
[0m17:59:28.713658 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:59:51.689795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766ef2765550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766ef282fcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766ef282e1b0>]}


============================== 17:59:51.693241 | 632b93d0-b6b0-4ff7-af23-4ca5501f68ff ==============================
[0m17:59:51.693241 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:59:51.693990 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'target_path': 'None', 'write_json': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "372f0b81-7f5d-4ed8-a969-878de7f4a5f3", "ai_explanation": "Based on PCA factors, this transaction exhibits unusual patterns in V7 and V12, indicating fraud."} --profiles-dir .', 'debug': 'False', 'profiles_dir': '.', 'static_parser': 'True', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'printer_width': '80', 'empty': 'False', 'quiet': 'False', 'partial_parse': 'True', 'version_check': 'True', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'warn_error': 'None', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True'}
[0m17:59:51.939899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '632b93d0-b6b0-4ff7-af23-4ca5501f68ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766ef1f255e0>]}
[0m17:59:52.010669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '632b93d0-b6b0-4ff7-af23-4ca5501f68ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766ef1ed3ec0>]}
[0m17:59:52.012408 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:59:52.094896 [debug] [MainThread]: checksum: 26e19188e978f8688c010d2cd3c43f2e5edb89b7be11a8efa51d2079b057afe2, vars: {'ai_explanation': 'Based on PCA factors, this transaction exhibits unusual '
                   'patterns in V7 and V12, indicating fraud.',
 'txn_id': '372f0b81-7f5d-4ed8-a969-878de7f4a5f3'}, profile: , target: , version: 1.11.2
[0m17:59:52.187621 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:59:52.188309 [debug] [MainThread]: previous checksum: 26e19188e978f8688c010d2cd3c43f2e5edb89b7be11a8efa51d2079b057afe2, current checksum: 30f2dea30fb220ec459d9d69f1ad5898be1460e79ea346cd5acc9cb2a4af95ee
[0m17:59:52.188817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '632b93d0-b6b0-4ff7-af23-4ca5501f68ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766ee619e390>]}
[0m17:59:53.430488 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m17:59:53.431195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '632b93d0-b6b0-4ff7-af23-4ca5501f68ff', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766ee619f860>]}
[0m17:59:53.525713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '632b93d0-b6b0-4ff7-af23-4ca5501f68ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766ef1f03380>]}
[0m17:59:53.595266 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:59:53.597023 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:59:53.609450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '632b93d0-b6b0-4ff7-af23-4ca5501f68ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766ee4053c20>]}
[0m17:59:53.610026 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m17:59:53.610490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '632b93d0-b6b0-4ff7-af23-4ca5501f68ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766ee41b9d90>]}
[0m17:59:53.612246 [info ] [MainThread]: 
[0m17:59:53.612742 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:59:53.613205 [info ] [MainThread]: 
[0m17:59:53.613808 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:59:53.614821 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m17:59:53.650393 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m17:59:53.650933 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m17:59:53.651382 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:59:53.741894 [debug] [ThreadPool]: SQL status: OK in 0.090 seconds
[0m17:59:53.744268 [debug] [ThreadPool]: On list_argus_vault: Close
[0m17:59:53.745428 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m17:59:53.746296 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m17:59:53.757157 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:59:53.757827 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m17:59:53.758478 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:59:53.760551 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m17:59:53.762565 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:59:53.763214 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m17:59:53.764071 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:59:53.764690 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:59:53.765327 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m17:59:53.766252 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:59:53.767652 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:59:53.768233 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:59:53.768651 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:59:53.769270 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:59:53.769707 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m17:59:53.775552 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m17:59:53.781583 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:59:53.782200 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m17:59:53.782610 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:59:53.783659 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:59:53.784126 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:59:53.784549 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m17:59:53.795158 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m17:59:53.796642 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m17:59:53.797962 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m17:59:53.798406 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m17:59:53.800087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '632b93d0-b6b0-4ff7-af23-4ca5501f68ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766ee41d5af0>]}
[0m17:59:53.800701 [debug] [MainThread]: Using duckdb connection "master"
[0m17:59:53.801150 [debug] [MainThread]: On master: BEGIN
[0m17:59:53.801552 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:59:53.802399 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:59:53.802838 [debug] [MainThread]: On master: COMMIT
[0m17:59:53.803287 [debug] [MainThread]: Using duckdb connection "master"
[0m17:59:53.803690 [debug] [MainThread]: On master: COMMIT
[0m17:59:53.804304 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:59:53.804731 [debug] [MainThread]: On master: Close
[0m17:59:53.806820 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:59:53.807485 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m17:59:53.808060 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m17:59:53.808556 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m17:59:53.816811 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:59:53.817623 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m17:59:53.875552 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:59:53.876200 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201175953850462"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Based on PCA factors, this transaction exhibits unusual patterns in V7 and V12, indicating fraud.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '372f0b81-7f5d-4ed8-a969-878de7f4a5f3'
    );
  
  
  
[0m17:59:53.876683 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:59:53.885549 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m17:59:53.893351 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:59:53.893868 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m17:59:53.894585 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:59:53.895084 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:59:53.895550 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201175953850462'
      
      
      order by ordinal_position

  
[0m17:59:53.899006 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:59:53.904063 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:59:53.904577 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:59:53.907427 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:59:53.917717 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:59:53.918254 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:59:53.920664 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:59:53.922188 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:59:53.922697 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m17:59:53.923469 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:59:53.939828 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:59:53.940607 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:59:53.941115 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201175953850462"
    )
  
[0m17:59:53.942409 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:59:53.952902 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:59:53.953444 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:59:53.953905 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:59:53.957770 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:59:53.959775 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m17:59:53.961488 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '632b93d0-b6b0-4ff7-af23-4ca5501f68ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766ef3017d40>]}
[0m17:59:53.962280 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.15s]
[0m17:59:53.963021 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:59:53.964426 [debug] [MainThread]: Using duckdb connection "master"
[0m17:59:53.964941 [debug] [MainThread]: On master: BEGIN
[0m17:59:53.965375 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:59:53.966325 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:59:53.966764 [debug] [MainThread]: On master: COMMIT
[0m17:59:53.967208 [debug] [MainThread]: Using duckdb connection "master"
[0m17:59:53.967610 [debug] [MainThread]: On master: COMMIT
[0m17:59:53.968238 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:59:53.968668 [debug] [MainThread]: On master: Close
[0m17:59:53.969184 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:59:53.969581 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m17:59:53.970020 [info ] [MainThread]: 
[0m17:59:53.970472 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m17:59:53.971246 [debug] [MainThread]: Command end result
[0m17:59:53.991368 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:59:53.993048 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:59:53.998710 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m17:59:53.999174 [info ] [MainThread]: 
[0m17:59:53.999696 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:59:54.000164 [info ] [MainThread]: 
[0m17:59:54.000628 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:59:54.001273 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:59:54.002330 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3747222, "process_in_blocks": "0", "process_kernel_time": 0.320762, "process_mem_max_rss": "275336", "process_out_blocks": "3112", "process_user_time": 4.287726}
[0m17:59:54.002944 [debug] [MainThread]: Command `dbt run` succeeded at 17:59:54.002815 after 2.38 seconds
[0m17:59:54.003435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766ef2765550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766ee5f3b980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766ee5f3ac00>]}
[0m17:59:54.003939 [debug] [MainThread]: Flushing usage events
[0m17:59:54.891164 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:00:13.146138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaff259d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faafef4ae70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faafef4a030>]}


============================== 18:00:13.149636 | 5914bb66-30de-43a8-9255-a4972629569b ==============================
[0m18:00:13.149636 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:00:13.150347 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'fail_fast': 'False', 'introspect': 'True', 'static_parser': 'True', 'partial_parse': 'True', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'write_json': 'True', 'empty': 'False', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "a458ac52-c68c-46ca-83d8-c8691fe31537", "ai_explanation": "Based on PCA factors, this transaction is flagged for fraud due to significantly high V2 and V11 values."} --profiles-dir .', 'printer_width': '80', 'no_print': 'None', 'log_format': 'default', 'cache_selected_only': 'False', 'target_path': 'None', 'quiet': 'False', 'log_cache_events': 'False', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'profiles_dir': '.', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'debug': 'False', 'indirect_selection': 'eager'}
[0m18:00:13.417696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5914bb66-30de-43a8-9255-a4972629569b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faafe81ede0>]}
[0m18:00:13.489512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5914bb66-30de-43a8-9255-a4972629569b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaff0dac30>]}
[0m18:00:13.491364 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:00:13.575333 [debug] [MainThread]: checksum: b45a3a5f33c5e2d9896230e6241b90406e5c9837ca923fdc28d4682a3b242ac8, vars: {'ai_explanation': 'Based on PCA factors, this transaction is flagged for '
                   'fraud due to significantly high V2 and V11 values.',
 'txn_id': 'a458ac52-c68c-46ca-83d8-c8691fe31537'}, profile: , target: , version: 1.11.2
[0m18:00:13.668644 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:00:13.669243 [debug] [MainThread]: previous checksum: b45a3a5f33c5e2d9896230e6241b90406e5c9837ca923fdc28d4682a3b242ac8, current checksum: 26e19188e978f8688c010d2cd3c43f2e5edb89b7be11a8efa51d2079b057afe2
[0m18:00:13.669712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5914bb66-30de-43a8-9255-a4972629569b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faafef4a840>]}
[0m18:00:14.912894 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m18:00:14.913634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5914bb66-30de-43a8-9255-a4972629569b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaf27dbe60>]}
[0m18:00:15.008961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5914bb66-30de-43a8-9255-a4972629569b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaff7eb950>]}
[0m18:00:15.081844 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:00:15.083742 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:00:15.096359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5914bb66-30de-43a8-9255-a4972629569b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaf012b620>]}
[0m18:00:15.096968 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m18:00:15.097495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5914bb66-30de-43a8-9255-a4972629569b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaf29bbe00>]}
[0m18:00:15.099318 [info ] [MainThread]: 
[0m18:00:15.099845 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:00:15.100342 [info ] [MainThread]: 
[0m18:00:15.101042 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:00:15.102096 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m18:00:15.137481 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m18:00:15.138043 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m18:00:15.138488 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:15.227721 [debug] [ThreadPool]: SQL status: OK in 0.089 seconds
[0m18:00:15.229600 [debug] [ThreadPool]: On list_argus_vault: Close
[0m18:00:15.230650 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m18:00:15.231272 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m18:00:15.238958 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:00:15.239530 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m18:00:15.240012 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:00:15.241903 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m18:00:15.243578 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:00:15.244065 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m18:00:15.244701 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:00:15.245195 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:00:15.245660 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m18:00:15.246474 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:00:15.247478 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:00:15.247977 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:00:15.248429 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:00:15.249199 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:00:15.249668 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m18:00:15.255688 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m18:00:15.262159 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:00:15.262786 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m18:00:15.263263 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:00:15.264513 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:00:15.264996 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:00:15.265448 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m18:00:15.277500 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m18:00:15.279222 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m18:00:15.280569 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m18:00:15.281056 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m18:00:15.282714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5914bb66-30de-43a8-9255-a4972629569b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faada504d70>]}
[0m18:00:15.283421 [debug] [MainThread]: Using duckdb connection "master"
[0m18:00:15.283879 [debug] [MainThread]: On master: BEGIN
[0m18:00:15.284362 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:00:15.285624 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:00:15.286134 [debug] [MainThread]: On master: COMMIT
[0m18:00:15.286588 [debug] [MainThread]: Using duckdb connection "master"
[0m18:00:15.287137 [debug] [MainThread]: On master: COMMIT
[0m18:00:15.288004 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:00:15.288550 [debug] [MainThread]: On master: Close
[0m18:00:15.290826 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:00:15.291577 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m18:00:15.292240 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m18:00:15.292719 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m18:00:15.301396 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:00:15.302205 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m18:00:15.360603 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:00:15.361257 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201180015335226"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Based on PCA factors, this transaction is flagged for fraud due to significantly high V2 and V11 values.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = 'a458ac52-c68c-46ca-83d8-c8691fe31537'
    );
  
  
  
[0m18:00:15.361743 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:15.370093 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m18:00:15.377718 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:00:15.378250 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m18:00:15.378974 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:00:15.379457 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:00:15.379945 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201180015335226'
      
      
      order by ordinal_position

  
[0m18:00:15.382406 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:00:15.387346 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:00:15.387863 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:00:15.391426 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:00:15.401540 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:00:15.402091 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:00:15.404453 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:00:15.405992 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:00:15.406501 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m18:00:15.407289 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:00:15.423645 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:00:15.424436 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:00:15.424961 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201180015335226"
    )
  
[0m18:00:15.426347 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:00:15.436745 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:00:15.437279 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:00:15.437737 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:00:15.451678 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m18:00:15.453705 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m18:00:15.455452 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5914bb66-30de-43a8-9255-a4972629569b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaff643ce0>]}
[0m18:00:15.456241 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m18:00:15.457003 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:00:15.459033 [debug] [MainThread]: Using duckdb connection "master"
[0m18:00:15.459551 [debug] [MainThread]: On master: BEGIN
[0m18:00:15.460061 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:00:15.461132 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:00:15.461657 [debug] [MainThread]: On master: COMMIT
[0m18:00:15.462165 [debug] [MainThread]: Using duckdb connection "master"
[0m18:00:15.462608 [debug] [MainThread]: On master: COMMIT
[0m18:00:15.463269 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:00:15.463731 [debug] [MainThread]: On master: Close
[0m18:00:15.464300 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:00:15.464741 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m18:00:15.465242 [info ] [MainThread]: 
[0m18:00:15.465726 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m18:00:15.466563 [debug] [MainThread]: Command end result
[0m18:00:15.488276 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:00:15.489979 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:00:15.495787 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m18:00:15.496290 [info ] [MainThread]: 
[0m18:00:15.496851 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:00:15.497361 [info ] [MainThread]: 
[0m18:00:15.497872 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:00:15.498546 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:00:15.499626 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.4169917, "process_in_blocks": "0", "process_kernel_time": 0.309036, "process_mem_max_rss": "278128", "process_out_blocks": "3112", "process_user_time": 4.364149}
[0m18:00:15.500261 [debug] [MainThread]: Command `dbt run` succeeded at 18:00:15.500151 after 2.42 seconds
[0m18:00:15.500771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaff6f2390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaff66d310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaf275be90>]}
[0m18:00:15.501309 [debug] [MainThread]: Flushing usage events
[0m18:00:16.412013 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:00:32.494440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7081bc74a690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7081bc27e5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7081bc27ec30>]}


============================== 18:00:32.497712 | c9098425-16d1-4d4b-848f-14e813314a38 ==============================
[0m18:00:32.497712 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:00:32.498402 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'no_print': 'None', 'write_json': 'True', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'cache_selected_only': 'False', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "e8abd301-0f41-490c-a3f6-251cfb934023", "ai_explanation": "The transaction is fraudulent based on the PCA score of -3.54, indicating significant deviation from normal behavior."} --profiles-dir .', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'version_check': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'printer_width': '80', 'static_parser': 'True', 'quiet': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '.', 'indirect_selection': 'eager', 'warn_error': 'None', 'target_path': 'None', 'log_format': 'default', 'empty': 'False'}
[0m18:00:32.745086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c9098425-16d1-4d4b-848f-14e813314a38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7081bb7708f0>]}
[0m18:00:32.815417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c9098425-16d1-4d4b-848f-14e813314a38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7081bdd0cf50>]}
[0m18:00:32.817128 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:00:32.901353 [debug] [MainThread]: checksum: e17c5c153a51011133ec80acc7de13cc8bfc2c6fabd6dda0b631f453ae231238, vars: {'ai_explanation': 'The transaction is fraudulent based on the PCA score of '
                   '-3.54, indicating significant deviation from normal '
                   'behavior.',
 'txn_id': 'e8abd301-0f41-490c-a3f6-251cfb934023'}, profile: , target: , version: 1.11.2
[0m18:00:32.993404 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:00:32.994026 [debug] [MainThread]: previous checksum: e17c5c153a51011133ec80acc7de13cc8bfc2c6fabd6dda0b631f453ae231238, current checksum: b45a3a5f33c5e2d9896230e6241b90406e5c9837ca923fdc28d4682a3b242ac8
[0m18:00:32.994473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c9098425-16d1-4d4b-848f-14e813314a38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7081afac24b0>]}
[0m18:00:34.217843 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m18:00:34.218536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c9098425-16d1-4d4b-848f-14e813314a38', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7081af98e990>]}
[0m18:00:34.310558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c9098425-16d1-4d4b-848f-14e813314a38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7081afaeadb0>]}
[0m18:00:34.379068 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:00:34.380792 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:00:34.393068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c9098425-16d1-4d4b-848f-14e813314a38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708183626750>]}
[0m18:00:34.393629 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m18:00:34.394136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9098425-16d1-4d4b-848f-14e813314a38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7081837c99a0>]}
[0m18:00:34.395877 [info ] [MainThread]: 
[0m18:00:34.396387 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:00:34.396816 [info ] [MainThread]: 
[0m18:00:34.397442 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:00:34.398443 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m18:00:34.433574 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m18:00:34.434079 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m18:00:34.434516 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:34.520696 [debug] [ThreadPool]: SQL status: OK in 0.086 seconds
[0m18:00:34.522478 [debug] [ThreadPool]: On list_argus_vault: Close
[0m18:00:34.523367 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m18:00:34.523974 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m18:00:34.531295 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:00:34.531754 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m18:00:34.532197 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:00:34.533366 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:00:34.534671 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:00:34.535121 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m18:00:34.535725 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:00:34.536170 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:00:34.536571 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m18:00:34.537298 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:00:34.538254 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:00:34.538694 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:00:34.539127 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:00:34.539714 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:00:34.540168 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m18:00:34.545762 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m18:00:34.551904 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:00:34.552467 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m18:00:34.552880 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:00:34.553786 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:00:34.554257 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:00:34.554680 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m18:00:34.566725 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m18:00:34.568300 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m18:00:34.569590 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m18:00:34.570052 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m18:00:34.571703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9098425-16d1-4d4b-848f-14e813314a38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708183729d60>]}
[0m18:00:34.572316 [debug] [MainThread]: Using duckdb connection "master"
[0m18:00:34.572742 [debug] [MainThread]: On master: BEGIN
[0m18:00:34.573185 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:00:34.574076 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:00:34.574513 [debug] [MainThread]: On master: COMMIT
[0m18:00:34.574946 [debug] [MainThread]: Using duckdb connection "master"
[0m18:00:34.575352 [debug] [MainThread]: On master: COMMIT
[0m18:00:34.576034 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:00:34.576474 [debug] [MainThread]: On master: Close
[0m18:00:34.578521 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:00:34.579166 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m18:00:34.579735 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m18:00:34.580251 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m18:00:34.588382 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:00:34.589155 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m18:00:34.646112 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:00:34.646709 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201180034621529"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'The transaction is fraudulent based on the PCA score of -3.54, indicating significant deviation from normal behavior.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = 'e8abd301-0f41-490c-a3f6-251cfb934023'
    );
  
  
  
[0m18:00:34.647225 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:34.655700 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m18:00:34.663426 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:00:34.663955 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m18:00:34.664889 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:00:34.665397 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:00:34.665864 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201180034621529'
      
      
      order by ordinal_position

  
[0m18:00:34.668448 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:00:34.673495 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:00:34.674023 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:00:34.676733 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:00:34.686785 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:00:34.687329 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:00:34.689990 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:00:34.691489 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:00:34.692010 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m18:00:34.692763 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:00:34.709155 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:00:34.709967 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:00:34.710471 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201180034621529"
    )
  
[0m18:00:34.711606 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:00:34.722014 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:00:34.722520 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:00:34.723005 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:00:34.737254 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m18:00:34.739324 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m18:00:34.741047 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9098425-16d1-4d4b-848f-14e813314a38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7081ad96c9b0>]}
[0m18:00:34.741801 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m18:00:34.742552 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:00:34.743877 [debug] [MainThread]: Using duckdb connection "master"
[0m18:00:34.744387 [debug] [MainThread]: On master: BEGIN
[0m18:00:34.744810 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:00:34.745776 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:00:34.746241 [debug] [MainThread]: On master: COMMIT
[0m18:00:34.746654 [debug] [MainThread]: Using duckdb connection "master"
[0m18:00:34.747077 [debug] [MainThread]: On master: COMMIT
[0m18:00:34.747679 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:00:34.748209 [debug] [MainThread]: On master: Close
[0m18:00:34.748791 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:00:34.749304 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m18:00:34.749727 [info ] [MainThread]: 
[0m18:00:34.750205 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m18:00:34.750993 [debug] [MainThread]: Command end result
[0m18:00:34.770096 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:00:34.771690 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:00:34.777315 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m18:00:34.777750 [info ] [MainThread]: 
[0m18:00:34.778285 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:00:34.778723 [info ] [MainThread]: 
[0m18:00:34.779205 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:00:34.779823 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:00:34.780869 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.348766, "process_in_blocks": "0", "process_kernel_time": 0.304594, "process_mem_max_rss": "273424", "process_out_blocks": "3112", "process_user_time": 4.27826}
[0m18:00:34.781477 [debug] [MainThread]: Command `dbt run` succeeded at 18:00:34.781374 after 2.35 seconds
[0m18:00:34.781970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7081bbe52630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7081bc91ea80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7081837f6bd0>]}
[0m18:00:34.782452 [debug] [MainThread]: Flushing usage events
[0m18:00:35.813198 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:00:52.496936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0375a5bf80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d03746c9b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d03746c8830>]}


============================== 18:00:52.500287 | 06ddf16a-2164-4327-a06d-50c1af72fd98 ==============================
[0m18:00:52.500287 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:00:52.500988 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "6ae2972e-a901-438a-b68c-21412d85c6cc", "ai_explanation": "This transaction is flagged for fraud due to significant PCA scores (V3: -11.43, V10: -13.19)."} --profiles-dir .', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'introspect': 'True', 'log_cache_events': 'False', 'log_format': 'default', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'version_check': 'True', 'debug': 'False', 'profiles_dir': '.', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'static_parser': 'True', 'printer_width': '80', 'target_path': 'None', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'write_json': 'True', 'partial_parse': 'True'}
[0m18:00:52.748204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06ddf16a-2164-4327-a06d-50c1af72fd98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0373cf2930>]}
[0m18:00:52.819184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '06ddf16a-2164-4327-a06d-50c1af72fd98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0373e13620>]}
[0m18:00:52.820872 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:00:52.905314 [debug] [MainThread]: checksum: 5d4f447a310a9a9ccab7821c9dbab52e0fa9c1bd423bce25baff2fc4fe671ee5, vars: {'ai_explanation': 'This transaction is flagged for fraud due to significant '
                   'PCA scores (V3: -11.43, V10: -13.19).',
 'txn_id': '6ae2972e-a901-438a-b68c-21412d85c6cc'}, profile: , target: , version: 1.11.2
[0m18:00:52.997671 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:00:52.998280 [debug] [MainThread]: previous checksum: 5d4f447a310a9a9ccab7821c9dbab52e0fa9c1bd423bce25baff2fc4fe671ee5, current checksum: e17c5c153a51011133ec80acc7de13cc8bfc2c6fabd6dda0b631f453ae231238
[0m18:00:52.998737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '06ddf16a-2164-4327-a06d-50c1af72fd98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d03746fa9f0>]}
[0m18:00:54.258867 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m18:00:54.259579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '06ddf16a-2164-4327-a06d-50c1af72fd98', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0367fc5e50>]}
[0m18:00:54.351313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06ddf16a-2164-4327-a06d-50c1af72fd98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0367d45400>]}
[0m18:00:54.419709 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:00:54.421448 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:00:54.433800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '06ddf16a-2164-4327-a06d-50c1af72fd98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0367d6f6e0>]}
[0m18:00:54.434393 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m18:00:54.434854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06ddf16a-2164-4327-a06d-50c1af72fd98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d03641eb890>]}
[0m18:00:54.436595 [info ] [MainThread]: 
[0m18:00:54.437143 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:00:54.437603 [info ] [MainThread]: 
[0m18:00:54.438268 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:00:54.439272 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m18:00:54.474872 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m18:00:54.475374 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m18:00:54.475817 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:54.562171 [debug] [ThreadPool]: SQL status: OK in 0.086 seconds
[0m18:00:54.564181 [debug] [ThreadPool]: On list_argus_vault: Close
[0m18:00:54.565048 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m18:00:54.565645 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m18:00:54.572846 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:00:54.573359 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m18:00:54.573806 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:00:54.575213 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:00:54.576529 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:00:54.576995 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m18:00:54.577630 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:00:54.578097 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:00:54.578538 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m18:00:54.579281 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:00:54.580235 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:00:54.580693 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:00:54.581151 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:00:54.581779 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:00:54.582263 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m18:00:54.587831 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m18:00:54.593431 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:00:54.593999 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m18:00:54.594438 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:00:54.595302 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:00:54.595753 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:00:54.596232 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m18:00:54.607265 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m18:00:54.608722 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m18:00:54.610047 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m18:00:54.610507 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m18:00:54.612033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06ddf16a-2164-4327-a06d-50c1af72fd98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d03430e26c0>]}
[0m18:00:54.612662 [debug] [MainThread]: Using duckdb connection "master"
[0m18:00:54.613164 [debug] [MainThread]: On master: BEGIN
[0m18:00:54.613570 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:00:54.614444 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:00:54.614884 [debug] [MainThread]: On master: COMMIT
[0m18:00:54.615350 [debug] [MainThread]: Using duckdb connection "master"
[0m18:00:54.615748 [debug] [MainThread]: On master: COMMIT
[0m18:00:54.616365 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:00:54.616790 [debug] [MainThread]: On master: Close
[0m18:00:54.618907 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:00:54.619608 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m18:00:54.620197 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m18:00:54.620687 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m18:00:54.628518 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:00:54.629238 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m18:00:54.685082 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:00:54.685663 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201180054660998"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'This transaction is flagged for fraud due to significant PCA scores (V3: -11.43, V10: -13.19).' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '6ae2972e-a901-438a-b68c-21412d85c6cc'
    );
  
  
  
[0m18:00:54.686166 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:54.694343 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m18:00:54.701817 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:00:54.702336 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m18:00:54.703036 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:00:54.703525 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:00:54.704044 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201180054660998'
      
      
      order by ordinal_position

  
[0m18:00:54.706886 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:00:54.711844 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:00:54.712366 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:00:54.715802 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:00:54.725794 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:00:54.726319 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:00:54.728814 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:00:54.730320 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:00:54.730819 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m18:00:54.731577 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:00:54.747691 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:00:54.748467 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:00:54.748974 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201180054660998"
    )
  
[0m18:00:54.750131 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:00:54.760490 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:00:54.761022 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:00:54.761484 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:00:54.775480 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m18:00:54.777503 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m18:00:54.779249 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06ddf16a-2164-4327-a06d-50c1af72fd98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0342ff3f20>]}
[0m18:00:54.780015 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m18:00:54.780720 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:00:54.782572 [debug] [MainThread]: Using duckdb connection "master"
[0m18:00:54.783099 [debug] [MainThread]: On master: BEGIN
[0m18:00:54.783546 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:00:54.784640 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:00:54.785119 [debug] [MainThread]: On master: COMMIT
[0m18:00:54.785529 [debug] [MainThread]: Using duckdb connection "master"
[0m18:00:54.785949 [debug] [MainThread]: On master: COMMIT
[0m18:00:54.786563 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:00:54.787021 [debug] [MainThread]: On master: Close
[0m18:00:54.787512 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:00:54.787901 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m18:00:54.788382 [info ] [MainThread]: 
[0m18:00:54.788827 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m18:00:54.789644 [debug] [MainThread]: Command end result
[0m18:00:54.809217 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:00:54.810942 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:00:54.816746 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m18:00:54.817228 [info ] [MainThread]: 
[0m18:00:54.817743 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:00:54.818223 [info ] [MainThread]: 
[0m18:00:54.818685 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:00:54.819359 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:00:54.820414 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3855577, "process_in_blocks": "0", "process_kernel_time": 0.303805, "process_mem_max_rss": "279128", "process_out_blocks": "3120", "process_user_time": 4.300771}
[0m18:00:54.821028 [debug] [MainThread]: Command `dbt run` succeeded at 18:00:54.820891 after 2.39 seconds
[0m18:00:54.821517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d03743d2060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0373fd0800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0374cb2570>]}
[0m18:00:54.822024 [debug] [MainThread]: Flushing usage events
[0m18:00:55.828890 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:01:11.319321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b99249cfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b991d0de20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b9921c7170>]}


============================== 18:01:11.322657 | 4f2e7fb9-e014-46b8-b885-5efa59d89f63 ==============================
[0m18:01:11.322657 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:01:11.323363 [debug] [MainThread]: running dbt with arguments {'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'write_json': 'True', 'printer_width': '80', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "79bd8c03-38a4-4a25-9643-97646a17c4bf", "ai_explanation": "The PCA factors indicate a significant anomaly in this transaction, suggesting fraud."} --profiles-dir .', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'profiles_dir': '.', 'warn_error': 'None', 'debug': 'False', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'target_path': 'None', 'version_check': 'True', 'introspect': 'True', 'partial_parse': 'True', 'log_format': 'default', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'no_print': 'None'}
[0m18:01:11.568413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f2e7fb9-e014-46b8-b885-5efa59d89f63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b9922e25a0>]}
[0m18:01:11.638985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f2e7fb9-e014-46b8-b885-5efa59d89f63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b9916c90a0>]}
[0m18:01:11.640733 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:01:11.727458 [debug] [MainThread]: checksum: a314373abbaceb7f8eeb211d47ab5b193366fc727a731163f89bdc6b1b6b4c95, vars: {'ai_explanation': 'The PCA factors indicate a significant anomaly in this '
                   'transaction, suggesting fraud.',
 'txn_id': '79bd8c03-38a4-4a25-9643-97646a17c4bf'}, profile: , target: , version: 1.11.2
[0m18:01:11.819858 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:01:11.820482 [debug] [MainThread]: previous checksum: a314373abbaceb7f8eeb211d47ab5b193366fc727a731163f89bdc6b1b6b4c95, current checksum: 5d4f447a310a9a9ccab7821c9dbab52e0fa9c1bd423bce25baff2fc4fe671ee5
[0m18:01:11.820989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4f2e7fb9-e014-46b8-b885-5efa59d89f63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b9859ba1e0>]}
[0m18:01:13.045322 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m18:01:13.045993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4f2e7fb9-e014-46b8-b885-5efa59d89f63', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b9916eba40>]}
[0m18:01:13.137308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f2e7fb9-e014-46b8-b885-5efa59d89f63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b9841e3cb0>]}
[0m18:01:13.205956 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:01:13.207662 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:01:13.219954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f2e7fb9-e014-46b8-b885-5efa59d89f63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b9917196a0>]}
[0m18:01:13.220508 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m18:01:13.221004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f2e7fb9-e014-46b8-b885-5efa59d89f63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b9857510d0>]}
[0m18:01:13.222737 [info ] [MainThread]: 
[0m18:01:13.223244 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:01:13.223671 [info ] [MainThread]: 
[0m18:01:13.224285 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:01:13.225329 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m18:01:13.260629 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m18:01:13.261140 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m18:01:13.261588 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:13.348800 [debug] [ThreadPool]: SQL status: OK in 0.087 seconds
[0m18:01:13.350508 [debug] [ThreadPool]: On list_argus_vault: Close
[0m18:01:13.351401 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m18:01:13.352000 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m18:01:13.359432 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:01:13.359971 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m18:01:13.360395 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:01:13.361528 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:01:13.362817 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:01:13.363277 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m18:01:13.363885 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:01:13.364324 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:01:13.364722 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m18:01:13.365377 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:01:13.366306 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:01:13.366745 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:01:13.367181 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:01:13.368035 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:01:13.368472 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m18:01:13.374145 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m18:01:13.380098 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:01:13.380627 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m18:01:13.381051 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:01:13.381979 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:01:13.382410 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:01:13.382821 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m18:01:13.393939 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m18:01:13.395403 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m18:01:13.396671 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m18:01:13.397131 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m18:01:13.398739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f2e7fb9-e014-46b8-b885-5efa59d89f63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b9841f24e0>]}
[0m18:01:13.399394 [debug] [MainThread]: Using duckdb connection "master"
[0m18:01:13.399813 [debug] [MainThread]: On master: BEGIN
[0m18:01:13.400235 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:01:13.401179 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:01:13.401621 [debug] [MainThread]: On master: COMMIT
[0m18:01:13.402062 [debug] [MainThread]: Using duckdb connection "master"
[0m18:01:13.402462 [debug] [MainThread]: On master: COMMIT
[0m18:01:13.403141 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:01:13.403585 [debug] [MainThread]: On master: Close
[0m18:01:13.405612 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:01:13.406251 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m18:01:13.406798 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m18:01:13.407315 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m18:01:13.415446 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:01:13.416172 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m18:01:13.472587 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:01:13.473204 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201180113448218"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'The PCA factors indicate a significant anomaly in this transaction, suggesting fraud.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '79bd8c03-38a4-4a25-9643-97646a17c4bf'
    );
  
  
  
[0m18:01:13.473690 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:01:13.482009 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m18:01:13.489936 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:01:13.490461 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m18:01:13.491182 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:01:13.491659 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:01:13.492144 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201180113448218'
      
      
      order by ordinal_position

  
[0m18:01:13.495023 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:01:13.500154 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:01:13.500683 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:01:13.503168 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:01:13.513736 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:01:13.514312 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:01:13.517097 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:01:13.518646 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:01:13.519166 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m18:01:13.519955 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:01:13.536228 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:01:13.537014 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:01:13.537522 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201180113448218"
    )
  
[0m18:01:13.538658 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:01:13.549027 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:01:13.549538 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:01:13.550052 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:01:13.563398 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m18:01:13.565428 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m18:01:13.567139 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f2e7fb9-e014-46b8-b885-5efa59d89f63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b98574d730>]}
[0m18:01:13.567878 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m18:01:13.568606 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:01:13.570129 [debug] [MainThread]: Using duckdb connection "master"
[0m18:01:13.570572 [debug] [MainThread]: On master: BEGIN
[0m18:01:13.571001 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:01:13.571888 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:01:13.572350 [debug] [MainThread]: On master: COMMIT
[0m18:01:13.572751 [debug] [MainThread]: Using duckdb connection "master"
[0m18:01:13.573179 [debug] [MainThread]: On master: COMMIT
[0m18:01:13.573746 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:01:13.574207 [debug] [MainThread]: On master: Close
[0m18:01:13.574687 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:01:13.575109 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m18:01:13.575523 [info ] [MainThread]: 
[0m18:01:13.575996 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m18:01:13.576773 [debug] [MainThread]: Command end result
[0m18:01:13.595690 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:01:13.597297 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:01:13.602856 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m18:01:13.603311 [info ] [MainThread]: 
[0m18:01:13.603819 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:01:13.604279 [info ] [MainThread]: 
[0m18:01:13.604734 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:01:13.605366 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:01:13.606391 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3493235, "process_in_blocks": "0", "process_kernel_time": 0.318178, "process_mem_max_rss": "270376", "process_out_blocks": "3104", "process_user_time": 4.26914}
[0m18:01:13.606993 [debug] [MainThread]: Command `dbt run` succeeded at 18:01:13.606866 after 2.35 seconds
[0m18:01:13.607466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b9919fdc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b991a5eab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b98402bcb0>]}
[0m18:01:13.607953 [debug] [MainThread]: Flushing usage events
[0m18:01:14.584447 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:01:30.285074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a532cfea630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a532ee461b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a532c8e3050>]}


============================== 18:01:30.288429 | 0b6ae636-51c8-4781-8966-f1caa0107f5c ==============================
[0m18:01:30.288429 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:01:30.289123 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'printer_width': '80', 'log_cache_events': 'False', 'no_print': 'None', 'log_format': 'default', 'debug': 'False', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'empty': 'False', 'introspect': 'True', 'warn_error': 'None', 'target_path': 'None', 'profiles_dir': '.', 'fail_fast': 'False', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'partial_parse': 'True', 'quiet': 'False', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "a5160474-4fe2-4fcd-9d11-45b3604f170c", "ai_explanation": "The transaction is fraud due to significant anomalies in PCA scores V12 and V17."} --profiles-dir .', 'cache_selected_only': 'False'}
[0m18:01:30.535634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b6ae636-51c8-4781-8966-f1caa0107f5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a532bfce6c0>]}
[0m18:01:30.606687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b6ae636-51c8-4781-8966-f1caa0107f5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a532ea591c0>]}
[0m18:01:30.608378 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:01:30.692302 [debug] [MainThread]: checksum: d0161bcc9f47e0cc6e4b3eed1619ab9d6e4266902b16a7fd1b47b9f468a34c39, vars: {'ai_explanation': 'The transaction is fraud due to significant anomalies in '
                   'PCA scores V12 and V17.',
 'txn_id': 'a5160474-4fe2-4fcd-9d11-45b3604f170c'}, profile: , target: , version: 1.11.2
[0m18:01:30.785524 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:01:30.786169 [debug] [MainThread]: previous checksum: d0161bcc9f47e0cc6e4b3eed1619ab9d6e4266902b16a7fd1b47b9f468a34c39, current checksum: a314373abbaceb7f8eeb211d47ab5b193366fc727a731163f89bdc6b1b6b4c95
[0m18:01:30.786632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0b6ae636-51c8-4781-8966-f1caa0107f5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a532c8e2810>]}
[0m18:01:32.011508 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m18:01:32.012176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0b6ae636-51c8-4781-8966-f1caa0107f5c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a531ff67ce0>]}
[0m18:01:32.106883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b6ae636-51c8-4781-8966-f1caa0107f5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a531ffe9af0>]}
[0m18:01:32.175617 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:01:32.177359 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:01:32.189699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b6ae636-51c8-4781-8966-f1caa0107f5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a531c1a94f0>]}
[0m18:01:32.190287 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m18:01:32.190750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b6ae636-51c8-4781-8966-f1caa0107f5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a531ff2adb0>]}
[0m18:01:32.192503 [info ] [MainThread]: 
[0m18:01:32.193009 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:01:32.193442 [info ] [MainThread]: 
[0m18:01:32.194068 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:01:32.195141 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m18:01:32.230460 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m18:01:32.230986 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m18:01:32.231418 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:32.316800 [debug] [ThreadPool]: SQL status: OK in 0.085 seconds
[0m18:01:32.318483 [debug] [ThreadPool]: On list_argus_vault: Close
[0m18:01:32.319373 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m18:01:32.319981 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m18:01:32.327336 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:01:32.327801 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m18:01:32.328262 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:01:32.329408 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:01:32.330702 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:01:32.331154 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m18:01:32.331740 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:01:32.332183 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:01:32.332587 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m18:01:32.333311 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:01:32.334247 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:01:32.334689 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:01:32.335113 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:01:32.335694 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:01:32.336146 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m18:01:32.341795 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m18:01:32.347352 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:01:32.347884 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m18:01:32.348317 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:01:32.349227 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:01:32.349666 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:01:32.350109 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m18:01:32.360887 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m18:01:32.362295 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m18:01:32.363589 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m18:01:32.364078 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m18:01:32.365639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b6ae636-51c8-4781-8966-f1caa0107f5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a532bd644d0>]}
[0m18:01:32.366255 [debug] [MainThread]: Using duckdb connection "master"
[0m18:01:32.366807 [debug] [MainThread]: On master: BEGIN
[0m18:01:32.367392 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:01:32.368569 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:01:32.369094 [debug] [MainThread]: On master: COMMIT
[0m18:01:32.369696 [debug] [MainThread]: Using duckdb connection "master"
[0m18:01:32.370187 [debug] [MainThread]: On master: COMMIT
[0m18:01:32.371152 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:01:32.372032 [debug] [MainThread]: On master: Close
[0m18:01:32.374193 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:01:32.374863 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m18:01:32.375527 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m18:01:32.376055 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m18:01:32.384014 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:01:32.384758 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m18:01:32.440903 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:01:32.441494 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201180132416733"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'The transaction is fraud due to significant anomalies in PCA scores V12 and V17.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = 'a5160474-4fe2-4fcd-9d11-45b3604f170c'
    );
  
  
  
[0m18:01:32.442018 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:01:32.450435 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m18:01:32.458019 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:01:32.458521 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m18:01:32.459212 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:01:32.459688 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:01:32.460170 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201180132416733'
      
      
      order by ordinal_position

  
[0m18:01:32.463041 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:01:32.467938 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:01:32.468446 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:01:32.471439 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:01:32.481450 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:01:32.481984 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:01:32.484442 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:01:32.485953 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:01:32.486453 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m18:01:32.487228 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:01:32.503325 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:01:32.504135 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:01:32.504624 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201180132416733"
    )
  
[0m18:01:32.506102 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:01:32.516761 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:01:32.517401 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:01:32.517875 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:01:32.531681 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m18:01:32.533824 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m18:01:32.535601 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b6ae636-51c8-4781-8966-f1caa0107f5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a531ff2b290>]}
[0m18:01:32.536385 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m18:01:32.537163 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:01:32.538622 [debug] [MainThread]: Using duckdb connection "master"
[0m18:01:32.539147 [debug] [MainThread]: On master: BEGIN
[0m18:01:32.539594 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:01:32.540698 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:01:32.541175 [debug] [MainThread]: On master: COMMIT
[0m18:01:32.541589 [debug] [MainThread]: Using duckdb connection "master"
[0m18:01:32.542016 [debug] [MainThread]: On master: COMMIT
[0m18:01:32.542625 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:01:32.543087 [debug] [MainThread]: On master: Close
[0m18:01:32.543579 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:01:32.544003 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m18:01:32.544428 [info ] [MainThread]: 
[0m18:01:32.544880 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m18:01:32.545669 [debug] [MainThread]: Command end result
[0m18:01:32.565304 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:01:32.567047 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:01:32.572852 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m18:01:32.573342 [info ] [MainThread]: 
[0m18:01:32.573864 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:01:32.574324 [info ] [MainThread]: 
[0m18:01:32.574794 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:01:32.575444 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:01:32.576535 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.353813, "process_in_blocks": "0", "process_kernel_time": 0.324852, "process_mem_max_rss": "275040", "process_out_blocks": "3112", "process_user_time": 4.292625}
[0m18:01:32.577166 [debug] [MainThread]: Command `dbt run` succeeded at 18:01:32.577055 after 2.35 seconds
[0m18:01:32.577658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a532ce21d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a531fef58e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a531ff78320>]}
[0m18:01:32.578167 [debug] [MainThread]: Flushing usage events
[0m18:01:33.466204 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:01:49.051651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d407f990a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d407664da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d40778e8a0>]}


============================== 18:01:49.054890 | 56d0086e-f8f7-4a05-8fc9-afed47555d17 ==============================
[0m18:01:49.054890 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:01:49.055599 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'log_format': 'default', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'quiet': 'False', 'indirect_selection': 'eager', 'introspect': 'True', 'profiles_dir': '.', 'no_print': 'None', 'partial_parse': 'True', 'write_json': 'True', 'version_check': 'True', 'use_colors': 'True', 'printer_width': '80', 'use_experimental_parser': 'False', 'empty': 'False', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "59607940-8643-4828-928c-78bcb54a12d6", "ai_explanation": "Based on PCA factors, this transaction is fraud due to significant deviations from expected patterns."} --profiles-dir .', 'target_path': 'None', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'fail_fast': 'False', 'static_parser': 'True', 'cache_selected_only': 'False'}
[0m18:01:49.300709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '56d0086e-f8f7-4a05-8fc9-afed47555d17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d4084994f0>]}
[0m18:01:49.371330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '56d0086e-f8f7-4a05-8fc9-afed47555d17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d407539310>]}
[0m18:01:49.372999 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:01:49.456339 [debug] [MainThread]: checksum: 058952744eba9d4188a6943ba4a873bc3c23f38b426c253049c8044f8542f4c5, vars: {'ai_explanation': 'Based on PCA factors, this transaction is fraud due to '
                   'significant deviations from expected patterns.',
 'txn_id': '59607940-8643-4828-928c-78bcb54a12d6'}, profile: , target: , version: 1.11.2
[0m18:01:49.549113 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:01:49.549702 [debug] [MainThread]: previous checksum: 058952744eba9d4188a6943ba4a873bc3c23f38b426c253049c8044f8542f4c5, current checksum: d0161bcc9f47e0cc6e4b3eed1619ab9d6e4266902b16a7fd1b47b9f468a34c39
[0m18:01:49.550222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '56d0086e-f8f7-4a05-8fc9-afed47555d17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d3fb7a6c90>]}
[0m18:01:50.769795 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m18:01:50.770485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '56d0086e-f8f7-4a05-8fc9-afed47555d17', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d40750c3e0>]}
[0m18:01:50.862332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '56d0086e-f8f7-4a05-8fc9-afed47555d17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d4075e0440>]}
[0m18:01:50.930858 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:01:50.932576 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:01:50.944829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '56d0086e-f8f7-4a05-8fc9-afed47555d17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d3f81b25a0>]}
[0m18:01:50.945402 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m18:01:50.945870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56d0086e-f8f7-4a05-8fc9-afed47555d17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d3fb945580>]}
[0m18:01:50.947624 [info ] [MainThread]: 
[0m18:01:50.948136 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:01:50.948578 [info ] [MainThread]: 
[0m18:01:50.949214 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:01:50.950175 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m18:01:50.985524 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m18:01:50.986033 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m18:01:50.986464 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:51.078316 [debug] [ThreadPool]: SQL status: OK in 0.092 seconds
[0m18:01:51.080017 [debug] [ThreadPool]: On list_argus_vault: Close
[0m18:01:51.080894 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m18:01:51.081514 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m18:01:51.089291 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:01:51.089768 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m18:01:51.090311 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:01:51.092973 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m18:01:51.094517 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:01:51.095024 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m18:01:51.095667 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:01:51.096119 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:01:51.096525 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m18:01:51.097253 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:01:51.098214 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:01:51.098661 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:01:51.099101 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:01:51.099748 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:01:51.100221 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m18:01:51.106463 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m18:01:51.112639 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:01:51.113230 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m18:01:51.113639 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:01:51.115005 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:01:51.115447 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:01:51.115865 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m18:01:51.127464 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m18:01:51.128975 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m18:01:51.130377 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m18:01:51.130816 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m18:01:51.132489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56d0086e-f8f7-4a05-8fc9-afed47555d17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d3fb5eb110>]}
[0m18:01:51.133188 [debug] [MainThread]: Using duckdb connection "master"
[0m18:01:51.133614 [debug] [MainThread]: On master: BEGIN
[0m18:01:51.134038 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:01:51.134993 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:01:51.135434 [debug] [MainThread]: On master: COMMIT
[0m18:01:51.135845 [debug] [MainThread]: Using duckdb connection "master"
[0m18:01:51.136558 [debug] [MainThread]: On master: COMMIT
[0m18:01:51.137576 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:01:51.138086 [debug] [MainThread]: On master: Close
[0m18:01:51.140303 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:01:51.141075 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m18:01:51.141713 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m18:01:51.142263 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m18:01:51.150683 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:01:51.151418 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m18:01:51.207432 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:01:51.208034 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201180151183138"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Based on PCA factors, this transaction is fraud due to significant deviations from expected patterns.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '59607940-8643-4828-928c-78bcb54a12d6'
    );
  
  
  
[0m18:01:51.208540 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:01:51.216721 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m18:01:51.224301 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:01:51.224808 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m18:01:51.225497 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:01:51.225992 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:01:51.226469 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201180151183138'
      
      
      order by ordinal_position

  
[0m18:01:51.228986 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:01:51.233896 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:01:51.234436 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:01:51.237153 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:01:51.247208 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:01:51.247721 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:01:51.250417 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:01:51.251948 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:01:51.252455 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m18:01:51.253233 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:01:51.269516 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:01:51.270307 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:01:51.270804 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201180151183138"
    )
  
[0m18:01:51.272008 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:01:51.282314 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:01:51.282821 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:01:51.283321 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:01:51.296972 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m18:01:51.298904 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m18:01:51.300625 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56d0086e-f8f7-4a05-8fc9-afed47555d17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d40a1b8ef0>]}
[0m18:01:51.301399 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m18:01:51.302128 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:01:51.303700 [debug] [MainThread]: Using duckdb connection "master"
[0m18:01:51.304265 [debug] [MainThread]: On master: BEGIN
[0m18:01:51.304706 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:01:51.305611 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:01:51.306063 [debug] [MainThread]: On master: COMMIT
[0m18:01:51.306465 [debug] [MainThread]: Using duckdb connection "master"
[0m18:01:51.306854 [debug] [MainThread]: On master: COMMIT
[0m18:01:51.307464 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:01:51.307888 [debug] [MainThread]: On master: Close
[0m18:01:51.308417 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:01:51.308809 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m18:01:51.309245 [info ] [MainThread]: 
[0m18:01:51.309688 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m18:01:51.310442 [debug] [MainThread]: Command end result
[0m18:01:51.330075 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:01:51.331726 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:01:51.337283 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m18:01:51.337731 [info ] [MainThread]: 
[0m18:01:51.338266 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:01:51.338701 [info ] [MainThread]: 
[0m18:01:51.339182 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:01:51.339786 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:01:51.340831 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.351264, "process_in_blocks": "0", "process_kernel_time": 0.298045, "process_mem_max_rss": "282508", "process_out_blocks": "3104", "process_user_time": 4.263043}
[0m18:01:51.341453 [debug] [MainThread]: Command `dbt run` succeeded at 18:01:51.341352 after 2.35 seconds
[0m18:01:51.341944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d3fb544a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d407d3e1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d3e3326990>]}
[0m18:01:51.342423 [debug] [MainThread]: Flushing usage events
[0m18:01:52.346058 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:02:09.532456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6a7791aae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6a77cfa390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6a77cfa1b0>]}


============================== 18:02:09.535796 | d48da486-e084-40ec-8039-c564edeca669 ==============================
[0m18:02:09.535796 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:02:09.536512 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'debug': 'False', 'profiles_dir': '.', 'log_format': 'default', 'warn_error': 'None', 'printer_width': '80', 'log_cache_events': 'False', 'quiet': 'False', 'target_path': 'None', 'introspect': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "8f120c20-ca74-4480-abae-bd73d68fca1c", "ai_explanation": "Fraudulent transaction identified due to extreme PCA scores: V12 and V17 indicate manipulation of financial data."} --profiles-dir .', 'indirect_selection': 'eager', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'cache_selected_only': 'False', 'empty': 'False', 'partial_parse': 'True', 'write_json': 'True'}
[0m18:02:09.782470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd48da486-e084-40ec-8039-c564edeca669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6a76c039b0>]}
[0m18:02:09.853036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd48da486-e084-40ec-8039-c564edeca669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6a76bbbef0>]}
[0m18:02:09.854755 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:02:09.940500 [debug] [MainThread]: checksum: 01b3c88a5fb117a3946f10e2318c0efa76173de910a9edeb752c56f2050c99c6, vars: {'ai_explanation': 'Fraudulent transaction identified due to extreme PCA '
                   'scores: V12 and V17 indicate manipulation of financial '
                   'data.',
 'txn_id': '8f120c20-ca74-4480-abae-bd73d68fca1c'}, profile: , target: , version: 1.11.2
[0m18:02:10.033491 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:02:10.034117 [debug] [MainThread]: previous checksum: 01b3c88a5fb117a3946f10e2318c0efa76173de910a9edeb752c56f2050c99c6, current checksum: 058952744eba9d4188a6943ba4a873bc3c23f38b426c253049c8044f8542f4c5
[0m18:02:10.034580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd48da486-e084-40ec-8039-c564edeca669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6a775528d0>]}
[0m18:02:11.260328 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m18:02:11.261039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd48da486-e084-40ec-8039-c564edeca669', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6a6ad8b230>]}
[0m18:02:11.351642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd48da486-e084-40ec-8039-c564edeca669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6a76c036e0>]}
[0m18:02:11.422845 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:02:11.424721 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:02:11.437260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd48da486-e084-40ec-8039-c564edeca669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6a6ad25b20>]}
[0m18:02:11.437840 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m18:02:11.438366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd48da486-e084-40ec-8039-c564edeca669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6a681071a0>]}
[0m18:02:11.440159 [info ] [MainThread]: 
[0m18:02:11.440684 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:02:11.441171 [info ] [MainThread]: 
[0m18:02:11.441823 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:02:11.442902 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m18:02:11.478410 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m18:02:11.478945 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m18:02:11.479450 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:02:11.570242 [debug] [ThreadPool]: SQL status: OK in 0.091 seconds
[0m18:02:11.572618 [debug] [ThreadPool]: On list_argus_vault: Close
[0m18:02:11.573824 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m18:02:11.574715 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m18:02:11.585542 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:02:11.586245 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m18:02:11.586872 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:02:11.589040 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m18:02:11.591053 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:02:11.591682 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m18:02:11.592567 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:02:11.593221 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:02:11.593835 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m18:02:11.594806 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:02:11.596259 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:02:11.596907 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:02:11.597550 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:02:11.598484 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:02:11.599151 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m18:02:11.604963 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m18:02:11.610936 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:02:11.611474 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m18:02:11.611879 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:02:11.613114 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:02:11.613549 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:02:11.614001 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m18:02:11.625183 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m18:02:11.626691 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m18:02:11.627985 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m18:02:11.628429 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m18:02:11.629977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd48da486-e084-40ec-8039-c564edeca669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6a16d330e0>]}
[0m18:02:11.630652 [debug] [MainThread]: Using duckdb connection "master"
[0m18:02:11.631140 [debug] [MainThread]: On master: BEGIN
[0m18:02:11.631582 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:02:11.632515 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:02:11.633007 [debug] [MainThread]: On master: COMMIT
[0m18:02:11.633465 [debug] [MainThread]: Using duckdb connection "master"
[0m18:02:11.633902 [debug] [MainThread]: On master: COMMIT
[0m18:02:11.634527 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:02:11.634999 [debug] [MainThread]: On master: Close
[0m18:02:11.637064 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:02:11.637699 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m18:02:11.638279 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m18:02:11.638775 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m18:02:11.646777 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:02:11.647521 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m18:02:11.703537 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:02:11.704135 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201180211679309"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Fraudulent transaction identified due to extreme PCA scores: V12 and V17 indicate manipulation of financial data.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '8f120c20-ca74-4480-abae-bd73d68fca1c'
    );
  
  
  
[0m18:02:11.704629 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:02:11.714308 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m18:02:11.722319 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:02:11.722851 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m18:02:11.723636 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:02:11.724148 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:02:11.724620 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201180211679309'
      
      
      order by ordinal_position

  
[0m18:02:11.727421 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:02:11.732403 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:02:11.732942 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:02:11.736020 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:02:11.746206 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:02:11.746739 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:02:11.749459 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:02:11.750991 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:02:11.751501 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m18:02:11.752308 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:02:11.768578 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:02:11.769364 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:02:11.769862 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201180211679309"
    )
  
[0m18:02:11.771072 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:02:11.781408 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:02:11.781958 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:02:11.782427 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:02:11.798128 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m18:02:11.800250 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m18:02:11.801974 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd48da486-e084-40ec-8039-c564edeca669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6a6ae3f770>]}
[0m18:02:11.802722 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m18:02:11.803461 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:02:11.804806 [debug] [MainThread]: Using duckdb connection "master"
[0m18:02:11.805395 [debug] [MainThread]: On master: BEGIN
[0m18:02:11.805902 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:02:11.806890 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:02:11.807380 [debug] [MainThread]: On master: COMMIT
[0m18:02:11.807830 [debug] [MainThread]: Using duckdb connection "master"
[0m18:02:11.808294 [debug] [MainThread]: On master: COMMIT
[0m18:02:11.809056 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:02:11.809537 [debug] [MainThread]: On master: Close
[0m18:02:11.810084 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:02:11.810528 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m18:02:11.811017 [info ] [MainThread]: 
[0m18:02:11.811508 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m18:02:11.812332 [debug] [MainThread]: Command end result
[0m18:02:11.833850 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:02:11.835566 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:02:11.841281 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m18:02:11.841739 [info ] [MainThread]: 
[0m18:02:11.842335 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:02:11.842810 [info ] [MainThread]: 
[0m18:02:11.843369 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:02:11.844050 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:02:11.845154 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3746617, "process_in_blocks": "0", "process_kernel_time": 0.283561, "process_mem_max_rss": "281316", "process_out_blocks": "3112", "process_user_time": 4.32976}
[0m18:02:11.845768 [debug] [MainThread]: Command `dbt run` succeeded at 18:02:11.845660 after 2.38 seconds
[0m18:02:11.846302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6a775fe7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6a77387800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6a777572f0>]}
[0m18:02:11.846816 [debug] [MainThread]: Flushing usage events
[0m18:02:12.840892 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:02:31.439608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711fe8a397c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711fea87de50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711fe8a399a0>]}


============================== 18:02:31.442964 | 1c398d9f-86ee-4e43-9f12-8adfaba9fe09 ==============================
[0m18:02:31.442964 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:02:31.443624 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'quiet': 'False', 'fail_fast': 'False', 'target_path': 'None', 'empty': 'False', 'write_json': 'True', 'log_format': 'default', 'use_experimental_parser': 'False', 'version_check': 'True', 'printer_width': '80', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "ccf36b6b-699e-4d19-9744-e9887ed66f11", "ai_explanation": "Fraud likely due to PCA factors V3, V7, and V12 indicating significant anomalies."} --profiles-dir .', 'no_print': 'None', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'static_parser': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'warn_error': 'None', 'profiles_dir': '.', 'introspect': 'True'}
[0m18:02:31.690861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c398d9f-86ee-4e43-9f12-8adfaba9fe09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711fe7949940>]}
[0m18:02:31.761721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1c398d9f-86ee-4e43-9f12-8adfaba9fe09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711fea4910d0>]}
[0m18:02:31.763479 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:02:31.846941 [debug] [MainThread]: checksum: d4c53a8d7dca206fdea1c14c3611d031315871c9c409f2a8f3667409a6c1dbf3, vars: {'ai_explanation': 'Fraud likely due to PCA factors V3, V7, and V12 indicating '
                   'significant anomalies.',
 'txn_id': 'ccf36b6b-699e-4d19-9744-e9887ed66f11'}, profile: , target: , version: 1.11.2
[0m18:02:31.939301 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:02:31.939878 [debug] [MainThread]: previous checksum: d4c53a8d7dca206fdea1c14c3611d031315871c9c409f2a8f3667409a6c1dbf3, current checksum: 01b3c88a5fb117a3946f10e2318c0efa76173de910a9edeb752c56f2050c99c6
[0m18:02:31.940374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1c398d9f-86ee-4e43-9f12-8adfaba9fe09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711fe7856360>]}
[0m18:02:33.166170 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m18:02:33.166883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1c398d9f-86ee-4e43-9f12-8adfaba9fe09', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711fdb98c800>]}
[0m18:02:33.259303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c398d9f-86ee-4e43-9f12-8adfaba9fe09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711fdb9ab350>]}
[0m18:02:33.327952 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:02:33.329629 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:02:33.341764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c398d9f-86ee-4e43-9f12-8adfaba9fe09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711f9b70f320>]}
[0m18:02:33.342346 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m18:02:33.342871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c398d9f-86ee-4e43-9f12-8adfaba9fe09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711fd81bc8c0>]}
[0m18:02:33.344629 [info ] [MainThread]: 
[0m18:02:33.345184 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:02:33.345656 [info ] [MainThread]: 
[0m18:02:33.346315 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:02:33.347330 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m18:02:33.382187 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m18:02:33.382679 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m18:02:33.383142 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:02:33.468898 [debug] [ThreadPool]: SQL status: OK in 0.086 seconds
[0m18:02:33.470608 [debug] [ThreadPool]: On list_argus_vault: Close
[0m18:02:33.471577 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m18:02:33.472188 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m18:02:33.479717 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:02:33.480223 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m18:02:33.480649 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:02:33.482321 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m18:02:33.483716 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:02:33.484178 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m18:02:33.484772 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:02:33.485222 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:02:33.485628 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m18:02:33.486306 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:02:33.487306 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:02:33.487770 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:02:33.488207 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:02:33.488812 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:02:33.489291 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m18:02:33.494994 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m18:02:33.500966 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:02:33.501508 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m18:02:33.501942 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:02:33.502863 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:02:33.503334 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:02:33.503754 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m18:02:33.515412 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m18:02:33.517138 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m18:02:33.518448 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m18:02:33.518895 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m18:02:33.520520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c398d9f-86ee-4e43-9f12-8adfaba9fe09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711fd80fbc20>]}
[0m18:02:33.521168 [debug] [MainThread]: Using duckdb connection "master"
[0m18:02:33.521634 [debug] [MainThread]: On master: BEGIN
[0m18:02:33.522094 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:02:33.523131 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:02:33.523596 [debug] [MainThread]: On master: COMMIT
[0m18:02:33.524076 [debug] [MainThread]: Using duckdb connection "master"
[0m18:02:33.524508 [debug] [MainThread]: On master: COMMIT
[0m18:02:33.525153 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:02:33.525624 [debug] [MainThread]: On master: Close
[0m18:02:33.527730 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:02:33.528471 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m18:02:33.529067 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m18:02:33.529671 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m18:02:33.538231 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:02:33.538963 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m18:02:33.595635 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:02:33.596216 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201180233571204"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Fraud likely due to PCA factors V3, V7, and V12 indicating significant anomalies.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = 'ccf36b6b-699e-4d19-9744-e9887ed66f11'
    );
  
  
  
[0m18:02:33.596701 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:02:33.605066 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m18:02:33.612634 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:02:33.613160 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m18:02:33.613827 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:02:33.614327 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:02:33.614785 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201180233571204'
      
      
      order by ordinal_position

  
[0m18:02:33.617455 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:02:33.622477 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:02:33.623012 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:02:33.625783 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:02:33.635926 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:02:33.636445 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:02:33.639264 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:02:33.640781 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:02:33.641310 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m18:02:33.642069 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:02:33.658409 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:02:33.659192 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:02:33.659687 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201180233571204"
    )
  
[0m18:02:33.660846 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:02:33.671290 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:02:33.671794 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:02:33.672302 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:02:33.686175 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m18:02:33.688257 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m18:02:33.689998 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c398d9f-86ee-4e43-9f12-8adfaba9fe09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711fdb95bf20>]}
[0m18:02:33.690749 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m18:02:33.691486 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:02:33.692848 [debug] [MainThread]: Using duckdb connection "master"
[0m18:02:33.693421 [debug] [MainThread]: On master: BEGIN
[0m18:02:33.693935 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:02:33.694869 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:02:33.695355 [debug] [MainThread]: On master: COMMIT
[0m18:02:33.695793 [debug] [MainThread]: Using duckdb connection "master"
[0m18:02:33.696242 [debug] [MainThread]: On master: COMMIT
[0m18:02:33.696858 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:02:33.697332 [debug] [MainThread]: On master: Close
[0m18:02:33.697841 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:02:33.698291 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m18:02:33.698849 [info ] [MainThread]: 
[0m18:02:33.699568 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m18:02:33.700379 [debug] [MainThread]: Command end result
[0m18:02:33.721028 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:02:33.722650 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:02:33.728419 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m18:02:33.728861 [info ] [MainThread]: 
[0m18:02:33.729435 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:02:33.729881 [info ] [MainThread]: 
[0m18:02:33.730408 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:02:33.731067 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:02:33.732137 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3548138, "process_in_blocks": "0", "process_kernel_time": 0.306939, "process_mem_max_rss": "279852", "process_out_blocks": "3120", "process_user_time": 4.288214}
[0m18:02:33.732728 [debug] [MainThread]: Command `dbt run` succeeded at 18:02:33.732621 after 2.36 seconds
[0m18:02:33.733238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711fe88fa360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711fdb926360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711fdb9d9070>]}
[0m18:02:33.733739 [debug] [MainThread]: Flushing usage events
[0m18:02:34.708512 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:02:50.633272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705f7a52a6c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705f79cb43b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705f79d7a9f0>]}


============================== 18:02:50.636780 | cd82a605-69b4-40a5-bb08-04eade3255e7 ==============================
[0m18:02:50.636780 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:02:50.637502 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'introspect': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'log_cache_events': 'False', 'no_print': 'None', 'warn_error': 'None', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'empty': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'fail_fast': 'False', 'cache_selected_only': 'False', 'profiles_dir': '.', 'indirect_selection': 'eager', 'log_format': 'default', 'debug': 'False', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "a7cb3f02-4357-432e-be6e-6a9d57e7f2e9", "ai_explanation": "The transaction is flagged as fraudulent due to PCA factor V17 (-18.103) exceeding the threshold."} --profiles-dir .', 'write_json': 'True', 'target_path': 'None', 'partial_parse': 'True'}
[0m18:02:50.887511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd82a605-69b4-40a5-bb08-04eade3255e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705f793627b0>]}
[0m18:02:50.958849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd82a605-69b4-40a5-bb08-04eade3255e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705f7943acf0>]}
[0m18:02:50.960598 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:02:51.044986 [debug] [MainThread]: checksum: 82adec693854520924edb16a7a6927163ea07c7ab319bffb9cf6dfc5135f5a5c, vars: {'ai_explanation': 'The transaction is flagged as fraudulent due to PCA factor '
                   'V17 (-18.103) exceeding the threshold.',
 'txn_id': 'a7cb3f02-4357-432e-be6e-6a9d57e7f2e9'}, profile: , target: , version: 1.11.2
[0m18:02:51.138224 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:02:51.138826 [debug] [MainThread]: previous checksum: 82adec693854520924edb16a7a6927163ea07c7ab319bffb9cf6dfc5135f5a5c, current checksum: d4c53a8d7dca206fdea1c14c3611d031315871c9c409f2a8f3667409a6c1dbf3
[0m18:02:51.139327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cd82a605-69b4-40a5-bb08-04eade3255e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705f6d9d68d0>]}
[0m18:02:52.376118 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m18:02:52.376812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cd82a605-69b4-40a5-bb08-04eade3255e7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705f6c183c50>]}
[0m18:02:52.469455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd82a605-69b4-40a5-bb08-04eade3255e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705f6c0bf740>]}
[0m18:02:52.542747 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:02:52.544683 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:02:52.557511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd82a605-69b4-40a5-bb08-04eade3255e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705f6d52e750>]}
[0m18:02:52.558129 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m18:02:52.558628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd82a605-69b4-40a5-bb08-04eade3255e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705f6c0edc70>]}
[0m18:02:52.560477 [info ] [MainThread]: 
[0m18:02:52.561028 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:02:52.561511 [info ] [MainThread]: 
[0m18:02:52.562204 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:02:52.563288 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m18:02:52.598707 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m18:02:52.599254 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m18:02:52.599688 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:02:52.689723 [debug] [ThreadPool]: SQL status: OK in 0.090 seconds
[0m18:02:52.691437 [debug] [ThreadPool]: On list_argus_vault: Close
[0m18:02:52.692291 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m18:02:52.692861 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m18:02:52.700157 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:02:52.700612 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m18:02:52.701048 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:02:52.702169 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:02:52.703463 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:02:52.703895 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m18:02:52.704505 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:02:52.704941 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:02:52.705350 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m18:02:52.706064 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:02:52.707000 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:02:52.707436 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:02:52.707836 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:02:52.708537 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:02:52.708994 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m18:02:52.714680 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m18:02:52.720344 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:02:52.720872 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m18:02:52.721299 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:02:52.722196 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:02:52.722627 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:02:52.723068 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m18:02:52.733951 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m18:02:52.735389 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m18:02:52.736660 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m18:02:52.737122 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m18:02:52.738650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd82a605-69b4-40a5-bb08-04eade3255e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705f512f3d70>]}
[0m18:02:52.739310 [debug] [MainThread]: Using duckdb connection "master"
[0m18:02:52.739805 [debug] [MainThread]: On master: BEGIN
[0m18:02:52.740275 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:02:52.741299 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:02:52.741783 [debug] [MainThread]: On master: COMMIT
[0m18:02:52.742273 [debug] [MainThread]: Using duckdb connection "master"
[0m18:02:52.742721 [debug] [MainThread]: On master: COMMIT
[0m18:02:52.743381 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:02:52.743846 [debug] [MainThread]: On master: Close
[0m18:02:52.745986 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:02:52.746710 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m18:02:52.747277 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m18:02:52.747751 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m18:02:52.755791 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:02:52.756510 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m18:02:52.812745 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:02:52.813325 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201180252788499"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'The transaction is flagged as fraudulent due to PCA factor V17 (-18.103) exceeding the threshold.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = 'a7cb3f02-4357-432e-be6e-6a9d57e7f2e9'
    );
  
  
  
[0m18:02:52.813808 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:02:52.822574 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m18:02:52.830346 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:02:52.830853 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m18:02:52.831596 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:02:52.832098 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:02:52.832558 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201180252788499'
      
      
      order by ordinal_position

  
[0m18:02:52.835043 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:02:52.840024 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:02:52.840538 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:02:52.843035 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:02:52.853065 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:02:52.853579 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:02:52.855967 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:02:52.857457 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:02:52.857971 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m18:02:52.858714 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:02:52.874993 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:02:52.875760 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:02:52.876274 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201180252788499"
    )
  
[0m18:02:52.877469 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:02:52.888044 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:02:52.888550 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:02:52.889041 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:02:52.902269 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m18:02:52.904407 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m18:02:52.906137 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd82a605-69b4-40a5-bb08-04eade3255e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705f7a360c20>]}
[0m18:02:52.906882 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m18:02:52.907613 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:02:52.908983 [debug] [MainThread]: Using duckdb connection "master"
[0m18:02:52.909541 [debug] [MainThread]: On master: BEGIN
[0m18:02:52.910083 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:02:52.911025 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:02:52.911494 [debug] [MainThread]: On master: COMMIT
[0m18:02:52.911973 [debug] [MainThread]: Using duckdb connection "master"
[0m18:02:52.912416 [debug] [MainThread]: On master: COMMIT
[0m18:02:52.913081 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:02:52.913553 [debug] [MainThread]: On master: Close
[0m18:02:52.914087 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:02:52.914516 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m18:02:52.914998 [info ] [MainThread]: 
[0m18:02:52.915497 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m18:02:52.916325 [debug] [MainThread]: Command end result
[0m18:02:52.938497 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:02:52.940229 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:02:52.946010 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m18:02:52.946469 [info ] [MainThread]: 
[0m18:02:52.947050 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:02:52.947524 [info ] [MainThread]: 
[0m18:02:52.948066 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:02:52.948725 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:02:52.949813 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3798416, "process_in_blocks": "0", "process_kernel_time": 0.332516, "process_mem_max_rss": "269512", "process_out_blocks": "3112", "process_user_time": 4.295912}
[0m18:02:52.950454 [debug] [MainThread]: Command `dbt run` succeeded at 18:02:52.950344 after 2.38 seconds
[0m18:02:52.950973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705f7c37e060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705f7bf953a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705f7943a390>]}
[0m18:02:52.951486 [debug] [MainThread]: Flushing usage events
[0m18:02:53.835783 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:03:09.300870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4534a8a3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4534910320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4537644d40>]}


============================== 18:03:09.304464 | 6f26c223-319c-4fca-8ab0-0431eaf83f32 ==============================
[0m18:03:09.304464 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:03:09.305165 [debug] [MainThread]: running dbt with arguments {'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'use_colors': 'True', 'cache_selected_only': 'False', 'empty': 'False', 'partial_parse': 'True', 'warn_error': 'None', 'log_cache_events': 'False', 'printer_width': '80', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'quiet': 'False', 'indirect_selection': 'eager', 'fail_fast': 'False', 'version_check': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'profiles_dir': '.', 'log_format': 'default', 'introspect': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "87a1c74b-91a8-406b-9e60-43ebb49fd20b", "ai_explanation": "Fraud detected: significant deviations in PCA factors indicate manipulation of financial data."} --profiles-dir .'}
[0m18:03:09.556705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6f26c223-319c-4fca-8ab0-0431eaf83f32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4528db3170>]}
[0m18:03:09.627796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6f26c223-319c-4fca-8ab0-0431eaf83f32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e45373e15b0>]}
[0m18:03:09.629525 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:03:09.713969 [debug] [MainThread]: checksum: 9b6ae109f7ffbd6793181a86e389b19021d1faef7f219cdd1a0f64790a3d717b, vars: {'ai_explanation': 'Fraud detected: significant deviations in PCA factors '
                   'indicate manipulation of financial data.',
 'txn_id': '87a1c74b-91a8-406b-9e60-43ebb49fd20b'}, profile: , target: , version: 1.11.2
[0m18:03:09.807660 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:03:09.808281 [debug] [MainThread]: previous checksum: 9b6ae109f7ffbd6793181a86e389b19021d1faef7f219cdd1a0f64790a3d717b, current checksum: 82adec693854520924edb16a7a6927163ea07c7ab319bffb9cf6dfc5135f5a5c
[0m18:03:09.808749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6f26c223-319c-4fca-8ab0-0431eaf83f32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4528ab2630>]}
[0m18:03:11.061449 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m18:03:11.062150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6f26c223-319c-4fca-8ab0-0431eaf83f32', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4534834800>]}
[0m18:03:11.156000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6f26c223-319c-4fca-8ab0-0431eaf83f32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e45280e4740>]}
[0m18:03:11.225576 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:03:11.227357 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:03:11.241553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6f26c223-319c-4fca-8ab0-0431eaf83f32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4528131190>]}
[0m18:03:11.242173 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m18:03:11.242647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f26c223-319c-4fca-8ab0-0431eaf83f32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e45348e4620>]}
[0m18:03:11.244493 [info ] [MainThread]: 
[0m18:03:11.245010 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:03:11.245457 [info ] [MainThread]: 
[0m18:03:11.246129 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:03:11.247501 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m18:03:11.283305 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m18:03:11.283881 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m18:03:11.284377 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:03:11.368757 [debug] [ThreadPool]: SQL status: OK in 0.084 seconds
[0m18:03:11.370515 [debug] [ThreadPool]: On list_argus_vault: Close
[0m18:03:11.371395 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m18:03:11.372011 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m18:03:11.379440 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:03:11.379907 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m18:03:11.380350 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:03:11.382033 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m18:03:11.383366 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:03:11.383800 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m18:03:11.384422 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:03:11.384846 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:03:11.385273 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m18:03:11.385897 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:03:11.386831 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:03:11.387291 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:03:11.387694 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:03:11.388373 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:03:11.388817 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m18:03:11.394513 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m18:03:11.400251 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:03:11.400786 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m18:03:11.401210 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:03:11.402107 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:03:11.402541 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:03:11.402971 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m18:03:11.413853 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m18:03:11.415306 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m18:03:11.416567 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m18:03:11.417029 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m18:03:11.418730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f26c223-319c-4fca-8ab0-0431eaf83f32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4528196960>]}
[0m18:03:11.419344 [debug] [MainThread]: Using duckdb connection "master"
[0m18:03:11.419769 [debug] [MainThread]: On master: BEGIN
[0m18:03:11.420197 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:03:11.421067 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:03:11.421513 [debug] [MainThread]: On master: COMMIT
[0m18:03:11.421967 [debug] [MainThread]: Using duckdb connection "master"
[0m18:03:11.422394 [debug] [MainThread]: On master: COMMIT
[0m18:03:11.423024 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:03:11.423465 [debug] [MainThread]: On master: Close
[0m18:03:11.425504 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:03:11.426150 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m18:03:11.426759 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m18:03:11.427264 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m18:03:11.435318 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:03:11.436055 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m18:03:11.493051 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:03:11.493616 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201180311468478"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Fraud detected: significant deviations in PCA factors indicate manipulation of financial data.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '87a1c74b-91a8-406b-9e60-43ebb49fd20b'
    );
  
  
  
[0m18:03:11.494123 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:11.502671 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m18:03:11.510313 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:03:11.510819 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m18:03:11.511516 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:03:11.512012 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:03:11.512483 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201180311468478'
      
      
      order by ordinal_position

  
[0m18:03:11.515168 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:03:11.520157 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:03:11.520664 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:03:11.523155 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:03:11.533316 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:03:11.533841 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:03:11.536185 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:03:11.537690 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:03:11.538213 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m18:03:11.539227 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:03:11.555723 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:03:11.556509 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:03:11.557026 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201180311468478"
    )
  
[0m18:03:11.558171 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:03:11.568700 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:03:11.569264 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:03:11.569721 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:03:11.584201 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m18:03:11.586196 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m18:03:11.587949 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f26c223-319c-4fca-8ab0-0431eaf83f32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4535927e30>]}
[0m18:03:11.588701 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m18:03:11.589483 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:03:11.590902 [debug] [MainThread]: Using duckdb connection "master"
[0m18:03:11.591437 [debug] [MainThread]: On master: BEGIN
[0m18:03:11.591876 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:03:11.592845 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:03:11.593305 [debug] [MainThread]: On master: COMMIT
[0m18:03:11.593714 [debug] [MainThread]: Using duckdb connection "master"
[0m18:03:11.594138 [debug] [MainThread]: On master: COMMIT
[0m18:03:11.594740 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:03:11.595202 [debug] [MainThread]: On master: Close
[0m18:03:11.595691 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:03:11.596118 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m18:03:11.596541 [info ] [MainThread]: 
[0m18:03:11.597009 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m18:03:11.597773 [debug] [MainThread]: Command end result
[0m18:03:11.617943 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:03:11.619634 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:03:11.625354 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m18:03:11.625795 [info ] [MainThread]: 
[0m18:03:11.626328 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:03:11.626762 [info ] [MainThread]: 
[0m18:03:11.627239 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:03:11.627844 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:03:11.628873 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3926713, "process_in_blocks": "0", "process_kernel_time": 0.300176, "process_mem_max_rss": "272360", "process_out_blocks": "3120", "process_user_time": 4.353546}
[0m18:03:11.629469 [debug] [MainThread]: Command `dbt run` succeeded at 18:03:11.629368 after 2.39 seconds
[0m18:03:11.629944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4535909820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e45348e6450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e45348e7590>]}
[0m18:03:11.630423 [debug] [MainThread]: Flushing usage events
[0m18:03:12.513696 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:03:27.731898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74a39ed39e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74a39e4ddb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74a39efe7200>]}


============================== 18:03:27.735343 | d1455091-9bbc-43fc-a186-7ad59119698d ==============================
[0m18:03:27.735343 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:03:27.736048 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'printer_width': '80', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'introspect': 'True', 'target_path': 'None', 'use_experimental_parser': 'False', 'static_parser': 'True', 'warn_error': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "2b66a29b-5aea-427c-a810-027ae6e7a19f", "ai_explanation": "The transaction exhibits a high degree of unusual behavior, indicating potential fraud."} --profiles-dir .', 'use_colors': 'True', 'quiet': 'False', 'debug': 'False', 'no_print': 'None', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'empty': 'False', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'profiles_dir': '.', 'partial_parse': 'True', 'cache_selected_only': 'False'}
[0m18:03:27.982802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1455091-9bbc-43fc-a186-7ad59119698d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74a39e345610>]}
[0m18:03:28.053568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd1455091-9bbc-43fc-a186-7ad59119698d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74a39e4059a0>]}
[0m18:03:28.055303 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:03:28.139186 [debug] [MainThread]: checksum: 3114cc0e8bf858be067f17c085477938824c2dbf1e3c7843cc4726f34368bcb2, vars: {'ai_explanation': 'The transaction exhibits a high degree of unusual '
                   'behavior, indicating potential fraud.',
 'txn_id': '2b66a29b-5aea-427c-a810-027ae6e7a19f'}, profile: , target: , version: 1.11.2
[0m18:03:28.232570 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:03:28.233196 [debug] [MainThread]: previous checksum: 3114cc0e8bf858be067f17c085477938824c2dbf1e3c7843cc4726f34368bcb2, current checksum: 9b6ae109f7ffbd6793181a86e389b19021d1faef7f219cdd1a0f64790a3d717b
[0m18:03:28.233663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd1455091-9bbc-43fc-a186-7ad59119698d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74a3924ca0c0>]}
[0m18:03:29.453702 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m18:03:29.454374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd1455091-9bbc-43fc-a186-7ad59119698d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74a3903a27e0>]}
[0m18:03:29.554243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1455091-9bbc-43fc-a186-7ad59119698d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74a3903a0890>]}
[0m18:03:29.623413 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:03:29.625398 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:03:29.638956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd1455091-9bbc-43fc-a186-7ad59119698d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74a352070410>]}
[0m18:03:29.639597 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m18:03:29.640106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1455091-9bbc-43fc-a186-7ad59119698d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74a392799cd0>]}
[0m18:03:29.641884 [info ] [MainThread]: 
[0m18:03:29.642407 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:03:29.642838 [info ] [MainThread]: 
[0m18:03:29.643492 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:03:29.644524 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m18:03:29.681216 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m18:03:29.681876 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m18:03:29.682368 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:03:29.778376 [debug] [ThreadPool]: SQL status: OK in 0.096 seconds
[0m18:03:29.780117 [debug] [ThreadPool]: On list_argus_vault: Close
[0m18:03:29.781081 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m18:03:29.781691 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m18:03:29.789326 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:03:29.789837 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m18:03:29.790312 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:03:29.792076 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m18:03:29.793490 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:03:29.793966 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m18:03:29.794624 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:03:29.795093 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:03:29.795532 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m18:03:29.796286 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:03:29.797257 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:03:29.797718 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:03:29.798182 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:03:29.798818 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:03:29.799316 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m18:03:29.805767 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m18:03:29.812167 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:03:29.812767 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m18:03:29.813278 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:03:29.815074 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m18:03:29.815516 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:03:29.815970 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m18:03:29.827009 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m18:03:29.828547 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m18:03:29.829833 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m18:03:29.830299 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m18:03:29.831861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1455091-9bbc-43fc-a186-7ad59119698d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74a3925b4da0>]}
[0m18:03:29.832527 [debug] [MainThread]: Using duckdb connection "master"
[0m18:03:29.832998 [debug] [MainThread]: On master: BEGIN
[0m18:03:29.833438 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:03:29.834335 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:03:29.834806 [debug] [MainThread]: On master: COMMIT
[0m18:03:29.835292 [debug] [MainThread]: Using duckdb connection "master"
[0m18:03:29.835724 [debug] [MainThread]: On master: COMMIT
[0m18:03:29.836390 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:03:29.836857 [debug] [MainThread]: On master: Close
[0m18:03:29.838992 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:03:29.839639 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m18:03:29.840217 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m18:03:29.840696 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m18:03:29.849123 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:03:29.849832 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m18:03:29.906159 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:03:29.906706 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201180329881660"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'The transaction exhibits a high degree of unusual behavior, indicating potential fraud.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '2b66a29b-5aea-427c-a810-027ae6e7a19f'
    );
  
  
  
[0m18:03:29.907217 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:29.915606 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m18:03:29.923108 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:03:29.923613 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m18:03:29.924315 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:03:29.924795 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:03:29.925284 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201180329881660'
      
      
      order by ordinal_position

  
[0m18:03:29.928235 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:03:29.933256 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:03:29.933776 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:03:29.936614 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:03:29.946736 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:03:29.947280 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:03:29.949677 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:03:29.951204 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:03:29.951710 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m18:03:29.952732 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:03:29.969129 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:03:29.969897 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:03:29.970409 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201180329881660"
    )
  
[0m18:03:29.971563 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:03:29.982025 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:03:29.982536 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:03:29.983012 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:03:29.987389 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m18:03:29.989391 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m18:03:29.991155 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1455091-9bbc-43fc-a186-7ad59119698d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74a3903765d0>]}
[0m18:03:29.991946 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.15s]
[0m18:03:29.992665 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:03:29.994039 [debug] [MainThread]: Using duckdb connection "master"
[0m18:03:29.994527 [debug] [MainThread]: On master: BEGIN
[0m18:03:29.994971 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:03:29.995946 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:03:29.996387 [debug] [MainThread]: On master: COMMIT
[0m18:03:29.996796 [debug] [MainThread]: Using duckdb connection "master"
[0m18:03:29.997223 [debug] [MainThread]: On master: COMMIT
[0m18:03:29.997802 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:03:29.998262 [debug] [MainThread]: On master: Close
[0m18:03:29.998752 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:03:29.999182 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m18:03:29.999599 [info ] [MainThread]: 
[0m18:03:30.000065 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m18:03:30.000811 [debug] [MainThread]: Command end result
[0m18:03:30.020691 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:03:30.022364 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:03:30.028017 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m18:03:30.028450 [info ] [MainThread]: 
[0m18:03:30.028976 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:03:30.029418 [info ] [MainThread]: 
[0m18:03:30.029883 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:03:30.030520 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:03:30.031552 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3644876, "process_in_blocks": "0", "process_kernel_time": 0.310049, "process_mem_max_rss": "282080", "process_out_blocks": "3112", "process_user_time": 4.271355}
[0m18:03:30.032159 [debug] [MainThread]: Command `dbt run` succeeded at 18:03:30.032048 after 2.37 seconds
[0m18:03:30.032631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74a39e9820f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74a35200df40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74a39034b200>]}
[0m18:03:30.033136 [debug] [MainThread]: Flushing usage events
[0m18:03:31.087907 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:03:46.562001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8071363a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b80722952b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8070c13470>]}


============================== 18:03:46.565422 | 5fb8f577-0a1f-4345-9fe2-6dbab87079a7 ==============================
[0m18:03:46.565422 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:03:46.566146 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'fail_fast': 'False', 'quiet': 'False', 'log_format': 'default', 'printer_width': '80', 'no_print': 'None', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'write_json': 'True', 'profiles_dir': '.', 'use_experimental_parser': 'False', 'use_colors': 'True', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "7aeeefd4-6003-4c7a-b2f1-18575c4e926e", "ai_explanation": "Based on PCA factors, this transaction exhibits suspicious outliers and anomalies, indicating fraud."} --profiles-dir .', 'debug': 'False', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'warn_error': 'None', 'version_check': 'True', 'static_parser': 'True', 'partial_parse': 'True', 'introspect': 'True'}
[0m18:03:46.813953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5fb8f577-0a1f-4345-9fe2-6dbab87079a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b807139ad80>]}
[0m18:03:46.884526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5fb8f577-0a1f-4345-9fe2-6dbab87079a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8070435520>]}
[0m18:03:46.886287 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:03:46.971666 [debug] [MainThread]: checksum: f7dcb0a592be265fefa719cdbc95e2c06eb5daa0060319ce5488fb914722a17f, vars: {'ai_explanation': 'Based on PCA factors, this transaction exhibits suspicious '
                   'outliers and anomalies, indicating fraud.',
 'txn_id': '7aeeefd4-6003-4c7a-b2f1-18575c4e926e'}, profile: , target: , version: 1.11.2
[0m18:03:47.064452 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:03:47.065068 [debug] [MainThread]: previous checksum: f7dcb0a592be265fefa719cdbc95e2c06eb5daa0060319ce5488fb914722a17f, current checksum: 3114cc0e8bf858be067f17c085477938824c2dbf1e3c7843cc4726f34368bcb2
[0m18:03:47.065598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5fb8f577-0a1f-4345-9fe2-6dbab87079a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b80646b1f10>]}
[0m18:03:48.300238 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m18:03:48.300932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5fb8f577-0a1f-4345-9fe2-6dbab87079a7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b80641f7800>]}
[0m18:03:48.392651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5fb8f577-0a1f-4345-9fe2-6dbab87079a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b806401f740>]}
[0m18:03:48.460883 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:03:48.462591 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:03:48.474781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5fb8f577-0a1f-4345-9fe2-6dbab87079a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b804c51b530>]}
[0m18:03:48.475354 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m18:03:48.475829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fb8f577-0a1f-4345-9fe2-6dbab87079a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b806498aea0>]}
[0m18:03:48.477635 [info ] [MainThread]: 
[0m18:03:48.478154 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:03:48.478605 [info ] [MainThread]: 
[0m18:03:48.479231 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:03:48.480279 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m18:03:48.515174 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m18:03:48.515669 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m18:03:48.516117 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:03:48.601210 [debug] [ThreadPool]: SQL status: OK in 0.085 seconds
[0m18:03:48.602878 [debug] [ThreadPool]: On list_argus_vault: Close
[0m18:03:48.603750 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m18:03:48.604353 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m18:03:48.611720 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:03:48.612259 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m18:03:48.612711 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:03:48.614226 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:03:48.615598 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:03:48.616055 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m18:03:48.616736 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:03:48.617182 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:03:48.617584 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m18:03:48.618319 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:03:48.619260 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:03:48.619699 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:03:48.620122 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:03:48.620785 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:03:48.621245 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m18:03:48.626785 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m18:03:48.632601 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:03:48.633182 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m18:03:48.633587 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:03:48.634487 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:03:48.634939 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:03:48.635381 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m18:03:48.646253 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m18:03:48.647691 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m18:03:48.649017 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m18:03:48.649458 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m18:03:48.650972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fb8f577-0a1f-4345-9fe2-6dbab87079a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b806418b110>]}
[0m18:03:48.651544 [debug] [MainThread]: Using duckdb connection "master"
[0m18:03:48.651983 [debug] [MainThread]: On master: BEGIN
[0m18:03:48.652399 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:03:48.653284 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:03:48.653725 [debug] [MainThread]: On master: COMMIT
[0m18:03:48.654164 [debug] [MainThread]: Using duckdb connection "master"
[0m18:03:48.654558 [debug] [MainThread]: On master: COMMIT
[0m18:03:48.655176 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:03:48.655605 [debug] [MainThread]: On master: Close
[0m18:03:48.657625 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:03:48.658294 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m18:03:48.658846 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m18:03:48.659375 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m18:03:48.667593 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:03:48.668323 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m18:03:48.724862 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:03:48.725517 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201180348700457"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Based on PCA factors, this transaction exhibits suspicious outliers and anomalies, indicating fraud.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '7aeeefd4-6003-4c7a-b2f1-18575c4e926e'
    );
  
  
  
[0m18:03:48.726025 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:48.734797 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m18:03:48.742389 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:03:48.742897 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m18:03:48.743603 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:03:48.744099 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:03:48.744564 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201180348700457'
      
      
      order by ordinal_position

  
[0m18:03:48.747324 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:03:48.752372 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:03:48.752887 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:03:48.755431 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:03:48.765799 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:03:48.766361 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:03:48.769241 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:03:48.770802 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:03:48.771328 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m18:03:48.772094 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:03:48.788584 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:03:48.789411 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:03:48.789905 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201180348700457"
    )
  
[0m18:03:48.791300 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:03:48.802576 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:03:48.803122 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:03:48.803591 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:03:48.816446 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m18:03:48.818582 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m18:03:48.820326 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fb8f577-0a1f-4345-9fe2-6dbab87079a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8064151160>]}
[0m18:03:48.821128 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m18:03:48.821839 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:03:48.823410 [debug] [MainThread]: Using duckdb connection "master"
[0m18:03:48.823953 [debug] [MainThread]: On master: BEGIN
[0m18:03:48.824436 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:03:48.825474 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:03:48.825935 [debug] [MainThread]: On master: COMMIT
[0m18:03:48.826359 [debug] [MainThread]: Using duckdb connection "master"
[0m18:03:48.826763 [debug] [MainThread]: On master: COMMIT
[0m18:03:48.827450 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:03:48.827889 [debug] [MainThread]: On master: Close
[0m18:03:48.828412 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:03:48.828810 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m18:03:48.829264 [info ] [MainThread]: 
[0m18:03:48.829720 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m18:03:48.830520 [debug] [MainThread]: Command end result
[0m18:03:48.849823 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:03:48.851451 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:03:48.857067 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m18:03:48.857500 [info ] [MainThread]: 
[0m18:03:48.858024 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:03:48.858462 [info ] [MainThread]: 
[0m18:03:48.858936 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:03:48.859554 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:03:48.860578 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.360973, "process_in_blocks": "0", "process_kernel_time": 0.320338, "process_mem_max_rss": "271520", "process_out_blocks": "3120", "process_user_time": 4.26854}
[0m18:03:48.861179 [debug] [MainThread]: Command `dbt run` succeeded at 18:03:48.861075 after 2.36 seconds
[0m18:03:48.861654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8070cdae70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8074c73d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8074c73da0>]}
[0m18:03:48.862157 [debug] [MainThread]: Flushing usage events
[0m18:03:49.839569 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:04:04.954182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7225a404f020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7225a4075580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7225a40755b0>]}


============================== 18:04:04.957487 | c314455c-4185-4e12-8f0c-cec1094c849b ==============================
[0m18:04:04.957487 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:04:04.958174 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'version_check': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'debug': 'False', 'fail_fast': 'False', 'target_path': 'None', 'empty': 'False', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "c1bb9682-8a87-409d-8c2c-973f07ed03ae", "ai_explanation": "Fraudulent transaction detected: PCA factors indicate significant anomalies and inconsistencies."} --profiles-dir .', 'profiles_dir': '.', 'use_colors': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'indirect_selection': 'eager', 'printer_width': '80', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'log_format': 'default', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m18:04:05.203800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c314455c-4185-4e12-8f0c-cec1094c849b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7225a383a9f0>]}
[0m18:04:05.274691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c314455c-4185-4e12-8f0c-cec1094c849b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722597d51880>]}
[0m18:04:05.276364 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:04:05.361629 [debug] [MainThread]: checksum: f42d91b0fa38bd6b9cd6f594fea3bf5e175f0b1017adca6ef41d1d414136e203, vars: {'ai_explanation': 'Fraudulent transaction detected: PCA factors indicate '
                   'significant anomalies and inconsistencies.',
 'txn_id': 'c1bb9682-8a87-409d-8c2c-973f07ed03ae'}, profile: , target: , version: 1.11.2
[0m18:04:05.454664 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:04:05.455288 [debug] [MainThread]: previous checksum: f42d91b0fa38bd6b9cd6f594fea3bf5e175f0b1017adca6ef41d1d414136e203, current checksum: f7dcb0a592be265fefa719cdbc95e2c06eb5daa0060319ce5488fb914722a17f
[0m18:04:05.455742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c314455c-4185-4e12-8f0c-cec1094c849b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7225a404e8a0>]}
[0m18:04:06.685966 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m18:04:06.686674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c314455c-4185-4e12-8f0c-cec1094c849b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7225a380d430>]}
[0m18:04:06.779684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c314455c-4185-4e12-8f0c-cec1094c849b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722597d81670>]}
[0m18:04:06.848524 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:04:06.850229 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:04:06.862382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c314455c-4185-4e12-8f0c-cec1094c849b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722577622840>]}
[0m18:04:06.862943 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m18:04:06.863410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c314455c-4185-4e12-8f0c-cec1094c849b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72259594d190>]}
[0m18:04:06.865149 [info ] [MainThread]: 
[0m18:04:06.865637 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:04:06.866093 [info ] [MainThread]: 
[0m18:04:06.866693 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:04:06.867744 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m18:04:06.903122 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m18:04:06.903618 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m18:04:06.904078 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:04:06.993053 [debug] [ThreadPool]: SQL status: OK in 0.089 seconds
[0m18:04:06.994738 [debug] [ThreadPool]: On list_argus_vault: Close
[0m18:04:06.995679 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m18:04:06.996273 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m18:04:07.003723 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:04:07.004211 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m18:04:07.004642 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:04:07.005785 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:04:07.007100 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:04:07.007529 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m18:04:07.008171 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:04:07.008595 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:04:07.009019 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m18:04:07.009667 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:04:07.010587 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:04:07.011040 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:04:07.011444 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:04:07.012106 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:04:07.012537 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m18:04:07.018094 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m18:04:07.023802 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:04:07.024353 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m18:04:07.024759 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:04:07.025760 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:04:07.026218 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:04:07.026632 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m18:04:07.037516 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m18:04:07.039039 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m18:04:07.040310 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m18:04:07.040742 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m18:04:07.042415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c314455c-4185-4e12-8f0c-cec1094c849b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72257762bef0>]}
[0m18:04:07.043041 [debug] [MainThread]: Using duckdb connection "master"
[0m18:04:07.043471 [debug] [MainThread]: On master: BEGIN
[0m18:04:07.043871 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:04:07.044750 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:04:07.045219 [debug] [MainThread]: On master: COMMIT
[0m18:04:07.045635 [debug] [MainThread]: Using duckdb connection "master"
[0m18:04:07.046068 [debug] [MainThread]: On master: COMMIT
[0m18:04:07.046718 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:04:07.047179 [debug] [MainThread]: On master: Close
[0m18:04:07.049614 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:04:07.050325 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m18:04:07.050968 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m18:04:07.051821 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m18:04:07.060498 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:04:07.061222 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m18:04:07.119400 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:04:07.119967 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201180407095152"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Fraudulent transaction detected: PCA factors indicate significant anomalies and inconsistencies.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = 'c1bb9682-8a87-409d-8c2c-973f07ed03ae'
    );
  
  
  
[0m18:04:07.120454 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:07.128341 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m18:04:07.135737 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:04:07.136259 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m18:04:07.136967 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:04:07.137442 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:04:07.137928 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201180407095152'
      
      
      order by ordinal_position

  
[0m18:04:07.140479 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:04:07.145351 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:04:07.145859 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:04:07.149219 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:04:07.159219 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:04:07.159730 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:04:07.162320 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:04:07.163807 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:04:07.164327 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m18:04:07.165076 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:04:07.181190 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:04:07.181958 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:04:07.182439 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201180407095152"
    )
  
[0m18:04:07.183558 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:04:07.194598 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:04:07.195131 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:04:07.195593 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:04:07.210302 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m18:04:07.212304 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m18:04:07.214012 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c314455c-4185-4e12-8f0c-cec1094c849b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7225a64e52b0>]}
[0m18:04:07.214757 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m18:04:07.215487 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:04:07.216875 [debug] [MainThread]: Using duckdb connection "master"
[0m18:04:07.217451 [debug] [MainThread]: On master: BEGIN
[0m18:04:07.217879 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:04:07.218825 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:04:07.219276 [debug] [MainThread]: On master: COMMIT
[0m18:04:07.219679 [debug] [MainThread]: Using duckdb connection "master"
[0m18:04:07.220093 [debug] [MainThread]: On master: COMMIT
[0m18:04:07.220667 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:04:07.221110 [debug] [MainThread]: On master: Close
[0m18:04:07.221586 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:04:07.221998 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m18:04:07.222411 [info ] [MainThread]: 
[0m18:04:07.222848 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m18:04:07.223609 [debug] [MainThread]: Command end result
[0m18:04:07.242365 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:04:07.243982 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:04:07.249526 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m18:04:07.249984 [info ] [MainThread]: 
[0m18:04:07.250502 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:04:07.250953 [info ] [MainThread]: 
[0m18:04:07.251417 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:04:07.252042 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:04:07.253089 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3614922, "process_in_blocks": "0", "process_kernel_time": 0.313551, "process_mem_max_rss": "275824", "process_out_blocks": "3112", "process_user_time": 4.268663}
[0m18:04:07.253656 [debug] [MainThread]: Command `dbt run` succeeded at 18:04:07.253556 after 2.36 seconds
[0m18:04:07.254140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7225a404f020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7225a4607110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7225a37bf620>]}
[0m18:04:07.254606 [debug] [MainThread]: Flushing usage events
[0m18:04:08.189592 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:04:23.574861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739b89406c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739b88d1d820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739b89405670>]}


============================== 18:04:23.578277 | 72231cd0-cedb-4fae-8743-3169b9f83ab0 ==============================
[0m18:04:23.578277 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:04:23.578976 [debug] [MainThread]: running dbt with arguments {'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'fail_fast': 'False', 'profiles_dir': '.', 'empty': 'False', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'quiet': 'False', 'static_parser': 'True', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "6eda60ec-9c48-43e0-9a97-8e665039be21", "ai_explanation": "Transaction is fraudulent due to anomalous PCA values exceeding thresholds."} --profiles-dir .', 'no_print': 'None', 'write_json': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'use_colors': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'introspect': 'True', 'version_check': 'True', 'log_format': 'default', 'printer_width': '80', 'use_experimental_parser': 'False'}
[0m18:04:23.825216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '72231cd0-cedb-4fae-8743-3169b9f83ab0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739b884253a0>]}
[0m18:04:23.896758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '72231cd0-cedb-4fae-8743-3169b9f83ab0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739b884fc530>]}
[0m18:04:23.898639 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:04:23.983237 [debug] [MainThread]: checksum: 0ff28b272ad04490ac755f35b775442a33ffb392f90316736c5b812279bb3b79, vars: {'ai_explanation': 'Transaction is fraudulent due to anomalous PCA values '
                   'exceeding thresholds.',
 'txn_id': '6eda60ec-9c48-43e0-9a97-8e665039be21'}, profile: , target: , version: 1.11.2
[0m18:04:24.075544 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:04:24.076164 [debug] [MainThread]: previous checksum: 0ff28b272ad04490ac755f35b775442a33ffb392f90316736c5b812279bb3b79, current checksum: f42d91b0fa38bd6b9cd6f594fea3bf5e175f0b1017adca6ef41d1d414136e203
[0m18:04:24.076635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '72231cd0-cedb-4fae-8743-3169b9f83ab0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739b7c5ba7b0>]}
[0m18:04:25.310082 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m18:04:25.310743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '72231cd0-cedb-4fae-8743-3169b9f83ab0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739b881bf920>]}
[0m18:04:25.402028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '72231cd0-cedb-4fae-8743-3169b9f83ab0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739b7c37e7b0>]}
[0m18:04:25.470097 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:04:25.471765 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:04:25.484958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '72231cd0-cedb-4fae-8743-3169b9f83ab0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739b7c5baed0>]}
[0m18:04:25.485532 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m18:04:25.486028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72231cd0-cedb-4fae-8743-3169b9f83ab0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739b7c349010>]}
[0m18:04:25.487756 [info ] [MainThread]: 
[0m18:04:25.488266 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:04:25.488695 [info ] [MainThread]: 
[0m18:04:25.489321 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:04:25.490290 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m18:04:25.525467 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m18:04:25.525975 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m18:04:25.526410 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:04:25.615380 [debug] [ThreadPool]: SQL status: OK in 0.089 seconds
[0m18:04:25.617086 [debug] [ThreadPool]: On list_argus_vault: Close
[0m18:04:25.617993 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m18:04:25.618570 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m18:04:25.625887 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:04:25.626373 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m18:04:25.626805 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:04:25.628002 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:04:25.629292 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:04:25.629724 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m18:04:25.630373 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:04:25.630797 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:04:25.631227 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m18:04:25.631842 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:04:25.632762 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:04:25.633227 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:04:25.633633 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:04:25.634253 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:04:25.634682 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m18:04:25.640273 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m18:04:25.646094 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:04:25.646623 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m18:04:25.647045 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:04:25.647968 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:04:25.648407 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:04:25.648820 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m18:04:25.659804 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m18:04:25.661241 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m18:04:25.662517 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m18:04:25.662990 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m18:04:25.664510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72231cd0-cedb-4fae-8743-3169b9f83ab0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739b7c7532f0>]}
[0m18:04:25.665187 [debug] [MainThread]: Using duckdb connection "master"
[0m18:04:25.665647 [debug] [MainThread]: On master: BEGIN
[0m18:04:25.666110 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:04:25.667101 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:04:25.667567 [debug] [MainThread]: On master: COMMIT
[0m18:04:25.668041 [debug] [MainThread]: Using duckdb connection "master"
[0m18:04:25.668480 [debug] [MainThread]: On master: COMMIT
[0m18:04:25.669107 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:04:25.669564 [debug] [MainThread]: On master: Close
[0m18:04:25.671607 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:04:25.672273 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m18:04:25.672825 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m18:04:25.673356 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m18:04:25.681515 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:04:25.682267 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m18:04:25.738905 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:04:25.739483 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201180425714455"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Transaction is fraudulent due to anomalous PCA values exceeding thresholds.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '6eda60ec-9c48-43e0-9a97-8e665039be21'
    );
  
  
  
[0m18:04:25.740010 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:25.748305 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m18:04:25.755891 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:04:25.756416 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m18:04:25.757101 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:04:25.757582 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:04:25.758072 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201180425714455'
      
      
      order by ordinal_position

  
[0m18:04:25.760742 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:04:25.765710 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:04:25.766244 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:04:25.768641 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:04:25.778759 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:04:25.779301 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:04:25.781688 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:04:25.783226 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:04:25.783732 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m18:04:25.784752 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:04:25.801235 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:04:25.802053 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:04:25.802557 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201180425714455"
    )
  
[0m18:04:25.804018 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:04:25.814467 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:04:25.815023 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:04:25.815496 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:04:25.830113 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m18:04:25.832191 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m18:04:25.833901 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72231cd0-cedb-4fae-8743-3169b9f83ab0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739b60104da0>]}
[0m18:04:25.834675 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m18:04:25.835416 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:04:25.836753 [debug] [MainThread]: Using duckdb connection "master"
[0m18:04:25.837307 [debug] [MainThread]: On master: BEGIN
[0m18:04:25.837769 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:04:25.838738 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:04:25.839231 [debug] [MainThread]: On master: COMMIT
[0m18:04:25.839681 [debug] [MainThread]: Using duckdb connection "master"
[0m18:04:25.840140 [debug] [MainThread]: On master: COMMIT
[0m18:04:25.840862 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:04:25.841351 [debug] [MainThread]: On master: Close
[0m18:04:25.841869 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:04:25.842316 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m18:04:25.842775 [info ] [MainThread]: 
[0m18:04:25.843282 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m18:04:25.844104 [debug] [MainThread]: Command end result
[0m18:04:25.865935 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:04:25.867642 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:04:25.873354 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m18:04:25.873815 [info ] [MainThread]: 
[0m18:04:25.874393 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:04:25.874870 [info ] [MainThread]: 
[0m18:04:25.875408 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:04:25.876078 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:04:25.877188 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3654735, "process_in_blocks": "0", "process_kernel_time": 0.30862, "process_mem_max_rss": "270668", "process_out_blocks": "3120", "process_user_time": 4.296865}
[0m18:04:25.877799 [debug] [MainThread]: Command `dbt run` succeeded at 18:04:25.877690 after 2.37 seconds
[0m18:04:25.878328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739b889151c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739b743bfaa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739b7c543fb0>]}
[0m18:04:25.878846 [debug] [MainThread]: Flushing usage events
[0m18:04:26.881438 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:04:42.318431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb32bbbc5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb32c3303b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb32d11ade0>]}


============================== 18:04:42.321982 | 3466ccab-ac60-45e7-b621-9cd1a8037eaa ==============================
[0m18:04:42.321982 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:04:42.322714 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'empty': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'profiles_dir': '.', 'introspect': 'True', 'write_json': 'True', 'warn_error': 'None', 'printer_width': '80', 'static_parser': 'True', 'no_print': 'None', 'target_path': 'None', 'version_check': 'True', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "439c5e9d-a6a3-40ba-b441-5874776f4312", "ai_explanation": "Fraud detected: Abnormal PCA factors indicate manipulated transaction values and signatures."} --profiles-dir .', 'quiet': 'False', 'fail_fast': 'False'}
[0m18:04:42.581295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3466ccab-ac60-45e7-b621-9cd1a8037eaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb32b2b40b0>]}
[0m18:04:42.652949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3466ccab-ac60-45e7-b621-9cd1a8037eaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb32b350320>]}
[0m18:04:42.654715 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:04:42.740731 [debug] [MainThread]: checksum: d08577e6973cdfd3a16e95eed877fe5b741fd09876a764b3a46ca0cee8f10832, vars: {'ai_explanation': 'Fraud detected: Abnormal PCA factors indicate manipulated '
                   'transaction values and signatures.',
 'txn_id': '439c5e9d-a6a3-40ba-b441-5874776f4312'}, profile: , target: , version: 1.11.2
[0m18:04:42.835697 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:04:42.836310 [debug] [MainThread]: previous checksum: d08577e6973cdfd3a16e95eed877fe5b741fd09876a764b3a46ca0cee8f10832, current checksum: 0ff28b272ad04490ac755f35b775442a33ffb392f90316736c5b812279bb3b79
[0m18:04:42.836782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3466ccab-ac60-45e7-b621-9cd1a8037eaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb32bb4ea50>]}
[0m18:04:44.089314 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m18:04:44.090029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3466ccab-ac60-45e7-b621-9cd1a8037eaa', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb31f335070>]}
[0m18:04:44.183615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3466ccab-ac60-45e7-b621-9cd1a8037eaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb31c1dc380>]}
[0m18:04:44.255507 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:04:44.257411 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:04:44.270263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3466ccab-ac60-45e7-b621-9cd1a8037eaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb32b2014c0>]}
[0m18:04:44.270850 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m18:04:44.271356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3466ccab-ac60-45e7-b621-9cd1a8037eaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb31f35e7e0>]}
[0m18:04:44.273133 [info ] [MainThread]: 
[0m18:04:44.273631 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:04:44.274100 [info ] [MainThread]: 
[0m18:04:44.274727 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:04:44.275799 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m18:04:44.311328 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m18:04:44.311890 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m18:04:44.312351 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:04:44.401125 [debug] [ThreadPool]: SQL status: OK in 0.089 seconds
[0m18:04:44.402783 [debug] [ThreadPool]: On list_argus_vault: Close
[0m18:04:44.403644 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m18:04:44.404240 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m18:04:44.411635 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:04:44.412140 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m18:04:44.412558 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:04:44.414219 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m18:04:44.415582 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:04:44.416037 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m18:04:44.416646 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:04:44.417089 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:04:44.417492 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m18:04:44.418133 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:04:44.419060 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:04:44.419498 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:04:44.419901 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:04:44.420538 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:04:44.420988 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m18:04:44.426613 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m18:04:44.432404 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:04:44.432955 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m18:04:44.433367 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:04:44.434545 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:04:44.435003 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:04:44.435428 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m18:04:44.446428 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m18:04:44.447883 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m18:04:44.449178 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m18:04:44.449615 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m18:04:44.451346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3466ccab-ac60-45e7-b621-9cd1a8037eaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb31c1de9c0>]}
[0m18:04:44.452007 [debug] [MainThread]: Using duckdb connection "master"
[0m18:04:44.452468 [debug] [MainThread]: On master: BEGIN
[0m18:04:44.452872 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:04:44.453778 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:04:44.454242 [debug] [MainThread]: On master: COMMIT
[0m18:04:44.454656 [debug] [MainThread]: Using duckdb connection "master"
[0m18:04:44.455074 [debug] [MainThread]: On master: COMMIT
[0m18:04:44.455739 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:04:44.456202 [debug] [MainThread]: On master: Close
[0m18:04:44.458299 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:04:44.458965 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m18:04:44.459528 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m18:04:44.460023 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m18:04:44.468315 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:04:44.469056 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m18:04:44.525458 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:04:44.526054 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201180444501031"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Fraud detected: Abnormal PCA factors indicate manipulated transaction values and signatures.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '439c5e9d-a6a3-40ba-b441-5874776f4312'
    );
  
  
  
[0m18:04:44.526551 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:44.535321 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m18:04:44.543045 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:04:44.543553 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m18:04:44.544263 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:04:44.544744 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:04:44.545240 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201180444501031'
      
      
      order by ordinal_position

  
[0m18:04:44.547643 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:04:44.552614 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:04:44.553153 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:04:44.556356 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:04:44.566634 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:04:44.567175 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:04:44.569557 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:04:44.571076 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:04:44.571578 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m18:04:44.572336 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:04:44.588702 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:04:44.589484 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:04:44.590007 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201180444501031"
    )
  
[0m18:04:44.591220 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:04:44.601585 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:04:44.602118 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:04:44.602585 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:04:44.618618 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m18:04:44.620659 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m18:04:44.622383 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3466ccab-ac60-45e7-b621-9cd1a8037eaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb32c247dd0>]}
[0m18:04:44.623177 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m18:04:44.623899 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:04:44.625323 [debug] [MainThread]: Using duckdb connection "master"
[0m18:04:44.625865 [debug] [MainThread]: On master: BEGIN
[0m18:04:44.626358 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:04:44.627350 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:04:44.627783 [debug] [MainThread]: On master: COMMIT
[0m18:04:44.628216 [debug] [MainThread]: Using duckdb connection "master"
[0m18:04:44.628606 [debug] [MainThread]: On master: COMMIT
[0m18:04:44.629224 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:04:44.629642 [debug] [MainThread]: On master: Close
[0m18:04:44.630144 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:04:44.630538 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m18:04:44.630963 [info ] [MainThread]: 
[0m18:04:44.631409 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m18:04:44.632162 [debug] [MainThread]: Command end result
[0m18:04:44.650868 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:04:44.652476 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:04:44.658102 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m18:04:44.658533 [info ] [MainThread]: 
[0m18:04:44.659055 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:04:44.659490 [info ] [MainThread]: 
[0m18:04:44.659968 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:04:44.660586 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:04:44.661618 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.4127767, "process_in_blocks": "0", "process_kernel_time": 0.302354, "process_mem_max_rss": "279512", "process_out_blocks": "3112", "process_user_time": 4.386623}
[0m18:04:44.662218 [debug] [MainThread]: Command `dbt run` succeeded at 18:04:44.662116 after 2.41 seconds
[0m18:04:44.662682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb32d11ade0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb32b3fe720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb2c317bbf0>]}
[0m18:04:44.663172 [debug] [MainThread]: Flushing usage events
[0m18:04:45.546624 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:05:01.446360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736ef8777bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736ef79240e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736ef7b3e0f0>]}


============================== 18:05:01.449954 | 04df1739-a1c9-4ae3-a372-e8f81133a8be ==============================
[0m18:05:01.449954 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:05:01.450720 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'target_path': 'None', 'no_print': 'None', 'introspect': 'True', 'log_cache_events': 'False', 'version_check': 'True', 'printer_width': '80', 'cache_selected_only': 'False', 'use_colors': 'True', 'empty': 'False', 'profiles_dir': '.', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'warn_error': 'None', 'fail_fast': 'False', 'quiet': 'False', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "d81ac9a5-9443-4e1e-b7e2-ff92fbafb0a7", "ai_explanation": "Based on PCA factors, transaction is likely fraud due to significant deviation from mean."} --profiles-dir .', 'use_experimental_parser': 'False', 'write_json': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'debug': 'False'}
[0m18:05:01.710486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '04df1739-a1c9-4ae3-a372-e8f81133a8be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736eebd62ff0>]}
[0m18:05:01.782483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '04df1739-a1c9-4ae3-a372-e8f81133a8be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736efa3acd10>]}
[0m18:05:01.784352 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:05:01.871613 [debug] [MainThread]: checksum: 93675d4b734c1ab5b6e65f046928fa0d830a0df0eb1cc5f4fbe202ed42997b9f, vars: {'ai_explanation': 'Based on PCA factors, transaction is likely fraud due to '
                   'significant deviation from mean.',
 'txn_id': 'd81ac9a5-9443-4e1e-b7e2-ff92fbafb0a7'}, profile: , target: , version: 1.11.2
[0m18:05:01.963758 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:05:01.964386 [debug] [MainThread]: previous checksum: 93675d4b734c1ab5b6e65f046928fa0d830a0df0eb1cc5f4fbe202ed42997b9f, current checksum: d08577e6973cdfd3a16e95eed877fe5b741fd09876a764b3a46ca0cee8f10832
[0m18:05:01.964895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '04df1739-a1c9-4ae3-a372-e8f81133a8be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736ef8056720>]}
[0m18:05:03.192940 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m18:05:03.193649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '04df1739-a1c9-4ae3-a372-e8f81133a8be', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736ee99bcd10>]}
[0m18:05:03.285219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '04df1739-a1c9-4ae3-a372-e8f81133a8be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736ee9951220>]}
[0m18:05:03.354314 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:05:03.356002 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:05:03.368334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '04df1739-a1c9-4ae3-a372-e8f81133a8be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736ed37e5dc0>]}
[0m18:05:03.368891 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m18:05:03.369440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04df1739-a1c9-4ae3-a372-e8f81133a8be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736ed37c87a0>]}
[0m18:05:03.371194 [info ] [MainThread]: 
[0m18:05:03.371721 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:05:03.372212 [info ] [MainThread]: 
[0m18:05:03.372839 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:05:03.373893 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m18:05:03.409179 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m18:05:03.409668 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m18:05:03.410134 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:05:03.499999 [debug] [ThreadPool]: SQL status: OK in 0.090 seconds
[0m18:05:03.502333 [debug] [ThreadPool]: On list_argus_vault: Close
[0m18:05:03.503279 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m18:05:03.503898 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m18:05:03.511517 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:05:03.512060 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m18:05:03.512523 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:05:03.513811 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:05:03.515230 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:05:03.515712 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m18:05:03.516369 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:05:03.516817 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:05:03.517289 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m18:05:03.517975 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:05:03.518933 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:05:03.519409 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:05:03.519852 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:05:03.520612 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:05:03.521108 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m18:05:03.526999 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m18:05:03.532907 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:05:03.533477 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m18:05:03.533879 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:05:03.534810 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:05:03.535281 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:05:03.535704 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m18:05:03.546823 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m18:05:03.548283 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m18:05:03.549555 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m18:05:03.550009 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m18:05:03.551542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04df1739-a1c9-4ae3-a372-e8f81133a8be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736ed363d4f0>]}
[0m18:05:03.552170 [debug] [MainThread]: Using duckdb connection "master"
[0m18:05:03.552593 [debug] [MainThread]: On master: BEGIN
[0m18:05:03.553014 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:05:03.553891 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:05:03.554354 [debug] [MainThread]: On master: COMMIT
[0m18:05:03.554766 [debug] [MainThread]: Using duckdb connection "master"
[0m18:05:03.555194 [debug] [MainThread]: On master: COMMIT
[0m18:05:03.555792 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:05:03.556247 [debug] [MainThread]: On master: Close
[0m18:05:03.558294 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:05:03.558941 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m18:05:03.559514 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m18:05:03.560026 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m18:05:03.568288 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:05:03.569034 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m18:05:03.625337 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:05:03.625901 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201180503601122"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Based on PCA factors, transaction is likely fraud due to significant deviation from mean.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = 'd81ac9a5-9443-4e1e-b7e2-ff92fbafb0a7'
    );
  
  
  
[0m18:05:03.626411 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:05:03.634355 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m18:05:03.641924 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:05:03.642438 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m18:05:03.643132 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:05:03.643609 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:05:03.644093 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201180503601122'
      
      
      order by ordinal_position

  
[0m18:05:03.646821 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:05:03.651752 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:05:03.652282 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:05:03.654776 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:05:03.664744 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:05:03.665286 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:05:03.667655 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:05:03.669181 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:05:03.669702 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m18:05:03.670658 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:05:03.686904 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:05:03.687693 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:05:03.688211 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201180503601122"
    )
  
[0m18:05:03.689275 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:05:03.699653 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:05:03.700181 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:05:03.700641 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:05:03.713705 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m18:05:03.715702 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m18:05:03.717401 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04df1739-a1c9-4ae3-a372-e8f81133a8be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736ee9965a60>]}
[0m18:05:03.718157 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m18:05:03.718857 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:05:03.720488 [debug] [MainThread]: Using duckdb connection "master"
[0m18:05:03.721105 [debug] [MainThread]: On master: BEGIN
[0m18:05:03.721703 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:05:03.722710 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:05:03.723176 [debug] [MainThread]: On master: COMMIT
[0m18:05:03.723588 [debug] [MainThread]: Using duckdb connection "master"
[0m18:05:03.724023 [debug] [MainThread]: On master: COMMIT
[0m18:05:03.724660 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:05:03.725124 [debug] [MainThread]: On master: Close
[0m18:05:03.725616 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:05:03.726031 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m18:05:03.726454 [info ] [MainThread]: 
[0m18:05:03.726956 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m18:05:03.727759 [debug] [MainThread]: Command end result
[0m18:05:03.746684 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:05:03.748354 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:05:03.754030 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m18:05:03.754489 [info ] [MainThread]: 
[0m18:05:03.755067 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:05:03.755547 [info ] [MainThread]: 
[0m18:05:03.756068 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:05:03.756727 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:05:03.757837 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3749385, "process_in_blocks": "0", "process_kernel_time": 0.298288, "process_mem_max_rss": "273068", "process_out_blocks": "3120", "process_user_time": 4.326664}
[0m18:05:03.758449 [debug] [MainThread]: Command `dbt run` succeeded at 18:05:03.758348 after 2.38 seconds
[0m18:05:03.758943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736efa799b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736ee9983da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736eebd62ea0>]}
[0m18:05:03.759433 [debug] [MainThread]: Flushing usage events
[0m18:05:04.669602 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:05:19.991662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b87aef67ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b87ae2f6db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b87b0e2c7d0>]}


============================== 18:05:19.995074 | b1bf593c-6d60-4f31-b835-446958ddfc16 ==============================
[0m18:05:19.995074 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:05:19.995763 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'profiles_dir': '.', 'cache_selected_only': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'printer_width': '80', 'warn_error': 'None', 'quiet': 'False', 'use_colors': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "61da7a3a-32f7-4759-b3c1-cc7ade840925", "ai_explanation": "Unusually high V2 and V11 values indicate fraudulent activity with confidence."} --profiles-dir .', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'log_format': 'default', 'empty': 'False', 'indirect_selection': 'eager', 'no_print': 'None', 'use_experimental_parser': 'False', 'target_path': 'None', 'write_json': 'True'}
[0m18:05:20.242482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1bf593c-6d60-4f31-b835-446958ddfc16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b87aefee8d0>]}
[0m18:05:20.312977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b1bf593c-6d60-4f31-b835-446958ddfc16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b87a2547a70>]}
[0m18:05:20.314767 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:05:20.399355 [debug] [MainThread]: checksum: b64241971bd6b2588e4881c83e5cf2508ecefc23d4c6628e0bcab17e947cff3e, vars: {'ai_explanation': 'Unusually high V2 and V11 values indicate fraudulent '
                   'activity with confidence.',
 'txn_id': '61da7a3a-32f7-4759-b3c1-cc7ade840925'}, profile: , target: , version: 1.11.2
[0m18:05:20.491714 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:05:20.492335 [debug] [MainThread]: previous checksum: b64241971bd6b2588e4881c83e5cf2508ecefc23d4c6628e0bcab17e947cff3e, current checksum: 93675d4b734c1ab5b6e65f046928fa0d830a0df0eb1cc5f4fbe202ed42997b9f
[0m18:05:20.492798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b1bf593c-6d60-4f31-b835-446958ddfc16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b87ae852840>]}
[0m18:05:21.717374 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m18:05:21.718069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b1bf593c-6d60-4f31-b835-446958ddfc16', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b87a01758b0>]}
[0m18:05:21.810087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b1bf593c-6d60-4f31-b835-446958ddfc16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b87a2587d40>]}
[0m18:05:21.878486 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:05:21.880205 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:05:21.892378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b1bf593c-6d60-4f31-b835-446958ddfc16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b87a00bcc20>]}
[0m18:05:21.892955 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m18:05:21.893428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1bf593c-6d60-4f31-b835-446958ddfc16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b87a21a3f20>]}
[0m18:05:21.895164 [info ] [MainThread]: 
[0m18:05:21.895660 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:05:21.896131 [info ] [MainThread]: 
[0m18:05:21.896718 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:05:21.897778 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m18:05:21.934055 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m18:05:21.934749 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m18:05:21.935240 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:05:22.024462 [debug] [ThreadPool]: SQL status: OK in 0.089 seconds
[0m18:05:22.026215 [debug] [ThreadPool]: On list_argus_vault: Close
[0m18:05:22.027134 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m18:05:22.027710 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m18:05:22.035231 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:05:22.035689 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m18:05:22.036126 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:05:22.037320 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:05:22.038650 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:05:22.039269 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m18:05:22.040025 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:05:22.040459 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:05:22.040865 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m18:05:22.041606 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:05:22.042545 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:05:22.043006 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:05:22.043421 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:05:22.044051 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:05:22.044486 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m18:05:22.050729 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m18:05:22.057001 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:05:22.057594 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m18:05:22.058066 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:05:22.059558 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:05:22.060067 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:05:22.060541 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m18:05:22.072607 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m18:05:22.074365 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m18:05:22.075741 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m18:05:22.076250 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m18:05:22.077980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1bf593c-6d60-4f31-b835-446958ddfc16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b87ae015160>]}
[0m18:05:22.078635 [debug] [MainThread]: Using duckdb connection "master"
[0m18:05:22.079123 [debug] [MainThread]: On master: BEGIN
[0m18:05:22.079529 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:05:22.080689 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:05:22.081186 [debug] [MainThread]: On master: COMMIT
[0m18:05:22.081624 [debug] [MainThread]: Using duckdb connection "master"
[0m18:05:22.082074 [debug] [MainThread]: On master: COMMIT
[0m18:05:22.082782 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:05:22.083258 [debug] [MainThread]: On master: Close
[0m18:05:22.085354 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:05:22.086049 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m18:05:22.086618 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m18:05:22.087143 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m18:05:22.095600 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:05:22.096323 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m18:05:22.153341 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:05:22.153975 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201180522129161"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Unusually high V2 and V11 values indicate fraudulent activity with confidence.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '61da7a3a-32f7-4759-b3c1-cc7ade840925'
    );
  
  
  
[0m18:05:22.154465 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:05:22.163460 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m18:05:22.171063 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:05:22.171562 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m18:05:22.172254 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:05:22.172732 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:05:22.173222 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201180522129161'
      
      
      order by ordinal_position

  
[0m18:05:22.175827 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:05:22.180801 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:05:22.181327 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:05:22.183989 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:05:22.194060 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:05:22.194566 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:05:22.197121 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:05:22.198612 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:05:22.199130 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m18:05:22.200119 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:05:22.216216 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:05:22.216997 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:05:22.217485 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201180522129161"
    )
  
[0m18:05:22.218631 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:05:22.228890 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:05:22.229415 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:05:22.229867 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:05:22.233726 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:05:22.235743 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m18:05:22.237467 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1bf593c-6d60-4f31-b835-446958ddfc16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b87a2471910>]}
[0m18:05:22.238233 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.15s]
[0m18:05:22.238956 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:05:22.240297 [debug] [MainThread]: Using duckdb connection "master"
[0m18:05:22.240816 [debug] [MainThread]: On master: BEGIN
[0m18:05:22.241321 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:05:22.242281 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:05:22.242724 [debug] [MainThread]: On master: COMMIT
[0m18:05:22.243168 [debug] [MainThread]: Using duckdb connection "master"
[0m18:05:22.243568 [debug] [MainThread]: On master: COMMIT
[0m18:05:22.244196 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:05:22.244629 [debug] [MainThread]: On master: Close
[0m18:05:22.245145 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:05:22.245538 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m18:05:22.245966 [info ] [MainThread]: 
[0m18:05:22.246418 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m18:05:22.247196 [debug] [MainThread]: Command end result
[0m18:05:22.266343 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:05:22.267967 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:05:22.273565 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m18:05:22.274022 [info ] [MainThread]: 
[0m18:05:22.274543 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:05:22.275007 [info ] [MainThread]: 
[0m18:05:22.275474 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:05:22.276106 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:05:22.277170 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.348192, "process_in_blocks": "0", "process_kernel_time": 0.294119, "process_mem_max_rss": "276976", "process_out_blocks": "3112", "process_user_time": 4.280082}
[0m18:05:22.277741 [debug] [MainThread]: Command `dbt run` succeeded at 18:05:22.277639 after 2.35 seconds
[0m18:05:22.278238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b87ae852f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b87a00f50a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b87ae87d520>]}
[0m18:05:22.278719 [debug] [MainThread]: Flushing usage events
[0m18:05:23.217251 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:05:40.235718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e0971a0f0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e0970543230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e0970542000>]}


============================== 18:05:40.239107 | ac539421-f451-4357-80c9-e0fac5d481a5 ==============================
[0m18:05:40.239107 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:05:40.239764 [debug] [MainThread]: running dbt with arguments {'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'debug': 'False', 'introspect': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'partial_parse': 'True', 'fail_fast': 'False', 'log_format': 'default', 'cache_selected_only': 'False', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "a5f8b307-a79e-4eef-9acf-28f40e13831d", "ai_explanation": "Fraud detected: Anomalous PCA factors (V1: -5.19, V17: -18.39) indicate manipulated transaction."} --profiles-dir .', 'profiles_dir': '.', 'warn_error': 'None', 'version_check': 'True', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'use_colors': 'True', 'quiet': 'False', 'write_json': 'True', 'empty': 'False', 'indirect_selection': 'eager', 'use_experimental_parser': 'False'}
[0m18:05:40.491413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac539421-f451-4357-80c9-e0fac5d481a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e096fc12210>]}
[0m18:05:40.562302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac539421-f451-4357-80c9-e0fac5d481a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e09703b80e0>]}
[0m18:05:40.564034 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:05:40.648555 [debug] [MainThread]: checksum: c201c49faef5587e927ed8dfed107871ddb49aec0edc6c644c48e62b1541fdd6, vars: {'ai_explanation': 'Fraud detected: Anomalous PCA factors (V1: -5.19, V17: '
                   '-18.39) indicate manipulated transaction.',
 'txn_id': 'a5f8b307-a79e-4eef-9acf-28f40e13831d'}, profile: , target: , version: 1.11.2
[0m18:05:40.741044 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:05:40.741656 [debug] [MainThread]: previous checksum: c201c49faef5587e927ed8dfed107871ddb49aec0edc6c644c48e62b1541fdd6, current checksum: b64241971bd6b2588e4881c83e5cf2508ecefc23d4c6628e0bcab17e947cff3e
[0m18:05:40.742134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ac539421-f451-4357-80c9-e0fac5d481a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e0963daa990>]}
[0m18:05:41.981310 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m18:05:41.982012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ac539421-f451-4357-80c9-e0fac5d481a5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e096fbef2c0>]}
[0m18:05:42.075456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac539421-f451-4357-80c9-e0fac5d481a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e09601dd670>]}
[0m18:05:42.145710 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:05:42.147544 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:05:42.160237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac539421-f451-4357-80c9-e0fac5d481a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e0963b74f20>]}
[0m18:05:42.160800 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m18:05:42.161298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac539421-f451-4357-80c9-e0fac5d481a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e0963b4ca40>]}
[0m18:05:42.163068 [info ] [MainThread]: 
[0m18:05:42.163573 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:05:42.164050 [info ] [MainThread]: 
[0m18:05:42.164666 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:05:42.165691 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m18:05:42.201970 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m18:05:42.202580 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m18:05:42.203073 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:05:42.292862 [debug] [ThreadPool]: SQL status: OK in 0.090 seconds
[0m18:05:42.294612 [debug] [ThreadPool]: On list_argus_vault: Close
[0m18:05:42.295530 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m18:05:42.296152 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m18:05:42.303532 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:05:42.304039 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m18:05:42.304496 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:05:42.305655 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:05:42.307015 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:05:42.307480 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m18:05:42.308161 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:05:42.308615 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:05:42.309087 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m18:05:42.309824 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:05:42.310786 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:05:42.311279 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:05:42.311727 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:05:42.312439 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:05:42.312899 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m18:05:42.318739 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m18:05:42.325779 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:05:42.326329 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m18:05:42.326733 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:05:42.327647 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:05:42.328107 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:05:42.328519 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m18:05:42.340385 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m18:05:42.342240 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m18:05:42.344168 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m18:05:42.344766 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m18:05:42.346533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac539421-f451-4357-80c9-e0fac5d481a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e0963bebd70>]}
[0m18:05:42.347194 [debug] [MainThread]: Using duckdb connection "master"
[0m18:05:42.347627 [debug] [MainThread]: On master: BEGIN
[0m18:05:42.348197 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:05:42.349629 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:05:42.350123 [debug] [MainThread]: On master: COMMIT
[0m18:05:42.350542 [debug] [MainThread]: Using duckdb connection "master"
[0m18:05:42.350975 [debug] [MainThread]: On master: COMMIT
[0m18:05:42.351592 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:05:42.352054 [debug] [MainThread]: On master: Close
[0m18:05:42.354248 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:05:42.354973 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m18:05:42.355583 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m18:05:42.356131 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m18:05:42.365937 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:05:42.367029 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m18:05:42.431178 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:05:42.431805 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201180542405417"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Fraud detected: Anomalous PCA factors (V1: -5.19, V17: -18.39) indicate manipulated transaction.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = 'a5f8b307-a79e-4eef-9acf-28f40e13831d'
    );
  
  
  
[0m18:05:42.432338 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:05:42.441410 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m18:05:42.449617 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:05:42.450179 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m18:05:42.451270 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:05:42.451757 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:05:42.452303 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201180542405417'
      
      
      order by ordinal_position

  
[0m18:05:42.455578 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:05:42.461295 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:05:42.461868 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:05:42.465123 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:05:42.475977 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:05:42.476546 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:05:42.479735 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:05:42.481324 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:05:42.481867 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m18:05:42.482726 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:05:42.500079 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:05:42.501036 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:05:42.501571 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201180542405417"
    )
  
[0m18:05:42.503150 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:05:42.514351 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:05:42.515043 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:05:42.515558 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:05:42.530608 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m18:05:42.532843 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m18:05:42.534675 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac539421-f451-4357-80c9-e0fac5d481a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e0970c27ce0>]}
[0m18:05:42.535505 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.18s]
[0m18:05:42.536282 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:05:42.537879 [debug] [MainThread]: Using duckdb connection "master"
[0m18:05:42.538440 [debug] [MainThread]: On master: BEGIN
[0m18:05:42.538969 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:05:42.540318 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:05:42.540794 [debug] [MainThread]: On master: COMMIT
[0m18:05:42.541300 [debug] [MainThread]: Using duckdb connection "master"
[0m18:05:42.541786 [debug] [MainThread]: On master: COMMIT
[0m18:05:42.542442 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:05:42.542887 [debug] [MainThread]: On master: Close
[0m18:05:42.543435 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:05:42.543838 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m18:05:42.544294 [info ] [MainThread]: 
[0m18:05:42.544749 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m18:05:42.545571 [debug] [MainThread]: Command end result
[0m18:05:42.565093 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:05:42.566824 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:05:42.573459 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m18:05:42.573907 [info ] [MainThread]: 
[0m18:05:42.574452 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:05:42.574888 [info ] [MainThread]: 
[0m18:05:42.575378 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:05:42.576022 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:05:42.577115 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.4042795, "process_in_blocks": "0", "process_kernel_time": 0.313161, "process_mem_max_rss": "276248", "process_out_blocks": "3112", "process_user_time": 4.326595}
[0m18:05:42.577709 [debug] [MainThread]: Command `dbt run` succeeded at 18:05:42.577603 after 2.41 seconds
[0m18:05:42.578222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e0970105f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e0943927530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e0963bcc080>]}
[0m18:05:42.578713 [debug] [MainThread]: Flushing usage events
[0m18:05:43.444736 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:06:00.369828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c86a825bb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c86a714a870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c86a6b0b860>]}


============================== 18:06:00.373192 | e60429fd-e2af-4a39-987c-d52579656cde ==============================
[0m18:06:00.373192 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:06:00.373852 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "4fd6b6e2-de2d-48ce-b96f-0586701a6cfd", "ai_explanation": "Based on PCA factors, this transaction is fraud due to extreme V1 and V23 values exceeding 2-3 SDs from mean."} --profiles-dir .', 'empty': 'False', 'log_cache_events': 'False', 'target_path': 'None', 'log_format': 'default', 'version_check': 'True', 'profiles_dir': '.', 'no_print': 'None', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'warn_error': 'None', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'partial_parse': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'static_parser': 'True', 'use_experimental_parser': 'False', 'introspect': 'True'}
[0m18:06:00.619996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e60429fd-e2af-4a39-987c-d52579656cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c869a91b6b0>]}
[0m18:06:00.691469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e60429fd-e2af-4a39-987c-d52579656cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c86a66bf2c0>]}
[0m18:06:00.693233 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:06:00.777559 [debug] [MainThread]: checksum: bf4547c3df43bc34d36ece3515ccc5e0583a5cfcad69a3edd940ca50a8e7d5b6, vars: {'ai_explanation': 'Based on PCA factors, this transaction is fraud due to '
                   'extreme V1 and V23 values exceeding 2-3 SDs from mean.',
 'txn_id': '4fd6b6e2-de2d-48ce-b96f-0586701a6cfd'}, profile: , target: , version: 1.11.2
[0m18:06:00.870589 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:06:00.871229 [debug] [MainThread]: previous checksum: bf4547c3df43bc34d36ece3515ccc5e0583a5cfcad69a3edd940ca50a8e7d5b6, current checksum: c201c49faef5587e927ed8dfed107871ddb49aec0edc6c644c48e62b1541fdd6
[0m18:06:00.871688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e60429fd-e2af-4a39-987c-d52579656cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c869a68a510>]}
[0m18:06:02.121734 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m18:06:02.122433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e60429fd-e2af-4a39-987c-d52579656cde', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c869a60e990>]}
[0m18:06:02.215508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e60429fd-e2af-4a39-987c-d52579656cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c865a3b7020>]}
[0m18:06:02.285403 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:06:02.287195 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:06:02.299631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e60429fd-e2af-4a39-987c-d52579656cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c865a1ff560>]}
[0m18:06:02.300242 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m18:06:02.300722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e60429fd-e2af-4a39-987c-d52579656cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c865a239e20>]}
[0m18:06:02.302513 [info ] [MainThread]: 
[0m18:06:02.303027 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:06:02.303478 [info ] [MainThread]: 
[0m18:06:02.304145 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:06:02.305141 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m18:06:02.340540 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m18:06:02.341052 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m18:06:02.341483 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:06:02.427509 [debug] [ThreadPool]: SQL status: OK in 0.086 seconds
[0m18:06:02.429169 [debug] [ThreadPool]: On list_argus_vault: Close
[0m18:06:02.430019 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m18:06:02.430586 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m18:06:02.437935 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:06:02.438399 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m18:06:02.438812 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:06:02.439988 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:06:02.441285 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:06:02.441717 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m18:06:02.442332 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:06:02.442749 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:06:02.443179 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m18:06:02.443836 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:06:02.444762 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:06:02.445220 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:06:02.445626 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:06:02.446247 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:06:02.446678 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m18:06:02.452123 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m18:06:02.457845 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:06:02.458404 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m18:06:02.458811 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:06:02.459683 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:06:02.460136 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:06:02.460549 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m18:06:02.471454 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m18:06:02.472851 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m18:06:02.474139 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m18:06:02.474578 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m18:06:02.476155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e60429fd-e2af-4a39-987c-d52579656cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c865a386a80>]}
[0m18:06:02.476819 [debug] [MainThread]: Using duckdb connection "master"
[0m18:06:02.477281 [debug] [MainThread]: On master: BEGIN
[0m18:06:02.477702 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:06:02.478631 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:06:02.479100 [debug] [MainThread]: On master: COMMIT
[0m18:06:02.479538 [debug] [MainThread]: Using duckdb connection "master"
[0m18:06:02.479970 [debug] [MainThread]: On master: COMMIT
[0m18:06:02.480589 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:06:02.481047 [debug] [MainThread]: On master: Close
[0m18:06:02.483159 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:06:02.483781 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m18:06:02.484351 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m18:06:02.484820 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m18:06:02.492852 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:06:02.493582 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m18:06:02.549987 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:06:02.550606 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201180602525690"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Based on PCA factors, this transaction is fraud due to extreme V1 and V23 values exceeding 2-3 SDs from mean.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '4fd6b6e2-de2d-48ce-b96f-0586701a6cfd'
    );
  
  
  
[0m18:06:02.551125 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:06:02.559663 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m18:06:02.567456 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:06:02.567995 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m18:06:02.568710 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:06:02.569207 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:06:02.569665 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201180602525690'
      
      
      order by ordinal_position

  
[0m18:06:02.572408 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:06:02.577437 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:06:02.577960 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:06:02.580704 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:06:02.590685 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:06:02.591220 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:06:02.593701 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:06:02.595209 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:06:02.595707 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m18:06:02.596466 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:06:02.612652 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:06:02.613439 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:06:02.613944 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201180602525690"
    )
  
[0m18:06:02.615088 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:06:02.625363 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:06:02.625873 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:06:02.626356 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:06:02.639836 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m18:06:02.641773 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m18:06:02.643482 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e60429fd-e2af-4a39-987c-d52579656cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c869a60cc80>]}
[0m18:06:02.644238 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m18:06:02.644973 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:06:02.646654 [debug] [MainThread]: Using duckdb connection "master"
[0m18:06:02.647160 [debug] [MainThread]: On master: BEGIN
[0m18:06:02.647604 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:06:02.648642 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:06:02.649098 [debug] [MainThread]: On master: COMMIT
[0m18:06:02.649506 [debug] [MainThread]: Using duckdb connection "master"
[0m18:06:02.649895 [debug] [MainThread]: On master: COMMIT
[0m18:06:02.650508 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:06:02.650947 [debug] [MainThread]: On master: Close
[0m18:06:02.651428 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:06:02.651816 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m18:06:02.652252 [info ] [MainThread]: 
[0m18:06:02.652769 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m18:06:02.653557 [debug] [MainThread]: Command end result
[0m18:06:02.674137 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:06:02.675895 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:06:02.681584 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m18:06:02.682051 [info ] [MainThread]: 
[0m18:06:02.682584 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:06:02.683062 [info ] [MainThread]: 
[0m18:06:02.683546 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:06:02.684196 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:06:02.685297 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3777304, "process_in_blocks": "0", "process_kernel_time": 0.314627, "process_mem_max_rss": "273748", "process_out_blocks": "3112", "process_user_time": 4.296947}
[0m18:06:02.685931 [debug] [MainThread]: Command `dbt run` succeeded at 18:06:02.685804 after 2.38 seconds
[0m18:06:02.686427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c86a65881d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c86a648f3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c86a648fd10>]}
[0m18:06:02.686945 [debug] [MainThread]: Flushing usage events
[0m18:06:03.597247 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:06:20.033372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785e037e6de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785e0377b8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785e037e6d20>]}


============================== 18:06:20.036646 | 9d883b0b-769e-46a8-9527-f7b2ef495476 ==============================
[0m18:06:20.036646 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:06:20.037351 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'version_check': 'True', 'debug': 'False', 'write_json': 'True', 'partial_parse': 'True', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '.', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_format': 'default', 'use_experimental_parser': 'False', 'quiet': 'False', 'fail_fast': 'False', 'empty': 'False', 'log_cache_events': 'False', 'target_path': 'None', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "ec7b29e7-eb8d-4731-aa93-f8612c58a5e5", "ai_explanation": "Transaction is fraudulent due to extremely low V1 score (-14.47) and high V11 score (10.55)."} --profiles-dir .', 'printer_width': '80', 'no_print': 'None', 'use_colors': 'True'}
[0m18:06:20.284043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d883b0b-769e-46a8-9527-f7b2ef495476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785e058eb440>]}
[0m18:06:20.355577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d883b0b-769e-46a8-9527-f7b2ef495476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785df721e960>]}
[0m18:06:20.357354 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:06:20.441232 [debug] [MainThread]: checksum: 6617b02a256c0995d49fb74e91e4e5b6dce0becde56b9b45bf0aff91d16790d5, vars: {'ai_explanation': 'Transaction is fraudulent due to extremely low V1 score '
                   '(-14.47) and high V11 score (10.55).',
 'txn_id': 'ec7b29e7-eb8d-4731-aa93-f8612c58a5e5'}, profile: , target: , version: 1.11.2
[0m18:06:20.534188 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:06:20.534778 [debug] [MainThread]: previous checksum: 6617b02a256c0995d49fb74e91e4e5b6dce0becde56b9b45bf0aff91d16790d5, current checksum: bf4547c3df43bc34d36ece3515ccc5e0583a5cfcad69a3edd940ca50a8e7d5b6
[0m18:06:20.535251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9d883b0b-769e-46a8-9527-f7b2ef495476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785e037e67e0>]}
[0m18:06:21.759671 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m18:06:21.760361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9d883b0b-769e-46a8-9527-f7b2ef495476', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785e03e1c650>]}
[0m18:06:21.851615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d883b0b-769e-46a8-9527-f7b2ef495476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785df6f8edb0>]}
[0m18:06:21.920189 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:06:21.921878 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:06:21.934037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d883b0b-769e-46a8-9527-f7b2ef495476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785d9ee1f980>]}
[0m18:06:21.934571 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m18:06:21.935061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d883b0b-769e-46a8-9527-f7b2ef495476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785d9ee06b70>]}
[0m18:06:21.936773 [info ] [MainThread]: 
[0m18:06:21.937288 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:06:21.937727 [info ] [MainThread]: 
[0m18:06:21.938340 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:06:21.939406 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m18:06:21.974871 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m18:06:21.975402 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m18:06:21.975826 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:06:22.061240 [debug] [ThreadPool]: SQL status: OK in 0.085 seconds
[0m18:06:22.062980 [debug] [ThreadPool]: On list_argus_vault: Close
[0m18:06:22.063853 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m18:06:22.064459 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m18:06:22.071846 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:06:22.072336 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m18:06:22.072758 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:06:22.074337 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m18:06:22.075693 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:06:22.076153 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m18:06:22.076747 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:06:22.077199 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:06:22.077603 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m18:06:22.078337 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:06:22.079287 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:06:22.079731 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:06:22.080167 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:06:22.080800 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:06:22.081270 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m18:06:22.086769 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m18:06:22.092757 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:06:22.093318 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m18:06:22.093714 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:06:22.094878 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:06:22.095365 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:06:22.095777 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m18:06:22.107175 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m18:06:22.108630 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m18:06:22.109989 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m18:06:22.110433 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m18:06:22.111987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d883b0b-769e-46a8-9527-f7b2ef495476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785e037b4b00>]}
[0m18:06:22.112626 [debug] [MainThread]: Using duckdb connection "master"
[0m18:06:22.113068 [debug] [MainThread]: On master: BEGIN
[0m18:06:22.113454 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:06:22.114335 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:06:22.114769 [debug] [MainThread]: On master: COMMIT
[0m18:06:22.115201 [debug] [MainThread]: Using duckdb connection "master"
[0m18:06:22.115590 [debug] [MainThread]: On master: COMMIT
[0m18:06:22.116189 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:06:22.116615 [debug] [MainThread]: On master: Close
[0m18:06:22.118626 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:06:22.119295 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m18:06:22.119892 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m18:06:22.120419 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m18:06:22.128794 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:06:22.129540 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m18:06:22.186451 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:06:22.187065 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201180622162000"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Transaction is fraudulent due to extremely low V1 score (-14.47) and high V11 score (10.55).' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = 'ec7b29e7-eb8d-4731-aa93-f8612c58a5e5'
    );
  
  
  
[0m18:06:22.187561 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:06:22.196160 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m18:06:22.203769 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:06:22.204295 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m18:06:22.205017 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:06:22.205492 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:06:22.205969 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201180622162000'
      
      
      order by ordinal_position

  
[0m18:06:22.208425 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:06:22.213327 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:06:22.213831 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:06:22.216903 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:06:22.227212 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:06:22.227723 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:06:22.230072 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:06:22.231554 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:06:22.232068 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m18:06:22.232852 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:06:22.249258 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:06:22.250073 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:06:22.250585 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201180622162000"
    )
  
[0m18:06:22.251787 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:06:22.262327 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:06:22.262846 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:06:22.263369 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:06:22.276205 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m18:06:22.278232 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m18:06:22.279982 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d883b0b-769e-46a8-9527-f7b2ef495476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785d9e295940>]}
[0m18:06:22.280747 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m18:06:22.281533 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:06:22.283033 [debug] [MainThread]: Using duckdb connection "master"
[0m18:06:22.283537 [debug] [MainThread]: On master: BEGIN
[0m18:06:22.284018 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:06:22.284893 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:06:22.285345 [debug] [MainThread]: On master: COMMIT
[0m18:06:22.285752 [debug] [MainThread]: Using duckdb connection "master"
[0m18:06:22.286168 [debug] [MainThread]: On master: COMMIT
[0m18:06:22.286743 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:06:22.287191 [debug] [MainThread]: On master: Close
[0m18:06:22.287672 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:06:22.288090 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m18:06:22.288499 [info ] [MainThread]: 
[0m18:06:22.288956 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m18:06:22.289720 [debug] [MainThread]: Command end result
[0m18:06:22.308970 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:06:22.310622 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:06:22.316358 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m18:06:22.316798 [info ] [MainThread]: 
[0m18:06:22.317332 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:06:22.317769 [info ] [MainThread]: 
[0m18:06:22.318263 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:06:22.318883 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:06:22.319966 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.348849, "process_in_blocks": "0", "process_kernel_time": 0.29566, "process_mem_max_rss": "277428", "process_out_blocks": "3104", "process_user_time": 4.286091}
[0m18:06:22.320549 [debug] [MainThread]: Command `dbt run` succeeded at 18:06:22.320448 after 2.35 seconds
[0m18:06:22.321038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785e02f88da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785df709d8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785e03399c40>]}
[0m18:06:22.321520 [debug] [MainThread]: Flushing usage events
[0m18:06:23.184274 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:06:39.754186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799cccc8bb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799ccc6105c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799ccd2b25a0>]}


============================== 18:06:39.757480 | 3a519e80-0891-4537-b26f-200e77456090 ==============================
[0m18:06:39.757480 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:06:39.758189 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'static_parser': 'True', 'use_experimental_parser': 'False', 'log_format': 'default', 'cache_selected_only': 'False', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'log_cache_events': 'False', 'partial_parse': 'True', 'version_check': 'True', 'no_print': 'None', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '.', 'debug': 'False', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "54e52bce-5375-4c04-afcd-d086563c6e6e", "ai_explanation": "This transaction is fraud due to an extremely low V7 (-15.6) and suspicious high V11 (8.81)."} --profiles-dir .', 'use_colors': 'True', 'fail_fast': 'False', 'printer_width': '80', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'quiet': 'False', 'warn_error': 'None', 'indirect_selection': 'eager'}
[0m18:06:40.005573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a519e80-0891-4537-b26f-200e77456090', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799ccc2990a0>]}
[0m18:06:40.076999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3a519e80-0891-4537-b26f-200e77456090', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799ccee4d280>]}
[0m18:06:40.078748 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:06:40.164238 [debug] [MainThread]: checksum: 9c724c4d1772eefec758da5be464a3abd985a462fe6fd17950a256ba4d4c615d, vars: {'ai_explanation': 'This transaction is fraud due to an extremely low V7 '
                   '(-15.6) and suspicious high V11 (8.81).',
 'txn_id': '54e52bce-5375-4c04-afcd-d086563c6e6e'}, profile: , target: , version: 1.11.2
[0m18:06:40.256322 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:06:40.256984 [debug] [MainThread]: previous checksum: 9c724c4d1772eefec758da5be464a3abd985a462fe6fd17950a256ba4d4c615d, current checksum: 6617b02a256c0995d49fb74e91e4e5b6dce0becde56b9b45bf0aff91d16790d5
[0m18:06:40.257458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3a519e80-0891-4537-b26f-200e77456090', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799cc05a1d60>]}
[0m18:06:41.484649 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m18:06:41.485366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3a519e80-0891-4537-b26f-200e77456090', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799ccd331d60>]}
[0m18:06:41.587781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a519e80-0891-4537-b26f-200e77456090', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799cb83c4380>]}
[0m18:06:41.656984 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:06:41.658741 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:06:41.671022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a519e80-0891-4537-b26f-200e77456090', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799cc01778f0>]}
[0m18:06:41.671581 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m18:06:41.672068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a519e80-0891-4537-b26f-200e77456090', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799cb820ea80>]}
[0m18:06:41.673788 [info ] [MainThread]: 
[0m18:06:41.674303 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:06:41.674732 [info ] [MainThread]: 
[0m18:06:41.675369 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:06:41.676361 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m18:06:41.711367 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m18:06:41.711867 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m18:06:41.712327 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:06:41.803002 [debug] [ThreadPool]: SQL status: OK in 0.091 seconds
[0m18:06:41.804646 [debug] [ThreadPool]: On list_argus_vault: Close
[0m18:06:41.805519 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m18:06:41.806099 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m18:06:41.813368 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:06:41.813830 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m18:06:41.814276 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:06:41.815666 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:06:41.817000 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:06:41.817433 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m18:06:41.818056 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:06:41.818480 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:06:41.818879 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m18:06:41.819600 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:06:41.820524 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:06:41.820986 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:06:41.821401 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:06:41.822040 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:06:41.822475 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m18:06:41.828081 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m18:06:41.833999 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:06:41.834529 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m18:06:41.834962 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:06:41.836133 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:06:41.836569 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:06:41.837012 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m18:06:41.847680 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m18:06:41.849184 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m18:06:41.850449 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m18:06:41.850888 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m18:06:41.852628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a519e80-0891-4537-b26f-200e77456090', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799cb82277a0>]}
[0m18:06:41.853261 [debug] [MainThread]: Using duckdb connection "master"
[0m18:06:41.853720 [debug] [MainThread]: On master: BEGIN
[0m18:06:41.854143 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:06:41.855107 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:06:41.855549 [debug] [MainThread]: On master: COMMIT
[0m18:06:41.855983 [debug] [MainThread]: Using duckdb connection "master"
[0m18:06:41.856396 [debug] [MainThread]: On master: COMMIT
[0m18:06:41.857008 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:06:41.857441 [debug] [MainThread]: On master: Close
[0m18:06:41.859474 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:06:41.860165 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m18:06:41.860754 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m18:06:41.861248 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m18:06:41.869184 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:06:41.869887 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m18:06:41.925884 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:06:41.926467 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201180641901679"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'This transaction is fraud due to an extremely low V7 (-15.6) and suspicious high V11 (8.81).' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '54e52bce-5375-4c04-afcd-d086563c6e6e'
    );
  
  
  
[0m18:06:41.926973 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:06:41.935880 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m18:06:41.943518 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:06:41.944032 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m18:06:41.944693 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:06:41.945189 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:06:41.945650 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201180641901679'
      
      
      order by ordinal_position

  
[0m18:06:41.948662 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:06:41.953633 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:06:41.954157 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:06:41.956977 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:06:41.966950 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:06:41.967459 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:06:41.969797 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:06:41.971309 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:06:41.971810 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m18:06:41.972591 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:06:41.988644 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:06:41.989419 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:06:41.989905 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201180641901679"
    )
  
[0m18:06:41.990986 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:06:42.001254 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:06:42.001757 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:06:42.002241 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:06:42.017130 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m18:06:42.019095 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m18:06:42.020801 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a519e80-0891-4537-b26f-200e77456090', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799ccd203f80>]}
[0m18:06:42.021586 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m18:06:42.022328 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:06:42.023717 [debug] [MainThread]: Using duckdb connection "master"
[0m18:06:42.024266 [debug] [MainThread]: On master: BEGIN
[0m18:06:42.024743 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:06:42.025702 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:06:42.026249 [debug] [MainThread]: On master: COMMIT
[0m18:06:42.026727 [debug] [MainThread]: Using duckdb connection "master"
[0m18:06:42.027198 [debug] [MainThread]: On master: COMMIT
[0m18:06:42.027818 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:06:42.028288 [debug] [MainThread]: On master: Close
[0m18:06:42.028778 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:06:42.029260 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m18:06:42.029694 [info ] [MainThread]: 
[0m18:06:42.030165 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m18:06:42.030934 [debug] [MainThread]: Command end result
[0m18:06:42.049833 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:06:42.051472 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:06:42.057074 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m18:06:42.057508 [info ] [MainThread]: 
[0m18:06:42.058037 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:06:42.058481 [info ] [MainThread]: 
[0m18:06:42.058963 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:06:42.059583 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:06:42.060629 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3688567, "process_in_blocks": "0", "process_kernel_time": 0.300816, "process_mem_max_rss": "273476", "process_out_blocks": "3104", "process_user_time": 4.321264}
[0m18:06:42.061226 [debug] [MainThread]: Command `dbt run` succeeded at 18:06:42.061124 after 2.37 seconds
[0m18:06:42.061735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799ccc600f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799ccc49c2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799ccc49db80>]}
[0m18:06:42.062238 [debug] [MainThread]: Flushing usage events
[0m18:06:42.979430 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:06:58.955105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e34be2dd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e34c2c6ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e34bb1ba40>]}


============================== 18:06:58.958408 | 50de5ea3-8a68-4092-bc9f-e2762be5ac99 ==============================
[0m18:06:58.958408 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:06:58.959103 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'target_path': 'None', 'introspect': 'True', 'debug': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "efa1af50-71b3-4792-aecf-4de31c33bf6d", "ai_explanation": "This transaction is fraud due to extreme PCA scores (V1: -15.4) indicating manipulation."} --profiles-dir .', 'version_check': 'True', 'indirect_selection': 'eager', 'partial_parse': 'True', 'printer_width': '80', 'log_format': 'default', 'static_parser': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'empty': 'False', 'write_json': 'True', 'warn_error': 'None'}
[0m18:06:59.207703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '50de5ea3-8a68-4092-bc9f-e2762be5ac99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e33f74f440>]}
[0m18:06:59.279073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '50de5ea3-8a68-4092-bc9f-e2762be5ac99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e34c1eea80>]}
[0m18:06:59.280754 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:06:59.365263 [debug] [MainThread]: checksum: c3495e00dde0f0f076c0bc75b797c7de25b3da9b330f670f38ee53b68ac30c4f, vars: {'ai_explanation': 'This transaction is fraud due to extreme PCA scores (V1: '
                   '-15.4) indicating manipulation.',
 'txn_id': 'efa1af50-71b3-4792-aecf-4de31c33bf6d'}, profile: , target: , version: 1.11.2
[0m18:06:59.458632 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:06:59.459238 [debug] [MainThread]: previous checksum: c3495e00dde0f0f076c0bc75b797c7de25b3da9b330f670f38ee53b68ac30c4f, current checksum: 9c724c4d1772eefec758da5be464a3abd985a462fe6fd17950a256ba4d4c615d
[0m18:06:59.459702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '50de5ea3-8a68-4092-bc9f-e2762be5ac99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e33f4c2180>]}
[0m18:07:00.690845 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m18:07:00.691528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '50de5ea3-8a68-4092-bc9f-e2762be5ac99', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e33d39bd10>]}
[0m18:07:00.785414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '50de5ea3-8a68-4092-bc9f-e2762be5ac99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e34b16f560>]}
[0m18:07:00.855041 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:07:00.856809 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:07:00.869048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '50de5ea3-8a68-4092-bc9f-e2762be5ac99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e34b2210a0>]}
[0m18:07:00.869609 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m18:07:00.870098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50de5ea3-8a68-4092-bc9f-e2762be5ac99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e2e73f6a20>]}
[0m18:07:00.871814 [info ] [MainThread]: 
[0m18:07:00.872319 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:07:00.872747 [info ] [MainThread]: 
[0m18:07:00.873393 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:07:00.874365 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m18:07:00.909514 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m18:07:00.910057 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m18:07:00.910549 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:07:00.997504 [debug] [ThreadPool]: SQL status: OK in 0.087 seconds
[0m18:07:00.999218 [debug] [ThreadPool]: On list_argus_vault: Close
[0m18:07:01.000094 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m18:07:01.000665 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m18:07:01.008032 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:07:01.008495 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m18:07:01.008930 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:07:01.010053 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:07:01.011350 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:07:01.011782 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m18:07:01.012438 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:07:01.012861 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:07:01.013294 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m18:07:01.014024 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:07:01.014948 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:07:01.015391 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:07:01.015792 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:07:01.016420 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:07:01.016853 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m18:07:01.022521 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m18:07:01.028187 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:07:01.028721 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m18:07:01.029151 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:07:01.030037 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:07:01.030476 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:07:01.030893 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m18:07:01.041827 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m18:07:01.043243 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m18:07:01.044495 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m18:07:01.044948 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m18:07:01.046601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50de5ea3-8a68-4092-bc9f-e2762be5ac99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e33f378440>]}
[0m18:07:01.047201 [debug] [MainThread]: Using duckdb connection "master"
[0m18:07:01.047629 [debug] [MainThread]: On master: BEGIN
[0m18:07:01.048055 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:07:01.048946 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:07:01.049388 [debug] [MainThread]: On master: COMMIT
[0m18:07:01.049804 [debug] [MainThread]: Using duckdb connection "master"
[0m18:07:01.050227 [debug] [MainThread]: On master: COMMIT
[0m18:07:01.050832 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:07:01.051311 [debug] [MainThread]: On master: Close
[0m18:07:01.053362 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:07:01.054009 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m18:07:01.054559 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m18:07:01.055071 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m18:07:01.063199 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:07:01.063902 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m18:07:01.120665 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:07:01.121234 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201180701096129"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'This transaction is fraud due to extreme PCA scores (V1: -15.4) indicating manipulation.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = 'efa1af50-71b3-4792-aecf-4de31c33bf6d'
    );
  
  
  
[0m18:07:01.121743 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:07:01.129656 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m18:07:01.137227 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:07:01.137737 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m18:07:01.138747 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:07:01.139259 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:07:01.139731 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201180701096129'
      
      
      order by ordinal_position

  
[0m18:07:01.142466 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:07:01.147595 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:07:01.148129 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:07:01.151048 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:07:01.161168 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:07:01.161689 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:07:01.164030 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:07:01.165520 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:07:01.166036 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m18:07:01.166856 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:07:01.183374 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:07:01.184150 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:07:01.184660 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201180701096129"
    )
  
[0m18:07:01.185903 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:07:01.196320 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:07:01.196833 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:07:01.197335 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:07:01.210499 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m18:07:01.212475 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m18:07:01.214195 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50de5ea3-8a68-4092-bc9f-e2762be5ac99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e33d34b980>]}
[0m18:07:01.214970 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m18:07:01.215691 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:07:01.217586 [debug] [MainThread]: Using duckdb connection "master"
[0m18:07:01.218105 [debug] [MainThread]: On master: BEGIN
[0m18:07:01.218549 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:07:01.219502 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:07:01.219956 [debug] [MainThread]: On master: COMMIT
[0m18:07:01.220371 [debug] [MainThread]: Using duckdb connection "master"
[0m18:07:01.220768 [debug] [MainThread]: On master: COMMIT
[0m18:07:01.221420 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:07:01.221879 [debug] [MainThread]: On master: Close
[0m18:07:01.222400 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:07:01.222793 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m18:07:01.223229 [info ] [MainThread]: 
[0m18:07:01.223665 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m18:07:01.224429 [debug] [MainThread]: Command end result
[0m18:07:01.243894 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:07:01.245541 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:07:01.251218 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m18:07:01.251651 [info ] [MainThread]: 
[0m18:07:01.252181 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:07:01.252613 [info ] [MainThread]: 
[0m18:07:01.253095 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:07:01.253698 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:07:01.254725 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3627245, "process_in_blocks": "0", "process_kernel_time": 0.310547, "process_mem_max_rss": "277492", "process_out_blocks": "3112", "process_user_time": 4.300035}
[0m18:07:01.255318 [debug] [MainThread]: Command `dbt run` succeeded at 18:07:01.255216 after 2.36 seconds
[0m18:07:01.255779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e34b363680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e33f7e3470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e33f7907a0>]}
[0m18:07:01.256288 [debug] [MainThread]: Flushing usage events
[0m18:07:02.124352 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:07:17.574685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f7f11d1640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f7f03d2db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f7f2eb0860>]}


============================== 18:07:17.577994 | c7f96f2c-79b7-4af6-bfae-1520dc041bdc ==============================
[0m18:07:17.577994 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:07:17.578648 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'empty': 'False', 'printer_width': '80', 'quiet': 'False', 'use_colors': 'True', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'static_parser': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'target_path': 'None', 'profiles_dir': '.', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "98a492e1-032b-40b2-a175-4aadb982c508", "ai_explanation": "Fraud detected: Unusual PCA scores indicate anomalous transaction patterns and inconsistencies."} --profiles-dir .'}
[0m18:07:17.824286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c7f96f2c-79b7-4af6-bfae-1520dc041bdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f7f0070fe0>]}
[0m18:07:17.897549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c7f96f2c-79b7-4af6-bfae-1520dc041bdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f7f08ee930>]}
[0m18:07:17.899388 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:07:17.983396 [debug] [MainThread]: checksum: c1fa7fe27090f72ebde459db5704eac41ae9b39ec731c429dea6ac3f187a92cd, vars: {'ai_explanation': 'Fraud detected: Unusual PCA scores indicate anomalous '
                   'transaction patterns and inconsistencies.',
 'txn_id': '98a492e1-032b-40b2-a175-4aadb982c508'}, profile: , target: , version: 1.11.2
[0m18:07:18.076237 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:07:18.076822 [debug] [MainThread]: previous checksum: c1fa7fe27090f72ebde459db5704eac41ae9b39ec731c429dea6ac3f187a92cd, current checksum: c3495e00dde0f0f076c0bc75b797c7de25b3da9b330f670f38ee53b68ac30c4f
[0m18:07:18.077318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c7f96f2c-79b7-4af6-bfae-1520dc041bdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f7f0afaae0>]}
[0m18:07:19.296375 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m18:07:19.297054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c7f96f2c-79b7-4af6-bfae-1520dc041bdc', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f7e455b080>]}
[0m18:07:19.388478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7f96f2c-79b7-4af6-bfae-1520dc041bdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f7e418ec30>]}
[0m18:07:19.457153 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:07:19.459006 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:07:19.471542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7f96f2c-79b7-4af6-bfae-1520dc041bdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f7e01bad50>]}
[0m18:07:19.472118 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m18:07:19.472578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7f96f2c-79b7-4af6-bfae-1520dc041bdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f7e00fcd10>]}
[0m18:07:19.474332 [info ] [MainThread]: 
[0m18:07:19.474825 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:07:19.475278 [info ] [MainThread]: 
[0m18:07:19.475901 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:07:19.476993 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m18:07:19.512377 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m18:07:19.512907 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m18:07:19.513368 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:07:19.600308 [debug] [ThreadPool]: SQL status: OK in 0.087 seconds
[0m18:07:19.602020 [debug] [ThreadPool]: On list_argus_vault: Close
[0m18:07:19.602884 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m18:07:19.603496 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m18:07:19.610942 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:07:19.611408 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m18:07:19.611819 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:07:19.613236 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:07:19.614556 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:07:19.615005 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m18:07:19.615612 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:07:19.616053 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:07:19.616456 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m18:07:19.617113 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:07:19.618043 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:07:19.618485 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:07:19.618895 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:07:19.619524 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:07:19.619968 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m18:07:19.625480 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m18:07:19.631177 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:07:19.631717 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m18:07:19.632148 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:07:19.633082 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:07:19.633519 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:07:19.633960 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m18:07:19.644861 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m18:07:19.646277 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m18:07:19.647586 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m18:07:19.648044 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m18:07:19.649837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7f96f2c-79b7-4af6-bfae-1520dc041bdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f7f2c495b0>]}
[0m18:07:19.650464 [debug] [MainThread]: Using duckdb connection "master"
[0m18:07:19.650887 [debug] [MainThread]: On master: BEGIN
[0m18:07:19.651321 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:07:19.652294 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:07:19.652731 [debug] [MainThread]: On master: COMMIT
[0m18:07:19.653171 [debug] [MainThread]: Using duckdb connection "master"
[0m18:07:19.653567 [debug] [MainThread]: On master: COMMIT
[0m18:07:19.654176 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:07:19.654606 [debug] [MainThread]: On master: Close
[0m18:07:19.656628 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:07:19.657312 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m18:07:19.657876 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m18:07:19.658383 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m18:07:19.666711 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:07:19.667452 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m18:07:19.733517 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:07:19.734202 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201180719706994"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Fraud detected: Unusual PCA scores indicate anomalous transaction patterns and inconsistencies.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '98a492e1-032b-40b2-a175-4aadb982c508'
    );
  
  
  
[0m18:07:19.734715 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:07:19.743881 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m18:07:19.752326 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:07:19.753136 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m18:07:19.754507 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:07:19.755251 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:07:19.756066 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201180719706994'
      
      
      order by ordinal_position

  
[0m18:07:19.760165 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:07:19.767533 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:07:19.768078 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:07:19.770787 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:07:19.780943 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:07:19.781463 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:07:19.784163 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:07:19.785685 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:07:19.786214 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m18:07:19.787236 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:07:19.804412 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:07:19.805194 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:07:19.805686 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201180719706994"
    )
  
[0m18:07:19.806883 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:07:19.817304 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:07:19.817809 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:07:19.818299 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:07:19.832185 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m18:07:19.834286 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m18:07:19.836036 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7f96f2c-79b7-4af6-bfae-1520dc041bdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f7e428e780>]}
[0m18:07:19.836795 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.18s]
[0m18:07:19.837534 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:07:19.839001 [debug] [MainThread]: Using duckdb connection "master"
[0m18:07:19.839488 [debug] [MainThread]: On master: BEGIN
[0m18:07:19.839947 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:07:19.841028 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:07:19.841471 [debug] [MainThread]: On master: COMMIT
[0m18:07:19.841886 [debug] [MainThread]: Using duckdb connection "master"
[0m18:07:19.842310 [debug] [MainThread]: On master: COMMIT
[0m18:07:19.842903 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:07:19.843352 [debug] [MainThread]: On master: Close
[0m18:07:19.843830 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:07:19.844253 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m18:07:19.844661 [info ] [MainThread]: 
[0m18:07:19.845137 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m18:07:19.845885 [debug] [MainThread]: Command end result
[0m18:07:19.864797 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:07:19.866389 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:07:19.871945 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m18:07:19.872376 [info ] [MainThread]: 
[0m18:07:19.872882 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:07:19.873336 [info ] [MainThread]: 
[0m18:07:19.873786 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:07:19.874407 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:07:19.875430 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3627808, "process_in_blocks": "0", "process_kernel_time": 0.34141, "process_mem_max_rss": "276816", "process_out_blocks": "3104", "process_user_time": 4.250753}
[0m18:07:19.876020 [debug] [MainThread]: Command `dbt run` succeeded at 18:07:19.875895 after 2.36 seconds
[0m18:07:19.876491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f7f029c410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f7f029c260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f7e01d13a0>]}
[0m18:07:19.876982 [debug] [MainThread]: Flushing usage events
[0m18:07:20.760211 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:07:36.464264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8125589b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e812568abd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e81260257c0>]}


============================== 18:07:36.467579 | b8f2ad19-3892-4c72-a674-d1ac6166a832 ==============================
[0m18:07:36.467579 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:07:36.468280 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'indirect_selection': 'eager', 'profiles_dir': '.', 'target_path': 'None', 'static_parser': 'True', 'version_check': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "0c94d2a8-0f9e-4673-a972-4eca49e8fb9b", "ai_explanation": "Based on PCA factors, this transaction is fraudulent due to significant deviations from normal patterns."} --profiles-dir .', 'use_experimental_parser': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'printer_width': '80', 'empty': 'False', 'use_colors': 'True', 'write_json': 'True', 'warn_error': 'None', 'partial_parse': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'debug': 'False'}
[0m18:07:36.716223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8f2ad19-3892-4c72-a674-d1ac6166a832', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e811992c770>]}
[0m18:07:36.788164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b8f2ad19-3892-4c72-a674-d1ac6166a832', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e812599d280>]}
[0m18:07:36.790012 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:07:36.874231 [debug] [MainThread]: checksum: 73a8b87c6e4fc1dbeced13d7550c6641eda7ceb90082f5f65dd44c5619a4ee97, vars: {'ai_explanation': 'Based on PCA factors, this transaction is fraudulent due '
                   'to significant deviations from normal patterns.',
 'txn_id': '0c94d2a8-0f9e-4673-a972-4eca49e8fb9b'}, profile: , target: , version: 1.11.2
[0m18:07:36.967232 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:07:36.967844 [debug] [MainThread]: previous checksum: 73a8b87c6e4fc1dbeced13d7550c6641eda7ceb90082f5f65dd44c5619a4ee97, current checksum: c1fa7fe27090f72ebde459db5704eac41ae9b39ec731c429dea6ac3f187a92cd
[0m18:07:36.968359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b8f2ad19-3892-4c72-a674-d1ac6166a832', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8119691d00>]}
[0m18:07:38.211025 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m18:07:38.211718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b8f2ad19-3892-4c72-a674-d1ac6166a832', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8119557b60>]}
[0m18:07:38.305795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b8f2ad19-3892-4c72-a674-d1ac6166a832', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e81180bedb0>]}
[0m18:07:38.375112 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:07:38.376892 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:07:38.389475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8f2ad19-3892-4c72-a674-d1ac6166a832', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8118166870>]}
[0m18:07:38.390049 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m18:07:38.390516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8f2ad19-3892-4c72-a674-d1ac6166a832', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e81181fc560>]}
[0m18:07:38.392340 [info ] [MainThread]: 
[0m18:07:38.392837 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:07:38.393342 [info ] [MainThread]: 
[0m18:07:38.393988 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:07:38.395015 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m18:07:38.431100 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m18:07:38.431662 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m18:07:38.432122 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:07:38.522762 [debug] [ThreadPool]: SQL status: OK in 0.091 seconds
[0m18:07:38.524475 [debug] [ThreadPool]: On list_argus_vault: Close
[0m18:07:38.525349 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m18:07:38.525961 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m18:07:38.533416 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:07:38.533877 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m18:07:38.534336 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:07:38.535676 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:07:38.537012 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:07:38.537444 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m18:07:38.538076 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:07:38.538499 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:07:38.538900 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m18:07:38.539560 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:07:38.540489 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:07:38.540958 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:07:38.541371 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:07:38.542049 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:07:38.542484 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m18:07:38.548187 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m18:07:38.553808 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:07:38.554354 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m18:07:38.554757 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:07:38.555699 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:07:38.556153 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:07:38.556566 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m18:07:38.567376 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m18:07:38.568780 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m18:07:38.570059 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m18:07:38.570506 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m18:07:38.572004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8f2ad19-3892-4c72-a674-d1ac6166a832', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e80dc988ad0>]}
[0m18:07:38.572594 [debug] [MainThread]: Using duckdb connection "master"
[0m18:07:38.573051 [debug] [MainThread]: On master: BEGIN
[0m18:07:38.573456 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:07:38.574306 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:07:38.574741 [debug] [MainThread]: On master: COMMIT
[0m18:07:38.575185 [debug] [MainThread]: Using duckdb connection "master"
[0m18:07:38.575582 [debug] [MainThread]: On master: COMMIT
[0m18:07:38.576249 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:07:38.576675 [debug] [MainThread]: On master: Close
[0m18:07:38.578725 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:07:38.579371 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m18:07:38.579939 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m18:07:38.580427 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m18:07:38.588535 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:07:38.589278 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m18:07:38.645717 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:07:38.646291 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201180738621317"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Based on PCA factors, this transaction is fraudulent due to significant deviations from normal patterns.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '0c94d2a8-0f9e-4673-a972-4eca49e8fb9b'
    );
  
  
  
[0m18:07:38.646785 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:07:38.655007 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m18:07:38.662582 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:07:38.663110 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m18:07:38.663786 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:07:38.664291 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:07:38.664756 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201180738621317'
      
      
      order by ordinal_position

  
[0m18:07:38.667465 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:07:38.672544 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:07:38.673081 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:07:38.676064 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:07:38.686677 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:07:38.687230 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:07:38.689772 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:07:38.691358 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:07:38.691859 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m18:07:38.692657 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:07:38.709166 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:07:38.710024 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:07:38.710529 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201180738621317"
    )
  
[0m18:07:38.711852 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:07:38.722424 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:07:38.722969 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:07:38.723439 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:07:38.737180 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m18:07:38.739276 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m18:07:38.741058 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8f2ad19-3892-4c72-a674-d1ac6166a832', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e812631cbf0>]}
[0m18:07:38.741823 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m18:07:38.742558 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:07:38.744009 [debug] [MainThread]: Using duckdb connection "master"
[0m18:07:38.744598 [debug] [MainThread]: On master: BEGIN
[0m18:07:38.745100 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:07:38.746036 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:07:38.746475 [debug] [MainThread]: On master: COMMIT
[0m18:07:38.746888 [debug] [MainThread]: Using duckdb connection "master"
[0m18:07:38.747323 [debug] [MainThread]: On master: COMMIT
[0m18:07:38.747900 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:07:38.748366 [debug] [MainThread]: On master: Close
[0m18:07:38.748855 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:07:38.749294 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m18:07:38.749714 [info ] [MainThread]: 
[0m18:07:38.750193 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m18:07:38.751005 [debug] [MainThread]: Command end result
[0m18:07:38.769970 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:07:38.771582 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:07:38.777262 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m18:07:38.777713 [info ] [MainThread]: 
[0m18:07:38.778259 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:07:38.778702 [info ] [MainThread]: 
[0m18:07:38.779192 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:07:38.779814 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:07:38.780879 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3792994, "process_in_blocks": "0", "process_kernel_time": 0.320584, "process_mem_max_rss": "277004", "process_out_blocks": "3104", "process_user_time": 4.277434}
[0m18:07:38.781518 [debug] [MainThread]: Command `dbt run` succeeded at 18:07:38.781414 after 2.38 seconds
[0m18:07:38.782012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8125cdb800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e81180c8800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e81253b3320>]}
[0m18:07:38.782511 [debug] [MainThread]: Flushing usage events
[0m18:07:39.743075 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:07:56.864240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9c53d10c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9c53281490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9c53b0cbf0>]}


============================== 18:07:56.867674 | b2e17067-3d75-4e5a-88fb-51813b974d50 ==============================
[0m18:07:56.867674 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:07:56.868379 [debug] [MainThread]: running dbt with arguments {'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'use_colors': 'True', 'profiles_dir': '.', 'partial_parse': 'True', 'fail_fast': 'False', 'write_json': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'warn_error': 'None', 'no_print': 'None', 'printer_width': '80', 'cache_selected_only': 'False', 'log_format': 'default', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'target_path': 'None', 'log_cache_events': 'False', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "21c57c61-d245-48d0-970b-f9a2a1a540da", "ai_explanation": "Based on PCA factors, this transaction is fraud due to anomalous V7 and V17 values (-16.1964 and -12.1220)."} --profiles-dir .'}
[0m18:07:57.114566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b2e17067-3d75-4e5a-88fb-51813b974d50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9c539a9460>]}
[0m18:07:57.185893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b2e17067-3d75-4e5a-88fb-51813b974d50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9c53d10c20>]}
[0m18:07:57.187587 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:07:57.271245 [debug] [MainThread]: checksum: dd0d4955561dde53b574462445cb9470ad142c070102a6b69e8f422846ef9d8a, vars: {'ai_explanation': 'Based on PCA factors, this transaction is fraud due to '
                   'anomalous V7 and V17 values (-16.1964 and -12.1220).',
 'txn_id': '21c57c61-d245-48d0-970b-f9a2a1a540da'}, profile: , target: , version: 1.11.2
[0m18:07:57.363805 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:07:57.364447 [debug] [MainThread]: previous checksum: dd0d4955561dde53b574462445cb9470ad142c070102a6b69e8f422846ef9d8a, current checksum: 73a8b87c6e4fc1dbeced13d7550c6641eda7ceb90082f5f65dd44c5619a4ee97
[0m18:07:57.364903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b2e17067-3d75-4e5a-88fb-51813b974d50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9c46cbeb70>]}
[0m18:07:58.595210 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m18:07:58.595879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b2e17067-3d75-4e5a-88fb-51813b974d50', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9c44b45460>]}
[0m18:07:58.689322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b2e17067-3d75-4e5a-88fb-51813b974d50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9c069efe00>]}
[0m18:07:58.759105 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:07:58.760840 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:07:58.773173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b2e17067-3d75-4e5a-88fb-51813b974d50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9c068146b0>]}
[0m18:07:58.773714 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m18:07:58.774201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2e17067-3d75-4e5a-88fb-51813b974d50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9c069e16d0>]}
[0m18:07:58.775966 [info ] [MainThread]: 
[0m18:07:58.776487 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:07:58.776941 [info ] [MainThread]: 
[0m18:07:58.777553 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:07:58.778539 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m18:07:58.813532 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m18:07:58.814029 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m18:07:58.814453 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:07:58.900423 [debug] [ThreadPool]: SQL status: OK in 0.086 seconds
[0m18:07:58.902156 [debug] [ThreadPool]: On list_argus_vault: Close
[0m18:07:58.903017 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m18:07:58.903578 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m18:07:58.910858 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:07:58.911335 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m18:07:58.911746 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:07:58.913129 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:07:58.914429 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:07:58.914860 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m18:07:58.915492 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:07:58.915929 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:07:58.916339 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m18:07:58.917027 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:07:58.917955 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:07:58.918394 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:07:58.918795 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:07:58.919404 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:07:58.919832 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m18:07:58.925466 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m18:07:58.931093 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:07:58.931629 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m18:07:58.932059 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:07:58.932943 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:07:58.933383 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:07:58.933799 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m18:07:58.944791 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m18:07:58.946294 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m18:07:58.947573 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m18:07:58.948033 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m18:07:58.949579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2e17067-3d75-4e5a-88fb-51813b974d50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9c069c2300>]}
[0m18:07:58.950286 [debug] [MainThread]: Using duckdb connection "master"
[0m18:07:58.950742 [debug] [MainThread]: On master: BEGIN
[0m18:07:58.951205 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:07:58.952108 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:07:58.952586 [debug] [MainThread]: On master: COMMIT
[0m18:07:58.953062 [debug] [MainThread]: Using duckdb connection "master"
[0m18:07:58.953496 [debug] [MainThread]: On master: COMMIT
[0m18:07:58.954145 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:07:58.954609 [debug] [MainThread]: On master: Close
[0m18:07:58.956708 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:07:58.957447 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m18:07:58.958083 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m18:07:58.958598 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m18:07:58.966680 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:07:58.967396 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m18:07:59.024035 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:07:59.024608 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201180758999721"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Based on PCA factors, this transaction is fraud due to anomalous V7 and V17 values (-16.1964 and -12.1220).' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '21c57c61-d245-48d0-970b-f9a2a1a540da'
    );
  
  
  
[0m18:07:59.025116 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:07:59.033702 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m18:07:59.041397 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:07:59.041900 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m18:07:59.042623 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:07:59.043123 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:07:59.043589 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201180758999721'
      
      
      order by ordinal_position

  
[0m18:07:59.046069 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:07:59.051041 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:07:59.051553 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:07:59.054747 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:07:59.064892 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:07:59.065426 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:07:59.068870 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:07:59.070397 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:07:59.070898 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m18:07:59.071670 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:07:59.087887 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:07:59.088665 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:07:59.089188 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201180758999721"
    )
  
[0m18:07:59.090360 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:07:59.100647 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:07:59.101176 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:07:59.101637 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:07:59.118397 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m18:07:59.120349 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m18:07:59.122076 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2e17067-3d75-4e5a-88fb-51813b974d50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9c556b9040>]}
[0m18:07:59.122827 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m18:07:59.123562 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:07:59.124893 [debug] [MainThread]: Using duckdb connection "master"
[0m18:07:59.125491 [debug] [MainThread]: On master: BEGIN
[0m18:07:59.125977 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:07:59.126848 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:07:59.127460 [debug] [MainThread]: On master: COMMIT
[0m18:07:59.128131 [debug] [MainThread]: Using duckdb connection "master"
[0m18:07:59.128547 [debug] [MainThread]: On master: COMMIT
[0m18:07:59.129198 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:07:59.129721 [debug] [MainThread]: On master: Close
[0m18:07:59.130234 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:07:59.130628 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m18:07:59.131072 [info ] [MainThread]: 
[0m18:07:59.131516 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m18:07:59.132284 [debug] [MainThread]: Command end result
[0m18:07:59.151356 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:07:59.153005 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:07:59.158687 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m18:07:59.159163 [info ] [MainThread]: 
[0m18:07:59.159830 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:07:59.160365 [info ] [MainThread]: 
[0m18:07:59.160833 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:07:59.161480 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:07:59.162543 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3616438, "process_in_blocks": "0", "process_kernel_time": 0.305526, "process_mem_max_rss": "277596", "process_out_blocks": "3096", "process_user_time": 4.311096}
[0m18:07:59.163145 [debug] [MainThread]: Command `dbt run` succeeded at 18:07:59.163039 after 2.36 seconds
[0m18:07:59.163618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9c5325eff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9c0682a6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9c529f00b0>]}
[0m18:07:59.164120 [debug] [MainThread]: Flushing usage events
[0m18:08:00.048640 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:08:16.112508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7869891d7530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7869888a3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7869891d5010>]}


============================== 18:08:16.115902 | ec6802ed-37a3-4040-8da3-b74461648b31 ==============================
[0m18:08:16.115902 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:08:16.116599 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'indirect_selection': 'eager', 'partial_parse': 'True', 'debug': 'False', 'warn_error': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'no_print': 'None', 'write_json': 'True', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "aaa63247-caea-4979-bcf5-830071fa40ca", "ai_explanation": "The transaction is flagged for fraud based on a PCA score of -5.31, exceeding the threshold."} --profiles-dir .', 'printer_width': '80', 'profiles_dir': '.', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'quiet': 'False', 'target_path': 'None', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True'}
[0m18:08:16.363497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ec6802ed-37a3-4040-8da3-b74461648b31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786988855d30>]}
[0m18:08:16.435305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ec6802ed-37a3-4040-8da3-b74461648b31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78697cd0bce0>]}
[0m18:08:16.437191 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:08:16.522272 [debug] [MainThread]: checksum: 15c4420963095aeb2fe9d425eafbea83d308508889f2594adfe57a417bb9dc95, vars: {'ai_explanation': 'The transaction is flagged for fraud based on a PCA score '
                   'of -5.31, exceeding the threshold.',
 'txn_id': 'aaa63247-caea-4979-bcf5-830071fa40ca'}, profile: , target: , version: 1.11.2
[0m18:08:16.615502 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:08:16.616139 [debug] [MainThread]: previous checksum: 15c4420963095aeb2fe9d425eafbea83d308508889f2594adfe57a417bb9dc95, current checksum: dd0d4955561dde53b574462445cb9470ad142c070102a6b69e8f422846ef9d8a
[0m18:08:16.616607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ec6802ed-37a3-4040-8da3-b74461648b31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78697ca77380>]}
[0m18:08:17.854276 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m18:08:17.855104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ec6802ed-37a3-4040-8da3-b74461648b31', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78697cd55b20>]}
[0m18:08:17.958198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec6802ed-37a3-4040-8da3-b74461648b31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78697c13c1d0>]}
[0m18:08:18.028829 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:08:18.030592 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:08:18.042841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec6802ed-37a3-4040-8da3-b74461648b31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78697c0b1340>]}
[0m18:08:18.043437 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m18:08:18.043988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec6802ed-37a3-4040-8da3-b74461648b31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78697ca327e0>]}
[0m18:08:18.045741 [info ] [MainThread]: 
[0m18:08:18.046299 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:08:18.046787 [info ] [MainThread]: 
[0m18:08:18.047458 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:08:18.048513 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m18:08:18.083629 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m18:08:18.084135 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m18:08:18.084569 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:08:18.171935 [debug] [ThreadPool]: SQL status: OK in 0.087 seconds
[0m18:08:18.173601 [debug] [ThreadPool]: On list_argus_vault: Close
[0m18:08:18.174511 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m18:08:18.175164 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m18:08:18.182540 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:08:18.183053 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m18:08:18.183502 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:08:18.184659 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:08:18.186013 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:08:18.186474 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m18:08:18.187129 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:08:18.187581 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:08:18.188050 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m18:08:18.188708 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:08:18.189679 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:08:18.190171 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:08:18.190623 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:08:18.191332 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:08:18.191798 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m18:08:18.197356 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m18:08:18.203169 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:08:18.203695 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m18:08:18.204129 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:08:18.205238 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:08:18.205668 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:08:18.206105 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m18:08:18.217082 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m18:08:18.218495 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m18:08:18.219748 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m18:08:18.220207 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m18:08:18.221858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec6802ed-37a3-4040-8da3-b74461648b31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78697c101820>]}
[0m18:08:18.222554 [debug] [MainThread]: Using duckdb connection "master"
[0m18:08:18.223025 [debug] [MainThread]: On master: BEGIN
[0m18:08:18.223448 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:08:18.224431 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:08:18.224894 [debug] [MainThread]: On master: COMMIT
[0m18:08:18.225361 [debug] [MainThread]: Using duckdb connection "master"
[0m18:08:18.225782 [debug] [MainThread]: On master: COMMIT
[0m18:08:18.226457 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:08:18.226945 [debug] [MainThread]: On master: Close
[0m18:08:18.229066 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:08:18.229769 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m18:08:18.230338 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m18:08:18.230822 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m18:08:18.238817 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:08:18.239534 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m18:08:18.295731 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:08:18.296345 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201180818271462"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'The transaction is flagged for fraud based on a PCA score of -5.31, exceeding the threshold.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = 'aaa63247-caea-4979-bcf5-830071fa40ca'
    );
  
  
  
[0m18:08:18.296834 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:08:18.305138 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m18:08:18.312699 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:08:18.313229 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m18:08:18.313888 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:08:18.314380 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:08:18.314840 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201180818271462'
      
      
      order by ordinal_position

  
[0m18:08:18.317231 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:08:18.322134 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:08:18.322643 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:08:18.325290 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:08:18.335346 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:08:18.335858 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:08:18.338964 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:08:18.340450 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:08:18.340973 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m18:08:18.341728 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:08:18.357856 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:08:18.358635 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:08:18.359158 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201180818271462"
    )
  
[0m18:08:18.360576 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:08:18.370896 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:08:18.371425 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:08:18.371877 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:08:18.385311 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m18:08:18.387245 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m18:08:18.388928 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec6802ed-37a3-4040-8da3-b74461648b31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78698970cbc0>]}
[0m18:08:18.389674 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m18:08:18.390393 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:08:18.392119 [debug] [MainThread]: Using duckdb connection "master"
[0m18:08:18.392602 [debug] [MainThread]: On master: BEGIN
[0m18:08:18.393260 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:08:18.394288 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:08:18.394813 [debug] [MainThread]: On master: COMMIT
[0m18:08:18.395583 [debug] [MainThread]: Using duckdb connection "master"
[0m18:08:18.396053 [debug] [MainThread]: On master: COMMIT
[0m18:08:18.396893 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:08:18.397459 [debug] [MainThread]: On master: Close
[0m18:08:18.398026 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:08:18.398447 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m18:08:18.398885 [info ] [MainThread]: 
[0m18:08:18.399420 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m18:08:18.400259 [debug] [MainThread]: Command end result
[0m18:08:18.420593 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:08:18.422684 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:08:18.428730 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m18:08:18.429249 [info ] [MainThread]: 
[0m18:08:18.429845 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:08:18.430366 [info ] [MainThread]: 
[0m18:08:18.430869 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:08:18.431596 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:08:18.432745 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3823934, "process_in_blocks": "0", "process_kernel_time": 0.315076, "process_mem_max_rss": "271752", "process_out_blocks": "3112", "process_user_time": 4.300097}
[0m18:08:18.433419 [debug] [MainThread]: Command `dbt run` succeeded at 18:08:18.433308 after 2.38 seconds
[0m18:08:18.433948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78698d033da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78693c907f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78693c907f80>]}
[0m18:08:18.434435 [debug] [MainThread]: Flushing usage events
[0m18:08:19.318135 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:08:34.751192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75856c7c6570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75856c48a990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75856bc64b00>]}


============================== 18:08:34.754601 | 8337f5e1-91fc-4505-bfcb-d74796c31d4c ==============================
[0m18:08:34.754601 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:08:34.755335 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "50040fa2-1f5e-4f12-b1ce-4fb373fe46c5", "ai_explanation": "Fraudulent transaction due to extremely high negative PCA score (-16.37)."} --profiles-dir .', 'static_parser': 'True', 'introspect': 'True', 'debug': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'printer_width': '80', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'fail_fast': 'False', 'log_cache_events': 'False', 'empty': 'False', 'write_json': 'True', 'version_check': 'True', 'profiles_dir': '.', 'indirect_selection': 'eager', 'log_format': 'default', 'use_colors': 'True', 'log_path': '/workspaces/modern-stack-banking/Transform/logs'}
[0m18:08:35.010146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8337f5e1-91fc-4505-bfcb-d74796c31d4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75856b55b6b0>]}
[0m18:08:35.081747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8337f5e1-91fc-4505-bfcb-d74796c31d4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75856c92e420>]}
[0m18:08:35.083495 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:08:35.171667 [debug] [MainThread]: checksum: 8a17f0245663f978546703040373d8729966975dba073e69ce2780dda0242491, vars: {'ai_explanation': 'Fraudulent transaction due to extremely high negative PCA '
                   'score (-16.37).',
 'txn_id': '50040fa2-1f5e-4f12-b1ce-4fb373fe46c5'}, profile: , target: , version: 1.11.2
[0m18:08:35.267249 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:08:35.267858 [debug] [MainThread]: previous checksum: 8a17f0245663f978546703040373d8729966975dba073e69ce2780dda0242491, current checksum: 15c4420963095aeb2fe9d425eafbea83d308508889f2594adfe57a417bb9dc95
[0m18:08:35.268371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8337f5e1-91fc-4505-bfcb-d74796c31d4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75856c0eac60>]}
[0m18:08:36.508897 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m18:08:36.509575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8337f5e1-91fc-4505-bfcb-d74796c31d4c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75855f848080>]}
[0m18:08:36.602013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8337f5e1-91fc-4505-bfcb-d74796c31d4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75855f94e3f0>]}
[0m18:08:36.673192 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:08:36.674957 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:08:36.687302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8337f5e1-91fc-4505-bfcb-d74796c31d4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75855c197650>]}
[0m18:08:36.687883 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m18:08:36.688411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8337f5e1-91fc-4505-bfcb-d74796c31d4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75856b796690>]}
[0m18:08:36.690175 [info ] [MainThread]: 
[0m18:08:36.690690 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:08:36.691159 [info ] [MainThread]: 
[0m18:08:36.691770 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:08:36.692859 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m18:08:36.727821 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m18:08:36.728334 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m18:08:36.728762 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:08:36.814381 [debug] [ThreadPool]: SQL status: OK in 0.086 seconds
[0m18:08:36.816083 [debug] [ThreadPool]: On list_argus_vault: Close
[0m18:08:36.816968 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m18:08:36.817572 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m18:08:36.825019 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:08:36.825524 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m18:08:36.826046 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:08:36.827383 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:08:36.828699 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:08:36.829154 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m18:08:36.829785 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:08:36.830247 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:08:36.830651 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m18:08:36.831291 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:08:36.832216 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:08:36.832652 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:08:36.833082 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:08:36.833663 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:08:36.834113 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m18:08:36.839603 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m18:08:36.845296 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:08:36.845827 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m18:08:36.846253 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:08:36.847142 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:08:36.847584 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:08:36.848024 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m18:08:36.859203 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m18:08:36.860694 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m18:08:36.862010 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m18:08:36.862442 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m18:08:36.863990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8337f5e1-91fc-4505-bfcb-d74796c31d4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75850f518380>]}
[0m18:08:36.864636 [debug] [MainThread]: Using duckdb connection "master"
[0m18:08:36.865099 [debug] [MainThread]: On master: BEGIN
[0m18:08:36.865516 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:08:36.866468 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:08:36.866942 [debug] [MainThread]: On master: COMMIT
[0m18:08:36.867388 [debug] [MainThread]: Using duckdb connection "master"
[0m18:08:36.867804 [debug] [MainThread]: On master: COMMIT
[0m18:08:36.868444 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:08:36.868893 [debug] [MainThread]: On master: Close
[0m18:08:36.871040 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:08:36.871745 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m18:08:36.872424 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m18:08:36.872929 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m18:08:36.881077 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:08:36.881777 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m18:08:36.938400 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:08:36.939036 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201180836913928"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Fraudulent transaction due to extremely high negative PCA score (-16.37).' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '50040fa2-1f5e-4f12-b1ce-4fb373fe46c5'
    );
  
  
  
[0m18:08:36.939537 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:08:36.948284 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m18:08:36.956054 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:08:36.956575 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m18:08:36.957272 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:08:36.957763 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:08:36.958255 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201180836913928'
      
      
      order by ordinal_position

  
[0m18:08:36.961459 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:08:36.966529 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:08:36.967056 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:08:36.970290 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:08:36.980689 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:08:36.981226 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:08:36.983553 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:08:36.985058 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:08:36.985562 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m18:08:36.986334 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:08:37.002654 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:08:37.003436 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:08:37.003959 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201180836913928"
    )
  
[0m18:08:37.005405 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:08:37.016025 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:08:37.016560 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:08:37.017045 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:08:37.031085 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m18:08:37.033165 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m18:08:37.034905 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8337f5e1-91fc-4505-bfcb-d74796c31d4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75856e394e60>]}
[0m18:08:37.035701 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m18:08:37.036439 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:08:37.037840 [debug] [MainThread]: Using duckdb connection "master"
[0m18:08:37.038368 [debug] [MainThread]: On master: BEGIN
[0m18:08:37.038826 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:08:37.039743 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:08:37.040217 [debug] [MainThread]: On master: COMMIT
[0m18:08:37.040649 [debug] [MainThread]: Using duckdb connection "master"
[0m18:08:37.041089 [debug] [MainThread]: On master: COMMIT
[0m18:08:37.041692 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:08:37.042158 [debug] [MainThread]: On master: Close
[0m18:08:37.042734 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:08:37.043241 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m18:08:37.043749 [info ] [MainThread]: 
[0m18:08:37.044245 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m18:08:37.045060 [debug] [MainThread]: Command end result
[0m18:08:37.065333 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:08:37.066971 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:08:37.072679 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m18:08:37.073147 [info ] [MainThread]: 
[0m18:08:37.073672 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:08:37.074147 [info ] [MainThread]: 
[0m18:08:37.074630 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:08:37.075578 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:08:37.076968 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3889854, "process_in_blocks": "0", "process_kernel_time": 0.305079, "process_mem_max_rss": "283952", "process_out_blocks": "3104", "process_user_time": 4.334718}
[0m18:08:37.077541 [debug] [MainThread]: Command `dbt run` succeeded at 18:08:37.077439 after 2.39 seconds
[0m18:08:37.078021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75856c271160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75856c0eb320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75856b7dd940>]}
[0m18:08:37.078501 [debug] [MainThread]: Flushing usage events
[0m18:08:37.967671 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:08:53.613637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72861b9626f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72861ddddeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72861dc58800>]}


============================== 18:08:53.617012 | aacd7a5e-dc62-4322-b640-57fe9f850107 ==============================
[0m18:08:53.617012 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:08:53.617717 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'target_path': 'None', 'warn_error': 'None', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'use_colors': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'log_format': 'default', 'debug': 'False', 'introspect': 'True', 'printer_width': '80', 'partial_parse': 'True', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "6da136d3-c6fe-4742-bd0d-8fd6b8b50f1b", "ai_explanation": "The transaction is flagged as fraud due to an unusual PCA score of -16.92."} --profiles-dir .', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'quiet': 'False', 'profiles_dir': '.', 'empty': 'False'}
[0m18:08:53.863628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aacd7a5e-dc62-4322-b640-57fe9f850107', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72860f3c7260>]}
[0m18:08:53.934990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aacd7a5e-dc62-4322-b640-57fe9f850107', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72861b6c08c0>]}
[0m18:08:53.936693 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:08:54.022444 [debug] [MainThread]: checksum: ace0d62aa1f2d27090fe9dbeb3264da8d97b918c82fd28233ad76cf711de91f1, vars: {'ai_explanation': 'The transaction is flagged as fraud due to an unusual PCA '
                   'score of -16.92.',
 'txn_id': '6da136d3-c6fe-4742-bd0d-8fd6b8b50f1b'}, profile: , target: , version: 1.11.2
[0m18:08:54.116540 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:08:54.117190 [debug] [MainThread]: previous checksum: ace0d62aa1f2d27090fe9dbeb3264da8d97b918c82fd28233ad76cf711de91f1, current checksum: 8a17f0245663f978546703040373d8729966975dba073e69ce2780dda0242491
[0m18:08:54.117698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'aacd7a5e-dc62-4322-b640-57fe9f850107', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72860f0c6000>]}
[0m18:08:55.352958 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m18:08:55.353649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'aacd7a5e-dc62-4322-b640-57fe9f850107', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72860cff31a0>]}
[0m18:08:55.446516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aacd7a5e-dc62-4322-b640-57fe9f850107', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7285e6de3bf0>]}
[0m18:08:55.515546 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:08:55.517393 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:08:55.529948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aacd7a5e-dc62-4322-b640-57fe9f850107', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7285e6dee4e0>]}
[0m18:08:55.530529 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m18:08:55.531042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aacd7a5e-dc62-4322-b640-57fe9f850107', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7285e6d039e0>]}
[0m18:08:55.532773 [info ] [MainThread]: 
[0m18:08:55.533289 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:08:55.533723 [info ] [MainThread]: 
[0m18:08:55.534366 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:08:55.535480 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m18:08:55.570411 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m18:08:55.570903 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m18:08:55.571360 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:08:55.657121 [debug] [ThreadPool]: SQL status: OK in 0.086 seconds
[0m18:08:55.658754 [debug] [ThreadPool]: On list_argus_vault: Close
[0m18:08:55.659625 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m18:08:55.660229 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m18:08:55.667535 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:08:55.668021 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m18:08:55.668443 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:08:55.669819 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:08:55.671152 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:08:55.671588 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m18:08:55.672198 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:08:55.672621 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:08:55.673045 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m18:08:55.673673 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:08:55.674597 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:08:55.675052 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:08:55.675460 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:08:55.676060 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:08:55.676496 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m18:08:55.684174 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m18:08:55.690063 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:08:55.690599 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m18:08:55.691031 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:08:55.691905 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:08:55.692361 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:08:55.692771 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m18:08:55.703791 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m18:08:55.705228 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m18:08:55.706480 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m18:08:55.706936 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m18:08:55.708461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aacd7a5e-dc62-4322-b640-57fe9f850107', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72860cf9faa0>]}
[0m18:08:55.709095 [debug] [MainThread]: Using duckdb connection "master"
[0m18:08:55.709529 [debug] [MainThread]: On master: BEGIN
[0m18:08:55.709951 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:08:55.710877 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:08:55.711352 [debug] [MainThread]: On master: COMMIT
[0m18:08:55.711768 [debug] [MainThread]: Using duckdb connection "master"
[0m18:08:55.712207 [debug] [MainThread]: On master: COMMIT
[0m18:08:55.712813 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:08:55.713272 [debug] [MainThread]: On master: Close
[0m18:08:55.715294 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:08:55.716234 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m18:08:55.717149 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m18:08:55.717632 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m18:08:55.726003 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:08:55.726707 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m18:08:55.782959 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:08:55.783516 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201180855758780"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'The transaction is flagged as fraud due to an unusual PCA score of -16.92.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '6da136d3-c6fe-4742-bd0d-8fd6b8b50f1b'
    );
  
  
  
[0m18:08:55.784018 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:08:55.792232 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m18:08:55.800005 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:08:55.800522 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m18:08:55.801211 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:08:55.801694 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:08:55.802189 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201180855758780'
      
      
      order by ordinal_position

  
[0m18:08:55.805087 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:08:55.810101 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:08:55.810617 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:08:55.813094 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:08:55.823251 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:08:55.823780 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:08:55.826121 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:08:55.827608 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:08:55.828134 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m18:08:55.828885 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:08:55.845243 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:08:55.846042 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:08:55.846539 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201180855758780"
    )
  
[0m18:08:55.847956 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:08:55.858268 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:08:55.858781 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:08:55.859322 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:08:55.872829 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m18:08:55.874899 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m18:08:55.876644 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aacd7a5e-dc62-4322-b640-57fe9f850107', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72860cf7d430>]}
[0m18:08:55.877408 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m18:08:55.878136 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:08:55.879741 [debug] [MainThread]: Using duckdb connection "master"
[0m18:08:55.880266 [debug] [MainThread]: On master: BEGIN
[0m18:08:55.880690 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:08:55.881623 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:08:55.882093 [debug] [MainThread]: On master: COMMIT
[0m18:08:55.882507 [debug] [MainThread]: Using duckdb connection "master"
[0m18:08:55.882907 [debug] [MainThread]: On master: COMMIT
[0m18:08:55.883523 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:08:55.883976 [debug] [MainThread]: On master: Close
[0m18:08:55.884477 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:08:55.884883 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m18:08:55.885337 [info ] [MainThread]: 
[0m18:08:55.885786 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m18:08:55.886567 [debug] [MainThread]: Command end result
[0m18:08:55.905368 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:08:55.907002 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:08:55.912647 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m18:08:55.913114 [info ] [MainThread]: 
[0m18:08:55.913632 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:08:55.914094 [info ] [MainThread]: 
[0m18:08:55.914559 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:08:55.915191 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:08:55.916234 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3652046, "process_in_blocks": "0", "process_kernel_time": 0.308297, "process_mem_max_rss": "279532", "process_out_blocks": "3112", "process_user_time": 4.277501}
[0m18:08:55.916815 [debug] [MainThread]: Command `dbt run` succeeded at 18:08:55.916712 after 2.37 seconds
[0m18:08:55.917311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72861d2ef230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72860f357a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7285e6d263c0>]}
[0m18:08:55.917784 [debug] [MainThread]: Flushing usage events
[0m18:08:56.855545 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:09:13.006467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c26150a210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c26122eb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c26128cc20>]}


============================== 18:09:13.009792 | ace88663-9b26-40d3-9564-f0311dce38a3 ==============================
[0m18:09:13.009792 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:09:13.010502 [debug] [MainThread]: running dbt with arguments {'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'static_parser': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'introspect': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'use_colors': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'use_experimental_parser': 'False', 'log_format': 'default', 'no_print': 'None', 'quiet': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'empty': 'False', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "3ba58c4c-3d7c-4a73-b73a-6abe4cd9f0bf", "ai_explanation": "This transaction is fraud due to extreme PCA factor V3 (-24.202142) indicating significant irregularity."} --profiles-dir .', 'warn_error': 'None', 'profiles_dir': '.', 'write_json': 'True'}
[0m18:09:13.263199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ace88663-9b26-40d3-9564-f0311dce38a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c255207500>]}
[0m18:09:13.340628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ace88663-9b26-40d3-9564-f0311dce38a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c26397dac0>]}
[0m18:09:13.343408 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:09:13.429326 [debug] [MainThread]: checksum: fb85100a10ccd7de12af3e5e7bfebf37016df5b72a55c8ad877fd8f1ff63fbc8, vars: {'ai_explanation': 'This transaction is fraud due to extreme PCA factor V3 '
                   '(-24.202142) indicating significant irregularity.',
 'txn_id': '3ba58c4c-3d7c-4a73-b73a-6abe4cd9f0bf'}, profile: , target: , version: 1.11.2
[0m18:09:13.523318 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:09:13.523934 [debug] [MainThread]: previous checksum: fb85100a10ccd7de12af3e5e7bfebf37016df5b72a55c8ad877fd8f1ff63fbc8, current checksum: ace0d62aa1f2d27090fe9dbeb3264da8d97b918c82fd28233ad76cf711de91f1
[0m18:09:13.524416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ace88663-9b26-40d3-9564-f0311dce38a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c25cb0e120>]}
[0m18:09:14.760641 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m18:09:14.761326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ace88663-9b26-40d3-9564-f0311dce38a3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c260d7f9e0>]}
[0m18:09:14.854295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ace88663-9b26-40d3-9564-f0311dce38a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c254db7200>]}
[0m18:09:14.923707 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:09:14.925485 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:09:14.938172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ace88663-9b26-40d3-9564-f0311dce38a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c2541e00e0>]}
[0m18:09:14.938775 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m18:09:14.939266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ace88663-9b26-40d3-9564-f0311dce38a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c254f89790>]}
[0m18:09:14.941036 [info ] [MainThread]: 
[0m18:09:14.941533 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:09:14.941992 [info ] [MainThread]: 
[0m18:09:14.942597 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:09:14.943599 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m18:09:14.978846 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m18:09:14.979352 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m18:09:14.979796 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:09:15.065471 [debug] [ThreadPool]: SQL status: OK in 0.086 seconds
[0m18:09:15.067184 [debug] [ThreadPool]: On list_argus_vault: Close
[0m18:09:15.068057 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m18:09:15.068627 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m18:09:15.076109 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:09:15.076573 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m18:09:15.077014 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:09:15.078174 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:09:15.079481 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:09:15.079926 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m18:09:15.080529 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:09:15.080980 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:09:15.081396 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m18:09:15.082112 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:09:15.083055 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:09:15.083499 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:09:15.083903 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:09:15.084527 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:09:15.084986 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m18:09:15.090579 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m18:09:15.096469 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:09:15.097023 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m18:09:15.097428 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:09:15.098579 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:09:15.099034 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:09:15.099450 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m18:09:15.110481 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m18:09:15.112015 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m18:09:15.113301 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m18:09:15.113744 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m18:09:15.115338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ace88663-9b26-40d3-9564-f0311dce38a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c254d661b0>]}
[0m18:09:15.115971 [debug] [MainThread]: Using duckdb connection "master"
[0m18:09:15.116430 [debug] [MainThread]: On master: BEGIN
[0m18:09:15.116993 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:09:15.117993 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:09:15.118450 [debug] [MainThread]: On master: COMMIT
[0m18:09:15.118873 [debug] [MainThread]: Using duckdb connection "master"
[0m18:09:15.119305 [debug] [MainThread]: On master: COMMIT
[0m18:09:15.119903 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:09:15.120355 [debug] [MainThread]: On master: Close
[0m18:09:15.122371 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:09:15.123030 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m18:09:15.123588 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m18:09:15.124106 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m18:09:15.132259 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:09:15.133000 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m18:09:15.190031 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:09:15.190587 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201180915165328"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'This transaction is fraud due to extreme PCA factor V3 (-24.202142) indicating significant irregularity.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '3ba58c4c-3d7c-4a73-b73a-6abe4cd9f0bf'
    );
  
  
  
[0m18:09:15.191099 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:09:15.199181 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m18:09:15.206857 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:09:15.207387 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m18:09:15.208083 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:09:15.208565 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:09:15.209046 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201180915165328'
      
      
      order by ordinal_position

  
[0m18:09:15.211750 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:09:15.216758 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:09:15.217297 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:09:15.220133 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:09:15.230356 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:09:15.230881 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:09:15.233269 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:09:15.234777 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:09:15.235304 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m18:09:15.236073 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:09:15.252630 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:09:15.253449 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:09:15.253983 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201180915165328"
    )
  
[0m18:09:15.255424 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:09:15.266001 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:09:15.266515 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:09:15.266996 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:09:15.280192 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m18:09:15.282183 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m18:09:15.283949 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ace88663-9b26-40d3-9564-f0311dce38a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c261dd3bf0>]}
[0m18:09:15.284727 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m18:09:15.285460 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:09:15.287269 [debug] [MainThread]: Using duckdb connection "master"
[0m18:09:15.287779 [debug] [MainThread]: On master: BEGIN
[0m18:09:15.288246 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:09:15.289205 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:09:15.289641 [debug] [MainThread]: On master: COMMIT
[0m18:09:15.290070 [debug] [MainThread]: Using duckdb connection "master"
[0m18:09:15.290496 [debug] [MainThread]: On master: COMMIT
[0m18:09:15.291169 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:09:15.291769 [debug] [MainThread]: On master: Close
[0m18:09:15.292524 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:09:15.293069 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m18:09:15.293759 [info ] [MainThread]: 
[0m18:09:15.294338 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m18:09:15.295155 [debug] [MainThread]: Command end result
[0m18:09:15.318150 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:09:15.319967 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:09:15.328002 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m18:09:15.328781 [info ] [MainThread]: 
[0m18:09:15.329681 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:09:15.330506 [info ] [MainThread]: 
[0m18:09:15.331390 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:09:15.332525 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:09:15.334239 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3897946, "process_in_blocks": "0", "process_kernel_time": 0.288196, "process_mem_max_rss": "272096", "process_out_blocks": "3104", "process_user_time": 4.347791}
[0m18:09:15.335022 [debug] [MainThread]: Command `dbt run` succeeded at 18:09:15.334864 after 2.39 seconds
[0m18:09:15.335826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c2613297f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c261c11ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c2616a5220>]}
[0m18:09:15.336723 [debug] [MainThread]: Flushing usage events
[0m18:09:16.199331 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:09:32.640880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74472f3fd250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74472f3fdc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74472eb64bf0>]}


============================== 18:09:32.644291 | 7c7ed8d4-30c5-49a4-b089-507e69eb569e ==============================
[0m18:09:32.644291 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:09:32.645014 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'use_colors': 'True', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'profiles_dir': '.', 'quiet': 'False', 'indirect_selection': 'eager', 'introspect': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'partial_parse': 'True', 'static_parser': 'True', 'version_check': 'True', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "10af23d3-f8b8-4ef6-8e4c-5afdfd25cabe", "ai_explanation": "This transaction is fraud due to abnormally low PCA scores (-8.43, -9.95) indicating unusual patterns."} --profiles-dir .', 'debug': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'log_format': 'default', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'write_json': 'True'}
[0m18:09:32.891669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c7ed8d4-30c5-49a4-b089-507e69eb569e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74472ea2b080>]}
[0m18:09:32.962801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c7ed8d4-30c5-49a4-b089-507e69eb569e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74472f2a8440>]}
[0m18:09:32.964457 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:09:33.048694 [debug] [MainThread]: checksum: 33f41b159dd259be267e4d6a8bb3dd55b487b22b9e3de2b8f13ded38f2522ac3, vars: {'ai_explanation': 'This transaction is fraud due to abnormally low PCA scores '
                   '(-8.43, -9.95) indicating unusual patterns.',
 'txn_id': '10af23d3-f8b8-4ef6-8e4c-5afdfd25cabe'}, profile: , target: , version: 1.11.2
[0m18:09:33.142299 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:09:33.142873 [debug] [MainThread]: previous checksum: 33f41b159dd259be267e4d6a8bb3dd55b487b22b9e3de2b8f13ded38f2522ac3, current checksum: fb85100a10ccd7de12af3e5e7bfebf37016df5b72a55c8ad877fd8f1ff63fbc8
[0m18:09:33.143349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7c7ed8d4-30c5-49a4-b089-507e69eb569e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74472f42e8a0>]}
[0m18:09:34.377885 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m18:09:34.378570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7c7ed8d4-30c5-49a4-b089-507e69eb569e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744722c83020>]}
[0m18:09:34.471736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c7ed8d4-30c5-49a4-b089-507e69eb569e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74472016e390>]}
[0m18:09:34.542877 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:09:34.544619 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:09:34.556963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c7ed8d4-30c5-49a4-b089-507e69eb569e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74470a9085c0>]}
[0m18:09:34.557521 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m18:09:34.558010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c7ed8d4-30c5-49a4-b089-507e69eb569e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74470a9a5f70>]}
[0m18:09:34.559755 [info ] [MainThread]: 
[0m18:09:34.560266 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:09:34.560695 [info ] [MainThread]: 
[0m18:09:34.561317 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:09:34.562325 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m18:09:34.597354 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m18:09:34.597837 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m18:09:34.598319 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:09:34.688943 [debug] [ThreadPool]: SQL status: OK in 0.090 seconds
[0m18:09:34.690620 [debug] [ThreadPool]: On list_argus_vault: Close
[0m18:09:34.691560 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m18:09:34.692164 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m18:09:34.699474 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:09:34.699952 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m18:09:34.700378 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:09:34.701566 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:09:34.702861 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:09:34.703310 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m18:09:34.703931 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:09:34.704354 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:09:34.704750 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m18:09:34.705472 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:09:34.706398 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:09:34.706832 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:09:34.707260 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:09:34.707847 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:09:34.708301 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m18:09:34.715058 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m18:09:34.720946 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:09:34.721487 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m18:09:34.721893 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:09:34.723052 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:09:34.723490 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:09:34.723906 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m18:09:34.735051 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m18:09:34.736504 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m18:09:34.737797 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m18:09:34.738274 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m18:09:34.740064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c7ed8d4-30c5-49a4-b089-507e69eb569e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74470a810650>]}
[0m18:09:34.740683 [debug] [MainThread]: Using duckdb connection "master"
[0m18:09:34.741167 [debug] [MainThread]: On master: BEGIN
[0m18:09:34.741577 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:09:34.742520 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:09:34.742981 [debug] [MainThread]: On master: COMMIT
[0m18:09:34.743403 [debug] [MainThread]: Using duckdb connection "master"
[0m18:09:34.743805 [debug] [MainThread]: On master: COMMIT
[0m18:09:34.744429 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:09:34.744858 [debug] [MainThread]: On master: Close
[0m18:09:34.747006 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:09:34.747631 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m18:09:34.748230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m18:09:34.748715 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m18:09:34.756869 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:09:34.757606 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m18:09:34.815208 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:09:34.815766 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201180934790581"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'This transaction is fraud due to abnormally low PCA scores (-8.43, -9.95) indicating unusual patterns.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '10af23d3-f8b8-4ef6-8e4c-5afdfd25cabe'
    );
  
  
  
[0m18:09:34.816280 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:09:34.825066 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m18:09:34.832870 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:09:34.833401 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m18:09:34.834162 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:09:34.834643 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:09:34.835147 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201180934790581'
      
      
      order by ordinal_position

  
[0m18:09:34.837775 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:09:34.842786 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:09:34.843324 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:09:34.846740 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:09:34.857061 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:09:34.857583 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:09:34.860043 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:09:34.861559 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:09:34.862087 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m18:09:34.862837 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:09:34.879300 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:09:34.880118 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:09:34.880629 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201180934790581"
    )
  
[0m18:09:34.881927 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:09:34.892475 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:09:34.893027 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:09:34.893501 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:09:34.907533 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m18:09:34.909542 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m18:09:34.911288 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c7ed8d4-30c5-49a4-b089-507e69eb569e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7447317350d0>]}
[0m18:09:34.912064 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m18:09:34.912791 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:09:34.914274 [debug] [MainThread]: Using duckdb connection "master"
[0m18:09:34.914767 [debug] [MainThread]: On master: BEGIN
[0m18:09:34.915377 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:09:34.916661 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:09:34.917126 [debug] [MainThread]: On master: COMMIT
[0m18:09:34.917541 [debug] [MainThread]: Using duckdb connection "master"
[0m18:09:34.917990 [debug] [MainThread]: On master: COMMIT
[0m18:09:34.918600 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:09:34.919075 [debug] [MainThread]: On master: Close
[0m18:09:34.919581 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:09:34.920015 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m18:09:34.920453 [info ] [MainThread]: 
[0m18:09:34.920936 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m18:09:34.921721 [debug] [MainThread]: Command end result
[0m18:09:34.941988 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:09:34.943619 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:09:34.949270 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m18:09:34.949719 [info ] [MainThread]: 
[0m18:09:34.950272 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:09:34.950732 [info ] [MainThread]: 
[0m18:09:34.951241 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:09:34.951874 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:09:34.952948 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3753314, "process_in_blocks": "0", "process_kernel_time": 0.319316, "process_mem_max_rss": "275280", "process_out_blocks": "3112", "process_user_time": 4.291371}
[0m18:09:34.953539 [debug] [MainThread]: Command `dbt run` succeeded at 18:09:34.953432 after 2.38 seconds
[0m18:09:34.954045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74472eb001d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744722f40bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744722fa29c0>]}
[0m18:09:34.954542 [debug] [MainThread]: Flushing usage events
[0m18:09:35.840795 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:09:51.106302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749509254f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749509b1d8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749509b1e0f0>]}


============================== 18:09:51.109641 | 98c3c0f2-1a03-4cc9-b948-bfc4c6ed1ecb ==============================
[0m18:09:51.109641 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:09:51.110367 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'warn_error': 'None', 'target_path': 'None', 'log_cache_events': 'False', 'profiles_dir': '.', 'static_parser': 'True', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "112e355f-53b5-4bb7-ab4c-ec55c8bbf83c", "ai_explanation": "The transaction is fraudulent due to an extremely low PCA score (-20.299)."} --profiles-dir .', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'use_colors': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'printer_width': '80', 'introspect': 'True', 'quiet': 'False', 'partial_parse': 'True', 'version_check': 'True', 'log_format': 'default', 'fail_fast': 'False'}
[0m18:09:51.357561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '98c3c0f2-1a03-4cc9-b948-bfc4c6ed1ecb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749508b49d60>]}
[0m18:09:51.428177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '98c3c0f2-1a03-4cc9-b948-bfc4c6ed1ecb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7495089b4830>]}
[0m18:09:51.429943 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:09:51.514508 [debug] [MainThread]: checksum: d21bcb07e9f2b0888706f40dda80e895cb7504152dd87635dabcdb5a3c3b6e69, vars: {'ai_explanation': 'The transaction is fraudulent due to an extremely low PCA '
                   'score (-20.299).',
 'txn_id': '112e355f-53b5-4bb7-ab4c-ec55c8bbf83c'}, profile: , target: , version: 1.11.2
[0m18:09:51.607197 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:09:51.607805 [debug] [MainThread]: previous checksum: d21bcb07e9f2b0888706f40dda80e895cb7504152dd87635dabcdb5a3c3b6e69, current checksum: 33f41b159dd259be267e4d6a8bb3dd55b487b22b9e3de2b8f13ded38f2522ac3
[0m18:09:51.608331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '98c3c0f2-1a03-4cc9-b948-bfc4c6ed1ecb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749508afbb00>]}
[0m18:09:52.834952 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m18:09:52.835636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '98c3c0f2-1a03-4cc9-b948-bfc4c6ed1ecb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7494fc1ab2c0>]}
[0m18:09:52.926663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '98c3c0f2-1a03-4cc9-b948-bfc4c6ed1ecb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7494fc1f00e0>]}
[0m18:09:52.995474 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:09:52.997177 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:09:53.009260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '98c3c0f2-1a03-4cc9-b948-bfc4c6ed1ecb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7494fc02fcb0>]}
[0m18:09:53.009808 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m18:09:53.010350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98c3c0f2-1a03-4cc9-b948-bfc4c6ed1ecb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7494fc0f5a00>]}
[0m18:09:53.012086 [info ] [MainThread]: 
[0m18:09:53.012614 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:09:53.013108 [info ] [MainThread]: 
[0m18:09:53.013741 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:09:53.014791 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m18:09:53.050072 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m18:09:53.050571 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m18:09:53.051039 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:09:53.134710 [debug] [ThreadPool]: SQL status: OK in 0.084 seconds
[0m18:09:53.136421 [debug] [ThreadPool]: On list_argus_vault: Close
[0m18:09:53.137325 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m18:09:53.138016 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m18:09:53.145437 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:09:53.145957 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m18:09:53.146419 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:09:53.147652 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:09:53.149004 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:09:53.149473 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m18:09:53.150121 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:09:53.150574 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:09:53.151045 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m18:09:53.151734 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:09:53.152698 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:09:53.153188 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:09:53.153630 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:09:53.154377 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:09:53.154840 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m18:09:53.160616 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m18:09:53.166518 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:09:53.167099 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m18:09:53.167538 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:09:53.168454 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:09:53.168935 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:09:53.169398 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m18:09:53.180270 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m18:09:53.181789 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m18:09:53.183168 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m18:09:53.183636 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m18:09:53.185193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98c3c0f2-1a03-4cc9-b948-bfc4c6ed1ecb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7494fcb3de80>]}
[0m18:09:53.185766 [debug] [MainThread]: Using duckdb connection "master"
[0m18:09:53.186217 [debug] [MainThread]: On master: BEGIN
[0m18:09:53.186615 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:09:53.187575 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:09:53.188034 [debug] [MainThread]: On master: COMMIT
[0m18:09:53.188446 [debug] [MainThread]: Using duckdb connection "master"
[0m18:09:53.188845 [debug] [MainThread]: On master: COMMIT
[0m18:09:53.189469 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:09:53.189895 [debug] [MainThread]: On master: Close
[0m18:09:53.191942 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:09:53.192593 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m18:09:53.193181 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m18:09:53.193662 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m18:09:53.201571 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:09:53.202287 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m18:09:53.258552 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:09:53.259150 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201180953234248"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'The transaction is fraudulent due to an extremely low PCA score (-20.299).' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '112e355f-53b5-4bb7-ab4c-ec55c8bbf83c'
    );
  
  
  
[0m18:09:53.259629 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:09:53.268168 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m18:09:53.276120 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:09:53.276645 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m18:09:53.277693 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:09:53.278247 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:09:53.279022 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201180953234248'
      
      
      order by ordinal_position

  
[0m18:09:53.283031 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:09:53.289483 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:09:53.290023 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:09:53.292788 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:09:53.303302 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:09:53.303841 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:09:53.306684 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:09:53.308255 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:09:53.308749 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m18:09:53.309781 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:09:53.326218 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:09:53.327010 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:09:53.327506 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201180953234248"
    )
  
[0m18:09:53.328702 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:09:53.339231 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:09:53.339739 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:09:53.340223 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:09:53.354123 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m18:09:53.356244 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m18:09:53.357979 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98c3c0f2-1a03-4cc9-b948-bfc4c6ed1ecb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749508a21160>]}
[0m18:09:53.358722 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m18:09:53.359465 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:09:53.361084 [debug] [MainThread]: Using duckdb connection "master"
[0m18:09:53.361561 [debug] [MainThread]: On master: BEGIN
[0m18:09:53.362023 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:09:53.362968 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:09:53.363419 [debug] [MainThread]: On master: COMMIT
[0m18:09:53.363834 [debug] [MainThread]: Using duckdb connection "master"
[0m18:09:53.364265 [debug] [MainThread]: On master: COMMIT
[0m18:09:53.364960 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:09:53.365437 [debug] [MainThread]: On master: Close
[0m18:09:53.366090 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:09:53.366512 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m18:09:53.366960 [info ] [MainThread]: 
[0m18:09:53.367458 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m18:09:53.368350 [debug] [MainThread]: Command end result
[0m18:09:53.387376 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:09:53.389000 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:09:53.394660 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m18:09:53.395133 [info ] [MainThread]: 
[0m18:09:53.395703 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:09:53.396221 [info ] [MainThread]: 
[0m18:09:53.396739 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:09:53.397570 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:09:53.399113 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3553693, "process_in_blocks": "0", "process_kernel_time": 0.310447, "process_mem_max_rss": "277688", "process_out_blocks": "3120", "process_user_time": 4.26295}
[0m18:09:53.399700 [debug] [MainThread]: Command `dbt run` succeeded at 18:09:53.399593 after 2.36 seconds
[0m18:09:53.400202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749508b8ab70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7494fcc2fc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7494fce7fb60>]}
[0m18:09:53.400689 [debug] [MainThread]: Flushing usage events
[0m18:09:54.263287 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:10:09.958933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70179a8e9430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701799e77110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70179a8ea5a0>]}


============================== 18:10:09.962272 | a9f72bcc-0d7c-41fb-a721-cde5a9ac3a32 ==============================
[0m18:10:09.962272 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:10:09.962971 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'partial_parse': 'True', 'fail_fast': 'False', 'empty': 'False', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'indirect_selection': 'eager', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "e845a30e-f371-4bef-895a-18c95ebd4414", "ai_explanation": "The transaction is fraud based on the PCA scores indicating a high degree of anormality."} --profiles-dir .', 'log_cache_events': 'False', 'warn_error': 'None', 'log_format': 'default', 'static_parser': 'True', 'profiles_dir': '.', 'introspect': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'write_json': 'True', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m18:10:10.213235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9f72bcc-0d7c-41fb-a721-cde5a9ac3a32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701797fc4410>]}
[0m18:10:10.284608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a9f72bcc-0d7c-41fb-a721-cde5a9ac3a32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7017989fae70>]}
[0m18:10:10.286404 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:10:10.371073 [debug] [MainThread]: checksum: b086f1b50c4690ce8481e09256793939ae00cd66a374614f4bace9cf1bba0af0, vars: {'ai_explanation': 'The transaction is fraud based on the PCA scores '
                   'indicating a high degree of anormality.',
 'txn_id': 'e845a30e-f371-4bef-895a-18c95ebd4414'}, profile: , target: , version: 1.11.2
[0m18:10:10.465022 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:10:10.465637 [debug] [MainThread]: previous checksum: b086f1b50c4690ce8481e09256793939ae00cd66a374614f4bace9cf1bba0af0, current checksum: d21bcb07e9f2b0888706f40dda80e895cb7504152dd87635dabcdb5a3c3b6e69
[0m18:10:10.466129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a9f72bcc-0d7c-41fb-a721-cde5a9ac3a32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70178c29ecf0>]}
[0m18:10:11.685284 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m18:10:11.685971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a9f72bcc-0d7c-41fb-a721-cde5a9ac3a32', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70178c2523c0>]}
[0m18:10:11.777078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a9f72bcc-0d7c-41fb-a721-cde5a9ac3a32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70178c5780e0>]}
[0m18:10:11.850252 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:10:11.852019 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:10:11.864446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a9f72bcc-0d7c-41fb-a721-cde5a9ac3a32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701788119490>]}
[0m18:10:11.865025 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m18:10:11.865530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9f72bcc-0d7c-41fb-a721-cde5a9ac3a32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701788375700>]}
[0m18:10:11.867314 [info ] [MainThread]: 
[0m18:10:11.867821 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:10:11.868297 [info ] [MainThread]: 
[0m18:10:11.868952 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:10:11.869971 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m18:10:11.905073 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m18:10:11.905594 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m18:10:11.906093 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:10:11.992947 [debug] [ThreadPool]: SQL status: OK in 0.087 seconds
[0m18:10:11.994618 [debug] [ThreadPool]: On list_argus_vault: Close
[0m18:10:11.995515 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m18:10:11.996139 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m18:10:12.003416 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:10:12.003927 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m18:10:12.004388 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:10:12.006102 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m18:10:12.007460 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:10:12.007939 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m18:10:12.008572 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:10:12.009042 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:10:12.009492 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m18:10:12.010169 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:10:12.011128 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:10:12.011598 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:10:12.012060 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:10:12.012685 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:10:12.013174 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m18:10:12.018862 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m18:10:12.024674 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:10:12.025233 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m18:10:12.025637 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:10:12.026515 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:10:12.026968 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:10:12.027395 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m18:10:12.038167 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m18:10:12.039573 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m18:10:12.040822 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m18:10:12.041291 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m18:10:12.042787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9f72bcc-0d7c-41fb-a721-cde5a9ac3a32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701788163ce0>]}
[0m18:10:12.043428 [debug] [MainThread]: Using duckdb connection "master"
[0m18:10:12.043879 [debug] [MainThread]: On master: BEGIN
[0m18:10:12.044326 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:10:12.045236 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:10:12.045698 [debug] [MainThread]: On master: COMMIT
[0m18:10:12.046173 [debug] [MainThread]: Using duckdb connection "master"
[0m18:10:12.046606 [debug] [MainThread]: On master: COMMIT
[0m18:10:12.047252 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:10:12.047702 [debug] [MainThread]: On master: Close
[0m18:10:12.049758 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:10:12.050408 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m18:10:12.050982 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m18:10:12.051475 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m18:10:12.059609 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:10:12.060334 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m18:10:12.116798 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:10:12.117426 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201181012092450"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'The transaction is fraud based on the PCA scores indicating a high degree of anormality.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = 'e845a30e-f371-4bef-895a-18c95ebd4414'
    );
  
  
  
[0m18:10:12.117930 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:12.126353 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m18:10:12.134150 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:10:12.134670 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m18:10:12.135407 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:10:12.135886 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:10:12.136380 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201181012092450'
      
      
      order by ordinal_position

  
[0m18:10:12.139227 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:10:12.144375 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:10:12.144894 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:10:12.147410 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:10:12.157559 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:10:12.158095 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:10:12.160502 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:10:12.162039 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:10:12.162555 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m18:10:12.163385 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:10:12.179780 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:10:12.180613 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:10:12.181145 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201181012092450"
    )
  
[0m18:10:12.182467 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:10:12.193047 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:10:12.193636 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:10:12.194130 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:10:12.203692 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m18:10:12.206075 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m18:10:12.207962 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9f72bcc-0d7c-41fb-a721-cde5a9ac3a32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7017982fd9d0>]}
[0m18:10:12.208748 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m18:10:12.209504 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:10:12.211209 [debug] [MainThread]: Using duckdb connection "master"
[0m18:10:12.211801 [debug] [MainThread]: On master: BEGIN
[0m18:10:12.212411 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:10:12.213803 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:10:12.214445 [debug] [MainThread]: On master: COMMIT
[0m18:10:12.215056 [debug] [MainThread]: Using duckdb connection "master"
[0m18:10:12.215623 [debug] [MainThread]: On master: COMMIT
[0m18:10:12.216560 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:10:12.217206 [debug] [MainThread]: On master: Close
[0m18:10:12.217946 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:10:12.218531 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m18:10:12.219196 [info ] [MainThread]: 
[0m18:10:12.219836 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m18:10:12.221033 [debug] [MainThread]: Command end result
[0m18:10:12.241231 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:10:12.243348 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:10:12.249492 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m18:10:12.250020 [info ] [MainThread]: 
[0m18:10:12.250579 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:10:12.251100 [info ] [MainThread]: 
[0m18:10:12.251657 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:10:12.252445 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:10:12.253720 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.35732, "process_in_blocks": "0", "process_kernel_time": 0.298253, "process_mem_max_rss": "270860", "process_out_blocks": "3112", "process_user_time": 4.278593}
[0m18:10:12.254441 [debug] [MainThread]: Command `dbt run` succeeded at 18:10:12.254329 after 2.36 seconds
[0m18:10:12.255050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7017988fa360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701797f993a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701799d4ae70>]}
[0m18:10:12.255665 [debug] [MainThread]: Flushing usage events
[0m18:10:13.224975 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:10:29.642542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a60c00f1ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a60c0710a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a60c2591d60>]}


============================== 18:10:29.645985 | ed9fd6cf-c6d1-4a50-b20f-fc5d5941133f ==============================
[0m18:10:29.645985 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:10:29.646698 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'no_print': 'None', 'cache_selected_only': 'False', 'partial_parse': 'True', 'printer_width': '80', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "07d3fd1b-f336-46c8-b3b0-7839faffb37f", "ai_explanation": "Fraud detected: V1 and V7 scores indicate anomalous spending patterns, V17 score suggests excessive transactions."} --profiles-dir .', 'introspect': 'True', 'debug': 'False', 'use_colors': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '.', 'version_check': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'static_parser': 'True', 'empty': 'False', 'target_path': 'None', 'quiet': 'False', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'log_format': 'default'}
[0m18:10:29.893869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ed9fd6cf-c6d1-4a50-b20f-fc5d5941133f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a60bf5b8a70>]}
[0m18:10:29.965118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ed9fd6cf-c6d1-4a50-b20f-fc5d5941133f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a60b3b68380>]}
[0m18:10:29.966839 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:10:30.050825 [debug] [MainThread]: checksum: e99c4ad7db26a82f90f2313102de60744a77563933f62a413378d287a588c9cf, vars: {'ai_explanation': 'Fraud detected: V1 and V7 scores indicate anomalous '
                   'spending patterns, V17 score suggests excessive '
                   'transactions.',
 'txn_id': '07d3fd1b-f336-46c8-b3b0-7839faffb37f'}, profile: , target: , version: 1.11.2
[0m18:10:30.144562 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:10:30.145202 [debug] [MainThread]: previous checksum: e99c4ad7db26a82f90f2313102de60744a77563933f62a413378d287a588c9cf, current checksum: b086f1b50c4690ce8481e09256793939ae00cd66a374614f4bace9cf1bba0af0
[0m18:10:30.145689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ed9fd6cf-c6d1-4a50-b20f-fc5d5941133f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a60bfe569f0>]}
[0m18:10:31.373907 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m18:10:31.374591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ed9fd6cf-c6d1-4a50-b20f-fc5d5941133f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a60b3bc59a0>]}
[0m18:10:31.467384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ed9fd6cf-c6d1-4a50-b20f-fc5d5941133f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a60b1748cb0>]}
[0m18:10:31.536619 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:10:31.538334 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:10:31.550514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ed9fd6cf-c6d1-4a50-b20f-fc5d5941133f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a60b176e240>]}
[0m18:10:31.551106 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m18:10:31.551570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed9fd6cf-c6d1-4a50-b20f-fc5d5941133f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a604b50b4d0>]}
[0m18:10:31.553309 [info ] [MainThread]: 
[0m18:10:31.553798 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:10:31.554253 [info ] [MainThread]: 
[0m18:10:31.554837 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:10:31.555907 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m18:10:31.591269 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m18:10:31.591759 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m18:10:31.592214 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:10:31.681466 [debug] [ThreadPool]: SQL status: OK in 0.089 seconds
[0m18:10:31.683164 [debug] [ThreadPool]: On list_argus_vault: Close
[0m18:10:31.684075 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m18:10:31.684660 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m18:10:31.692323 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:10:31.692790 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m18:10:31.693238 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:10:31.694413 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:10:31.695746 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:10:31.696201 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m18:10:31.696791 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:10:31.697230 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:10:31.697631 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m18:10:31.698273 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:10:31.699198 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:10:31.699636 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:10:31.700066 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:10:31.700648 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:10:31.701106 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m18:10:31.706546 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m18:10:31.712290 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:10:31.712830 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m18:10:31.713264 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:10:31.714604 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:10:31.715102 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:10:31.715567 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m18:10:31.726582 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m18:10:31.728089 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m18:10:31.729388 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m18:10:31.729856 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m18:10:31.731564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed9fd6cf-c6d1-4a50-b20f-fc5d5941133f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a60b39b0770>]}
[0m18:10:31.732192 [debug] [MainThread]: Using duckdb connection "master"
[0m18:10:31.732612 [debug] [MainThread]: On master: BEGIN
[0m18:10:31.733035 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:10:31.734232 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:10:31.734678 [debug] [MainThread]: On master: COMMIT
[0m18:10:31.735121 [debug] [MainThread]: Using duckdb connection "master"
[0m18:10:31.735524 [debug] [MainThread]: On master: COMMIT
[0m18:10:31.736203 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:10:31.736638 [debug] [MainThread]: On master: Close
[0m18:10:31.738697 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:10:31.739427 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m18:10:31.740055 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m18:10:31.740552 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m18:10:31.748805 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:10:31.749540 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m18:10:31.806405 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:10:31.806987 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201181031781801"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Fraud detected: V1 and V7 scores indicate anomalous spending patterns, V17 score suggests excessive transactions.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '07d3fd1b-f336-46c8-b3b0-7839faffb37f'
    );
  
  
  
[0m18:10:31.807472 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:31.815347 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m18:10:31.823072 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:10:31.823578 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m18:10:31.824579 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:10:31.825093 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:10:31.825560 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201181031781801'
      
      
      order by ordinal_position

  
[0m18:10:31.828277 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:10:31.833372 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:10:31.833900 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:10:31.836479 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:10:31.846600 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:10:31.847128 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:10:31.849745 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:10:31.851278 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:10:31.851774 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m18:10:31.852553 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:10:31.868978 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:10:31.869766 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:10:31.870278 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201181031781801"
    )
  
[0m18:10:31.871435 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:10:31.881986 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:10:31.882499 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:10:31.882988 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:10:31.896563 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m18:10:31.898535 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m18:10:31.900286 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed9fd6cf-c6d1-4a50-b20f-fc5d5941133f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a604b449520>]}
[0m18:10:31.901081 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m18:10:31.901803 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:10:31.903198 [debug] [MainThread]: Using duckdb connection "master"
[0m18:10:31.903687 [debug] [MainThread]: On master: BEGIN
[0m18:10:31.904195 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:10:31.905198 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:10:31.905660 [debug] [MainThread]: On master: COMMIT
[0m18:10:31.906108 [debug] [MainThread]: Using duckdb connection "master"
[0m18:10:31.906509 [debug] [MainThread]: On master: COMMIT
[0m18:10:31.907146 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:10:31.907585 [debug] [MainThread]: On master: Close
[0m18:10:31.908107 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:10:31.908508 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m18:10:31.908946 [info ] [MainThread]: 
[0m18:10:31.909407 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m18:10:31.910186 [debug] [MainThread]: Command end result
[0m18:10:31.929106 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:10:31.930695 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:10:31.936372 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m18:10:31.936815 [info ] [MainThread]: 
[0m18:10:31.937356 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:10:31.937796 [info ] [MainThread]: 
[0m18:10:31.938284 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:10:31.938887 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:10:31.939933 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3599803, "process_in_blocks": "0", "process_kernel_time": 0.310372, "process_mem_max_rss": "277184", "process_out_blocks": "3112", "process_user_time": 4.288868}
[0m18:10:31.940516 [debug] [MainThread]: Command `dbt run` succeeded at 18:10:31.940413 after 2.36 seconds
[0m18:10:31.941001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a60c05f2480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a604b433f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a604b43bf50>]}
[0m18:10:31.941482 [debug] [MainThread]: Flushing usage events
[0m18:10:32.837376 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:10:48.144102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cf221e270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cf2063c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cf1a0b950>]}


============================== 18:10:48.147636 | a1a3b16a-24b9-4a29-8708-dd308c794d6a ==============================
[0m18:10:48.147636 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:10:48.148357 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'empty': 'False', 'no_print': 'None', 'fail_fast': 'False', 'introspect': 'True', 'profiles_dir': '.', 'target_path': 'None', 'static_parser': 'True', 'version_check': 'True', 'log_format': 'default', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'use_colors': 'True', 'warn_error': 'None', 'partial_parse': 'True', 'cache_selected_only': 'False', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'write_json': 'True', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "0ee5dfe6-a679-466d-b710-d757f339397c", "ai_explanation": "Fraudulent transaction based on PCA factor scores indicating anomalous patterns."} --profiles-dir .', 'use_experimental_parser': 'False'}
[0m18:10:48.395886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a1a3b16a-24b9-4a29-8708-dd308c794d6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cf10de870>]}
[0m18:10:48.466787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a1a3b16a-24b9-4a29-8708-dd308c794d6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cf3cad250>]}
[0m18:10:48.468548 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:10:48.552442 [debug] [MainThread]: checksum: 09fc3203d677b5cf6a29e4c4d9e1ec6369d2023c585e04e1f148865325b950df, vars: {'ai_explanation': 'Fraudulent transaction based on PCA factor scores '
                   'indicating anomalous patterns.',
 'txn_id': '0ee5dfe6-a679-466d-b710-d757f339397c'}, profile: , target: , version: 1.11.2
[0m18:10:48.645592 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:10:48.646268 [debug] [MainThread]: previous checksum: 09fc3203d677b5cf6a29e4c4d9e1ec6369d2023c585e04e1f148865325b950df, current checksum: e99c4ad7db26a82f90f2313102de60744a77563933f62a413378d287a588c9cf
[0m18:10:48.646764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a1a3b16a-24b9-4a29-8708-dd308c794d6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cf1942930>]}
[0m18:10:49.866794 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m18:10:49.867538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a1a3b16a-24b9-4a29-8708-dd308c794d6a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ce53020c0>]}
[0m18:10:49.960567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a1a3b16a-24b9-4a29-8708-dd308c794d6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ce51eb0e0>]}
[0m18:10:50.029166 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:10:50.030886 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:10:50.043097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a1a3b16a-24b9-4a29-8708-dd308c794d6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ce41ba9c0>]}
[0m18:10:50.043646 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m18:10:50.044186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1a3b16a-24b9-4a29-8708-dd308c794d6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ce534e720>]}
[0m18:10:50.045932 [info ] [MainThread]: 
[0m18:10:50.046457 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:10:50.046946 [info ] [MainThread]: 
[0m18:10:50.047602 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:10:50.048672 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m18:10:50.084099 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m18:10:50.084574 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m18:10:50.085039 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:10:50.170521 [debug] [ThreadPool]: SQL status: OK in 0.085 seconds
[0m18:10:50.172243 [debug] [ThreadPool]: On list_argus_vault: Close
[0m18:10:50.173139 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m18:10:50.173725 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m18:10:50.181185 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:10:50.181645 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m18:10:50.182106 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:10:50.183298 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:10:50.184625 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:10:50.185082 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m18:10:50.185678 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:10:50.186144 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:10:50.186547 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m18:10:50.187191 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:10:50.188140 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:10:50.188579 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:10:50.189005 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:10:50.189587 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:10:50.190055 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m18:10:50.195680 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m18:10:50.201555 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:10:50.202144 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m18:10:50.202553 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:10:50.203733 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:10:50.204222 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:10:50.204641 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m18:10:50.215720 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m18:10:50.217399 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m18:10:50.218718 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m18:10:50.219207 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m18:10:50.220779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1a3b16a-24b9-4a29-8708-dd308c794d6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ce41d8c80>]}
[0m18:10:50.221410 [debug] [MainThread]: Using duckdb connection "master"
[0m18:10:50.221842 [debug] [MainThread]: On master: BEGIN
[0m18:10:50.222282 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:10:50.223172 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:10:50.223618 [debug] [MainThread]: On master: COMMIT
[0m18:10:50.224059 [debug] [MainThread]: Using duckdb connection "master"
[0m18:10:50.224462 [debug] [MainThread]: On master: COMMIT
[0m18:10:50.225091 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:10:50.225530 [debug] [MainThread]: On master: Close
[0m18:10:50.227594 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:10:50.228261 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m18:10:50.228813 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m18:10:50.229310 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m18:10:50.237660 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:10:50.238404 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m18:10:50.295677 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:10:50.296311 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201181050271176"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Fraudulent transaction based on PCA factor scores indicating anomalous patterns.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '0ee5dfe6-a679-466d-b710-d757f339397c'
    );
  
  
  
[0m18:10:50.296809 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:50.305341 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m18:10:50.313088 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:10:50.313600 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m18:10:50.314564 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:10:50.315080 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:10:50.315551 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201181050271176'
      
      
      order by ordinal_position

  
[0m18:10:50.318308 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:10:50.323370 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:10:50.323881 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:10:50.326404 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:10:50.336458 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:10:50.336999 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:10:50.340357 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:10:50.341877 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:10:50.342405 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m18:10:50.343185 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:10:50.359555 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:10:50.360326 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:10:50.360821 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201181050271176"
    )
  
[0m18:10:50.362305 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:10:50.372721 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:10:50.373256 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:10:50.373722 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:10:50.387176 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m18:10:50.389181 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m18:10:50.390901 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1a3b16a-24b9-4a29-8708-dd308c794d6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ca44d71d0>]}
[0m18:10:50.391683 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m18:10:50.392418 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:10:50.393836 [debug] [MainThread]: Using duckdb connection "master"
[0m18:10:50.394412 [debug] [MainThread]: On master: BEGIN
[0m18:10:50.394856 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:10:50.395752 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:10:50.396222 [debug] [MainThread]: On master: COMMIT
[0m18:10:50.396637 [debug] [MainThread]: Using duckdb connection "master"
[0m18:10:50.397062 [debug] [MainThread]: On master: COMMIT
[0m18:10:50.397678 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:10:50.398166 [debug] [MainThread]: On master: Close
[0m18:10:50.398656 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:10:50.399083 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m18:10:50.399503 [info ] [MainThread]: 
[0m18:10:50.399965 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m18:10:50.400728 [debug] [MainThread]: Command end result
[0m18:10:50.419703 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:10:50.421434 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:10:50.427101 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m18:10:50.427538 [info ] [MainThread]: 
[0m18:10:50.428067 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:10:50.428502 [info ] [MainThread]: 
[0m18:10:50.428972 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:10:50.429584 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:10:50.430631 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3545353, "process_in_blocks": "0", "process_kernel_time": 0.30211, "process_mem_max_rss": "281436", "process_out_blocks": "3120", "process_user_time": 4.294924}
[0m18:10:50.431257 [debug] [MainThread]: Command `dbt run` succeeded at 18:10:50.431149 after 2.36 seconds
[0m18:10:50.431722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cf13f2b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cf11ee810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cf12101a0>]}
[0m18:10:50.432217 [debug] [MainThread]: Flushing usage events
[0m18:10:51.439372 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:11:06.892703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d26dd3d820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d26d4273b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d26dbfa3f0>]}


============================== 18:11:06.896003 | c8469fde-043b-4e59-a7fe-5bd7d56d2770 ==============================
[0m18:11:06.896003 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:11:06.896677 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'debug': 'False', 'profiles_dir': '.', 'version_check': 'True', 'log_cache_events': 'False', 'introspect': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'warn_error': 'None', 'printer_width': '80', 'quiet': 'False', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "cf0b9b26-83c3-4c54-a95e-0d32808bc77b", "ai_explanation": "Fraud detected: anomalous PCA scores indicate artificially inflated transaction value and unusual patterns."} --profiles-dir .', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'use_colors': 'True', 'log_format': 'default', 'static_parser': 'True'}
[0m18:11:07.142385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8469fde-043b-4e59-a7fe-5bd7d56d2770', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d26dbae480>]}
[0m18:11:07.212442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c8469fde-043b-4e59-a7fe-5bd7d56d2770', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d26cbed4c0>]}
[0m18:11:07.214148 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:11:07.297998 [debug] [MainThread]: checksum: 33bc24a3c21815868b6971a43237577a5f1252f1cbad15b391914e1d5706f8d8, vars: {'ai_explanation': 'Fraud detected: anomalous PCA scores indicate artificially '
                   'inflated transaction value and unusual patterns.',
 'txn_id': 'cf0b9b26-83c3-4c54-a95e-0d32808bc77b'}, profile: , target: , version: 1.11.2
[0m18:11:07.391004 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:11:07.391604 [debug] [MainThread]: previous checksum: 33bc24a3c21815868b6971a43237577a5f1252f1cbad15b391914e1d5706f8d8, current checksum: 09fc3203d677b5cf6a29e4c4d9e1ec6369d2023c585e04e1f148865325b950df
[0m18:11:07.392101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c8469fde-043b-4e59-a7fe-5bd7d56d2770', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d26d4528a0>]}
[0m18:11:08.611265 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m18:11:08.611972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c8469fde-043b-4e59-a7fe-5bd7d56d2770', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d26cbef230>]}
[0m18:11:08.707025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c8469fde-043b-4e59-a7fe-5bd7d56d2770', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d26000b4a0>]}
[0m18:11:08.780510 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:11:08.782401 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:11:08.794964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c8469fde-043b-4e59-a7fe-5bd7d56d2770', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d260032ea0>]}
[0m18:11:08.795561 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m18:11:08.796095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8469fde-043b-4e59-a7fe-5bd7d56d2770', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d26019ffb0>]}
[0m18:11:08.797890 [info ] [MainThread]: 
[0m18:11:08.798438 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:11:08.798904 [info ] [MainThread]: 
[0m18:11:08.799597 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:11:08.800681 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m18:11:08.836458 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m18:11:08.836986 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m18:11:08.837440 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:11:08.925019 [debug] [ThreadPool]: SQL status: OK in 0.087 seconds
[0m18:11:08.926654 [debug] [ThreadPool]: On list_argus_vault: Close
[0m18:11:08.927550 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m18:11:08.928193 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m18:11:08.935622 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:11:08.936127 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m18:11:08.936550 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:11:08.937738 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:11:08.939100 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:11:08.939534 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m18:11:08.940145 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:11:08.940569 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:11:08.941000 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m18:11:08.941647 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:11:08.942592 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:11:08.943064 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:11:08.943473 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:11:08.944084 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:11:08.944524 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m18:11:08.950102 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m18:11:08.955748 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:11:08.956316 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m18:11:08.956731 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:11:08.957637 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:11:08.958102 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:11:08.958526 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m18:11:08.969623 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m18:11:08.971136 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m18:11:08.972426 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m18:11:08.972871 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m18:11:08.974555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8469fde-043b-4e59-a7fe-5bd7d56d2770', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d2600cdb80>]}
[0m18:11:08.975244 [debug] [MainThread]: Using duckdb connection "master"
[0m18:11:08.975712 [debug] [MainThread]: On master: BEGIN
[0m18:11:08.976194 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:11:08.977183 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:11:08.977656 [debug] [MainThread]: On master: COMMIT
[0m18:11:08.978155 [debug] [MainThread]: Using duckdb connection "master"
[0m18:11:08.978600 [debug] [MainThread]: On master: COMMIT
[0m18:11:08.979256 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:11:08.979723 [debug] [MainThread]: On master: Close
[0m18:11:08.981840 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:11:08.982563 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m18:11:08.983177 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m18:11:08.983653 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m18:11:08.991893 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:11:08.992660 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m18:11:09.050587 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:11:09.051249 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201181109024978"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Fraud detected: anomalous PCA scores indicate artificially inflated transaction value and unusual patterns.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = 'cf0b9b26-83c3-4c54-a95e-0d32808bc77b'
    );
  
  
  
[0m18:11:09.051741 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:11:09.060687 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m18:11:09.069424 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:11:09.070021 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m18:11:09.071153 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:11:09.071640 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:11:09.072151 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201181109024978'
      
      
      order by ordinal_position

  
[0m18:11:09.075524 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:11:09.081180 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:11:09.081809 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:11:09.085528 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:11:09.096809 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:11:09.097454 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:11:09.101476 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:11:09.103175 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:11:09.103681 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m18:11:09.104783 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:11:09.121808 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:11:09.122819 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:11:09.123476 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201181109024978"
    )
  
[0m18:11:09.125284 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:11:09.136555 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:11:09.137208 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:11:09.137711 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:11:09.154749 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m18:11:09.157083 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m18:11:09.158949 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8469fde-043b-4e59-a7fe-5bd7d56d2770', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d26db3fe30>]}
[0m18:11:09.159758 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.17s]
[0m18:11:09.160526 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:11:09.162253 [debug] [MainThread]: Using duckdb connection "master"
[0m18:11:09.162731 [debug] [MainThread]: On master: BEGIN
[0m18:11:09.163195 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:11:09.164391 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:11:09.164845 [debug] [MainThread]: On master: COMMIT
[0m18:11:09.165324 [debug] [MainThread]: Using duckdb connection "master"
[0m18:11:09.165788 [debug] [MainThread]: On master: COMMIT
[0m18:11:09.166533 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:11:09.167032 [debug] [MainThread]: On master: Close
[0m18:11:09.167573 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:11:09.168029 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m18:11:09.168485 [info ] [MainThread]: 
[0m18:11:09.169034 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m18:11:09.169888 [debug] [MainThread]: Command end result
[0m18:11:09.191081 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:11:09.193025 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:11:09.199288 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m18:11:09.199745 [info ] [MainThread]: 
[0m18:11:09.200337 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:11:09.200815 [info ] [MainThread]: 
[0m18:11:09.201355 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:11:09.202039 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:11:09.203125 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3723867, "process_in_blocks": "0", "process_kernel_time": 0.280806, "process_mem_max_rss": "281072", "process_out_blocks": "3104", "process_user_time": 4.312309}
[0m18:11:09.203712 [debug] [MainThread]: Command `dbt run` succeeded at 18:11:09.203609 after 2.37 seconds
[0m18:11:09.204233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d26fb99d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d26d9332c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d271493da0>]}
[0m18:11:09.204725 [debug] [MainThread]: Flushing usage events
[0m18:11:10.099342 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:11:25.783561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7beaf3eba0c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7beaf54e4170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7beaf3eb8410>]}


============================== 18:11:25.786889 | 4a5c8918-c8a4-4041-a0ec-3f89bdfe9695 ==============================
[0m18:11:25.786889 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:11:25.787603 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "d3a850fd-e3b3-472e-b11f-7a20aea3799f", "ai_explanation": "Based on PCA factors, this transaction exhibits a significant departure from normal patterns, indicating fraud."} --profiles-dir .', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'quiet': 'False', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'static_parser': 'True', 'profiles_dir': '.', 'empty': 'False', 'use_colors': 'True', 'target_path': 'None', 'warn_error': 'None', 'write_json': 'True'}
[0m18:11:26.032847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a5c8918-c8a4-4041-a0ec-3f89bdfe9695', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7beaf445eed0>]}
[0m18:11:26.104790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4a5c8918-c8a4-4041-a0ec-3f89bdfe9695', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7beaf34dc080>]}
[0m18:11:26.106609 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:11:26.190330 [debug] [MainThread]: checksum: c58731e0b1146ad10d04d5b80af899a75a4c1a877434fd357c2c75ce6cbcc908, vars: {'ai_explanation': 'Based on PCA factors, this transaction exhibits a '
                   'significant departure from normal patterns, indicating '
                   'fraud.',
 'txn_id': 'd3a850fd-e3b3-472e-b11f-7a20aea3799f'}, profile: , target: , version: 1.11.2
[0m18:11:26.283158 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:11:26.283776 [debug] [MainThread]: previous checksum: c58731e0b1146ad10d04d5b80af899a75a4c1a877434fd357c2c75ce6cbcc908, current checksum: 33bc24a3c21815868b6971a43237577a5f1252f1cbad15b391914e1d5706f8d8
[0m18:11:26.284279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4a5c8918-c8a4-4041-a0ec-3f89bdfe9695', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7beaf3ef69c0>]}
[0m18:11:27.510832 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m18:11:27.511511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4a5c8918-c8a4-4041-a0ec-3f89bdfe9695', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7beae76fbfe0>]}
[0m18:11:27.603304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a5c8918-c8a4-4041-a0ec-3f89bdfe9695', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7beaf7a4f4a0>]}
[0m18:11:27.673805 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:11:27.675514 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:11:27.687717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a5c8918-c8a4-4041-a0ec-3f89bdfe9695', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7beacb327b30>]}
[0m18:11:27.688295 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m18:11:27.688754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a5c8918-c8a4-4041-a0ec-3f89bdfe9695', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7beacb30ad80>]}
[0m18:11:27.690511 [info ] [MainThread]: 
[0m18:11:27.691018 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:11:27.691452 [info ] [MainThread]: 
[0m18:11:27.692074 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:11:27.693120 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m18:11:27.728456 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m18:11:27.728994 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m18:11:27.729458 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:11:27.814958 [debug] [ThreadPool]: SQL status: OK in 0.085 seconds
[0m18:11:27.816645 [debug] [ThreadPool]: On list_argus_vault: Close
[0m18:11:27.817522 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m18:11:27.818176 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m18:11:27.825418 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:11:27.825879 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m18:11:27.826321 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:11:27.827702 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:11:27.829036 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:11:27.829469 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m18:11:27.830106 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:11:27.830530 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:11:27.830953 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m18:11:27.831643 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:11:27.832569 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:11:27.833023 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:11:27.833432 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:11:27.834039 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:11:27.834476 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m18:11:27.840188 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m18:11:27.845873 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:11:27.846450 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m18:11:27.846858 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:11:27.847726 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:11:27.848184 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:11:27.848600 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m18:11:27.859660 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m18:11:27.861100 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m18:11:27.862447 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m18:11:27.862890 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m18:11:27.864421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a5c8918-c8a4-4041-a0ec-3f89bdfe9695', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7beaf33a15b0>]}
[0m18:11:27.865054 [debug] [MainThread]: Using duckdb connection "master"
[0m18:11:27.865510 [debug] [MainThread]: On master: BEGIN
[0m18:11:27.865906 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:11:27.866789 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:11:27.867258 [debug] [MainThread]: On master: COMMIT
[0m18:11:27.867675 [debug] [MainThread]: Using duckdb connection "master"
[0m18:11:27.868099 [debug] [MainThread]: On master: COMMIT
[0m18:11:27.868687 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:11:27.869155 [debug] [MainThread]: On master: Close
[0m18:11:27.871232 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:11:27.871851 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m18:11:27.872440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m18:11:27.872955 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m18:11:27.881035 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:11:27.881752 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m18:11:27.938323 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:11:27.938883 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201181127913825"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Based on PCA factors, this transaction exhibits a significant departure from normal patterns, indicating fraud.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = 'd3a850fd-e3b3-472e-b11f-7a20aea3799f'
    );
  
  
  
[0m18:11:27.939399 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:11:27.947462 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m18:11:27.954930 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:11:27.955467 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m18:11:27.956161 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:11:27.956640 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:11:27.957130 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201181127913825'
      
      
      order by ordinal_position

  
[0m18:11:27.960287 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:11:27.965279 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:11:27.965788 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:11:27.968598 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:11:27.978722 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:11:27.979266 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:11:27.981953 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:11:27.983448 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:11:27.983967 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m18:11:27.984739 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:11:28.001111 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:11:28.001867 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:11:28.002398 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201181127913825"
    )
  
[0m18:11:28.003553 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:11:28.014177 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:11:28.014693 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:11:28.015181 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:11:28.028893 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m18:11:28.030935 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m18:11:28.032679 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a5c8918-c8a4-4041-a0ec-3f89bdfe9695', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7beaf619cec0>]}
[0m18:11:28.033454 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m18:11:28.034185 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:11:28.035591 [debug] [MainThread]: Using duckdb connection "master"
[0m18:11:28.036097 [debug] [MainThread]: On master: BEGIN
[0m18:11:28.036537 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:11:28.037476 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:11:28.037979 [debug] [MainThread]: On master: COMMIT
[0m18:11:28.038439 [debug] [MainThread]: Using duckdb connection "master"
[0m18:11:28.038874 [debug] [MainThread]: On master: COMMIT
[0m18:11:28.039576 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:11:28.040039 [debug] [MainThread]: On master: Close
[0m18:11:28.040529 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:11:28.040943 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m18:11:28.041356 [info ] [MainThread]: 
[0m18:11:28.041796 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m18:11:28.042569 [debug] [MainThread]: Command end result
[0m18:11:28.061576 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:11:28.063564 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:11:28.070236 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m18:11:28.070818 [info ] [MainThread]: 
[0m18:11:28.071534 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:11:28.072005 [info ] [MainThread]: 
[0m18:11:28.072469 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:11:28.073107 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:11:28.074160 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3525996, "process_in_blocks": "0", "process_kernel_time": 0.324606, "process_mem_max_rss": "277504", "process_out_blocks": "3120", "process_user_time": 4.239674}
[0m18:11:28.074746 [debug] [MainThread]: Command `dbt run` succeeded at 18:11:28.074643 after 2.35 seconds
[0m18:11:28.075252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7beaf7d3fd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7beaf34de120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7beaf4706e40>]}
[0m18:11:28.075732 [debug] [MainThread]: Flushing usage events
[0m18:11:29.011703 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:11:44.837926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a4838c0770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a483b1be00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a4840f22d0>]}


============================== 18:11:44.841256 | 5ac26502-7819-40d8-9db0-db68d0a47312 ==============================
[0m18:11:44.841256 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:11:44.841906 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'log_cache_events': 'False', 'profiles_dir': '.', 'use_experimental_parser': 'False', 'target_path': 'None', 'write_json': 'True', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "93437a93-5822-4410-aeba-012b7aec7704", "ai_explanation": "The txn is fraud due to a significant negative PCA score (-12.8357595817777)."} --profiles-dir .', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'empty': 'False', 'fail_fast': 'False', 'debug': 'False', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'no_print': 'None', 'partial_parse': 'True', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'use_colors': 'True', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'static_parser': 'True', 'printer_width': '80'}
[0m18:11:45.098373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ac26502-7819-40d8-9db0-db68d0a47312', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a482f715e0>]}
[0m18:11:45.168980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5ac26502-7819-40d8-9db0-db68d0a47312', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a485ba90a0>]}
[0m18:11:45.170701 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:11:45.256237 [debug] [MainThread]: checksum: 9e0ae329dc41436fe0e3bb05f19cfb037f92ab65cfed4d66302067d601a2dab9, vars: {'ai_explanation': 'The txn is fraud due to a significant negative PCA score '
                   '(-12.8357595817777).',
 'txn_id': '93437a93-5822-4410-aeba-012b7aec7704'}, profile: , target: , version: 1.11.2
[0m18:11:45.349937 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:11:45.350522 [debug] [MainThread]: previous checksum: 9e0ae329dc41436fe0e3bb05f19cfb037f92ab65cfed4d66302067d601a2dab9, current checksum: c58731e0b1146ad10d04d5b80af899a75a4c1a877434fd357c2c75ce6cbcc908
[0m18:11:45.350993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5ac26502-7819-40d8-9db0-db68d0a47312', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a483852c60>]}
[0m18:11:46.593384 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m18:11:46.594057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5ac26502-7819-40d8-9db0-db68d0a47312', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a4751a92e0>]}
[0m18:11:46.685704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5ac26502-7819-40d8-9db0-db68d0a47312', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a41efe71a0>]}
[0m18:11:46.754366 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:11:46.756079 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:11:46.768411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5ac26502-7819-40d8-9db0-db68d0a47312', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a41efc7770>]}
[0m18:11:46.768992 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m18:11:46.769475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ac26502-7819-40d8-9db0-db68d0a47312', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a475139310>]}
[0m18:11:46.771203 [info ] [MainThread]: 
[0m18:11:46.771704 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:11:46.772171 [info ] [MainThread]: 
[0m18:11:46.772768 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:11:46.773802 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m18:11:46.808983 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m18:11:46.809467 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m18:11:46.809896 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:11:46.898593 [debug] [ThreadPool]: SQL status: OK in 0.089 seconds
[0m18:11:46.900273 [debug] [ThreadPool]: On list_argus_vault: Close
[0m18:11:46.901144 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m18:11:46.901731 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m18:11:46.909112 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:11:46.909597 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m18:11:46.910060 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:11:46.911462 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:11:46.912784 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:11:46.913256 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m18:11:46.914129 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:11:46.914576 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:11:46.915027 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m18:11:46.915672 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:11:46.916613 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:11:46.917088 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:11:46.917515 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:11:46.918141 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:11:46.918590 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m18:11:46.923951 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m18:11:46.929594 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:11:46.930161 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m18:11:46.930584 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:11:46.931484 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:11:46.931951 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:11:46.932389 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m18:11:46.943159 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m18:11:46.944580 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m18:11:46.945862 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m18:11:46.946341 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m18:11:46.947842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ac26502-7819-40d8-9db0-db68d0a47312', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a41efc4860>]}
[0m18:11:46.948457 [debug] [MainThread]: Using duckdb connection "master"
[0m18:11:46.948882 [debug] [MainThread]: On master: BEGIN
[0m18:11:46.949302 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:11:46.950152 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:11:46.950589 [debug] [MainThread]: On master: COMMIT
[0m18:11:46.951020 [debug] [MainThread]: Using duckdb connection "master"
[0m18:11:46.951413 [debug] [MainThread]: On master: COMMIT
[0m18:11:46.952025 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:11:46.952447 [debug] [MainThread]: On master: Close
[0m18:11:46.954415 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:11:46.955071 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m18:11:46.955650 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m18:11:46.956184 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m18:11:46.964238 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:11:46.965012 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m18:11:47.021482 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:11:47.022066 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201181146996999"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'The txn is fraud due to a significant negative PCA score (-12.8357595817777).' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '93437a93-5822-4410-aeba-012b7aec7704'
    );
  
  
  
[0m18:11:47.022576 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:11:47.030833 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m18:11:47.038358 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:11:47.038876 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m18:11:47.039882 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:11:47.040409 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:11:47.040906 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201181146996999'
      
      
      order by ordinal_position

  
[0m18:11:47.043870 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:11:47.048930 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:11:47.049467 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:11:47.052052 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:11:47.062251 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:11:47.062787 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:11:47.065619 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:11:47.067185 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:11:47.067696 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m18:11:47.068746 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:11:47.085379 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:11:47.086207 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:11:47.086722 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201181146996999"
    )
  
[0m18:11:47.088433 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:11:47.099003 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:11:47.099537 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:11:47.100044 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:11:47.114754 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m18:11:47.117511 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m18:11:47.119263 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ac26502-7819-40d8-9db0-db68d0a47312', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a485ce0d40>]}
[0m18:11:47.120047 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m18:11:47.120769 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:11:47.122164 [debug] [MainThread]: Using duckdb connection "master"
[0m18:11:47.122720 [debug] [MainThread]: On master: BEGIN
[0m18:11:47.123257 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:11:47.124428 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:11:47.124890 [debug] [MainThread]: On master: COMMIT
[0m18:11:47.125367 [debug] [MainThread]: Using duckdb connection "master"
[0m18:11:47.125792 [debug] [MainThread]: On master: COMMIT
[0m18:11:47.126435 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:11:47.126894 [debug] [MainThread]: On master: Close
[0m18:11:47.127477 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:11:47.127901 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m18:11:47.128409 [info ] [MainThread]: 
[0m18:11:47.128893 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m18:11:47.129754 [debug] [MainThread]: Command end result
[0m18:11:47.151156 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:11:47.153209 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:11:47.159221 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m18:11:47.159725 [info ] [MainThread]: 
[0m18:11:47.160296 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:11:47.160737 [info ] [MainThread]: 
[0m18:11:47.161228 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:11:47.161854 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:11:47.162895 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3874857, "process_in_blocks": "0", "process_kernel_time": 0.303114, "process_mem_max_rss": "282996", "process_out_blocks": "3112", "process_user_time": 4.314924}
[0m18:11:47.163502 [debug] [MainThread]: Command `dbt run` succeeded at 18:11:47.163400 after 2.39 seconds
[0m18:11:47.164020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a48411d940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a48411f380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a41ee4c770>]}
[0m18:11:47.164506 [debug] [MainThread]: Flushing usage events
[0m18:11:48.119095 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:12:03.557412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74cd2162c680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74cd1f777ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74cd1f777aa0>]}


============================== 18:12:03.560933 | 49f04bd7-2535-4ac7-b144-21191c75f310 ==============================
[0m18:12:03.560933 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:12:03.561628 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'profiles_dir': '.', 'printer_width': '80', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'indirect_selection': 'eager', 'version_check': 'True', 'cache_selected_only': 'False', 'quiet': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'target_path': 'None', 'introspect': 'True', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "d886a3c8-af63-4415-bf33-4c866f22184e", "ai_explanation": "The transaction is flagged as fraud based on PCA factor scores indicating significant anomalies."} --profiles-dir .', 'no_print': 'None', 'debug': 'False', 'warn_error': 'None', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'empty': 'False', 'use_colors': 'True'}
[0m18:12:03.811636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49f04bd7-2535-4ac7-b144-21191c75f310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74cd1e7d3620>]}
[0m18:12:03.883789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49f04bd7-2535-4ac7-b144-21191c75f310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74cd12d53cb0>]}
[0m18:12:03.885598 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:12:03.970729 [debug] [MainThread]: checksum: 9774bd95ecb1b372d025d6d1130e826f3bcab361d0b69c7525dbe530f6c4cab4, vars: {'ai_explanation': 'The transaction is flagged as fraud based on PCA factor '
                   'scores indicating significant anomalies.',
 'txn_id': 'd886a3c8-af63-4415-bf33-4c866f22184e'}, profile: , target: , version: 1.11.2
[0m18:12:04.065809 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:12:04.066418 [debug] [MainThread]: previous checksum: 9774bd95ecb1b372d025d6d1130e826f3bcab361d0b69c7525dbe530f6c4cab4, current checksum: 9e0ae329dc41436fe0e3bb05f19cfb037f92ab65cfed4d66302067d601a2dab9
[0m18:12:04.066859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '49f04bd7-2535-4ac7-b144-21191c75f310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74cd1f052960>]}
[0m18:12:05.294180 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m18:12:05.294839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '49f04bd7-2535-4ac7-b144-21191c75f310', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ccc2f03800>]}
[0m18:12:05.386696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49f04bd7-2535-4ac7-b144-21191c75f310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74cd1e84e390>]}
[0m18:12:05.456262 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:12:05.458087 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:12:05.470367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49f04bd7-2535-4ac7-b144-21191c75f310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74cd109f31a0>]}
[0m18:12:05.470954 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m18:12:05.471437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49f04bd7-2535-4ac7-b144-21191c75f310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74cd217a9ac0>]}
[0m18:12:05.473170 [info ] [MainThread]: 
[0m18:12:05.473667 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:12:05.474126 [info ] [MainThread]: 
[0m18:12:05.474717 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:12:05.475787 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m18:12:05.510646 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m18:12:05.511166 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m18:12:05.511590 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:12:05.598773 [debug] [ThreadPool]: SQL status: OK in 0.087 seconds
[0m18:12:05.600458 [debug] [ThreadPool]: On list_argus_vault: Close
[0m18:12:05.601313 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m18:12:05.601876 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m18:12:05.609149 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:12:05.609608 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m18:12:05.610040 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:12:05.611440 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:12:05.612741 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:12:05.613191 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m18:12:05.613796 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:12:05.614237 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:12:05.614635 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m18:12:05.615323 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:12:05.616247 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:12:05.616684 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:12:05.617110 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:12:05.617748 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:12:05.618204 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m18:12:05.623803 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m18:12:05.629372 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:12:05.629904 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m18:12:05.630332 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:12:05.631210 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:12:05.631642 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:12:05.632115 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m18:12:05.643193 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m18:12:05.644614 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m18:12:05.645884 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m18:12:05.646347 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m18:12:05.647832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49f04bd7-2535-4ac7-b144-21191c75f310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74cd12de50a0>]}
[0m18:12:05.648458 [debug] [MainThread]: Using duckdb connection "master"
[0m18:12:05.648889 [debug] [MainThread]: On master: BEGIN
[0m18:12:05.649321 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:12:05.650436 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:12:05.650880 [debug] [MainThread]: On master: COMMIT
[0m18:12:05.651328 [debug] [MainThread]: Using duckdb connection "master"
[0m18:12:05.651731 [debug] [MainThread]: On master: COMMIT
[0m18:12:05.652328 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:12:05.652756 [debug] [MainThread]: On master: Close
[0m18:12:05.654807 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:12:05.655453 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m18:12:05.656027 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m18:12:05.656502 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m18:12:05.664514 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:12:05.665233 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m18:12:05.721555 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:12:05.722183 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201181205697151"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'The transaction is flagged as fraud based on PCA factor scores indicating significant anomalies.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = 'd886a3c8-af63-4415-bf33-4c866f22184e'
    );
  
  
  
[0m18:12:05.722665 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:05.731593 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m18:12:05.739240 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:12:05.739743 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m18:12:05.740439 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:12:05.740926 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:12:05.741395 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201181205697151'
      
      
      order by ordinal_position

  
[0m18:12:05.743843 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:12:05.748729 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:12:05.749253 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:12:05.752590 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:12:05.762744 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:12:05.763281 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:12:05.765616 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:12:05.767116 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:12:05.767611 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m18:12:05.768375 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:12:05.784581 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:12:05.785361 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:12:05.785847 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201181205697151"
    )
  
[0m18:12:05.787021 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:12:05.797284 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:12:05.797799 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:12:05.798307 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:12:05.810186 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m18:12:05.812137 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m18:12:05.813838 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49f04bd7-2535-4ac7-b144-21191c75f310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74cd1f73fbf0>]}
[0m18:12:05.814605 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m18:12:05.815340 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:12:05.817025 [debug] [MainThread]: Using duckdb connection "master"
[0m18:12:05.817525 [debug] [MainThread]: On master: BEGIN
[0m18:12:05.817975 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:12:05.819202 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:12:05.819637 [debug] [MainThread]: On master: COMMIT
[0m18:12:05.820072 [debug] [MainThread]: Using duckdb connection "master"
[0m18:12:05.820468 [debug] [MainThread]: On master: COMMIT
[0m18:12:05.821104 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:12:05.821541 [debug] [MainThread]: On master: Close
[0m18:12:05.822052 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:12:05.822451 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m18:12:05.822871 [info ] [MainThread]: 
[0m18:12:05.823348 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m18:12:05.824116 [debug] [MainThread]: Command end result
[0m18:12:05.843212 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:12:05.844853 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:12:05.850548 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m18:12:05.851002 [info ] [MainThread]: 
[0m18:12:05.851523 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:12:05.851985 [info ] [MainThread]: 
[0m18:12:05.852453 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:12:05.853085 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:12:05.854164 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.36012, "process_in_blocks": "0", "process_kernel_time": 0.296442, "process_mem_max_rss": "283536", "process_out_blocks": "3112", "process_user_time": 4.338203}
[0m18:12:05.854733 [debug] [MainThread]: Command `dbt run` succeeded at 18:12:05.854633 after 2.36 seconds
[0m18:12:05.855226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74cd1f5315b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74cd1e772720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74cd2309fd70>]}
[0m18:12:05.855704 [debug] [MainThread]: Flushing usage events
[0m18:12:06.856251 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:12:22.148990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e4e7d796a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e4e7ab63f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e4e7d7a330>]}


============================== 18:12:22.152371 | 0de3a9a2-6e14-4030-a924-5f6e82d1a8f4 ==============================
[0m18:12:22.152371 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:12:22.153175 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'version_check': 'True', 'quiet': 'False', 'fail_fast': 'False', 'printer_width': '80', 'debug': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'profiles_dir': '.', 'target_path': 'None', 'use_colors': 'True', 'log_cache_events': 'False', 'static_parser': 'True', 'use_experimental_parser': 'False', 'log_format': 'default', 'write_json': 'True', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "68c5c775-5592-40c0-898a-5802ebf7df77", "ai_explanation": "Based on PCA factors, this transaction exhibits an unusual and suspicious pattern of characteristics."} --profiles-dir .', 'empty': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'log_path': '/workspaces/modern-stack-banking/Transform/logs'}
[0m18:12:22.399932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0de3a9a2-6e14-4030-a924-5f6e82d1a8f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e4e746db20>]}
[0m18:12:22.471142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0de3a9a2-6e14-4030-a924-5f6e82d1a8f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e4e7dbc620>]}
[0m18:12:22.472847 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:12:22.558179 [debug] [MainThread]: checksum: 22f48b2d49b6aca5a3b803921fd6dfbffd42bc04cdf453a0b295bf227f2d278a, vars: {'ai_explanation': 'Based on PCA factors, this transaction exhibits an unusual '
                   'and suspicious pattern of characteristics.',
 'txn_id': '68c5c775-5592-40c0-898a-5802ebf7df77'}, profile: , target: , version: 1.11.2
[0m18:12:22.650495 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:12:22.651102 [debug] [MainThread]: previous checksum: 22f48b2d49b6aca5a3b803921fd6dfbffd42bc04cdf453a0b295bf227f2d278a, current checksum: 9774bd95ecb1b372d025d6d1130e826f3bcab361d0b69c7525dbe530f6c4cab4
[0m18:12:22.651567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0de3a9a2-6e14-4030-a924-5f6e82d1a8f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e4e7d52c00>]}
[0m18:12:23.886023 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m18:12:23.886700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0de3a9a2-6e14-4030-a924-5f6e82d1a8f4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e4db596db0>]}
[0m18:12:23.978810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0de3a9a2-6e14-4030-a924-5f6e82d1a8f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e4db591af0>]}
[0m18:12:24.047356 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:12:24.049034 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:12:24.061102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0de3a9a2-6e14-4030-a924-5f6e82d1a8f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e47b33b7a0>]}
[0m18:12:24.061646 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m18:12:24.062144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0de3a9a2-6e14-4030-a924-5f6e82d1a8f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e4db6aa7e0>]}
[0m18:12:24.063859 [info ] [MainThread]: 
[0m18:12:24.064360 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:12:24.064784 [info ] [MainThread]: 
[0m18:12:24.065389 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:12:24.066436 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m18:12:24.101365 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m18:12:24.101852 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m18:12:24.102321 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:12:24.190971 [debug] [ThreadPool]: SQL status: OK in 0.089 seconds
[0m18:12:24.192632 [debug] [ThreadPool]: On list_argus_vault: Close
[0m18:12:24.193536 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m18:12:24.194140 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m18:12:24.201487 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:12:24.201986 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m18:12:24.202429 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:12:24.203617 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:12:24.204975 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:12:24.205424 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m18:12:24.206067 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:12:24.206510 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:12:24.206955 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m18:12:24.207671 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:12:24.208620 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:12:24.209096 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:12:24.209527 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:12:24.210168 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:12:24.210617 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m18:12:24.216166 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m18:12:24.221874 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:12:24.222428 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m18:12:24.222836 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:12:24.223720 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:12:24.224190 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:12:24.224604 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m18:12:24.235653 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m18:12:24.237089 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m18:12:24.238371 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m18:12:24.238826 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m18:12:24.240531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0de3a9a2-6e14-4030-a924-5f6e82d1a8f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e4d81e8a70>]}
[0m18:12:24.241159 [debug] [MainThread]: Using duckdb connection "master"
[0m18:12:24.241584 [debug] [MainThread]: On master: BEGIN
[0m18:12:24.241998 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:12:24.243269 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:12:24.243710 [debug] [MainThread]: On master: COMMIT
[0m18:12:24.244170 [debug] [MainThread]: Using duckdb connection "master"
[0m18:12:24.244572 [debug] [MainThread]: On master: COMMIT
[0m18:12:24.245206 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:12:24.245635 [debug] [MainThread]: On master: Close
[0m18:12:24.247712 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:12:24.248404 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m18:12:24.248999 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m18:12:24.249481 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m18:12:24.258135 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:12:24.258854 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m18:12:24.317949 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:12:24.318569 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201181224292702"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Based on PCA factors, this transaction exhibits an unusual and suspicious pattern of characteristics.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '68c5c775-5592-40c0-898a-5802ebf7df77'
    );
  
  
  
[0m18:12:24.319079 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:24.327142 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m18:12:24.334663 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:12:24.335183 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m18:12:24.335846 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:12:24.336349 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:12:24.336810 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201181224292702'
      
      
      order by ordinal_position

  
[0m18:12:24.339704 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:12:24.344712 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:12:24.345241 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:12:24.348018 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:12:24.358180 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:12:24.358692 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:12:24.361328 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:12:24.362850 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:12:24.363375 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m18:12:24.364130 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:12:24.380495 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:12:24.381309 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:12:24.381802 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201181224292702"
    )
  
[0m18:12:24.383298 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:12:24.393857 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:12:24.394406 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:12:24.394873 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:12:24.408664 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m18:12:24.410650 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m18:12:24.412407 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0de3a9a2-6e14-4030-a924-5f6e82d1a8f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e4e843bd10>]}
[0m18:12:24.413188 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m18:12:24.413929 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:12:24.415382 [debug] [MainThread]: Using duckdb connection "master"
[0m18:12:24.415907 [debug] [MainThread]: On master: BEGIN
[0m18:12:24.416413 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:12:24.417542 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:12:24.418010 [debug] [MainThread]: On master: COMMIT
[0m18:12:24.418429 [debug] [MainThread]: Using duckdb connection "master"
[0m18:12:24.418828 [debug] [MainThread]: On master: COMMIT
[0m18:12:24.419484 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:12:24.419939 [debug] [MainThread]: On master: Close
[0m18:12:24.420444 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:12:24.420839 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m18:12:24.421304 [info ] [MainThread]: 
[0m18:12:24.421749 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m18:12:24.422550 [debug] [MainThread]: Command end result
[0m18:12:24.441556 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:12:24.443157 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:12:24.448756 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m18:12:24.449212 [info ] [MainThread]: 
[0m18:12:24.449719 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:12:24.450179 [info ] [MainThread]: 
[0m18:12:24.450638 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:12:24.451264 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:12:24.452299 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3663268, "process_in_blocks": "0", "process_kernel_time": 0.303027, "process_mem_max_rss": "285288", "process_out_blocks": "3120", "process_user_time": 4.298838}
[0m18:12:24.452873 [debug] [MainThread]: Command `dbt run` succeeded at 18:12:24.452772 after 2.37 seconds
[0m18:12:24.453364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e4ebddfda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e4db5892e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e4db952f30>]}
[0m18:12:24.453842 [debug] [MainThread]: Flushing usage events
[0m18:12:25.478841 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:12:41.545737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735181856390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735181857230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735181856420>]}


============================== 18:12:41.549039 | 0d123c98-6f1e-4bb8-94da-d3056a73680b ==============================
[0m18:12:41.549039 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:12:41.549762 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'profiles_dir': '.', 'partial_parse': 'True', 'log_cache_events': 'False', 'write_json': 'True', 'log_format': 'default', 'static_parser': 'True', 'empty': 'False', 'use_colors': 'True', 'cache_selected_only': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'version_check': 'True', 'debug': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'quiet': 'False', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "79cb2d19-4794-442c-9d8d-e81acbc550f3", "ai_explanation": "Based on PCA factors, this transaction is likely fraudulent due to extreme V7 and V17 scores indicating manipulation."} --profiles-dir .', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'introspect': 'True', 'no_print': 'None'}
[0m18:12:41.794699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d123c98-6f1e-4bb8-94da-d3056a73680b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73518114ef90>]}
[0m18:12:41.865463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d123c98-6f1e-4bb8-94da-d3056a73680b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735183b91850>]}
[0m18:12:41.867204 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:12:41.952184 [debug] [MainThread]: checksum: 9c3ec1a5d04b51da0cd8d9cc1165457538e72991dcf0f607c6731d428f0ff304, vars: {'ai_explanation': 'Based on PCA factors, this transaction is likely '
                   'fraudulent due to extreme V7 and V17 scores indicating '
                   'manipulation.',
 'txn_id': '79cb2d19-4794-442c-9d8d-e81acbc550f3'}, profile: , target: , version: 1.11.2
[0m18:12:42.044717 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:12:42.045343 [debug] [MainThread]: previous checksum: 9c3ec1a5d04b51da0cd8d9cc1165457538e72991dcf0f607c6731d428f0ff304, current checksum: 22f48b2d49b6aca5a3b803921fd6dfbffd42bc04cdf453a0b295bf227f2d278a
[0m18:12:42.045829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0d123c98-6f1e-4bb8-94da-d3056a73680b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735181020a70>]}
[0m18:12:43.277337 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m18:12:43.278028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0d123c98-6f1e-4bb8-94da-d3056a73680b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73517520fce0>]}
[0m18:12:43.369964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d123c98-6f1e-4bb8-94da-d3056a73680b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7351741556d0>]}
[0m18:12:43.439116 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:12:43.440857 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:12:43.453360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d123c98-6f1e-4bb8-94da-d3056a73680b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735134f2b800>]}
[0m18:12:43.453953 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m18:12:43.454434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d123c98-6f1e-4bb8-94da-d3056a73680b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7351741967e0>]}
[0m18:12:43.456191 [info ] [MainThread]: 
[0m18:12:43.456691 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:12:43.457149 [info ] [MainThread]: 
[0m18:12:43.457747 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:12:43.458735 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m18:12:43.493720 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m18:12:43.494293 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m18:12:43.494718 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:12:43.579678 [debug] [ThreadPool]: SQL status: OK in 0.085 seconds
[0m18:12:43.581367 [debug] [ThreadPool]: On list_argus_vault: Close
[0m18:12:43.582215 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m18:12:43.582790 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m18:12:43.590119 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:12:43.590584 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m18:12:43.591023 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:12:43.592375 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:12:43.593676 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:12:43.594127 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m18:12:43.594716 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:12:43.595157 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:12:43.595553 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m18:12:43.596250 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:12:43.597189 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:12:43.597622 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:12:43.598047 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:12:43.598619 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:12:43.599071 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m18:12:43.604668 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m18:12:43.610329 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:12:43.610871 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m18:12:43.611306 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:12:43.612451 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:12:43.612892 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:12:43.613343 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m18:12:43.624290 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m18:12:43.625770 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m18:12:43.627058 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m18:12:43.627502 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m18:12:43.629121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d123c98-6f1e-4bb8-94da-d3056a73680b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735134f2b800>]}
[0m18:12:43.629727 [debug] [MainThread]: Using duckdb connection "master"
[0m18:12:43.630191 [debug] [MainThread]: On master: BEGIN
[0m18:12:43.630590 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:12:43.631529 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:12:43.631985 [debug] [MainThread]: On master: COMMIT
[0m18:12:43.632407 [debug] [MainThread]: Using duckdb connection "master"
[0m18:12:43.632815 [debug] [MainThread]: On master: COMMIT
[0m18:12:43.633439 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:12:43.633870 [debug] [MainThread]: On master: Close
[0m18:12:43.635946 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:12:43.636611 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m18:12:43.637191 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m18:12:43.637673 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m18:12:43.645725 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:12:43.646484 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m18:12:43.704425 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:12:43.705026 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201181243679783"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Based on PCA factors, this transaction is likely fraudulent due to extreme V7 and V17 scores indicating manipulation.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '79cb2d19-4794-442c-9d8d-e81acbc550f3'
    );
  
  
  
[0m18:12:43.705513 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:43.714041 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m18:12:43.721672 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:12:43.722200 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m18:12:43.722874 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:12:43.723372 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:12:43.723832 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201181243679783'
      
      
      order by ordinal_position

  
[0m18:12:43.726455 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:12:43.731508 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:12:43.732036 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:12:43.735040 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:12:43.745263 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:12:43.745799 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:12:43.748106 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:12:43.749613 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:12:43.750135 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m18:12:43.750936 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:12:43.767180 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:12:43.768006 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:12:43.768512 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201181243679783"
    )
  
[0m18:12:43.769638 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:12:43.780276 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:12:43.780781 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:12:43.781262 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:12:43.797425 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m18:12:43.799403 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m18:12:43.801139 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d123c98-6f1e-4bb8-94da-d3056a73680b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7351246fd6d0>]}
[0m18:12:43.801877 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m18:12:43.802601 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:12:43.803982 [debug] [MainThread]: Using duckdb connection "master"
[0m18:12:43.804507 [debug] [MainThread]: On master: BEGIN
[0m18:12:43.804953 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:12:43.805889 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:12:43.806351 [debug] [MainThread]: On master: COMMIT
[0m18:12:43.806766 [debug] [MainThread]: Using duckdb connection "master"
[0m18:12:43.807188 [debug] [MainThread]: On master: COMMIT
[0m18:12:43.807823 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:12:43.808295 [debug] [MainThread]: On master: Close
[0m18:12:43.808784 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:12:43.809218 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m18:12:43.809633 [info ] [MainThread]: 
[0m18:12:43.810100 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m18:12:43.810855 [debug] [MainThread]: Command end result
[0m18:12:43.829566 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:12:43.831195 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:12:43.836809 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m18:12:43.837268 [info ] [MainThread]: 
[0m18:12:43.837782 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:12:43.838245 [info ] [MainThread]: 
[0m18:12:43.838699 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:12:43.839329 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:12:43.840370 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3565574, "process_in_blocks": "0", "process_kernel_time": 0.281848, "process_mem_max_rss": "273180", "process_out_blocks": "3112", "process_user_time": 4.288054}
[0m18:12:43.840983 [debug] [MainThread]: Command `dbt run` succeeded at 18:12:43.840837 after 2.36 seconds
[0m18:12:43.841459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73518565b8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735181128170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735185877da0>]}
[0m18:12:43.841951 [debug] [MainThread]: Flushing usage events
[0m18:12:44.866682 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:13:00.497671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c190ae63320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c190ae62870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c190b577a40>]}


============================== 18:13:00.501050 | 612e211c-1620-4fd8-97f8-4aca86b2b759 ==============================
[0m18:13:00.501050 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:13:00.501719 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'quiet': 'False', 'target_path': 'None', 'write_json': 'True', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'empty': 'False', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "74991071-67f1-4ca2-bbed-9b5f6e661011", "ai_explanation": "Fraud detected due to extreme anomalies in PCA factors, indicating manipulation of transaction data."} --profiles-dir .', 'profiles_dir': '.', 'static_parser': 'True', 'use_colors': 'True', 'debug': 'False', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True'}
[0m18:13:00.747958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '612e211c-1620-4fd8-97f8-4aca86b2b759', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c18feb9e5d0>]}
[0m18:13:00.819186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '612e211c-1620-4fd8-97f8-4aca86b2b759', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c190ada5f70>]}
[0m18:13:00.820856 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:13:00.914587 [debug] [MainThread]: checksum: d236ef4bf0880be70b2612a7ff3beeb1f9ada5073e6eb20053f5d6bc0fdc0e8b, vars: {'ai_explanation': 'Fraud detected due to extreme anomalies in PCA factors, '
                   'indicating manipulation of transaction data.',
 'txn_id': '74991071-67f1-4ca2-bbed-9b5f6e661011'}, profile: , target: , version: 1.11.2
[0m18:13:01.010363 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:13:01.010965 [debug] [MainThread]: previous checksum: d236ef4bf0880be70b2612a7ff3beeb1f9ada5073e6eb20053f5d6bc0fdc0e8b, current checksum: 9c3ec1a5d04b51da0cd8d9cc1165457538e72991dcf0f607c6731d428f0ff304
[0m18:13:01.011438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '612e211c-1620-4fd8-97f8-4aca86b2b759', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c190ae627e0>]}
[0m18:13:02.254301 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m18:13:02.254969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '612e211c-1620-4fd8-97f8-4aca86b2b759', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c18fc7a89e0>]}
[0m18:13:02.347460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '612e211c-1620-4fd8-97f8-4aca86b2b759', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c18b6525970>]}
[0m18:13:02.416381 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:13:02.418079 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:13:02.430188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '612e211c-1620-4fd8-97f8-4aca86b2b759', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c18b6525580>]}
[0m18:13:02.430731 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m18:13:02.431225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '612e211c-1620-4fd8-97f8-4aca86b2b759', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c18fc792300>]}
[0m18:13:02.432971 [info ] [MainThread]: 
[0m18:13:02.433471 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:13:02.433901 [info ] [MainThread]: 
[0m18:13:02.434533 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:13:02.435579 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m18:13:02.471159 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m18:13:02.471682 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m18:13:02.472164 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:13:02.558619 [debug] [ThreadPool]: SQL status: OK in 0.086 seconds
[0m18:13:02.560377 [debug] [ThreadPool]: On list_argus_vault: Close
[0m18:13:02.561248 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m18:13:02.561849 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m18:13:02.569228 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:13:02.569691 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m18:13:02.570131 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:13:02.571328 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:13:02.572657 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:13:02.573107 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m18:13:02.573730 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:13:02.574181 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:13:02.574581 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m18:13:02.575222 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:13:02.576137 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:13:02.576576 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:13:02.576998 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:13:02.577581 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:13:02.578033 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m18:13:02.583629 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m18:13:02.589511 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:13:02.590061 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m18:13:02.590461 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:13:02.591359 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:13:02.591797 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:13:02.592244 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m18:13:02.602735 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m18:13:02.604147 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m18:13:02.605415 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m18:13:02.605854 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m18:13:02.607373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '612e211c-1620-4fd8-97f8-4aca86b2b759', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c18b65dd130>]}
[0m18:13:02.607989 [debug] [MainThread]: Using duckdb connection "master"
[0m18:13:02.608437 [debug] [MainThread]: On master: BEGIN
[0m18:13:02.608826 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:13:02.609687 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:13:02.610139 [debug] [MainThread]: On master: COMMIT
[0m18:13:02.610543 [debug] [MainThread]: Using duckdb connection "master"
[0m18:13:02.610957 [debug] [MainThread]: On master: COMMIT
[0m18:13:02.611545 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:13:02.611990 [debug] [MainThread]: On master: Close
[0m18:13:02.613997 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:13:02.614637 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m18:13:02.615290 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m18:13:02.615905 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m18:13:02.624050 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:13:02.624763 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m18:13:02.681576 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:13:02.682156 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201181302657034"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Fraud detected due to extreme anomalies in PCA factors, indicating manipulation of transaction data.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '74991071-67f1-4ca2-bbed-9b5f6e661011'
    );
  
  
  
[0m18:13:02.682644 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:02.691344 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m18:13:02.699160 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:13:02.699683 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m18:13:02.700409 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:13:02.700885 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:13:02.701382 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201181302657034'
      
      
      order by ordinal_position

  
[0m18:13:02.704667 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:13:02.709790 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:13:02.710320 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:13:02.712885 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:13:02.723250 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:13:02.723767 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:13:02.726480 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:13:02.728018 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:13:02.728525 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m18:13:02.729576 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:13:02.746018 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:13:02.746786 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:13:02.747301 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201181302657034"
    )
  
[0m18:13:02.748513 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:13:02.758969 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:13:02.759481 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:13:02.759965 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:13:02.773955 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m18:13:02.775899 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m18:13:02.777633 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '612e211c-1620-4fd8-97f8-4aca86b2b759', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c190b53fc20>]}
[0m18:13:02.778392 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m18:13:02.779117 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:13:02.780448 [debug] [MainThread]: Using duckdb connection "master"
[0m18:13:02.780905 [debug] [MainThread]: On master: BEGIN
[0m18:13:02.781362 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:13:02.782271 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:13:02.782706 [debug] [MainThread]: On master: COMMIT
[0m18:13:02.783136 [debug] [MainThread]: Using duckdb connection "master"
[0m18:13:02.783526 [debug] [MainThread]: On master: COMMIT
[0m18:13:02.784152 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:13:02.784578 [debug] [MainThread]: On master: Close
[0m18:13:02.785072 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:13:02.785463 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m18:13:02.785864 [info ] [MainThread]: 
[0m18:13:02.786329 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m18:13:02.787082 [debug] [MainThread]: Command end result
[0m18:13:02.805628 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:13:02.807249 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:13:02.812814 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m18:13:02.813280 [info ] [MainThread]: 
[0m18:13:02.813782 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:13:02.814263 [info ] [MainThread]: 
[0m18:13:02.814723 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:13:02.815348 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:13:02.816357 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3817713, "process_in_blocks": "0", "process_kernel_time": 0.305972, "process_mem_max_rss": "276548", "process_out_blocks": "3120", "process_user_time": 4.330159}
[0m18:13:02.816946 [debug] [MainThread]: Command `dbt run` succeeded at 18:13:02.816822 after 2.38 seconds
[0m18:13:02.817421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c190a89a7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c190a809880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c18fc7f4650>]}
[0m18:13:02.817889 [debug] [MainThread]: Flushing usage events
[0m18:13:03.928166 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:13:19.767975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c94356725a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c943794e330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9438f29f40>]}


============================== 18:13:19.771391 | 958ee78b-59a8-42f4-b6b0-866c1cf65fcf ==============================
[0m18:13:19.771391 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:13:19.772090 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'no_print': 'None', 'debug': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "c3040d31-9267-4583-894c-1840cc0795d5", "ai_explanation": "Based on PCA factors, this transaction exhibits significant deviation from normal patterns, indicating potential fraud."} --profiles-dir .', 'printer_width': '80', 'write_json': 'True', 'quiet': 'False', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'static_parser': 'True', 'warn_error': 'None', 'empty': 'False', 'profiles_dir': '.', 'fail_fast': 'False'}
[0m18:13:20.024796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '958ee78b-59a8-42f4-b6b0-866c1cf65fcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c94352bca70>]}
[0m18:13:20.097331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '958ee78b-59a8-42f4-b6b0-866c1cf65fcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c943569bb30>]}
[0m18:13:20.099196 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:13:20.186240 [debug] [MainThread]: checksum: c3182574ab999c9a1cfdac58f362bf5da618941b8149c09ab99594e0ce450499, vars: {'ai_explanation': 'Based on PCA factors, this transaction exhibits '
                   'significant deviation from normal patterns, indicating '
                   'potential fraud.',
 'txn_id': 'c3040d31-9267-4583-894c-1840cc0795d5'}, profile: , target: , version: 1.11.2
[0m18:13:20.280333 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:13:20.280986 [debug] [MainThread]: previous checksum: c3182574ab999c9a1cfdac58f362bf5da618941b8149c09ab99594e0ce450499, current checksum: d236ef4bf0880be70b2612a7ff3beeb1f9ada5073e6eb20053f5d6bc0fdc0e8b
[0m18:13:20.281450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '958ee78b-59a8-42f4-b6b0-866c1cf65fcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9428c9d8e0>]}
[0m18:13:21.509764 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m18:13:21.510468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '958ee78b-59a8-42f4-b6b0-866c1cf65fcf', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9428f6c9e0>]}
[0m18:13:21.602743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '958ee78b-59a8-42f4-b6b0-866c1cf65fcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c94281114c0>]}
[0m18:13:21.675468 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:13:21.677455 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:13:21.690477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '958ee78b-59a8-42f4-b6b0-866c1cf65fcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c93e8b44230>]}
[0m18:13:21.691108 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m18:13:21.691585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '958ee78b-59a8-42f4-b6b0-866c1cf65fcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c94280a6870>]}
[0m18:13:21.693397 [info ] [MainThread]: 
[0m18:13:21.693903 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:13:21.694376 [info ] [MainThread]: 
[0m18:13:21.695022 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:13:21.696074 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m18:13:21.733886 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m18:13:21.734489 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m18:13:21.734937 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:13:21.826157 [debug] [ThreadPool]: SQL status: OK in 0.091 seconds
[0m18:13:21.827816 [debug] [ThreadPool]: On list_argus_vault: Close
[0m18:13:21.828704 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m18:13:21.829318 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m18:13:21.836662 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:13:21.837151 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m18:13:21.837570 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:13:21.838982 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:13:21.840277 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:13:21.840707 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m18:13:21.841363 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:13:21.841786 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:13:21.842217 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m18:13:21.842935 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:13:21.843840 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:13:21.844300 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:13:21.844708 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:13:21.845315 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:13:21.845747 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m18:13:21.851289 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m18:13:21.857127 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:13:21.857664 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m18:13:21.858099 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:13:21.859232 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:13:21.859667 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:13:21.860112 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m18:13:21.871041 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m18:13:21.872478 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m18:13:21.873749 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m18:13:21.874207 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m18:13:21.875857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '958ee78b-59a8-42f4-b6b0-866c1cf65fcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9435ab38c0>]}
[0m18:13:21.876488 [debug] [MainThread]: Using duckdb connection "master"
[0m18:13:21.876935 [debug] [MainThread]: On master: BEGIN
[0m18:13:21.877343 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:13:21.878271 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:13:21.878724 [debug] [MainThread]: On master: COMMIT
[0m18:13:21.879179 [debug] [MainThread]: Using duckdb connection "master"
[0m18:13:21.879585 [debug] [MainThread]: On master: COMMIT
[0m18:13:21.880202 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:13:21.880644 [debug] [MainThread]: On master: Close
[0m18:13:21.882688 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:13:21.883337 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m18:13:21.883892 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m18:13:21.884397 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m18:13:21.892490 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:13:21.893220 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m18:13:21.949615 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:13:21.950201 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201181321925352"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Based on PCA factors, this transaction exhibits significant deviation from normal patterns, indicating potential fraud.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = 'c3040d31-9267-4583-894c-1840cc0795d5'
    );
  
  
  
[0m18:13:21.950691 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:21.959259 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m18:13:21.967207 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:13:21.967734 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m18:13:21.968489 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:13:21.968988 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:13:21.969466 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201181321925352'
      
      
      order by ordinal_position

  
[0m18:13:21.972188 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:13:21.977166 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:13:21.977684 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:13:21.980496 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:13:21.990736 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:13:21.991297 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:13:21.993830 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:13:21.995384 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:13:21.995890 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m18:13:21.996709 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:13:22.013061 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:13:22.013824 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:13:22.014341 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201181321925352"
    )
  
[0m18:13:22.015795 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:13:22.026353 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:13:22.026868 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:13:22.027360 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:13:22.043676 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m18:13:22.045651 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m18:13:22.047381 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '958ee78b-59a8-42f4-b6b0-866c1cf65fcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c943769d280>]}
[0m18:13:22.048155 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m18:13:22.048880 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:13:22.050253 [debug] [MainThread]: Using duckdb connection "master"
[0m18:13:22.050741 [debug] [MainThread]: On master: BEGIN
[0m18:13:22.051199 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:13:22.052213 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:13:22.052661 [debug] [MainThread]: On master: COMMIT
[0m18:13:22.053114 [debug] [MainThread]: Using duckdb connection "master"
[0m18:13:22.053516 [debug] [MainThread]: On master: COMMIT
[0m18:13:22.054118 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:13:22.054554 [debug] [MainThread]: On master: Close
[0m18:13:22.055064 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:13:22.055466 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m18:13:22.055885 [info ] [MainThread]: 
[0m18:13:22.056359 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m18:13:22.057139 [debug] [MainThread]: Command end result
[0m18:13:22.076346 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:13:22.077982 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:13:22.083591 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m18:13:22.084048 [info ] [MainThread]: 
[0m18:13:22.084561 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:13:22.085021 [info ] [MainThread]: 
[0m18:13:22.085485 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:13:22.086121 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:13:22.087165 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3818104, "process_in_blocks": "0", "process_kernel_time": 0.281918, "process_mem_max_rss": "279164", "process_out_blocks": "3112", "process_user_time": 4.346496}
[0m18:13:22.087742 [debug] [MainThread]: Command `dbt run` succeeded at 18:13:22.087640 after 2.38 seconds
[0m18:13:22.088238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9428195d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9428b67230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9435adfa10>]}
[0m18:13:22.088708 [debug] [MainThread]: Flushing usage events
[0m18:13:22.984754 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:13:38.069535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c8d091e6c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c8d077a1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c8d0efa3c0>]}


============================== 18:13:38.072966 | 9a238409-5c6c-4f5c-be18-735f0d3daa02 ==============================
[0m18:13:38.072966 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:13:38.073648 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'fail_fast': 'False', 'indirect_selection': 'eager', 'version_check': 'True', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '.', 'log_format': 'default', 'empty': 'False', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'introspect': 'True', 'use_colors': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'printer_width': '80', 'quiet': 'False', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "1eb3bc31-9a80-4424-8984-ab96ce0a5b99", "ai_explanation": "This transaction is fraud due to extreme PCA values indicating unusual behavior."} --profiles-dir .', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:13:38.324210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a238409-5c6c-4f5c-be18-735f0d3daa02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c8cff1f8f0>]}
[0m18:13:38.395459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a238409-5c6c-4f5c-be18-735f0d3daa02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c8d07bc590>]}
[0m18:13:38.397241 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:13:38.483126 [debug] [MainThread]: checksum: 8ae5f3ad9369a954f73e04e020e43157c046a1f745b5381ea30583bf6bd95abf, vars: {'ai_explanation': 'This transaction is fraud due to extreme PCA values '
                   'indicating unusual behavior.',
 'txn_id': '1eb3bc31-9a80-4424-8984-ab96ce0a5b99'}, profile: , target: , version: 1.11.2
[0m18:13:38.575416 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:13:38.576016 [debug] [MainThread]: previous checksum: 8ae5f3ad9369a954f73e04e020e43157c046a1f745b5381ea30583bf6bd95abf, current checksum: c3182574ab999c9a1cfdac58f362bf5da618941b8149c09ab99594e0ce450499
[0m18:13:38.576490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9a238409-5c6c-4f5c-be18-735f0d3daa02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c8c42f58e0>]}
[0m18:13:39.813207 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m18:13:39.813862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9a238409-5c6c-4f5c-be18-735f0d3daa02', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c8c3f61940>]}
[0m18:13:39.905313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a238409-5c6c-4f5c-be18-735f0d3daa02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c8c3f88e30>]}
[0m18:13:39.973740 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:13:39.975575 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:13:39.988291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a238409-5c6c-4f5c-be18-735f0d3daa02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c89fd740e0>]}
[0m18:13:39.988860 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m18:13:39.989365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a238409-5c6c-4f5c-be18-735f0d3daa02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c8cffd6960>]}
[0m18:13:39.991119 [info ] [MainThread]: 
[0m18:13:39.991616 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:13:39.992078 [info ] [MainThread]: 
[0m18:13:39.992694 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:13:39.993675 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m18:13:40.028926 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m18:13:40.029415 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m18:13:40.029843 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:13:40.122422 [debug] [ThreadPool]: SQL status: OK in 0.092 seconds
[0m18:13:40.124117 [debug] [ThreadPool]: On list_argus_vault: Close
[0m18:13:40.124987 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m18:13:40.125558 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m18:13:40.132851 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:13:40.133356 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m18:13:40.133774 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:13:40.134993 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:13:40.136312 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:13:40.136744 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m18:13:40.137360 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:13:40.137777 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:13:40.138202 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m18:13:40.138824 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:13:40.139750 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:13:40.140207 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:13:40.140611 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:13:40.141307 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:13:40.141744 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m18:13:40.147428 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m18:13:40.153156 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:13:40.153684 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m18:13:40.154102 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:13:40.154959 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:13:40.155382 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:13:40.155799 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m18:13:40.166698 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m18:13:40.168168 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m18:13:40.169427 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m18:13:40.169859 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m18:13:40.171393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a238409-5c6c-4f5c-be18-735f0d3daa02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c8cfdcfa70>]}
[0m18:13:40.172020 [debug] [MainThread]: Using duckdb connection "master"
[0m18:13:40.172446 [debug] [MainThread]: On master: BEGIN
[0m18:13:40.172843 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:13:40.173753 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:13:40.174219 [debug] [MainThread]: On master: COMMIT
[0m18:13:40.174633 [debug] [MainThread]: Using duckdb connection "master"
[0m18:13:40.175050 [debug] [MainThread]: On master: COMMIT
[0m18:13:40.175636 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:13:40.176088 [debug] [MainThread]: On master: Close
[0m18:13:40.178120 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:13:40.178746 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m18:13:40.179344 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m18:13:40.179808 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m18:13:40.188026 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:13:40.188723 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m18:13:40.244853 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:13:40.245449 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201181340220620"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'This transaction is fraud due to extreme PCA values indicating unusual behavior.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '1eb3bc31-9a80-4424-8984-ab96ce0a5b99'
    );
  
  
  
[0m18:13:40.245951 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:40.254833 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m18:13:40.263001 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:13:40.263530 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m18:13:40.264250 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:13:40.264731 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:13:40.265225 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201181340220620'
      
      
      order by ordinal_position

  
[0m18:13:40.267732 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:13:40.272862 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:13:40.273400 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:13:40.276716 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:13:40.287148 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:13:40.287663 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:13:40.290166 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:13:40.291695 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:13:40.292219 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m18:13:40.293000 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:13:40.309303 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:13:40.310097 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:13:40.310590 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201181340220620"
    )
  
[0m18:13:40.311792 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:13:40.322356 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:13:40.322878 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:13:40.323363 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:13:40.336740 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m18:13:40.338839 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m18:13:40.340615 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a238409-5c6c-4f5c-be18-735f0d3daa02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c8d0e3be30>]}
[0m18:13:40.341422 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m18:13:40.342167 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:13:40.343870 [debug] [MainThread]: Using duckdb connection "master"
[0m18:13:40.344405 [debug] [MainThread]: On master: BEGIN
[0m18:13:40.344850 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:13:40.345965 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:13:40.346412 [debug] [MainThread]: On master: COMMIT
[0m18:13:40.346827 [debug] [MainThread]: Using duckdb connection "master"
[0m18:13:40.347268 [debug] [MainThread]: On master: COMMIT
[0m18:13:40.347890 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:13:40.348375 [debug] [MainThread]: On master: Close
[0m18:13:40.348868 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:13:40.349312 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m18:13:40.349729 [info ] [MainThread]: 
[0m18:13:40.350225 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m18:13:40.351046 [debug] [MainThread]: Command end result
[0m18:13:40.370118 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:13:40.371733 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:13:40.377419 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m18:13:40.377856 [info ] [MainThread]: 
[0m18:13:40.378396 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:13:40.378838 [info ] [MainThread]: 
[0m18:13:40.379330 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:13:40.379975 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:13:40.381032 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3748062, "process_in_blocks": "0", "process_kernel_time": 0.320404, "process_mem_max_rss": "273572", "process_out_blocks": "3120", "process_user_time": 4.314058}
[0m18:13:40.381608 [debug] [MainThread]: Command `dbt run` succeeded at 18:13:40.381506 after 2.38 seconds
[0m18:13:40.382097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c8d1c32e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c8c3f94770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c8c43773e0>]}
[0m18:13:40.382574 [debug] [MainThread]: Flushing usage events
[0m18:13:41.303287 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:13:57.708791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f79fb77bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f7a1c25d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f7a08e1e80>]}


============================== 18:13:57.712167 | 3e74fa43-2b17-4477-8dd5-9419215a707b ==============================
[0m18:13:57.712167 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:13:57.712862 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'profiles_dir': '.', 'write_json': 'True', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'log_format': 'default', 'printer_width': '80', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'empty': 'False', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'static_parser': 'True', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "252ecd19-bddb-40f7-a2ef-3950f9497965", "ai_explanation": "This transaction is fraud due to highly anomalous PCA scores (V3, V7, V17) indicating manipulation."} --profiles-dir .', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'warn_error': 'None'}
[0m18:13:57.959828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e74fa43-2b17-4477-8dd5-9419215a707b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f79eb726c0>]}
[0m18:13:58.030530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e74fa43-2b17-4477-8dd5-9419215a707b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f79f4cc590>]}
[0m18:13:58.032233 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:13:58.117835 [debug] [MainThread]: checksum: e33b81c22c0ae48efffb329d9e7a08fe89eea9d25d2b71e2da0ab925a225dd29, vars: {'ai_explanation': 'This transaction is fraud due to highly anomalous PCA '
                   'scores (V3, V7, V17) indicating manipulation.',
 'txn_id': '252ecd19-bddb-40f7-a2ef-3950f9497965'}, profile: , target: , version: 1.11.2
[0m18:13:58.211250 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:13:58.211850 [debug] [MainThread]: previous checksum: e33b81c22c0ae48efffb329d9e7a08fe89eea9d25d2b71e2da0ab925a225dd29, current checksum: 8ae5f3ad9369a954f73e04e020e43157c046a1f745b5381ea30583bf6bd95abf
[0m18:13:58.212386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3e74fa43-2b17-4477-8dd5-9419215a707b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f792ec92b0>]}
[0m18:13:59.446339 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m18:13:59.447044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3e74fa43-2b17-4477-8dd5-9419215a707b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f790df3320>]}
[0m18:13:59.539418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e74fa43-2b17-4477-8dd5-9419215a707b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f790dabc20>]}
[0m18:13:59.608181 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:13:59.609838 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:13:59.622050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e74fa43-2b17-4477-8dd5-9419215a707b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f776b29340>]}
[0m18:13:59.622602 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m18:13:59.623139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e74fa43-2b17-4477-8dd5-9419215a707b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f776bed340>]}
[0m18:13:59.624926 [info ] [MainThread]: 
[0m18:13:59.625537 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:13:59.625992 [info ] [MainThread]: 
[0m18:13:59.626599 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:13:59.627610 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m18:13:59.662966 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m18:13:59.663453 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m18:13:59.663881 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:13:59.750447 [debug] [ThreadPool]: SQL status: OK in 0.086 seconds
[0m18:13:59.752120 [debug] [ThreadPool]: On list_argus_vault: Close
[0m18:13:59.752977 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m18:13:59.753546 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m18:13:59.760849 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:13:59.761334 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m18:13:59.761762 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:13:59.762979 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:13:59.764281 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:13:59.764714 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m18:13:59.765332 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:13:59.765754 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:13:59.766184 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m18:13:59.766843 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:13:59.767776 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:13:59.768235 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:13:59.768637 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:13:59.769252 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:13:59.769682 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m18:13:59.775185 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m18:13:59.781257 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:13:59.782004 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m18:13:59.782565 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:13:59.783961 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:13:59.784548 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:13:59.785153 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m18:13:59.796738 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m18:13:59.798257 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m18:13:59.799564 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m18:13:59.800025 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m18:13:59.801534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e74fa43-2b17-4477-8dd5-9419215a707b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f790d38890>]}
[0m18:13:59.802121 [debug] [MainThread]: Using duckdb connection "master"
[0m18:13:59.802545 [debug] [MainThread]: On master: BEGIN
[0m18:13:59.802960 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:13:59.803850 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:13:59.804313 [debug] [MainThread]: On master: COMMIT
[0m18:13:59.804727 [debug] [MainThread]: Using duckdb connection "master"
[0m18:13:59.805145 [debug] [MainThread]: On master: COMMIT
[0m18:13:59.805728 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:13:59.806180 [debug] [MainThread]: On master: Close
[0m18:13:59.808212 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:13:59.808953 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m18:13:59.809550 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m18:13:59.810052 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m18:13:59.818940 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:13:59.819929 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m18:13:59.888767 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:13:59.889404 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201181359863808"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'This transaction is fraud due to highly anomalous PCA scores (V3, V7, V17) indicating manipulation.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '252ecd19-bddb-40f7-a2ef-3950f9497965'
    );
  
  
  
[0m18:13:59.889890 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:59.897864 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m18:13:59.905380 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:13:59.905886 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m18:13:59.906573 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:13:59.907080 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:13:59.907542 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201181359863808'
      
      
      order by ordinal_position

  
[0m18:13:59.910180 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:13:59.915118 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:13:59.915627 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:13:59.918133 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:13:59.928146 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:13:59.928662 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:13:59.931019 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:13:59.932496 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:13:59.933016 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m18:13:59.934092 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:13:59.950498 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:13:59.951367 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:13:59.951963 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201181359863808"
    )
  
[0m18:13:59.953182 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:13:59.963664 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:13:59.964272 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:13:59.964734 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:13:59.978324 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m18:13:59.980331 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m18:13:59.982078 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e74fa43-2b17-4477-8dd5-9419215a707b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f7744fd6d0>]}
[0m18:13:59.982822 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.17s]
[0m18:13:59.983567 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:13:59.985182 [debug] [MainThread]: Using duckdb connection "master"
[0m18:13:59.986083 [debug] [MainThread]: On master: BEGIN
[0m18:13:59.986626 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:13:59.987719 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:13:59.988184 [debug] [MainThread]: On master: COMMIT
[0m18:13:59.988606 [debug] [MainThread]: Using duckdb connection "master"
[0m18:13:59.989041 [debug] [MainThread]: On master: COMMIT
[0m18:13:59.989680 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:13:59.990146 [debug] [MainThread]: On master: Close
[0m18:13:59.990637 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:13:59.991071 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m18:13:59.991495 [info ] [MainThread]: 
[0m18:13:59.991963 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m18:13:59.992722 [debug] [MainThread]: Command end result
[0m18:14:00.011519 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:14:00.013137 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:14:00.018677 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m18:14:00.019144 [info ] [MainThread]: 
[0m18:14:00.019655 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:14:00.020121 [info ] [MainThread]: 
[0m18:14:00.020588 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:14:00.021259 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:14:00.022292 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3759637, "process_in_blocks": "0", "process_kernel_time": 0.322456, "process_mem_max_rss": "274980", "process_out_blocks": "3112", "process_user_time": 4.29282}
[0m18:14:00.022872 [debug] [MainThread]: Command `dbt run` succeeded at 18:14:00.022770 after 2.38 seconds
[0m18:14:00.023366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f79f2b2720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f79f454e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f7a351bd40>]}
[0m18:14:00.023843 [debug] [MainThread]: Flushing usage events
[0m18:14:00.920471 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:14:16.669712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b902005c470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b901fd9dac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9020ad23f0>]}


============================== 18:14:16.673117 | c04e7065-75d5-4244-9171-f5b3110321f0 ==============================
[0m18:14:16.673117 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:14:16.673858 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'log_format': 'default', 'debug': 'False', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'target_path': 'None', 'printer_width': '80', 'cache_selected_only': 'False', 'no_print': 'None', 'empty': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'static_parser': 'True', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "92132874-d404-4db5-8203-e508e4f3ca3e", "ai_explanation": "Based on PCA factors, this transaction exhibits unusual patterns and anomalies, indicating potential fraud."} --profiles-dir .', 'introspect': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'profiles_dir': '.', 'version_check': 'True'}
[0m18:14:16.921876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c04e7065-75d5-4244-9171-f5b3110321f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b901f7b17c0>]}
[0m18:14:16.992645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c04e7065-75d5-4244-9171-f5b3110321f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b901f8ff6b0>]}
[0m18:14:16.994344 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:14:17.078761 [debug] [MainThread]: checksum: ff875728ebdc12404f4ea72f0ae3cf58b7602314668101b1af1924c5f54ae40c, vars: {'ai_explanation': 'Based on PCA factors, this transaction exhibits unusual '
                   'patterns and anomalies, indicating potential fraud.',
 'txn_id': '92132874-d404-4db5-8203-e508e4f3ca3e'}, profile: , target: , version: 1.11.2
[0m18:14:17.171012 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:14:17.171606 [debug] [MainThread]: previous checksum: ff875728ebdc12404f4ea72f0ae3cf58b7602314668101b1af1924c5f54ae40c, current checksum: e33b81c22c0ae48efffb329d9e7a08fe89eea9d25d2b71e2da0ab925a225dd29
[0m18:14:17.172077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c04e7065-75d5-4244-9171-f5b3110321f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9013a8b080>]}
[0m18:14:18.389297 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m18:14:18.390034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c04e7065-75d5-4244-9171-f5b3110321f0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b901014ef60>]}
[0m18:14:18.481455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c04e7065-75d5-4244-9171-f5b3110321f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8fd37b92b0>]}
[0m18:14:18.549553 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:14:18.551260 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:14:18.563429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c04e7065-75d5-4244-9171-f5b3110321f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8fd37b9730>]}
[0m18:14:18.564001 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m18:14:18.564482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c04e7065-75d5-4244-9171-f5b3110321f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9013aaf9b0>]}
[0m18:14:18.566226 [info ] [MainThread]: 
[0m18:14:18.566722 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:14:18.567186 [info ] [MainThread]: 
[0m18:14:18.567779 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:14:18.568828 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m18:14:18.603999 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m18:14:18.604480 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m18:14:18.604932 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:14:18.693065 [debug] [ThreadPool]: SQL status: OK in 0.088 seconds
[0m18:14:18.694724 [debug] [ThreadPool]: On list_argus_vault: Close
[0m18:14:18.695629 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m18:14:18.696241 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m18:14:18.703631 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:14:18.704123 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m18:14:18.704556 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:14:18.705704 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:14:18.707092 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:14:18.707532 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m18:14:18.708421 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:14:18.708853 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:14:18.709299 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m18:14:18.709955 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:14:18.710904 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:14:18.711373 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:14:18.711778 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:14:18.712477 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:14:18.712938 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m18:14:18.718573 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m18:14:18.724568 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:14:18.725132 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m18:14:18.725539 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:14:18.726787 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:14:18.727251 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:14:18.727669 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m18:14:18.738799 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m18:14:18.740317 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m18:14:18.741574 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m18:14:18.742031 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m18:14:18.743683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c04e7065-75d5-4244-9171-f5b3110321f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8fd3653c50>]}
[0m18:14:18.744332 [debug] [MainThread]: Using duckdb connection "master"
[0m18:14:18.744760 [debug] [MainThread]: On master: BEGIN
[0m18:14:18.745188 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:14:18.746050 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:14:18.746496 [debug] [MainThread]: On master: COMMIT
[0m18:14:18.746932 [debug] [MainThread]: Using duckdb connection "master"
[0m18:14:18.747353 [debug] [MainThread]: On master: COMMIT
[0m18:14:18.747969 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:14:18.748405 [debug] [MainThread]: On master: Close
[0m18:14:18.750445 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:14:18.751152 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m18:14:18.751760 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m18:14:18.752282 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m18:14:18.760350 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:14:18.761088 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m18:14:18.817384 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:14:18.818012 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201181418792999"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Based on PCA factors, this transaction exhibits unusual patterns and anomalies, indicating potential fraud.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '92132874-d404-4db5-8203-e508e4f3ca3e'
    );
  
  
  
[0m18:14:18.818506 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:14:18.828098 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m18:14:18.835959 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:14:18.836487 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m18:14:18.837231 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:14:18.837712 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:14:18.838201 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201181418792999'
      
      
      order by ordinal_position

  
[0m18:14:18.840695 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:14:18.845931 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:14:18.846452 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:14:18.849012 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:14:18.859243 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:14:18.859766 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:14:18.862840 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:14:18.864399 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:14:18.864900 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m18:14:18.865670 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:14:18.881991 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:14:18.882752 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:14:18.883270 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201181418792999"
    )
  
[0m18:14:18.884497 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:14:18.894991 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:14:18.895503 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:14:18.895985 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:14:18.909299 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m18:14:18.911303 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m18:14:18.913018 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c04e7065-75d5-4244-9171-f5b3110321f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9022498d70>]}
[0m18:14:18.913771 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m18:14:18.914552 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:14:18.916117 [debug] [MainThread]: Using duckdb connection "master"
[0m18:14:18.916606 [debug] [MainThread]: On master: BEGIN
[0m18:14:18.917081 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:14:18.918088 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:14:18.918532 [debug] [MainThread]: On master: COMMIT
[0m18:14:18.918993 [debug] [MainThread]: Using duckdb connection "master"
[0m18:14:18.919410 [debug] [MainThread]: On master: COMMIT
[0m18:14:18.920037 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:14:18.920473 [debug] [MainThread]: On master: Close
[0m18:14:18.921002 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:14:18.921406 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m18:14:18.921821 [info ] [MainThread]: 
[0m18:14:18.922304 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m18:14:18.923076 [debug] [MainThread]: Command end result
[0m18:14:18.942289 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:14:18.943863 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:14:18.949461 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m18:14:18.949900 [info ] [MainThread]: 
[0m18:14:18.950430 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:14:18.950870 [info ] [MainThread]: 
[0m18:14:18.951354 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:14:18.951983 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:14:18.953020 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3460243, "process_in_blocks": "0", "process_kernel_time": 0.332397, "process_mem_max_rss": "275356", "process_out_blocks": "3104", "process_user_time": 4.25469}
[0m18:14:18.953600 [debug] [MainThread]: Command `dbt run` succeeded at 18:14:18.953498 after 2.35 seconds
[0m18:14:18.954079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9022751f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b90207aa0c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b90201e70e0>]}
[0m18:14:18.954549 [debug] [MainThread]: Flushing usage events
[0m18:14:19.981004 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:14:35.610170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4dc6d43650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4dc8afbd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4dc94389e0>]}


============================== 18:14:35.613476 | 76b860ac-2e04-40ca-a3b5-1877cf87d562 ==============================
[0m18:14:35.613476 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:14:35.614189 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'quiet': 'False', 'empty': 'False', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'no_print': 'None', 'debug': 'False', 'warn_error': 'None', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "2618234a-b467-4093-8b96-a3c7b9aacade", "ai_explanation": "Transaction is fraud due to extremely high negative PCA V17 score (-20.25)."} --profiles-dir .', 'static_parser': 'True', 'introspect': 'True', 'printer_width': '80', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'profiles_dir': '.', 'indirect_selection': 'eager', 'log_format': 'default', 'partial_parse': 'True', 'write_json': 'True'}
[0m18:14:35.861634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '76b860ac-2e04-40ca-a3b5-1877cf87d562', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4dbab43b00>]}
[0m18:14:35.932571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '76b860ac-2e04-40ca-a3b5-1877cf87d562', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4dc6634530>]}
[0m18:14:35.934327 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:14:36.018055 [debug] [MainThread]: checksum: 2f0aec37fd49449d2d603c87d90a41285755376e19a93c975556dab93abe44f2, vars: {'ai_explanation': 'Transaction is fraud due to extremely high negative PCA '
                   'V17 score (-20.25).',
 'txn_id': '2618234a-b467-4093-8b96-a3c7b9aacade'}, profile: , target: , version: 1.11.2
[0m18:14:36.110939 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:14:36.111548 [debug] [MainThread]: previous checksum: 2f0aec37fd49449d2d603c87d90a41285755376e19a93c975556dab93abe44f2, current checksum: ff875728ebdc12404f4ea72f0ae3cf58b7602314668101b1af1924c5f54ae40c
[0m18:14:36.112067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '76b860ac-2e04-40ca-a3b5-1877cf87d562', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4dba8b8d70>]}
[0m18:14:37.350220 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m18:14:37.350957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '76b860ac-2e04-40ca-a3b5-1877cf87d562', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4db878bb60>]}
[0m18:14:37.445782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '76b860ac-2e04-40ca-a3b5-1877cf87d562', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4dbaa431a0>]}
[0m18:14:37.514985 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:14:37.516723 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:14:37.529009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '76b860ac-2e04-40ca-a3b5-1877cf87d562', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4da65ae300>]}
[0m18:14:37.529578 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m18:14:37.530118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76b860ac-2e04-40ca-a3b5-1877cf87d562', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4dba702420>]}
[0m18:14:37.531854 [info ] [MainThread]: 
[0m18:14:37.532403 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:14:37.532871 [info ] [MainThread]: 
[0m18:14:37.533518 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:14:37.534495 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m18:14:37.569810 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m18:14:37.570323 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m18:14:37.570760 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:14:37.658026 [debug] [ThreadPool]: SQL status: OK in 0.087 seconds
[0m18:14:37.659721 [debug] [ThreadPool]: On list_argus_vault: Close
[0m18:14:37.660630 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m18:14:37.661263 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m18:14:37.668709 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:14:37.669195 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m18:14:37.669616 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:14:37.670766 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:14:37.672118 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:14:37.672549 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m18:14:37.673168 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:14:37.673594 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:14:37.674024 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m18:14:37.674672 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:14:37.675609 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:14:37.676068 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:14:37.676476 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:14:37.677177 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:14:37.677617 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m18:14:37.683143 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m18:14:37.688958 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:14:37.689494 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m18:14:37.689897 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:14:37.690805 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:14:37.691263 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:14:37.691681 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m18:14:37.702834 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m18:14:37.704342 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m18:14:37.705620 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m18:14:37.706084 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m18:14:37.707627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76b860ac-2e04-40ca-a3b5-1877cf87d562', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4dbab52960>]}
[0m18:14:37.708223 [debug] [MainThread]: Using duckdb connection "master"
[0m18:14:37.708646 [debug] [MainThread]: On master: BEGIN
[0m18:14:37.709070 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:14:37.710036 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:14:37.710481 [debug] [MainThread]: On master: COMMIT
[0m18:14:37.710896 [debug] [MainThread]: Using duckdb connection "master"
[0m18:14:37.711326 [debug] [MainThread]: On master: COMMIT
[0m18:14:37.712020 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:14:37.712451 [debug] [MainThread]: On master: Close
[0m18:14:37.714493 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:14:37.715143 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m18:14:37.715697 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m18:14:37.716204 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m18:14:37.724423 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:14:37.725162 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m18:14:37.782690 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:14:37.783353 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201181437757785"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Transaction is fraud due to extremely high negative PCA V17 score (-20.25).' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '2618234a-b467-4093-8b96-a3c7b9aacade'
    );
  
  
  
[0m18:14:37.783856 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:14:37.792154 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m18:14:37.800082 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:14:37.800601 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m18:14:37.801370 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:14:37.801844 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:14:37.802345 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201181437757785'
      
      
      order by ordinal_position

  
[0m18:14:37.805173 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:14:37.810251 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:14:37.810769 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:14:37.813496 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:14:37.823707 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:14:37.824238 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:14:37.826979 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:14:37.828491 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:14:37.829013 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m18:14:37.829791 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:14:37.846202 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:14:37.846984 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:14:37.847478 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201181437757785"
    )
  
[0m18:14:37.849426 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:14:37.859931 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:14:37.860462 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:14:37.860940 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:14:37.874726 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m18:14:37.876955 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m18:14:37.879328 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76b860ac-2e04-40ca-a3b5-1877cf87d562', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4da58e5ac0>]}
[0m18:14:37.880125 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m18:14:37.880856 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:14:37.882251 [debug] [MainThread]: Using duckdb connection "master"
[0m18:14:37.882707 [debug] [MainThread]: On master: BEGIN
[0m18:14:37.883156 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:14:37.884110 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:14:37.884589 [debug] [MainThread]: On master: COMMIT
[0m18:14:37.885060 [debug] [MainThread]: Using duckdb connection "master"
[0m18:14:37.885466 [debug] [MainThread]: On master: COMMIT
[0m18:14:37.886089 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:14:37.886525 [debug] [MainThread]: On master: Close
[0m18:14:37.887036 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:14:37.887439 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m18:14:37.887856 [info ] [MainThread]: 
[0m18:14:37.888369 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m18:14:37.889184 [debug] [MainThread]: Command end result
[0m18:14:37.908804 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:14:37.910477 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:14:37.916179 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m18:14:37.916621 [info ] [MainThread]: 
[0m18:14:37.917195 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:14:37.917670 [info ] [MainThread]: 
[0m18:14:37.918185 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:14:37.918846 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:14:37.919944 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3722482, "process_in_blocks": "0", "process_kernel_time": 0.296458, "process_mem_max_rss": "283536", "process_out_blocks": "3120", "process_user_time": 4.295172}
[0m18:14:37.920525 [debug] [MainThread]: Command `dbt run` succeeded at 18:14:37.920422 after 2.37 seconds
[0m18:14:37.921014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4da6422ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4dc7727dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4dc6e79550>]}
[0m18:14:37.921494 [debug] [MainThread]: Flushing usage events
[0m18:14:38.820897 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:14:54.089035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ad905dfb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ad905dfce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ad909e64b0>]}


============================== 18:14:54.092493 | c09d3632-df69-4d87-9c20-d2f470e301fc ==============================
[0m18:14:54.092493 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:14:54.093197 [debug] [MainThread]: running dbt with arguments {'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'write_json': 'True', 'target_path': 'None', 'partial_parse': 'True', 'empty': 'False', 'static_parser': 'True', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "85b9aad4-9fbb-489a-8d32-24f95daebc0a", "ai_explanation": "Fraud detected: txns PCA factors indicate significant abnormalities and outlier patterns."} --profiles-dir .', 'introspect': 'True', 'no_print': 'None', 'debug': 'False', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '.', 'log_format': 'default', 'log_cache_events': 'False', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'printer_width': '80', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'fail_fast': 'False'}
[0m18:14:54.343794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c09d3632-df69-4d87-9c20-d2f470e301fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ad8fac9700>]}
[0m18:14:54.415230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c09d3632-df69-4d87-9c20-d2f470e301fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ad8fbf96a0>]}
[0m18:14:54.416974 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:14:54.503138 [debug] [MainThread]: checksum: 45e5afb3d8c713798573a0ac328f82b7682894116cd8ac854ab225aed73e5eef, vars: {'ai_explanation': 'Fraud detected: txns PCA factors indicate significant '
                   'abnormalities and outlier patterns.',
 'txn_id': '85b9aad4-9fbb-489a-8d32-24f95daebc0a'}, profile: , target: , version: 1.11.2
[0m18:14:54.596605 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:14:54.597228 [debug] [MainThread]: previous checksum: 45e5afb3d8c713798573a0ac328f82b7682894116cd8ac854ab225aed73e5eef, current checksum: 2f0aec37fd49449d2d603c87d90a41285755376e19a93c975556dab93abe44f2
[0m18:14:54.597715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c09d3632-df69-4d87-9c20-d2f470e301fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ad902429c0>]}
[0m18:14:55.830888 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m18:14:55.831569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c09d3632-df69-4d87-9c20-d2f470e301fc', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ad81b83fe0>]}
[0m18:14:55.924404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c09d3632-df69-4d87-9c20-d2f470e301fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ad83affc80>]}
[0m18:14:55.992870 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:14:55.994584 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:14:56.006811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c09d3632-df69-4d87-9c20-d2f470e301fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ad5b8700e0>]}
[0m18:14:56.007398 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m18:14:56.007863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c09d3632-df69-4d87-9c20-d2f470e301fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ad5b84a9c0>]}
[0m18:14:56.009618 [info ] [MainThread]: 
[0m18:14:56.010126 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:14:56.010556 [info ] [MainThread]: 
[0m18:14:56.011153 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:14:56.012127 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m18:14:56.047141 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m18:14:56.047621 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m18:14:56.048073 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:14:56.134776 [debug] [ThreadPool]: SQL status: OK in 0.087 seconds
[0m18:14:56.136535 [debug] [ThreadPool]: On list_argus_vault: Close
[0m18:14:56.138465 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m18:14:56.139096 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m18:14:56.146659 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:14:56.147173 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m18:14:56.147597 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:14:56.149620 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m18:14:56.151062 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:14:56.151514 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m18:14:56.152189 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:14:56.152615 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:14:56.153053 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m18:14:56.153695 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:14:56.154657 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:14:56.155120 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:14:56.155529 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:14:56.156198 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:14:56.156638 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m18:14:56.162278 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m18:14:56.168255 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:14:56.168805 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m18:14:56.169240 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:14:56.170135 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:14:56.170569 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:14:56.171002 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m18:14:56.181944 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m18:14:56.183407 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m18:14:56.184674 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m18:14:56.185136 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m18:14:56.186776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c09d3632-df69-4d87-9c20-d2f470e301fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ad81bffad0>]}
[0m18:14:56.187426 [debug] [MainThread]: Using duckdb connection "master"
[0m18:14:56.187863 [debug] [MainThread]: On master: BEGIN
[0m18:14:56.188302 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:14:56.189196 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:14:56.189648 [debug] [MainThread]: On master: COMMIT
[0m18:14:56.190124 [debug] [MainThread]: Using duckdb connection "master"
[0m18:14:56.190548 [debug] [MainThread]: On master: COMMIT
[0m18:14:56.191216 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:14:56.191667 [debug] [MainThread]: On master: Close
[0m18:14:56.193717 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:14:56.194371 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m18:14:56.194946 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m18:14:56.195428 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m18:14:56.203681 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:14:56.204411 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m18:14:56.261356 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:14:56.261956 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201181456236784"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Fraud detected: txns PCA factors indicate significant abnormalities and outlier patterns.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '85b9aad4-9fbb-489a-8d32-24f95daebc0a'
    );
  
  
  
[0m18:14:56.262452 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:14:56.270387 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m18:14:56.277882 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:14:56.278407 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m18:14:56.279115 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:14:56.279595 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:14:56.280089 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201181456236784'
      
      
      order by ordinal_position

  
[0m18:14:56.283121 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:14:56.288209 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:14:56.288720 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:14:56.291560 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:14:56.301766 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:14:56.302299 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:14:56.304865 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:14:56.306386 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:14:56.306891 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m18:14:56.307650 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:14:56.324024 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:14:56.324823 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:14:56.325352 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201181456236784"
    )
  
[0m18:14:56.326892 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:14:56.337503 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:14:56.338050 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:14:56.338518 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:14:56.351859 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m18:14:56.354039 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m18:14:56.355755 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c09d3632-df69-4d87-9c20-d2f470e301fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ad5ace4b00>]}
[0m18:14:56.356533 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m18:14:56.357280 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:14:56.358656 [debug] [MainThread]: Using duckdb connection "master"
[0m18:14:56.359184 [debug] [MainThread]: On master: BEGIN
[0m18:14:56.359631 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:14:56.360586 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:14:56.361059 [debug] [MainThread]: On master: COMMIT
[0m18:14:56.361493 [debug] [MainThread]: Using duckdb connection "master"
[0m18:14:56.361931 [debug] [MainThread]: On master: COMMIT
[0m18:14:56.362628 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:14:56.363097 [debug] [MainThread]: On master: Close
[0m18:14:56.363603 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:14:56.364032 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m18:14:56.364482 [info ] [MainThread]: 
[0m18:14:56.364953 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m18:14:56.365728 [debug] [MainThread]: Command end result
[0m18:14:56.385813 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:14:56.387522 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:14:56.393203 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m18:14:56.393658 [info ] [MainThread]: 
[0m18:14:56.394230 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:14:56.394683 [info ] [MainThread]: 
[0m18:14:56.395211 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:14:56.395845 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:14:56.396939 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3716211, "process_in_blocks": "0", "process_kernel_time": 0.290447, "process_mem_max_rss": "279376", "process_out_blocks": "3112", "process_user_time": 4.314085}
[0m18:14:56.397540 [debug] [MainThread]: Command `dbt run` succeeded at 18:14:56.397434 after 2.37 seconds
[0m18:14:56.398042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ad8faf1e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ad5b82b680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ad81b7d040>]}
[0m18:14:56.398543 [debug] [MainThread]: Flushing usage events
[0m18:14:57.287405 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:15:14.294883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749a4689c530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749a46164320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749a461e9880>]}


============================== 18:15:14.298288 | e456366a-cd18-4cdd-864d-00184faec87c ==============================
[0m18:15:14.298288 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:15:14.298978 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'profiles_dir': '.', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'write_json': 'True', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'version_check': 'True', 'warn_error': 'None', 'log_format': 'default', 'printer_width': '80', 'static_parser': 'True', 'use_experimental_parser': 'False', 'use_colors': 'True', 'target_path': 'None', 'debug': 'False', 'indirect_selection': 'eager', 'empty': 'False', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "266a73fe-74d9-4a22-8858-7b80df244eef", "ai_explanation": "Fraudulent transaction based on PCA scores: V5 (-4.015) and V17 (-4.674) indicate significant anomalous patterns."} --profiles-dir .', 'partial_parse': 'True', 'log_path': '/workspaces/modern-stack-banking/Transform/logs'}
[0m18:15:14.543659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e456366a-cd18-4cdd-864d-00184faec87c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749a4614e540>]}
[0m18:15:14.614111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e456366a-cd18-4cdd-864d-00184faec87c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749a45f98f80>]}
[0m18:15:14.615761 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:15:14.699527 [debug] [MainThread]: checksum: e579f4ceb8dc2fafe19b7a4734d0bbe5e15125814c33d67de452b055f9c5592d, vars: {'ai_explanation': 'Fraudulent transaction based on PCA scores: V5 (-4.015) '
                   'and V17 (-4.674) indicate significant anomalous patterns.',
 'txn_id': '266a73fe-74d9-4a22-8858-7b80df244eef'}, profile: , target: , version: 1.11.2
[0m18:15:14.791504 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:15:14.792111 [debug] [MainThread]: previous checksum: e579f4ceb8dc2fafe19b7a4734d0bbe5e15125814c33d67de452b055f9c5592d, current checksum: 45e5afb3d8c713798573a0ac328f82b7682894116cd8ac854ab225aed73e5eef
[0m18:15:14.792601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e456366a-cd18-4cdd-864d-00184faec87c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749a3a2a22d0>]}
[0m18:15:16.029507 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m18:15:16.030183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e456366a-cd18-4cdd-864d-00184faec87c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749a381244a0>]}
[0m18:15:16.122806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e456366a-cd18-4cdd-864d-00184faec87c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749a3a11b8c0>]}
[0m18:15:16.191352 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:15:16.193058 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:15:16.205182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e456366a-cd18-4cdd-864d-00184faec87c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749a31f43ef0>]}
[0m18:15:16.205732 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m18:15:16.206225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e456366a-cd18-4cdd-864d-00184faec87c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749a380086b0>]}
[0m18:15:16.207954 [info ] [MainThread]: 
[0m18:15:16.208442 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:15:16.208874 [info ] [MainThread]: 
[0m18:15:16.209482 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:15:16.210471 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m18:15:16.246722 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m18:15:16.247344 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m18:15:16.247781 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:15:16.332894 [debug] [ThreadPool]: SQL status: OK in 0.085 seconds
[0m18:15:16.334598 [debug] [ThreadPool]: On list_argus_vault: Close
[0m18:15:16.335514 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m18:15:16.336118 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m18:15:16.343373 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:15:16.343836 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m18:15:16.344279 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:15:16.345414 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:15:16.346728 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:15:16.347186 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m18:15:16.347790 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:15:16.348237 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:15:16.348644 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m18:15:16.349369 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:15:16.350314 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:15:16.350760 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:15:16.351198 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:15:16.351864 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:15:16.352338 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m18:15:16.357717 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m18:15:16.363310 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:15:16.363846 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m18:15:16.364275 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:15:16.365449 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:15:16.365883 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:15:16.366343 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m18:15:16.377057 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m18:15:16.378485 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m18:15:16.379728 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m18:15:16.380186 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m18:15:16.381825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e456366a-cd18-4cdd-864d-00184faec87c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749a3a579ca0>]}
[0m18:15:16.382460 [debug] [MainThread]: Using duckdb connection "master"
[0m18:15:16.382889 [debug] [MainThread]: On master: BEGIN
[0m18:15:16.383323 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:15:16.384208 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:15:16.384651 [debug] [MainThread]: On master: COMMIT
[0m18:15:16.385100 [debug] [MainThread]: Using duckdb connection "master"
[0m18:15:16.385509 [debug] [MainThread]: On master: COMMIT
[0m18:15:16.386173 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:15:16.386613 [debug] [MainThread]: On master: Close
[0m18:15:16.388651 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:15:16.389380 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m18:15:16.390016 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m18:15:16.390544 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m18:15:16.398727 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:15:16.399459 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m18:15:16.456185 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:15:16.456763 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201181516431601"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Fraudulent transaction based on PCA scores: V5 (-4.015) and V17 (-4.674) indicate significant anomalous patterns.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '266a73fe-74d9-4a22-8858-7b80df244eef'
    );
  
  
  
[0m18:15:16.457274 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:15:16.466174 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m18:15:16.473983 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:15:16.474496 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m18:15:16.475213 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:15:16.475694 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:15:16.476189 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201181516431601'
      
      
      order by ordinal_position

  
[0m18:15:16.478866 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:15:16.483888 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:15:16.484417 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:15:16.487168 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:15:16.497215 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:15:16.497728 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:15:16.500112 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:15:16.501635 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:15:16.502157 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m18:15:16.502900 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:15:16.519287 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:15:16.520058 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:15:16.520551 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201181516431601"
    )
  
[0m18:15:16.521904 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:15:16.532428 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:15:16.532968 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:15:16.533442 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:15:16.546589 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m18:15:16.548578 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m18:15:16.550298 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e456366a-cd18-4cdd-864d-00184faec87c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749a47117bf0>]}
[0m18:15:16.551065 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m18:15:16.551788 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:15:16.553172 [debug] [MainThread]: Using duckdb connection "master"
[0m18:15:16.553667 [debug] [MainThread]: On master: BEGIN
[0m18:15:16.554123 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:15:16.555023 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:15:16.555470 [debug] [MainThread]: On master: COMMIT
[0m18:15:16.555886 [debug] [MainThread]: Using duckdb connection "master"
[0m18:15:16.556318 [debug] [MainThread]: On master: COMMIT
[0m18:15:16.556953 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:15:16.557394 [debug] [MainThread]: On master: Close
[0m18:15:16.557885 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:15:16.558317 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m18:15:16.558738 [info ] [MainThread]: 
[0m18:15:16.559213 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m18:15:16.560000 [debug] [MainThread]: Command end result
[0m18:15:16.579024 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:15:16.580593 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:15:16.586149 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m18:15:16.586579 [info ] [MainThread]: 
[0m18:15:16.587107 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:15:16.587542 [info ] [MainThread]: 
[0m18:15:16.588014 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:15:16.588629 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:15:16.589642 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3578231, "process_in_blocks": "0", "process_kernel_time": 0.338698, "process_mem_max_rss": "274948", "process_out_blocks": "3120", "process_user_time": 4.303051}
[0m18:15:16.590237 [debug] [MainThread]: Command `dbt run` succeeded at 18:15:16.590134 after 2.36 seconds
[0m18:15:16.590697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749a462e2b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749a381999d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749a3a579ca0>]}
[0m18:15:16.591188 [debug] [MainThread]: Flushing usage events
[0m18:15:17.526535 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:15:33.429459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76b01e9b5fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76b01ebf51c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76b01cb16e70>]}


============================== 18:15:33.432733 | 7a536eaa-e1e4-44fe-859b-5b071a51ff53 ==============================
[0m18:15:33.432733 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:15:33.433421 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'fail_fast': 'False', 'warn_error': 'None', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'profiles_dir': '.', 'use_colors': 'True', 'debug': 'False', 'empty': 'False', 'introspect': 'True', 'version_check': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "aae5bf58-f905-422a-8b46-4fd06cbbc6a9", "ai_explanation": "Based on PCA factors, this transaction is fraud due to significant negative V3 and V7 values."} --profiles-dir .', 'static_parser': 'True', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'quiet': 'False', 'log_cache_events': 'False', 'target_path': 'None', 'partial_parse': 'True'}
[0m18:15:33.680264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a536eaa-e1e4-44fe-859b-5b071a51ff53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76b01bb4f110>]}
[0m18:15:33.751168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a536eaa-e1e4-44fe-859b-5b071a51ff53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76b01bce1220>]}
[0m18:15:33.752927 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:15:33.837902 [debug] [MainThread]: checksum: 71c41457966547c3b3875c4e74072683e75f56090d8a125aa4c6fa86e0739b56, vars: {'ai_explanation': 'Based on PCA factors, this transaction is fraud due to '
                   'significant negative V3 and V7 values.',
 'txn_id': 'aae5bf58-f905-422a-8b46-4fd06cbbc6a9'}, profile: , target: , version: 1.11.2
[0m18:15:33.930410 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:15:33.931027 [debug] [MainThread]: previous checksum: 71c41457966547c3b3875c4e74072683e75f56090d8a125aa4c6fa86e0739b56, current checksum: e579f4ceb8dc2fafe19b7a4734d0bbe5e15125814c33d67de452b055f9c5592d
[0m18:15:33.931505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7a536eaa-e1e4-44fe-859b-5b071a51ff53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76b01c42e870>]}
[0m18:15:35.169518 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m18:15:35.170191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7a536eaa-e1e4-44fe-859b-5b071a51ff53', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76b00ff429f0>]}
[0m18:15:35.261029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a536eaa-e1e4-44fe-859b-5b071a51ff53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76afc79db1a0>]}
[0m18:15:35.329005 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:15:35.330668 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:15:35.342790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a536eaa-e1e4-44fe-859b-5b071a51ff53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76afc79ad5e0>]}
[0m18:15:35.343367 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m18:15:35.343827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a536eaa-e1e4-44fe-859b-5b071a51ff53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76b00c17ac00>]}
[0m18:15:35.345584 [info ] [MainThread]: 
[0m18:15:35.346104 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:15:35.346541 [info ] [MainThread]: 
[0m18:15:35.347153 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:15:35.348144 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m18:15:35.383466 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m18:15:35.383989 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m18:15:35.384440 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:15:35.471981 [debug] [ThreadPool]: SQL status: OK in 0.087 seconds
[0m18:15:35.473588 [debug] [ThreadPool]: On list_argus_vault: Close
[0m18:15:35.474426 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m18:15:35.474999 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m18:15:35.482163 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:15:35.482619 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m18:15:35.483049 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:15:35.484166 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:15:35.485444 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:15:35.485872 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m18:15:35.486488 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:15:35.486931 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:15:35.487337 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m18:15:35.487964 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:15:35.488850 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:15:35.489303 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:15:35.489701 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:15:35.490296 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:15:35.490719 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m18:15:35.496023 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m18:15:35.501539 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:15:35.502085 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m18:15:35.502483 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:15:35.503359 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:15:35.503786 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:15:35.504228 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m18:15:35.514996 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m18:15:35.516374 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m18:15:35.517618 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m18:15:35.518075 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m18:15:35.519538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a536eaa-e1e4-44fe-859b-5b071a51ff53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76afc790e7e0>]}
[0m18:15:35.520144 [debug] [MainThread]: Using duckdb connection "master"
[0m18:15:35.520567 [debug] [MainThread]: On master: BEGIN
[0m18:15:35.520970 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:15:35.521791 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:15:35.522246 [debug] [MainThread]: On master: COMMIT
[0m18:15:35.522653 [debug] [MainThread]: Using duckdb connection "master"
[0m18:15:35.523070 [debug] [MainThread]: On master: COMMIT
[0m18:15:35.523661 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:15:35.524117 [debug] [MainThread]: On master: Close
[0m18:15:35.526156 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:15:35.526771 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m18:15:35.527344 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m18:15:35.527810 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m18:15:35.535745 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:15:35.536492 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m18:15:35.592441 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:15:35.593000 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201181535568300"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Based on PCA factors, this transaction is fraud due to significant negative V3 and V7 values.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = 'aae5bf58-f905-422a-8b46-4fd06cbbc6a9'
    );
  
  
  
[0m18:15:35.593483 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:15:35.601752 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m18:15:35.609215 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:15:35.609714 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m18:15:35.610425 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:15:35.610895 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:15:35.611383 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201181535568300'
      
      
      order by ordinal_position

  
[0m18:15:35.613851 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:15:35.618703 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:15:35.619226 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:15:35.622058 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:15:35.631989 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:15:35.632499 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:15:35.634814 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:15:35.636308 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:15:35.636803 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m18:15:35.637618 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:15:35.653724 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:15:35.654496 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:15:35.655010 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201181535568300"
    )
  
[0m18:15:35.656399 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:15:35.666708 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:15:35.667229 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:15:35.667683 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:15:35.681355 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m18:15:35.683369 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m18:15:35.685094 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a536eaa-e1e4-44fe-859b-5b071a51ff53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76b00c13e780>]}
[0m18:15:35.685833 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m18:15:35.686558 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:15:35.687971 [debug] [MainThread]: Using duckdb connection "master"
[0m18:15:35.688456 [debug] [MainThread]: On master: BEGIN
[0m18:15:35.688870 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:15:35.689846 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:15:35.690303 [debug] [MainThread]: On master: COMMIT
[0m18:15:35.690710 [debug] [MainThread]: Using duckdb connection "master"
[0m18:15:35.691129 [debug] [MainThread]: On master: COMMIT
[0m18:15:35.691823 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:15:35.692535 [debug] [MainThread]: On master: Close
[0m18:15:35.693310 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:15:35.693981 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m18:15:35.694680 [info ] [MainThread]: 
[0m18:15:35.695380 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m18:15:35.696638 [debug] [MainThread]: Command end result
[0m18:15:35.719428 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:15:35.721074 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:15:35.726765 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m18:15:35.727229 [info ] [MainThread]: 
[0m18:15:35.727742 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:15:35.728202 [info ] [MainThread]: 
[0m18:15:35.728660 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:15:35.729296 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:15:35.730348 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.363277, "process_in_blocks": "0", "process_kernel_time": 0.287647, "process_mem_max_rss": "273520", "process_out_blocks": "3112", "process_user_time": 4.324638}
[0m18:15:35.730940 [debug] [MainThread]: Command `dbt run` succeeded at 18:15:35.730814 after 2.36 seconds
[0m18:15:35.731431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76b01e9b5fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76b01b9cf260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76b00c1213d0>]}
[0m18:15:35.731907 [debug] [MainThread]: Flushing usage events
[0m18:15:36.596440 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:15:52.599348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c17d2d725a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c17d4d49cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c17d287c140>]}


============================== 18:15:52.602764 | 2fc45688-206c-4f5f-9532-ef0203e53e9c ==============================
[0m18:15:52.602764 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:15:52.603443 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'static_parser': 'True', 'empty': 'False', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'partial_parse': 'True', 'debug': 'False', 'target_path': 'None', 'quiet': 'False', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "05b86882-eb1d-413d-9ecb-a30789de384a", "ai_explanation": "Based on the PCA factors, this transaction exhibits significant anomalies and is likely fraudulent due to extreme outliers."} --profiles-dir .', 'use_colors': 'True', 'fail_fast': 'False', 'write_json': 'True', 'version_check': 'True', 'no_print': 'None', 'introspect': 'True', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '.', 'log_format': 'default', 'indirect_selection': 'eager', 'use_experimental_parser': 'False'}
[0m18:15:52.850383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2fc45688-206c-4f5f-9532-ef0203e53e9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c17d27a4320>]}
[0m18:15:52.921402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2fc45688-206c-4f5f-9532-ef0203e53e9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c17d2640710>]}
[0m18:15:52.923152 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:15:53.008900 [debug] [MainThread]: checksum: fa7d336dfb28616aa981b3b412eb436d2de44dc495de4d526c20aa7fd283274a, vars: {'ai_explanation': 'Based on the PCA factors, this transaction exhibits '
                   'significant anomalies and is likely fraudulent due to '
                   'extreme outliers.',
 'txn_id': '05b86882-eb1d-413d-9ecb-a30789de384a'}, profile: , target: , version: 1.11.2
[0m18:15:53.101985 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:15:53.102583 [debug] [MainThread]: previous checksum: fa7d336dfb28616aa981b3b412eb436d2de44dc495de4d526c20aa7fd283274a, current checksum: 71c41457966547c3b3875c4e74072683e75f56090d8a125aa4c6fa86e0739b56
[0m18:15:53.103082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2fc45688-206c-4f5f-9532-ef0203e53e9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c17c607e000>]}
[0m18:15:54.329722 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m18:15:54.330465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2fc45688-206c-4f5f-9532-ef0203e53e9c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c17c4162cf0>]}
[0m18:15:54.425890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2fc45688-206c-4f5f-9532-ef0203e53e9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c17c6201220>]}
[0m18:15:54.497415 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:15:54.499236 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:15:54.511621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2fc45688-206c-4f5f-9532-ef0203e53e9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c17c41aadb0>]}
[0m18:15:54.512224 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m18:15:54.512731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2fc45688-206c-4f5f-9532-ef0203e53e9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c17c6351250>]}
[0m18:15:54.514523 [info ] [MainThread]: 
[0m18:15:54.515067 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:15:54.515531 [info ] [MainThread]: 
[0m18:15:54.516209 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:15:54.517244 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m18:15:54.552510 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m18:15:54.553024 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m18:15:54.553602 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:15:54.640861 [debug] [ThreadPool]: SQL status: OK in 0.087 seconds
[0m18:15:54.642605 [debug] [ThreadPool]: On list_argus_vault: Close
[0m18:15:54.643507 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m18:15:54.644133 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m18:15:54.651635 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:15:54.652122 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m18:15:54.652543 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:15:54.653704 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:15:54.655047 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:15:54.655483 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m18:15:54.656138 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:15:54.656561 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:15:54.656994 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m18:15:54.657614 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:15:54.658539 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:15:54.658986 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:15:54.659390 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:15:54.660029 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:15:54.660461 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m18:15:54.666105 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m18:15:54.672108 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:15:54.672642 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m18:15:54.673074 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:15:54.673940 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:15:54.674375 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:15:54.674788 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m18:15:54.685754 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m18:15:54.687170 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m18:15:54.688515 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m18:15:54.689050 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m18:15:54.690738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2fc45688-206c-4f5f-9532-ef0203e53e9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c17c619e000>]}
[0m18:15:54.691397 [debug] [MainThread]: Using duckdb connection "master"
[0m18:15:54.691863 [debug] [MainThread]: On master: BEGIN
[0m18:15:54.692328 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:15:54.693268 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:15:54.693733 [debug] [MainThread]: On master: COMMIT
[0m18:15:54.694225 [debug] [MainThread]: Using duckdb connection "master"
[0m18:15:54.694666 [debug] [MainThread]: On master: COMMIT
[0m18:15:54.695411 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:15:54.695879 [debug] [MainThread]: On master: Close
[0m18:15:54.698064 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:15:54.698762 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m18:15:54.699385 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m18:15:54.699863 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m18:15:54.709292 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:15:54.710064 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m18:15:54.771258 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:15:54.771991 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201181554742899"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Based on the PCA factors, this transaction exhibits significant anomalies and is likely fraudulent due to extreme outliers.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '05b86882-eb1d-413d-9ecb-a30789de384a'
    );
  
  
  
[0m18:15:54.772503 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:15:54.781871 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m18:15:54.790047 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:15:54.790606 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m18:15:54.791403 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:15:54.791938 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:15:54.792458 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201181554742899'
      
      
      order by ordinal_position

  
[0m18:15:54.795000 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:15:54.800367 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:15:54.800954 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:15:54.804046 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:15:54.814863 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:15:54.815525 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:15:54.818479 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:15:54.820351 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:15:54.820894 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m18:15:54.822028 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:15:54.838822 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:15:54.839775 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:15:54.840333 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201181554742899"
    )
  
[0m18:15:54.842054 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:15:54.852567 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:15:54.853126 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:15:54.853620 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:15:54.866784 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m18:15:54.869332 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m18:15:54.871146 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2fc45688-206c-4f5f-9532-ef0203e53e9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c17c637cd40>]}
[0m18:15:54.871947 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.17s]
[0m18:15:54.872681 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:15:54.874168 [debug] [MainThread]: Using duckdb connection "master"
[0m18:15:54.874683 [debug] [MainThread]: On master: BEGIN
[0m18:15:54.875233 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:15:54.876532 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:15:54.877030 [debug] [MainThread]: On master: COMMIT
[0m18:15:54.877524 [debug] [MainThread]: Using duckdb connection "master"
[0m18:15:54.878159 [debug] [MainThread]: On master: COMMIT
[0m18:15:54.878830 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:15:54.879298 [debug] [MainThread]: On master: Close
[0m18:15:54.880135 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:15:54.880661 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m18:15:54.881234 [info ] [MainThread]: 
[0m18:15:54.882012 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m18:15:54.882852 [debug] [MainThread]: Command end result
[0m18:15:54.902182 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:15:54.903985 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:15:54.909803 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m18:15:54.910273 [info ] [MainThread]: 
[0m18:15:54.910796 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:15:54.911262 [info ] [MainThread]: 
[0m18:15:54.911729 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:15:54.912378 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:15:54.913451 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3762717, "process_in_blocks": "0", "process_kernel_time": 0.339289, "process_mem_max_rss": "279612", "process_out_blocks": "3104", "process_user_time": 4.28118}
[0m18:15:54.914055 [debug] [MainThread]: Command `dbt run` succeeded at 18:15:54.913949 after 2.38 seconds
[0m18:15:54.914530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c17d1f78d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c17c40fbe30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c17c6351550>]}
[0m18:15:54.915029 [debug] [MainThread]: Flushing usage events
[0m18:15:55.780841 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:16:11.633863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715e31e62f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715e327aacf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715e32452570>]}


============================== 18:16:11.637197 | 829220ad-5bb6-471d-b00e-3180b3755d8d ==============================
[0m18:16:11.637197 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:16:11.637907 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "1a1d437a-294d-43ed-872b-f01970cac71c", "ai_explanation": "Based on PCA factors, transaction exhibits suspiciously high V1 and low V2 values, indicating fraud."} --profiles-dir .', 'partial_parse': 'True', 'empty': 'False', 'profiles_dir': '.', 'introspect': 'True', 'quiet': 'False', 'log_format': 'default', 'printer_width': '80', 'log_cache_events': 'False', 'use_colors': 'True', 'target_path': 'None', 'indirect_selection': 'eager', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'no_print': 'None', 'fail_fast': 'False', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'debug': 'False', 'static_parser': 'True', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'use_experimental_parser': 'False'}
[0m18:16:11.884711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '829220ad-5bb6-471d-b00e-3180b3755d8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715e31d4a6c0>]}
[0m18:16:11.955895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '829220ad-5bb6-471d-b00e-3180b3755d8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715e347c2ff0>]}
[0m18:16:11.957621 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:16:12.041344 [debug] [MainThread]: checksum: 7c6598f89c1d4aa79b652e803379cbd48d8e2e1d89035d9c32adec0877ecfa93, vars: {'ai_explanation': 'Based on PCA factors, transaction exhibits suspiciously '
                   'high V1 and low V2 values, indicating fraud.',
 'txn_id': '1a1d437a-294d-43ed-872b-f01970cac71c'}, profile: , target: , version: 1.11.2
[0m18:16:12.134015 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:16:12.134628 [debug] [MainThread]: previous checksum: 7c6598f89c1d4aa79b652e803379cbd48d8e2e1d89035d9c32adec0877ecfa93, current checksum: fa7d336dfb28616aa981b3b412eb436d2de44dc495de4d526c20aa7fd283274a
[0m18:16:12.135166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '829220ad-5bb6-471d-b00e-3180b3755d8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715e32552ae0>]}
[0m18:16:13.377409 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m18:16:13.378145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '829220ad-5bb6-471d-b00e-3180b3755d8d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715e31d49070>]}
[0m18:16:13.472365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '829220ad-5bb6-471d-b00e-3180b3755d8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715e31e208c0>]}
[0m18:16:13.543172 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:16:13.545000 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:16:13.557443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '829220ad-5bb6-471d-b00e-3180b3755d8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715e241cade0>]}
[0m18:16:13.558019 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m18:16:13.558497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '829220ad-5bb6-471d-b00e-3180b3755d8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715e31c2a030>]}
[0m18:16:13.560253 [info ] [MainThread]: 
[0m18:16:13.560755 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:16:13.561212 [info ] [MainThread]: 
[0m18:16:13.561832 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:16:13.562833 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m18:16:13.597996 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m18:16:13.598480 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m18:16:13.598935 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:16:13.684094 [debug] [ThreadPool]: SQL status: OK in 0.085 seconds
[0m18:16:13.685751 [debug] [ThreadPool]: On list_argus_vault: Close
[0m18:16:13.686618 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m18:16:13.687287 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m18:16:13.694659 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:16:13.695150 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m18:16:13.695574 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:16:13.696989 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:16:13.698314 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:16:13.698752 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m18:16:13.699386 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:16:13.699814 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:16:13.700248 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m18:16:13.700981 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:16:13.701893 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:16:13.702356 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:16:13.702763 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:16:13.703374 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:16:13.703808 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m18:16:13.709385 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m18:16:13.715249 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:16:13.715788 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m18:16:13.716223 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:16:13.717382 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:16:13.717817 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:16:13.718262 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m18:16:13.729173 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m18:16:13.730624 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m18:16:13.731894 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m18:16:13.732347 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m18:16:13.734033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '829220ad-5bb6-471d-b00e-3180b3755d8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715e241cade0>]}
[0m18:16:13.734643 [debug] [MainThread]: Using duckdb connection "master"
[0m18:16:13.735126 [debug] [MainThread]: On master: BEGIN
[0m18:16:13.735527 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:16:13.736453 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:16:13.736893 [debug] [MainThread]: On master: COMMIT
[0m18:16:13.737361 [debug] [MainThread]: Using duckdb connection "master"
[0m18:16:13.737765 [debug] [MainThread]: On master: COMMIT
[0m18:16:13.738422 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:16:13.738853 [debug] [MainThread]: On master: Close
[0m18:16:13.740936 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:16:13.741573 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m18:16:13.742151 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m18:16:13.742625 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m18:16:13.750813 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:16:13.751580 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m18:16:13.808414 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:16:13.808992 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201181613783884"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Based on PCA factors, transaction exhibits suspiciously high V1 and low V2 values, indicating fraud.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '1a1d437a-294d-43ed-872b-f01970cac71c'
    );
  
  
  
[0m18:16:13.809494 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:16:13.818426 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m18:16:13.826313 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:16:13.826825 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m18:16:13.827525 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:16:13.828020 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:16:13.828499 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201181613783884'
      
      
      order by ordinal_position

  
[0m18:16:13.831274 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:16:13.836340 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:16:13.836849 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:16:13.839352 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:16:13.849645 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:16:13.850187 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:16:13.852623 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:16:13.854147 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:16:13.854647 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m18:16:13.855439 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:16:13.871835 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:16:13.872625 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:16:13.873136 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201181613783884"
    )
  
[0m18:16:13.874255 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:16:13.884732 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:16:13.885272 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:16:13.885742 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:16:13.900705 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m18:16:13.902798 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m18:16:13.904525 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '829220ad-5bb6-471d-b00e-3180b3755d8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715e25d5f1d0>]}
[0m18:16:13.905301 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m18:16:13.906044 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:16:13.907454 [debug] [MainThread]: Using duckdb connection "master"
[0m18:16:13.907950 [debug] [MainThread]: On master: BEGIN
[0m18:16:13.908375 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:16:13.909331 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:16:13.909777 [debug] [MainThread]: On master: COMMIT
[0m18:16:13.910233 [debug] [MainThread]: Using duckdb connection "master"
[0m18:16:13.910640 [debug] [MainThread]: On master: COMMIT
[0m18:16:13.911295 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:16:13.911727 [debug] [MainThread]: On master: Close
[0m18:16:13.912254 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:16:13.912655 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m18:16:13.913101 [info ] [MainThread]: 
[0m18:16:13.913558 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m18:16:13.914358 [debug] [MainThread]: Command end result
[0m18:16:13.933308 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:16:13.934928 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:16:13.940590 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m18:16:13.941053 [info ] [MainThread]: 
[0m18:16:13.941573 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:16:13.942043 [info ] [MainThread]: 
[0m18:16:13.942513 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:16:13.943154 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:16:13.944225 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3727608, "process_in_blocks": "0", "process_kernel_time": 0.302086, "process_mem_max_rss": "275188", "process_out_blocks": "3120", "process_user_time": 4.324297}
[0m18:16:13.944808 [debug] [MainThread]: Command `dbt run` succeeded at 18:16:13.944706 after 2.37 seconds
[0m18:16:13.945306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715e32a7e630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715e31d22f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715e32c70e30>]}
[0m18:16:13.945791 [debug] [MainThread]: Flushing usage events
[0m18:16:14.845228 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:16:31.033464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71fda2175d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71fda2a26ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71fda2a26db0>]}


============================== 18:16:31.036857 | 8117648c-de50-463d-b0e2-406b80608abc ==============================
[0m18:16:31.036857 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:16:31.037577 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '.', 'debug': 'False', 'partial_parse': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'empty': 'False', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "82bebf47-270f-4831-90c2-b57e91ce9cb2", "ai_explanation": "Based on PCA factors, this transaction exhibits significant outliers in dimensions V7 and V17, indicating fraud."} --profiles-dir .', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_cache_events': 'False', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'write_json': 'True', 'warn_error': 'None', 'static_parser': 'True', 'introspect': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'log_format': 'default', 'target_path': 'None'}
[0m18:16:31.297049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8117648c-de50-463d-b0e2-406b80608abc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71fda1a5ede0>]}
[0m18:16:31.368685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8117648c-de50-463d-b0e2-406b80608abc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71fda43617c0>]}
[0m18:16:31.370436 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:16:31.457069 [debug] [MainThread]: checksum: c4ee0483d97d8b4e5c254ddaae2f7c61895767bcc1fc5faec548fcbe90926390, vars: {'ai_explanation': 'Based on PCA factors, this transaction exhibits '
                   'significant outliers in dimensions V7 and V17, indicating '
                   'fraud.',
 'txn_id': '82bebf47-270f-4831-90c2-b57e91ce9cb2'}, profile: , target: , version: 1.11.2
[0m18:16:31.558132 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:16:31.558742 [debug] [MainThread]: previous checksum: c4ee0483d97d8b4e5c254ddaae2f7c61895767bcc1fc5faec548fcbe90926390, current checksum: 7c6598f89c1d4aa79b652e803379cbd48d8e2e1d89035d9c32adec0877ecfa93
[0m18:16:31.559245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8117648c-de50-463d-b0e2-406b80608abc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71fda2142960>]}
[0m18:16:32.787846 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m18:16:32.788530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8117648c-de50-463d-b0e2-406b80608abc', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71fd95a769f0>]}
[0m18:16:32.885084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8117648c-de50-463d-b0e2-406b80608abc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71fda183e4b0>]}
[0m18:16:32.955089 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:16:32.956899 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:16:32.969420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8117648c-de50-463d-b0e2-406b80608abc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71fd94118620>]}
[0m18:16:32.970012 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m18:16:32.970498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8117648c-de50-463d-b0e2-406b80608abc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71fd959738c0>]}
[0m18:16:32.972302 [info ] [MainThread]: 
[0m18:16:32.972808 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:16:32.973262 [info ] [MainThread]: 
[0m18:16:32.973875 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:16:32.974969 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m18:16:33.010345 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m18:16:33.010847 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m18:16:33.011300 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:16:33.098892 [debug] [ThreadPool]: SQL status: OK in 0.087 seconds
[0m18:16:33.100835 [debug] [ThreadPool]: On list_argus_vault: Close
[0m18:16:33.102222 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m18:16:33.103144 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m18:16:33.111316 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:16:33.111788 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m18:16:33.112245 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:16:33.114101 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m18:16:33.115498 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:16:33.115968 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m18:16:33.116592 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:16:33.117045 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:16:33.117452 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m18:16:33.118137 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:16:33.119094 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:16:33.119539 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:16:33.119979 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:16:33.120568 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:16:33.121026 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m18:16:33.126771 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m18:16:33.132777 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:16:33.133389 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m18:16:33.133837 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:16:33.134812 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:16:33.135302 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:16:33.135775 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m18:16:33.146758 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m18:16:33.148339 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m18:16:33.149663 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m18:16:33.150154 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m18:16:33.151744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8117648c-de50-463d-b0e2-406b80608abc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71fd941ba9f0>]}
[0m18:16:33.152386 [debug] [MainThread]: Using duckdb connection "master"
[0m18:16:33.152837 [debug] [MainThread]: On master: BEGIN
[0m18:16:33.153307 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:16:33.154259 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:16:33.154713 [debug] [MainThread]: On master: COMMIT
[0m18:16:33.155203 [debug] [MainThread]: Using duckdb connection "master"
[0m18:16:33.155630 [debug] [MainThread]: On master: COMMIT
[0m18:16:33.156279 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:16:33.156725 [debug] [MainThread]: On master: Close
[0m18:16:33.158800 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:16:33.159508 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m18:16:33.160152 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m18:16:33.160643 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m18:16:33.168885 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:16:33.169638 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m18:16:33.226482 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:16:33.227083 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201181633202141"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Based on PCA factors, this transaction exhibits significant outliers in dimensions V7 and V17, indicating fraud.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '82bebf47-270f-4831-90c2-b57e91ce9cb2'
    );
  
  
  
[0m18:16:33.227585 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:16:33.235832 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m18:16:33.243377 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:16:33.243884 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m18:16:33.244617 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:16:33.245134 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:16:33.245596 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201181633202141'
      
      
      order by ordinal_position

  
[0m18:16:33.248270 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:16:33.253249 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:16:33.253766 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:16:33.256316 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:16:33.266425 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:16:33.266963 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:16:33.269980 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:16:33.271506 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:16:33.272067 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m18:16:33.272834 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:16:33.289583 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:16:33.290424 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:16:33.290946 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201181633202141"
    )
  
[0m18:16:33.292255 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:16:33.302986 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:16:33.303503 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:16:33.304012 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:16:33.319077 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m18:16:33.321099 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m18:16:33.322846 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8117648c-de50-463d-b0e2-406b80608abc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71fda2a27e00>]}
[0m18:16:33.323637 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m18:16:33.324423 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:16:33.325859 [debug] [MainThread]: Using duckdb connection "master"
[0m18:16:33.326446 [debug] [MainThread]: On master: BEGIN
[0m18:16:33.326952 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:16:33.328372 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:16:33.328825 [debug] [MainThread]: On master: COMMIT
[0m18:16:33.329281 [debug] [MainThread]: Using duckdb connection "master"
[0m18:16:33.329819 [debug] [MainThread]: On master: COMMIT
[0m18:16:33.330472 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:16:33.330929 [debug] [MainThread]: On master: Close
[0m18:16:33.331435 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:16:33.331832 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m18:16:33.332277 [info ] [MainThread]: 
[0m18:16:33.332732 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m18:16:33.333526 [debug] [MainThread]: Command end result
[0m18:16:33.352688 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:16:33.354342 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:16:33.360047 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m18:16:33.360497 [info ] [MainThread]: 
[0m18:16:33.361030 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:16:33.361482 [info ] [MainThread]: 
[0m18:16:33.362145 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:16:33.362800 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:16:33.363855 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3938615, "process_in_blocks": "0", "process_kernel_time": 0.290044, "process_mem_max_rss": "279316", "process_out_blocks": "3104", "process_user_time": 4.340739}
[0m18:16:33.364489 [debug] [MainThread]: Command `dbt run` succeeded at 18:16:33.364386 after 2.39 seconds
[0m18:16:33.364979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71fda4866030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71fd94023f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71fd959c87a0>]}
[0m18:16:33.365465 [debug] [MainThread]: Flushing usage events
[0m18:16:34.313845 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:16:49.542452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e092832ae10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e0928ce1970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e0928ce2000>]}


============================== 18:16:49.545791 | d2cb20ab-ac83-42d0-b230-43fb59ed9b92 ==============================
[0m18:16:49.545791 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:16:49.546478 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'quiet': 'False', 'version_check': 'True', 'log_format': 'default', 'write_json': 'True', 'profiles_dir': '.', 'static_parser': 'True', 'printer_width': '80', 'debug': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "a4d351a1-3b85-4f06-bff8-1e4825f3b341", "ai_explanation": "Fraudulent transaction based on PCA factors: outlier scores across multiple dimensions."} --profiles-dir .', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False'}
[0m18:16:49.812031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd2cb20ab-ac83-42d0-b230-43fb59ed9b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e09277ac6b0>]}
[0m18:16:49.883542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd2cb20ab-ac83-42d0-b230-43fb59ed9b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e092779bc80>]}
[0m18:16:49.885398 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:16:49.970901 [debug] [MainThread]: checksum: 7da3bf322460420a3aaf3c299b52d040db6cf6111e09ceaf1e036e2c1659580e, vars: {'ai_explanation': 'Fraudulent transaction based on PCA factors: outlier '
                   'scores across multiple dimensions.',
 'txn_id': 'a4d351a1-3b85-4f06-bff8-1e4825f3b341'}, profile: , target: , version: 1.11.2
[0m18:16:50.062689 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:16:50.063313 [debug] [MainThread]: previous checksum: 7da3bf322460420a3aaf3c299b52d040db6cf6111e09ceaf1e036e2c1659580e, current checksum: c4ee0483d97d8b4e5c254ddaae2f7c61895767bcc1fc5faec548fcbe90926390
[0m18:16:50.063765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd2cb20ab-ac83-42d0-b230-43fb59ed9b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e092832a840>]}
[0m18:16:51.295427 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m18:16:51.296133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd2cb20ab-ac83-42d0-b230-43fb59ed9b92', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e091bd30230>]}
[0m18:16:51.387829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd2cb20ab-ac83-42d0-b230-43fb59ed9b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e0927926a50>]}
[0m18:16:51.456836 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:16:51.458610 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:16:51.470795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd2cb20ab-ac83-42d0-b230-43fb59ed9b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e091bb9ac90>]}
[0m18:16:51.471364 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m18:16:51.471826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2cb20ab-ac83-42d0-b230-43fb59ed9b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e091b9bd400>]}
[0m18:16:51.473564 [info ] [MainThread]: 
[0m18:16:51.474072 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:16:51.474497 [info ] [MainThread]: 
[0m18:16:51.475112 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:16:51.476183 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m18:16:51.511270 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m18:16:51.511758 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m18:16:51.512224 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:16:51.600050 [debug] [ThreadPool]: SQL status: OK in 0.088 seconds
[0m18:16:51.601678 [debug] [ThreadPool]: On list_argus_vault: Close
[0m18:16:51.602601 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m18:16:51.603196 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m18:16:51.610465 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:16:51.610951 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m18:16:51.611372 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:16:51.612793 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:16:51.614115 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:16:51.614546 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m18:16:51.615167 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:16:51.615588 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:16:51.616018 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m18:16:51.616647 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:16:51.617562 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:16:51.618018 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:16:51.618420 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:16:51.619030 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:16:51.619463 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m18:16:51.625007 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m18:16:51.630784 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:16:51.631332 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m18:16:51.631730 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:16:51.632626 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:16:51.633083 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:16:51.633496 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m18:16:51.644338 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m18:16:51.645723 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m18:16:51.647013 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m18:16:51.647454 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m18:16:51.648969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2cb20ab-ac83-42d0-b230-43fb59ed9b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e08c3716540>]}
[0m18:16:51.649566 [debug] [MainThread]: Using duckdb connection "master"
[0m18:16:51.649997 [debug] [MainThread]: On master: BEGIN
[0m18:16:51.650397 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:16:51.651276 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:16:51.651711 [debug] [MainThread]: On master: COMMIT
[0m18:16:51.652141 [debug] [MainThread]: Using duckdb connection "master"
[0m18:16:51.652538 [debug] [MainThread]: On master: COMMIT
[0m18:16:51.653164 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:16:51.653594 [debug] [MainThread]: On master: Close
[0m18:16:51.655594 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:16:51.656322 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m18:16:51.656952 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m18:16:51.657462 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m18:16:51.665326 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:16:51.666044 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m18:16:51.721464 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:16:51.722053 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201181651697463"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Fraudulent transaction based on PCA factors: outlier scores across multiple dimensions.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = 'a4d351a1-3b85-4f06-bff8-1e4825f3b341'
    );
  
  
  
[0m18:16:51.722547 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:16:51.731166 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m18:16:51.740597 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:16:51.741130 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m18:16:51.741806 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:16:51.742310 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:16:51.742773 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201181651697463'
      
      
      order by ordinal_position

  
[0m18:16:51.745904 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:16:51.751242 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:16:51.751748 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:16:51.754988 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:16:51.765069 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:16:51.765582 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:16:51.768086 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:16:51.769578 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:16:51.770090 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m18:16:51.770875 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:16:51.787228 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:16:51.788021 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:16:51.788521 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201181651697463"
    )
  
[0m18:16:51.789700 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:16:51.799988 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:16:51.800492 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:16:51.800968 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:16:51.804837 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:16:51.806890 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m18:16:51.808602 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2cb20ab-ac83-42d0-b230-43fb59ed9b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e091b932e40>]}
[0m18:16:51.809374 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.15s]
[0m18:16:51.810100 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:16:51.812038 [debug] [MainThread]: Using duckdb connection "master"
[0m18:16:51.812690 [debug] [MainThread]: On master: BEGIN
[0m18:16:51.813151 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:16:51.814104 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:16:51.814551 [debug] [MainThread]: On master: COMMIT
[0m18:16:51.814980 [debug] [MainThread]: Using duckdb connection "master"
[0m18:16:51.815379 [debug] [MainThread]: On master: COMMIT
[0m18:16:51.816039 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:16:51.816472 [debug] [MainThread]: On master: Close
[0m18:16:51.816985 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:16:51.817384 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m18:16:51.817796 [info ] [MainThread]: 
[0m18:16:51.818260 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m18:16:51.819031 [debug] [MainThread]: Command end result
[0m18:16:51.838132 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:16:51.839794 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:16:51.845448 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m18:16:51.845890 [info ] [MainThread]: 
[0m18:16:51.846423 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:16:51.846856 [info ] [MainThread]: 
[0m18:16:51.847362 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:16:51.847997 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:16:51.849049 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.369202, "process_in_blocks": "0", "process_kernel_time": 0.284457, "process_mem_max_rss": "277368", "process_out_blocks": "3112", "process_user_time": 4.318404}
[0m18:16:51.849627 [debug] [MainThread]: Command `dbt run` succeeded at 18:16:51.849525 after 2.37 seconds
[0m18:16:51.850119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e0927e9aea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e091bd537a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e0928851d90>]}
[0m18:16:51.850596 [debug] [MainThread]: Flushing usage events
[0m18:16:52.878877 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:17:09.003270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71905a369d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71905a056db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71905a4fd610>]}


============================== 18:17:09.006662 | b2644311-2169-4cb5-99c6-7fed78dfee45 ==============================
[0m18:17:09.006662 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:17:09.007356 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'profiles_dir': '.', 'target_path': 'None', 'quiet': 'False', 'static_parser': 'True', 'version_check': 'True', 'indirect_selection': 'eager', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'write_json': 'True', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "228861af-2e01-4df8-9aa0-6415d9c16be7", "ai_explanation": "Unusually high V4 score and outlier values in V12 and V17 indicate potential fraud."} --profiles-dir .', 'no_print': 'None', 'use_colors': 'True', 'printer_width': '80', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'debug': 'False', 'warn_error': 'None', 'log_cache_events': 'False'}
[0m18:17:09.254262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b2644311-2169-4cb5-99c6-7fed78dfee45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719059bdeb70>]}
[0m18:17:09.324795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b2644311-2169-4cb5-99c6-7fed78dfee45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719059e41a30>]}
[0m18:17:09.326534 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:17:09.411952 [debug] [MainThread]: checksum: c8d98910a232c57b56706012165e7128e721314efa24c749ecd246b39b54d44f, vars: {'ai_explanation': 'Unusually high V4 score and outlier values in V12 and V17 '
                   'indicate potential fraud.',
 'txn_id': '228861af-2e01-4df8-9aa0-6415d9c16be7'}, profile: , target: , version: 1.11.2
[0m18:17:09.504322 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:17:09.504941 [debug] [MainThread]: previous checksum: c8d98910a232c57b56706012165e7128e721314efa24c749ecd246b39b54d44f, current checksum: 7da3bf322460420a3aaf3c299b52d040db6cf6111e09ceaf1e036e2c1659580e
[0m18:17:09.505416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b2644311-2169-4cb5-99c6-7fed78dfee45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71905a52e810>]}
[0m18:17:10.725903 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m18:17:10.726601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b2644311-2169-4cb5-99c6-7fed78dfee45', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71904db32990>]}
[0m18:17:10.817876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b2644311-2169-4cb5-99c6-7fed78dfee45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71904db8b380>]}
[0m18:17:10.886775 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:17:10.888499 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:17:10.900746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b2644311-2169-4cb5-99c6-7fed78dfee45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71904c031640>]}
[0m18:17:10.901340 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m18:17:10.901809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2644311-2169-4cb5-99c6-7fed78dfee45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71904c1cbda0>]}
[0m18:17:10.903555 [info ] [MainThread]: 
[0m18:17:10.904078 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:17:10.904521 [info ] [MainThread]: 
[0m18:17:10.905138 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:17:10.906153 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m18:17:10.941661 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m18:17:10.942181 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m18:17:10.942628 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:17:11.026783 [debug] [ThreadPool]: SQL status: OK in 0.084 seconds
[0m18:17:11.028478 [debug] [ThreadPool]: On list_argus_vault: Close
[0m18:17:11.029391 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m18:17:11.030010 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m18:17:11.037287 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:17:11.037758 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m18:17:11.038203 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:17:11.039325 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:17:11.040616 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:17:11.041067 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m18:17:11.041717 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:17:11.042168 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:17:11.042573 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m18:17:11.043285 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:17:11.044219 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:17:11.044672 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:17:11.045103 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:17:11.045760 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:17:11.046221 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m18:17:11.051786 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m18:17:11.057778 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:17:11.058340 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m18:17:11.058749 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:17:11.059655 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:17:11.060117 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:17:11.060540 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m18:17:11.071974 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m18:17:11.073516 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m18:17:11.074810 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m18:17:11.075286 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m18:17:11.076969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2644311-2169-4cb5-99c6-7fed78dfee45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71904c01c7a0>]}
[0m18:17:11.077587 [debug] [MainThread]: Using duckdb connection "master"
[0m18:17:11.078036 [debug] [MainThread]: On master: BEGIN
[0m18:17:11.078446 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:17:11.079317 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:17:11.079761 [debug] [MainThread]: On master: COMMIT
[0m18:17:11.080205 [debug] [MainThread]: Using duckdb connection "master"
[0m18:17:11.080606 [debug] [MainThread]: On master: COMMIT
[0m18:17:11.081238 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:17:11.081680 [debug] [MainThread]: On master: Close
[0m18:17:11.083737 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:17:11.084438 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m18:17:11.085038 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m18:17:11.085521 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m18:17:11.093791 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:17:11.094539 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m18:17:11.151623 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:17:11.152204 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201181711127006"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Unusually high V4 score and outlier values in V12 and V17 indicate potential fraud.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '228861af-2e01-4df8-9aa0-6415d9c16be7'
    );
  
  
  
[0m18:17:11.152691 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:17:11.160667 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m18:17:11.168182 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:17:11.168677 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m18:17:11.169372 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:17:11.169844 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:17:11.170334 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201181711127006'
      
      
      order by ordinal_position

  
[0m18:17:11.173058 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:17:11.178022 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:17:11.178533 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:17:11.181329 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:17:11.191401 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:17:11.191935 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:17:11.194734 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:17:11.196258 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:17:11.196766 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m18:17:11.197534 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:17:11.213856 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:17:11.214654 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:17:11.215175 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201181711127006"
    )
  
[0m18:17:11.216628 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:17:11.227156 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:17:11.227663 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:17:11.228145 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:17:11.242159 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m18:17:11.244158 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m18:17:11.245873 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2644311-2169-4cb5-99c6-7fed78dfee45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71903ceca600>]}
[0m18:17:11.246645 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m18:17:11.247378 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:17:11.249304 [debug] [MainThread]: Using duckdb connection "master"
[0m18:17:11.249810 [debug] [MainThread]: On master: BEGIN
[0m18:17:11.250301 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:17:11.251355 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:17:11.251799 [debug] [MainThread]: On master: COMMIT
[0m18:17:11.252243 [debug] [MainThread]: Using duckdb connection "master"
[0m18:17:11.252646 [debug] [MainThread]: On master: COMMIT
[0m18:17:11.253274 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:17:11.253709 [debug] [MainThread]: On master: Close
[0m18:17:11.254234 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:17:11.254633 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m18:17:11.255083 [info ] [MainThread]: 
[0m18:17:11.255534 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m18:17:11.256322 [debug] [MainThread]: Command end result
[0m18:17:11.275339 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:17:11.276991 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:17:11.282611 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m18:17:11.283067 [info ] [MainThread]: 
[0m18:17:11.283576 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:17:11.284031 [info ] [MainThread]: 
[0m18:17:11.284490 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:17:11.285118 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:17:11.286174 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.345335, "process_in_blocks": "0", "process_kernel_time": 0.28901, "process_mem_max_rss": "278160", "process_out_blocks": "3104", "process_user_time": 4.276555}
[0m18:17:11.286755 [debug] [MainThread]: Command `dbt run` succeeded at 18:17:11.286652 after 2.35 seconds
[0m18:17:11.287264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71905a18f3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71905a4fd310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719059afe000>]}
[0m18:17:11.287751 [debug] [MainThread]: Flushing usage events
[0m18:17:12.286974 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:17:27.641660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752d05ec06e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752d06916a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752d05907fb0>]}


============================== 18:17:27.644991 | 4b191b6a-21de-4225-b93f-be514959527e ==============================
[0m18:17:27.644991 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:17:27.645653 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'version_check': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'write_json': 'True', 'printer_width': '80', 'use_experimental_parser': 'False', 'warn_error': 'None', 'cache_selected_only': 'False', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'empty': 'False', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "d050dc5a-1d0c-4160-b2bd-fd609c72d384", "ai_explanation": "Based on PCA factors, transaction exhibits anomalous patterns indicating potential fraud."} --profiles-dir .', 'partial_parse': 'True', 'fail_fast': 'False', 'static_parser': 'True', 'introspect': 'True', 'use_colors': 'True', 'no_print': 'None', 'profiles_dir': '.', 'debug': 'False'}
[0m18:17:27.901993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b191b6a-21de-4225-b93f-be514959527e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752d05725b20>]}
[0m18:17:27.972381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b191b6a-21de-4225-b93f-be514959527e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752d06517b30>]}
[0m18:17:27.974146 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:17:28.058050 [debug] [MainThread]: checksum: fb2e8e1ae147f275f106238f7de7fcf8f7215fcb33bf1effbdcc6acfb1a867d3, vars: {'ai_explanation': 'Based on PCA factors, transaction exhibits anomalous '
                   'patterns indicating potential fraud.',
 'txn_id': 'd050dc5a-1d0c-4160-b2bd-fd609c72d384'}, profile: , target: , version: 1.11.2
[0m18:17:28.155498 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:17:28.156120 [debug] [MainThread]: previous checksum: fb2e8e1ae147f275f106238f7de7fcf8f7215fcb33bf1effbdcc6acfb1a867d3, current checksum: c8d98910a232c57b56706012165e7128e721314efa24c749ecd246b39b54d44f
[0m18:17:28.156578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4b191b6a-21de-4225-b93f-be514959527e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752d05e56ae0>]}
[0m18:17:29.382713 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m18:17:29.383384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4b191b6a-21de-4225-b93f-be514959527e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752cf81ca7e0>]}
[0m18:17:29.474198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b191b6a-21de-4225-b93f-be514959527e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752cf80ed040>]}
[0m18:17:29.542471 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:17:29.544149 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:17:29.556248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b191b6a-21de-4225-b93f-be514959527e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752cd9527e60>]}
[0m18:17:29.556779 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m18:17:29.557307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b191b6a-21de-4225-b93f-be514959527e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752cf802c710>]}
[0m18:17:29.559041 [info ] [MainThread]: 
[0m18:17:29.559541 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:17:29.559985 [info ] [MainThread]: 
[0m18:17:29.560593 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:17:29.561594 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m18:17:29.596320 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m18:17:29.596800 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m18:17:29.597272 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:17:29.686875 [debug] [ThreadPool]: SQL status: OK in 0.089 seconds
[0m18:17:29.688589 [debug] [ThreadPool]: On list_argus_vault: Close
[0m18:17:29.689469 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m18:17:29.690054 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m18:17:29.697493 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:17:29.697993 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m18:17:29.698421 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:17:29.699572 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:17:29.700882 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:17:29.701342 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m18:17:29.701963 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:17:29.702388 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:17:29.702796 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m18:17:29.703510 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:17:29.704464 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:17:29.704928 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:17:29.705353 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:17:29.705965 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:17:29.706400 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m18:17:29.711878 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m18:17:29.717621 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:17:29.718185 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m18:17:29.718595 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:17:29.719505 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:17:29.719975 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:17:29.720407 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m18:17:29.731327 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m18:17:29.732752 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m18:17:29.734017 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m18:17:29.734455 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m18:17:29.736084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b191b6a-21de-4225-b93f-be514959527e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752cf80cd340>]}
[0m18:17:29.736680 [debug] [MainThread]: Using duckdb connection "master"
[0m18:17:29.737131 [debug] [MainThread]: On master: BEGIN
[0m18:17:29.737529 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:17:29.738441 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:17:29.738876 [debug] [MainThread]: On master: COMMIT
[0m18:17:29.739321 [debug] [MainThread]: Using duckdb connection "master"
[0m18:17:29.739722 [debug] [MainThread]: On master: COMMIT
[0m18:17:29.740395 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:17:29.740824 [debug] [MainThread]: On master: Close
[0m18:17:29.742824 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:17:29.743515 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m18:17:29.744119 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m18:17:29.744609 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m18:17:29.752470 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:17:29.753198 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m18:17:29.809505 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:17:29.810100 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201181729785067"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Based on PCA factors, transaction exhibits anomalous patterns indicating potential fraud.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = 'd050dc5a-1d0c-4160-b2bd-fd609c72d384'
    );
  
  
  
[0m18:17:29.810599 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:17:29.819336 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m18:17:29.827283 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:17:29.827798 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m18:17:29.828516 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:17:29.829014 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:17:29.829488 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201181729785067'
      
      
      order by ordinal_position

  
[0m18:17:29.832673 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:17:29.837711 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:17:29.838251 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:17:29.841069 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:17:29.851084 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:17:29.851616 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:17:29.854294 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:17:29.855808 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:17:29.856337 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m18:17:29.857094 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:17:29.873484 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:17:29.874288 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:17:29.874793 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201181729785067"
    )
  
[0m18:17:29.876018 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:17:29.886453 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:17:29.887024 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:17:29.887496 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:17:29.901448 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m18:17:29.903458 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m18:17:29.905175 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b191b6a-21de-4225-b93f-be514959527e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752cf8170a10>]}
[0m18:17:29.905946 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m18:17:29.906673 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:17:29.908152 [debug] [MainThread]: Using duckdb connection "master"
[0m18:17:29.908639 [debug] [MainThread]: On master: BEGIN
[0m18:17:29.909121 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:17:29.910237 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:17:29.910678 [debug] [MainThread]: On master: COMMIT
[0m18:17:29.911133 [debug] [MainThread]: Using duckdb connection "master"
[0m18:17:29.911538 [debug] [MainThread]: On master: COMMIT
[0m18:17:29.912183 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:17:29.912622 [debug] [MainThread]: On master: Close
[0m18:17:29.913163 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:17:29.913567 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m18:17:29.914003 [info ] [MainThread]: 
[0m18:17:29.914501 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m18:17:29.915321 [debug] [MainThread]: Command end result
[0m18:17:29.935101 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:17:29.936789 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:17:29.942454 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m18:17:29.942893 [info ] [MainThread]: 
[0m18:17:29.943476 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:17:29.943963 [info ] [MainThread]: 
[0m18:17:29.944470 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:17:29.945154 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:17:29.946287 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3666322, "process_in_blocks": "0", "process_kernel_time": 0.303966, "process_mem_max_rss": "275784", "process_out_blocks": "3112", "process_user_time": 4.322083}
[0m18:17:29.946864 [debug] [MainThread]: Command `dbt run` succeeded at 18:17:29.946762 after 2.37 seconds
[0m18:17:29.947367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752d05802360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752cf81953a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752d081bd550>]}
[0m18:17:29.947851 [debug] [MainThread]: Flushing usage events
[0m18:17:30.972752 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:17:49.611468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770238b3da30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77023801a1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77023882e5a0>]}


============================== 18:17:49.614835 | 70bba0f5-248f-4e03-ace2-9440ab0081f3 ==============================
[0m18:17:49.614835 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:17:49.615516 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'version_check': 'True', 'printer_width': '80', 'warn_error': 'None', 'static_parser': 'True', 'debug': 'False', 'write_json': 'True', 'profiles_dir': '.', 'target_path': 'None', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "03493a62-adcc-40cf-b7d3-aa6ef823e9b8", "ai_explanation": "The txn is fraudulent due to extreme PCA values exceeding +3 standard deviations."} --profiles-dir .', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'quiet': 'False', 'log_cache_events': 'False', 'log_format': 'default', 'cache_selected_only': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False'}
[0m18:17:49.863067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '70bba0f5-248f-4e03-ace2-9440ab0081f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77022bf57f80>]}
[0m18:17:49.933877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '70bba0f5-248f-4e03-ace2-9440ab0081f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7702380b27e0>]}
[0m18:17:49.935632 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:17:50.021317 [debug] [MainThread]: checksum: fa08ec86423ec084161a16633296c9d5236fa3a9ad02586d9a16865f21dcfea5, vars: {'ai_explanation': 'The txn is fraudulent due to extreme PCA values exceeding '
                   '+3 standard deviations.',
 'txn_id': '03493a62-adcc-40cf-b7d3-aa6ef823e9b8'}, profile: , target: , version: 1.11.2
[0m18:17:50.114202 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:17:50.114807 [debug] [MainThread]: previous checksum: fa08ec86423ec084161a16633296c9d5236fa3a9ad02586d9a16865f21dcfea5, current checksum: fb2e8e1ae147f275f106238f7de7fcf8f7215fcb33bf1effbdcc6acfb1a867d3
[0m18:17:50.115282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '70bba0f5-248f-4e03-ace2-9440ab0081f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77022bcc61e0>]}
[0m18:17:51.365837 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m18:17:51.366530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '70bba0f5-248f-4e03-ace2-9440ab0081f3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770237c00650>]}
[0m18:17:51.467173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '70bba0f5-248f-4e03-ace2-9440ab0081f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7701eb9f4ce0>]}
[0m18:17:51.542903 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:17:51.544670 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:17:51.556829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '70bba0f5-248f-4e03-ace2-9440ab0081f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770229b9e930>]}
[0m18:17:51.557400 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m18:17:51.557863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70bba0f5-248f-4e03-ace2-9440ab0081f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770229b39910>]}
[0m18:17:51.559602 [info ] [MainThread]: 
[0m18:17:51.560106 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:17:51.560535 [info ] [MainThread]: 
[0m18:17:51.561144 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:17:51.562190 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m18:17:51.597462 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m18:17:51.598007 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m18:17:51.598437 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:17:51.692267 [debug] [ThreadPool]: SQL status: OK in 0.094 seconds
[0m18:17:51.693988 [debug] [ThreadPool]: On list_argus_vault: Close
[0m18:17:51.694875 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m18:17:51.695511 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m18:17:51.703201 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:17:51.703676 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m18:17:51.704154 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:17:51.705545 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:17:51.706905 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:17:51.707382 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m18:17:51.708002 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:17:51.708433 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:17:51.708835 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m18:17:51.709773 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:17:51.710722 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:17:51.711200 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:17:51.711602 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:17:51.712305 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:17:51.712740 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m18:17:51.719403 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m18:17:51.725327 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:17:51.725868 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m18:17:51.726312 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:17:51.727520 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:17:51.728041 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:17:51.728486 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m18:17:51.739558 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m18:17:51.741041 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m18:17:51.742318 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m18:17:51.742759 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m18:17:51.744427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70bba0f5-248f-4e03-ace2-9440ab0081f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7701eb92ee70>]}
[0m18:17:51.745063 [debug] [MainThread]: Using duckdb connection "master"
[0m18:17:51.745494 [debug] [MainThread]: On master: BEGIN
[0m18:17:51.745898 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:17:51.746756 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:17:51.747214 [debug] [MainThread]: On master: COMMIT
[0m18:17:51.747628 [debug] [MainThread]: Using duckdb connection "master"
[0m18:17:51.748052 [debug] [MainThread]: On master: COMMIT
[0m18:17:51.748646 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:17:51.749121 [debug] [MainThread]: On master: Close
[0m18:17:51.751184 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:17:51.751802 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m18:17:51.752439 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m18:17:51.752938 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m18:17:51.761138 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:17:51.761851 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m18:17:51.819413 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:17:51.820021 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201181751794612"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'The txn is fraudulent due to extreme PCA values exceeding +3 standard deviations.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '03493a62-adcc-40cf-b7d3-aa6ef823e9b8'
    );
  
  
  
[0m18:17:51.820521 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:17:51.829380 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m18:17:51.837229 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:17:51.837740 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m18:17:51.838462 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:17:51.838962 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:17:51.839436 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201181751794612'
      
      
      order by ordinal_position

  
[0m18:17:51.842271 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:17:51.847446 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:17:51.847998 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:17:51.850495 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:17:51.860784 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:17:51.861345 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:17:51.864378 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:17:51.865882 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:17:51.866421 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m18:17:51.867194 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:17:51.883845 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:17:51.884647 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:17:51.885199 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201181751794612"
    )
  
[0m18:17:51.886733 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:17:51.897465 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:17:51.898029 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:17:51.898504 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:17:51.913037 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m18:17:51.915043 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m18:17:51.916796 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70bba0f5-248f-4e03-ace2-9440ab0081f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770229b711c0>]}
[0m18:17:51.917592 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m18:17:51.918381 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:17:51.920147 [debug] [MainThread]: Using duckdb connection "master"
[0m18:17:51.920638 [debug] [MainThread]: On master: BEGIN
[0m18:17:51.921170 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:17:51.922305 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:17:51.922750 [debug] [MainThread]: On master: COMMIT
[0m18:17:51.923203 [debug] [MainThread]: Using duckdb connection "master"
[0m18:17:51.923605 [debug] [MainThread]: On master: COMMIT
[0m18:17:51.924372 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:17:51.924900 [debug] [MainThread]: On master: Close
[0m18:17:51.925461 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:17:51.925866 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m18:17:51.926331 [info ] [MainThread]: 
[0m18:17:51.926795 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m18:17:51.927599 [debug] [MainThread]: Command end result
[0m18:17:51.946263 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:17:51.947890 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:17:51.953546 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m18:17:51.954001 [info ] [MainThread]: 
[0m18:17:51.954518 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:17:51.954976 [info ] [MainThread]: 
[0m18:17:51.955447 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:17:51.956082 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:17:51.957136 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.408302, "process_in_blocks": "0", "process_kernel_time": 0.290146, "process_mem_max_rss": "280016", "process_out_blocks": "3112", "process_user_time": 4.352198}
[0m18:17:51.957716 [debug] [MainThread]: Command `dbt run` succeeded at 18:17:51.957615 after 2.41 seconds
[0m18:17:51.958456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7702381d6bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77023a605310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770238782570>]}
[0m18:17:51.959301 [debug] [MainThread]: Flushing usage events
[0m18:17:52.965844 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:18:09.324370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b05389d6540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0539572cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b053827d640>]}


============================== 18:18:09.327714 | d5f04913-0513-4c84-8330-6839616c9d96 ==============================
[0m18:18:09.327714 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:18:09.328475 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "e45c908b-1a6f-4c81-b8f3-0abc8aaa3418", "ai_explanation": "Based on PCA factors, this transaction is flagged as fraud due to significant outliers in V2 and V7."} --profiles-dir .', 'log_cache_events': 'False', 'debug': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'printer_width': '80', 'warn_error': 'None', 'partial_parse': 'True', 'quiet': 'False', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'write_json': 'True', 'profiles_dir': '.', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True'}
[0m18:18:09.578830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd5f04913-0513-4c84-8330-6839616c9d96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b052bf66a50>]}
[0m18:18:09.650514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd5f04913-0513-4c84-8330-6839616c9d96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b052bf53d40>]}
[0m18:18:09.652265 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:18:09.737293 [debug] [MainThread]: checksum: fcd63b374fca0ec5349f61fafc198ce8cdd1a3f9800b6170b564919c4dfb5af6, vars: {'ai_explanation': 'Based on PCA factors, this transaction is flagged as fraud '
                   'due to significant outliers in V2 and V7.',
 'txn_id': 'e45c908b-1a6f-4c81-b8f3-0abc8aaa3418'}, profile: , target: , version: 1.11.2
[0m18:18:09.831712 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:18:09.832362 [debug] [MainThread]: previous checksum: fcd63b374fca0ec5349f61fafc198ce8cdd1a3f9800b6170b564919c4dfb5af6, current checksum: fa08ec86423ec084161a16633296c9d5236fa3a9ad02586d9a16865f21dcfea5
[0m18:18:09.832830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd5f04913-0513-4c84-8330-6839616c9d96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b05379b4ce0>]}
[0m18:18:11.072778 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m18:18:11.073500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd5f04913-0513-4c84-8330-6839616c9d96', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0529ba9c70>]}
[0m18:18:11.166045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd5f04913-0513-4c84-8330-6839616c9d96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0529bcadb0>]}
[0m18:18:11.235996 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:18:11.237731 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:18:11.250268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd5f04913-0513-4c84-8330-6839616c9d96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b050b857230>]}
[0m18:18:11.250825 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m18:18:11.251339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5f04913-0513-4c84-8330-6839616c9d96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b050b84b740>]}
[0m18:18:11.253117 [info ] [MainThread]: 
[0m18:18:11.253626 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:18:11.254084 [info ] [MainThread]: 
[0m18:18:11.254675 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:18:11.255711 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m18:18:11.290963 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m18:18:11.291457 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m18:18:11.291899 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:18:11.376452 [debug] [ThreadPool]: SQL status: OK in 0.084 seconds
[0m18:18:11.378165 [debug] [ThreadPool]: On list_argus_vault: Close
[0m18:18:11.379140 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m18:18:11.379741 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m18:18:11.387224 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:18:11.387693 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m18:18:11.388136 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:18:11.389305 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:18:11.390652 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:18:11.391109 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m18:18:11.391720 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:18:11.392172 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:18:11.392580 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m18:18:11.393304 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:18:11.394257 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:18:11.394711 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:18:11.395148 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:18:11.395808 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:18:11.396272 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m18:18:11.401955 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m18:18:11.407760 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:18:11.408324 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m18:18:11.408734 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:18:11.409598 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:18:11.410058 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:18:11.410480 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m18:18:11.421338 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m18:18:11.422757 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m18:18:11.424047 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m18:18:11.424492 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m18:18:11.426024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5f04913-0513-4c84-8330-6839616c9d96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b050b90fc80>]}
[0m18:18:11.426625 [debug] [MainThread]: Using duckdb connection "master"
[0m18:18:11.427122 [debug] [MainThread]: On master: BEGIN
[0m18:18:11.427534 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:18:11.428734 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:18:11.429222 [debug] [MainThread]: On master: COMMIT
[0m18:18:11.429639 [debug] [MainThread]: Using duckdb connection "master"
[0m18:18:11.430087 [debug] [MainThread]: On master: COMMIT
[0m18:18:11.430695 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:18:11.431168 [debug] [MainThread]: On master: Close
[0m18:18:11.433961 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:18:11.435888 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m18:18:11.436488 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m18:18:11.437017 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m18:18:11.445326 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:18:11.446071 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m18:18:11.502632 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:18:11.503223 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201181811478177"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Based on PCA factors, this transaction is flagged as fraud due to significant outliers in V2 and V7.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = 'e45c908b-1a6f-4c81-b8f3-0abc8aaa3418'
    );
  
  
  
[0m18:18:11.503715 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:18:11.512599 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m18:18:11.520365 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:18:11.520879 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m18:18:11.521602 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:18:11.522105 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:18:11.522571 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201181811478177'
      
      
      order by ordinal_position

  
[0m18:18:11.525078 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:18:11.530040 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:18:11.530549 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:18:11.533604 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:18:11.543828 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:18:11.544365 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:18:11.546724 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:18:11.548235 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:18:11.548737 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m18:18:11.549499 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:18:11.565927 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:18:11.566698 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:18:11.567233 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201181811478177"
    )
  
[0m18:18:11.568470 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:18:11.578958 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:18:11.579475 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:18:11.579959 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:18:11.593583 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m18:18:11.595582 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m18:18:11.597325 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5f04913-0513-4c84-8330-6839616c9d96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b053893fce0>]}
[0m18:18:11.598099 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m18:18:11.598817 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:18:11.600312 [debug] [MainThread]: Using duckdb connection "master"
[0m18:18:11.600811 [debug] [MainThread]: On master: BEGIN
[0m18:18:11.601316 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:18:11.602403 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:18:11.602865 [debug] [MainThread]: On master: COMMIT
[0m18:18:11.603338 [debug] [MainThread]: Using duckdb connection "master"
[0m18:18:11.603765 [debug] [MainThread]: On master: COMMIT
[0m18:18:11.604706 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:18:11.605489 [debug] [MainThread]: On master: Close
[0m18:18:11.606079 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:18:11.606494 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m18:18:11.606945 [info ] [MainThread]: 
[0m18:18:11.607410 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m18:18:11.608350 [debug] [MainThread]: Command end result
[0m18:18:11.627530 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:18:11.629145 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:18:11.634866 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m18:18:11.635327 [info ] [MainThread]: 
[0m18:18:11.635893 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:18:11.636708 [info ] [MainThread]: 
[0m18:18:11.637511 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:18:11.638178 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:18:11.639236 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3785088, "process_in_blocks": "0", "process_kernel_time": 0.27593, "process_mem_max_rss": "278784", "process_out_blocks": "3104", "process_user_time": 4.33251}
[0m18:18:11.639821 [debug] [MainThread]: Command `dbt run` succeeded at 18:18:11.639718 after 2.38 seconds
[0m18:18:11.640337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b05383df140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0529b6a3c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b050b84b560>]}
[0m18:18:11.640812 [debug] [MainThread]: Flushing usage events
[0m18:18:12.536757 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:18:28.820190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72386fe1a360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72386f553020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72386f552f60>]}


============================== 18:18:28.823519 | 029794be-a36a-46af-afa4-74099fa210b5 ==============================
[0m18:18:28.823519 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:18:28.824231 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'use_colors': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'no_print': 'None', 'introspect': 'True', 'indirect_selection': 'eager', 'version_check': 'True', 'warn_error': 'None', 'write_json': 'True', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "5a4787c2-94fd-44c9-94a3-616729639197", "ai_explanation": "Fraud detected: Anomalously low PCA scores (V1-V20) indicate suspicious transaction."} --profiles-dir .', 'log_cache_events': 'False', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'use_experimental_parser': 'False', 'profiles_dir': '.', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'empty': 'False', 'static_parser': 'True', 'debug': 'False'}
[0m18:18:29.069805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '029794be-a36a-46af-afa4-74099fa210b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72386ecb4470>]}
[0m18:18:29.141618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '029794be-a36a-46af-afa4-74099fa210b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723871919160>]}
[0m18:18:29.143406 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:18:29.229185 [debug] [MainThread]: checksum: d8f9501aa274507bb10600ed263a08ecc64cba85dbb430c17b676a41bb6b2115, vars: {'ai_explanation': 'Fraud detected: Anomalously low PCA scores (V1-V20) '
                   'indicate suspicious transaction.',
 'txn_id': '5a4787c2-94fd-44c9-94a3-616729639197'}, profile: , target: , version: 1.11.2
[0m18:18:29.320995 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:18:29.321557 [debug] [MainThread]: previous checksum: d8f9501aa274507bb10600ed263a08ecc64cba85dbb430c17b676a41bb6b2115, current checksum: fcd63b374fca0ec5349f61fafc198ce8cdd1a3f9800b6170b564919c4dfb5af6
[0m18:18:29.322031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '029794be-a36a-46af-afa4-74099fa210b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72386ecb4b00>]}
[0m18:18:30.544981 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m18:18:30.545661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '029794be-a36a-46af-afa4-74099fa210b5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723862daadb0>]}
[0m18:18:30.637956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '029794be-a36a-46af-afa4-74099fa210b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723862dab1a0>]}
[0m18:18:30.706288 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:18:30.708029 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:18:30.720213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '029794be-a36a-46af-afa4-74099fa210b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7238601f6d80>]}
[0m18:18:30.720753 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m18:18:30.721240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '029794be-a36a-46af-afa4-74099fa210b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723812b39e20>]}
[0m18:18:30.722968 [info ] [MainThread]: 
[0m18:18:30.723455 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:18:30.723885 [info ] [MainThread]: 
[0m18:18:30.724504 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:18:30.725543 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m18:18:30.760551 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m18:18:30.761064 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m18:18:30.761521 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:18:30.848840 [debug] [ThreadPool]: SQL status: OK in 0.087 seconds
[0m18:18:30.850519 [debug] [ThreadPool]: On list_argus_vault: Close
[0m18:18:30.851394 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m18:18:30.851995 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m18:18:30.859340 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:18:30.859800 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m18:18:30.860243 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:18:30.861392 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:18:30.862693 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:18:30.863142 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m18:18:30.863767 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:18:30.864213 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:18:30.864617 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m18:18:30.865247 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:18:30.866168 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:18:30.866609 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m18:18:30.867036 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m18:18:30.867728 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:18:30.868189 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m18:18:30.873732 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m18:18:30.879515 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:18:30.880065 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m18:18:30.880477 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:18:30.881392 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:18:30.881826 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m18:18:30.882272 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m18:18:30.893223 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m18:18:30.894615 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m18:18:30.895891 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m18:18:30.896354 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m18:18:30.897961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '029794be-a36a-46af-afa4-74099fa210b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72386edf5190>]}
[0m18:18:30.898558 [debug] [MainThread]: Using duckdb connection "master"
[0m18:18:30.898994 [debug] [MainThread]: On master: BEGIN
[0m18:18:30.899390 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:18:30.900317 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:18:30.900752 [debug] [MainThread]: On master: COMMIT
[0m18:18:30.901190 [debug] [MainThread]: Using duckdb connection "master"
[0m18:18:30.901582 [debug] [MainThread]: On master: COMMIT
[0m18:18:30.902182 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:18:30.902604 [debug] [MainThread]: On master: Close
[0m18:18:30.904647 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:18:30.905303 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m18:18:30.905852 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m18:18:30.906364 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m18:18:30.914426 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:18:30.915168 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m18:18:30.971342 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:18:30.971931 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201181830947078"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Fraud detected: Anomalously low PCA scores (V1-V20) indicate suspicious transaction.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '5a4787c2-94fd-44c9-94a3-616729639197'
    );
  
  
  
[0m18:18:30.972432 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:18:30.980950 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m18:18:30.988724 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:18:30.989269 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m18:18:30.989988 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:18:30.990466 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:18:30.990949 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201181830947078'
      
      
      order by ordinal_position

  
[0m18:18:30.993406 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:18:30.998359 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:18:30.998880 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:18:31.001317 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:18:31.011352 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:18:31.011873 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m18:18:31.014551 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:18:31.016084 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:18:31.016587 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m18:18:31.017668 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:18:31.033956 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:18:31.034715 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:18:31.035235 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201181830947078"
    )
  
[0m18:18:31.036647 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:18:31.046952 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:18:31.047471 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m18:18:31.047959 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m18:18:31.061734 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m18:18:31.063689 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m18:18:31.065416 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '029794be-a36a-46af-afa4-74099fa210b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723862fbb260>]}
[0m18:18:31.066193 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m18:18:31.066925 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m18:18:31.068391 [debug] [MainThread]: Using duckdb connection "master"
[0m18:18:31.068989 [debug] [MainThread]: On master: BEGIN
[0m18:18:31.069429 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:18:31.070316 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:18:31.070749 [debug] [MainThread]: On master: COMMIT
[0m18:18:31.071185 [debug] [MainThread]: Using duckdb connection "master"
[0m18:18:31.071580 [debug] [MainThread]: On master: COMMIT
[0m18:18:31.072178 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:18:31.072611 [debug] [MainThread]: On master: Close
[0m18:18:31.073111 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:18:31.073501 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m18:18:31.073931 [info ] [MainThread]: 
[0m18:18:31.074379 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m18:18:31.075157 [debug] [MainThread]: Command end result
[0m18:18:31.093827 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m18:18:31.095442 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m18:18:31.101036 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m18:18:31.101469 [info ] [MainThread]: 
[0m18:18:31.101992 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:18:31.102444 [info ] [MainThread]: 
[0m18:18:31.102899 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:18:31.103533 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:18:31.104561 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3468947, "process_in_blocks": "0", "process_kernel_time": 0.309042, "process_mem_max_rss": "277152", "process_out_blocks": "3104", "process_user_time": 4.312685}
[0m18:18:31.105163 [debug] [MainThread]: Command `dbt run` succeeded at 18:18:31.105059 after 2.35 seconds
[0m18:18:31.105628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72386fadeea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723862e76cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72386fc71490>]}
[0m18:18:31.106136 [debug] [MainThread]: Flushing usage events
[0m18:18:32.156807 [debug] [MainThread]: An error was encountered while trying to flush usage events
