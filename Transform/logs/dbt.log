[0m11:14:22.850198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ac7f86ebd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ac7fe2b7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ac817bac90>]}


============================== 11:14:22.950207 | 6ef14966-2dda-4c61-9a55-5649cc9f4286 ==============================
[0m11:14:22.950207 [info ] [MainThread]: Running with dbt=1.11.2
[0m11:14:22.950919 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'write_json': 'True', 'introspect': 'True', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt deps', 'partial_parse': 'True', 'profiles_dir': '/home/codespace/.dbt', 'target_path': 'None', 'log_format': 'default', 'indirect_selection': 'eager', 'fail_fast': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'use_experimental_parser': 'False', 'printer_width': '80', 'quiet': 'False', 'version_check': 'True', 'log_path': 'logs'}
[0m11:14:22.951763 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path /workspaces/modern-stack-banking/Transform/dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m11:14:22.952829 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": false, "command_wall_clock_time": 0.16475806, "process_in_blocks": "28088", "process_kernel_time": 0.201408, "process_mem_max_rss": "101568", "process_out_blocks": "8", "process_user_time": 1.43}
[0m11:14:22.953423 [debug] [MainThread]: Command `dbt deps` failed at 11:14:22.953320 after 0.17 seconds
[0m11:14:22.953919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ac7fec3800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ac7ff4bc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ac7f838d70>]}
[0m11:14:22.954393 [debug] [MainThread]: Flushing usage events
[0m11:14:24.168751 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:15:21.021222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75163110e060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751630ea5670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751630d12360>]}


============================== 11:15:21.024363 | 3e43c08b-b79e-4bd2-99ca-f409c4a7aff7 ==============================
[0m11:15:21.024363 [info ] [MainThread]: Running with dbt=1.11.2
[0m11:15:21.025081 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'introspect': 'True', 'printer_width': '80', 'static_parser': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'warn_error': 'None', 'cache_selected_only': 'False', 'profiles_dir': '/home/codespace/.dbt', 'log_format': 'default', 'no_print': 'None', 'write_json': 'True', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'debug': 'False', 'empty': 'None', 'fail_fast': 'False', 'partial_parse': 'True'}
[0m11:15:21.026924 [info ] [MainThread]: [[33mWARNING[0m][GenericJSONSchemaValidationDeprecation]: Deprecated
functionality
'name' is a required property at top level in file
`/workspaces/modern-stack-banking/Transform/dbt_project.yml` is possibly a
deprecation. This generally means that either we failed to catch this as a more
specific deprecation type OR our JSONSchema had a regression (and this
deprecation was erroneous).
[0m11:15:21.029697 [error] [MainThread]: Encountered an error:
Runtime Error
  Required "name" field not present in project

Error encountered in /workspaces/modern-stack-banking/Transform/dbt_project.yml
[0m11:15:21.030747 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": false, "command_wall_clock_time": 0.07131323, "process_in_blocks": "0", "process_kernel_time": 0.146767, "process_mem_max_rss": "102444", "process_out_blocks": "16", "process_user_time": 1.46767}
[0m11:15:21.031326 [debug] [MainThread]: Command `dbt deps` failed at 11:15:21.031207 after 0.07 seconds
[0m11:15:21.031819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7516304b3f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7516302c1fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7516302c1ee0>]}
[0m11:15:21.032364 [debug] [MainThread]: Flushing usage events
[0m11:15:22.042397 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:16:23.706992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722439ebeb40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722439c9c0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722439879430>]}


============================== 11:16:23.710202 | 4400d6a8-4b7b-411b-afbd-89fde4a67c18 ==============================
[0m11:16:23.710202 [info ] [MainThread]: Running with dbt=1.11.2
[0m11:16:23.710884 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'warn_error': 'None', 'static_parser': 'True', 'log_cache_events': 'False', 'introspect': 'True', 'use_colors': 'True', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'partial_parse': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'cache_selected_only': 'False', 'target_path': 'None', 'debug': 'False', 'quiet': 'False', 'profiles_dir': '/home/codespace/.dbt', 'invocation_command': 'dbt deps', 'empty': 'None', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'version_check': 'True', 'printer_width': '80'}
[0m11:16:23.845553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4400d6a8-4b7b-411b-afbd-89fde4a67c18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7224391b67b0>]}
[0m11:16:23.856611 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:16:23.857457 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:16:23.858547 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.21352075, "process_in_blocks": "0", "process_kernel_time": 0.178666, "process_mem_max_rss": "105216", "process_out_blocks": "8", "process_user_time": 1.550108}
[0m11:16:23.859212 [debug] [MainThread]: Command `dbt deps` succeeded at 11:16:23.859086 after 0.21 seconds
[0m11:16:23.859726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72243a127b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722439182cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722439040860>]}
[0m11:16:23.860237 [debug] [MainThread]: Flushing usage events
[0m11:16:24.888918 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:18:34.018727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74acc5069b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74acc5745dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74acc50698e0>]}


============================== 11:18:34.022008 | 934c75f3-70ca-459d-ae26-9ddb3c796d57 ==============================
[0m11:18:34.022008 [info ] [MainThread]: Running with dbt=1.11.2
[0m11:18:34.022782 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'log_format': 'default', 'partial_parse': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'warn_error': 'None', 'static_parser': 'True', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'indirect_selection': 'eager', 'introspect': 'True', 'fail_fast': 'False', 'debug': 'False', 'empty': 'False', 'use_colors': 'True', 'profiles_dir': '.', 'write_json': 'True', 'use_experimental_parser': 'False', 'target_path': 'None', 'invocation_command': 'dbt run --select sat_txn_features --profiles-dir .', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'log_cache_events': 'False', 'printer_width': '80'}
[0m11:18:34.025353 [error] [MainThread]: Encountered an error:
Runtime Error
  
  dbt encountered an error while trying to read your profiles.yml file.
  
  Runtime Error
    Syntax error near line 2
    ------------------------------
    1  | cat <<EOF > /workspaces/modern-stack-banking/Transform/profiles.yml
    2  | modern_stack_banking:
    3  |   outputs:
    4  |     dev:
    5  |       type: duckdb
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 2, column 21
  
[0m11:18:34.026553 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.011260075, "process_in_blocks": "0", "process_kernel_time": 0.177506, "process_mem_max_rss": "101072", "process_out_blocks": "16", "process_user_time": 1.349247}
[0m11:18:34.027215 [debug] [MainThread]: Command `dbt run` failed at 11:18:34.027082 after 0.01 seconds
[0m11:18:34.027713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74acc5773ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74acc5314380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74acc5069d00>]}
[0m11:18:34.028264 [debug] [MainThread]: Flushing usage events
[0m11:18:35.073563 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:19:38.669452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5d8bd50cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5d8928d4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5d89fee390>]}


============================== 11:19:38.672630 | e6d56eec-b1fc-4310-a546-6eb8e1b1a46e ==============================
[0m11:19:38.672630 [info ] [MainThread]: Running with dbt=1.11.2
[0m11:19:38.673358 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'debug': 'False', 'warn_error': 'None', 'write_json': 'True', 'invocation_command': 'dbt run --select sat_txn_features --profiles-dir .', 'profiles_dir': '.', 'quiet': 'False', 'target_path': 'None', 'printer_width': '80', 'log_format': 'default', 'log_cache_events': 'False', 'use_colors': 'True', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'static_parser': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'empty': 'False', 'introspect': 'True', 'partial_parse': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:19:38.916897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6d56eec-b1fc-4310-a546-6eb8e1b1a46e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5d7d5afaa0>]}
[0m11:19:38.987033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6d56eec-b1fc-4310-a546-6eb8e1b1a46e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5d8bf47440>]}
[0m11:19:38.988610 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m11:19:39.073891 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m11:19:39.074653 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:19:39.075170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e6d56eec-b1fc-4310-a546-6eb8e1b1a46e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5d7d441e50>]}
[0m11:19:39.936647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6d56eec-b1fc-4310-a546-6eb8e1b1a46e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5d7c00e600>]}
[0m11:19:39.972717 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m11:19:39.974283 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m11:19:39.985732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6d56eec-b1fc-4310-a546-6eb8e1b1a46e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5d7d3c35f0>]}
[0m11:19:39.986259 [info ] [MainThread]: Found 472 macros
[0m11:19:39.986755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6d56eec-b1fc-4310-a546-6eb8e1b1a46e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5d7c00e930>]}
[0m11:19:39.987378 [warn ] [MainThread]: The selection criterion 'sat_txn_features' does not match any enabled nodes
[0m11:19:39.988745 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:19:39.989411 [debug] [MainThread]: Command end result
[0m11:19:40.005406 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m11:19:40.006817 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m11:19:40.009891 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m11:19:40.010910 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4039451, "process_in_blocks": "488", "process_kernel_time": 0.223014, "process_mem_max_rss": "175880", "process_out_blocks": "2880", "process_user_time": 2.695169}
[0m11:19:40.011482 [debug] [MainThread]: Command `dbt run` succeeded at 11:19:40.011378 after 1.40 seconds
[0m11:19:40.011977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5d8a106b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5d7d39a3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5d7d4414f0>]}
[0m11:19:40.012443 [debug] [MainThread]: Flushing usage events
[0m11:19:41.041824 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:21:12.382626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x732bbdc7e360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x732bc0185e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x732bbedaae70>]}


============================== 11:21:12.385945 | f50102b1-4dbb-4c6f-aa70-b8b2784c118a ==============================
[0m11:21:12.385945 [info ] [MainThread]: Running with dbt=1.11.2
[0m11:21:12.386614 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'debug': 'False', 'invocation_command': 'dbt run --select sat_txn_features --profiles-dir .', 'version_check': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'warn_error': 'None', 'printer_width': '80', 'use_experimental_parser': 'False', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'profiles_dir': '.', 'target_path': 'None', 'indirect_selection': 'eager', 'empty': 'False', 'write_json': 'True', 'static_parser': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'fail_fast': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:21:12.632812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f50102b1-4dbb-4c6f-aa70-b8b2784c118a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x732bbe1aeae0>]}
[0m11:21:12.704543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f50102b1-4dbb-4c6f-aa70-b8b2784c118a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x732bbdac8320>]}
[0m11:21:12.706273 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m11:21:12.790874 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m11:21:12.844991 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:21:12.845486 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m11:21:12.845938 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:21:12.851280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f50102b1-4dbb-4c6f-aa70-b8b2784c118a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x732bb15a06e0>]}
[0m11:21:12.891119 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m11:21:12.892749 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m11:21:12.903893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f50102b1-4dbb-4c6f-aa70-b8b2784c118a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x732bb1351430>]}
[0m11:21:12.904440 [info ] [MainThread]: Found 472 macros
[0m11:21:12.904942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f50102b1-4dbb-4c6f-aa70-b8b2784c118a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x732bb1344860>]}
[0m11:21:12.905571 [warn ] [MainThread]: The selection criterion 'sat_txn_features' does not match any enabled nodes
[0m11:21:12.906970 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:21:12.908980 [debug] [MainThread]: Command end result
[0m11:21:12.926422 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m11:21:12.928229 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m11:21:12.931628 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m11:21:12.932720 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6130554, "process_in_blocks": "0", "process_kernel_time": 0.238818, "process_mem_max_rss": "175796", "process_out_blocks": "1928", "process_user_time": 1.903551}
[0m11:21:12.933317 [debug] [MainThread]: Command `dbt run` succeeded at 11:21:12.933211 after 0.61 seconds
[0m11:21:12.933832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x732bbe1fa180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x732bbe1699d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x732bbd2f58b0>]}
[0m11:21:12.934328 [debug] [MainThread]: Flushing usage events
[0m11:21:13.973989 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:21:46.763976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744605d2ce00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7446061fa4b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744605d694c0>]}


============================== 11:21:46.767140 | f6d46cf0-0030-4c07-99b6-e28bc674c2b1 ==============================
[0m11:21:46.767140 [info ] [MainThread]: Running with dbt=1.11.2
[0m11:21:46.767816 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run --select path:models/vault/sats --profiles-dir .', 'version_check': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'introspect': 'True', 'log_format': 'default', 'write_json': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'profiles_dir': '.', 'target_path': 'None', 'warn_error': 'None', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'no_print': 'None', 'fail_fast': 'False'}
[0m11:21:47.012195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f6d46cf0-0030-4c07-99b6-e28bc674c2b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74460544bbf0>]}
[0m11:21:47.082615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f6d46cf0-0030-4c07-99b6-e28bc674c2b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74460533c9b0>]}
[0m11:21:47.084206 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m11:21:47.169181 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m11:21:47.223968 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:21:47.224477 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m11:21:47.224919 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:21:47.230224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f6d46cf0-0030-4c07-99b6-e28bc674c2b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7446055876e0>]}
[0m11:21:47.269733 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m11:21:47.271310 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m11:21:47.282419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f6d46cf0-0030-4c07-99b6-e28bc674c2b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7445f9439370>]}
[0m11:21:47.282981 [info ] [MainThread]: Found 472 macros
[0m11:21:47.283452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6d46cf0-0030-4c07-99b6-e28bc674c2b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7445f9739190>]}
[0m11:21:47.284334 [warn ] [MainThread]: The selection criterion 'path:models/vault/sats' does not match any enabled nodes
[0m11:21:47.285752 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:21:47.287790 [debug] [MainThread]: Command end result
[0m11:21:47.306324 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m11:21:47.308218 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m11:21:47.311593 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m11:21:47.312649 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6108266, "process_in_blocks": "0", "process_kernel_time": 0.23294, "process_mem_max_rss": "175720", "process_out_blocks": "1928", "process_user_time": 1.901513}
[0m11:21:47.313266 [debug] [MainThread]: Command `dbt run` succeeded at 11:21:47.313162 after 0.61 seconds
[0m11:21:47.313773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7445f942fbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74460521afc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744605219310>]}
[0m11:21:47.314265 [debug] [MainThread]: Flushing usage events
[0m11:21:48.320731 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:23:06.205411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774fdb16d5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774fdb3fa480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774fda66cbf0>]}


============================== 11:23:06.208730 | 73215605-9454-4bd9-b15b-8adc4f9c0c63 ==============================
[0m11:23:06.208730 [info ] [MainThread]: Running with dbt=1.11.2
[0m11:23:06.209458 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'write_json': 'True', 'partial_parse': 'True', 'empty': 'False', 'profiles_dir': '.', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'warn_error': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'introspect': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'no_print': 'None', 'quiet': 'False', 'use_colors': 'True', 'invocation_command': 'dbt run --select sat_txn_features --profiles-dir .', 'use_experimental_parser': 'False', 'target_path': 'None'}
[0m11:23:06.455181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '73215605-9454-4bd9-b15b-8adc4f9c0c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774fda534a40>]}
[0m11:23:06.525629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '73215605-9454-4bd9-b15b-8adc4f9c0c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774fda66eea0>]}
[0m11:23:06.527244 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m11:23:06.610640 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m11:23:06.665827 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:23:06.666334 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m11:23:06.666795 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:23:06.672152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '73215605-9454-4bd9-b15b-8adc4f9c0c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774fce88c5f0>]}
[0m11:23:06.713404 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m11:23:06.715087 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m11:23:06.726399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '73215605-9454-4bd9-b15b-8adc4f9c0c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774fce639220>]}
[0m11:23:06.726993 [info ] [MainThread]: Found 472 macros
[0m11:23:06.727489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73215605-9454-4bd9-b15b-8adc4f9c0c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774fda4e3da0>]}
[0m11:23:06.728177 [warn ] [MainThread]: The selection criterion 'sat_txn_features' does not match any enabled nodes
[0m11:23:06.729545 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:23:06.731603 [debug] [MainThread]: Command end result
[0m11:23:06.749241 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m11:23:06.751015 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m11:23:06.754387 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m11:23:06.755431 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.61213887, "process_in_blocks": "0", "process_kernel_time": 0.246498, "process_mem_max_rss": "175804", "process_out_blocks": "1928", "process_user_time": 1.898138}
[0m11:23:06.756043 [debug] [MainThread]: Command `dbt run` succeeded at 11:23:06.755939 after 0.61 seconds
[0m11:23:06.756534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774fdace0aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774fda5e3980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774fce73b800>]}
[0m11:23:06.757043 [debug] [MainThread]: Flushing usage events
[0m11:23:07.801260 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:23:13.398591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b164872dc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b164ad21e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b164abb0500>]}


============================== 11:23:13.401821 | 5c9ba89b-026f-4df5-9c01-cfb32e706818 ==============================
[0m11:23:13.401821 [info ] [MainThread]: Running with dbt=1.11.2
[0m11:23:13.402522 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run --select path:models/vault/sats --profiles-dir .', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'partial_parse': 'True', 'log_cache_events': 'False', 'profiles_dir': '.', 'introspect': 'True', 'write_json': 'True', 'printer_width': '80', 'quiet': 'False', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'no_print': 'None', 'target_path': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'indirect_selection': 'eager', 'version_check': 'True', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'debug': 'False'}
[0m11:23:13.646445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c9ba89b-026f-4df5-9c01-cfb32e706818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1647de6e40>]}
[0m11:23:13.717336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c9ba89b-026f-4df5-9c01-cfb32e706818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1647d8ffb0>]}
[0m11:23:13.718992 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m11:23:13.803974 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m11:23:13.858086 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:23:13.858588 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m11:23:13.859031 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:23:13.864342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c9ba89b-026f-4df5-9c01-cfb32e706818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b163c2193d0>]}
[0m11:23:13.903525 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m11:23:13.905125 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m11:23:13.916268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c9ba89b-026f-4df5-9c01-cfb32e706818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b163bf25b80>]}
[0m11:23:13.916837 [info ] [MainThread]: Found 472 macros
[0m11:23:13.917330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c9ba89b-026f-4df5-9c01-cfb32e706818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b163c065250>]}
[0m11:23:13.918213 [warn ] [MainThread]: The selection criterion 'path:models/vault/sats' does not match any enabled nodes
[0m11:23:13.919599 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:23:13.921620 [debug] [MainThread]: Command end result
[0m11:23:13.939113 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m11:23:13.940893 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m11:23:13.944204 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m11:23:13.945248 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6086291, "process_in_blocks": "0", "process_kernel_time": 0.234748, "process_mem_max_rss": "176092", "process_out_blocks": "1920", "process_user_time": 1.89397}
[0m11:23:13.945861 [debug] [MainThread]: Command `dbt run` succeeded at 11:23:13.945754 after 0.61 seconds
[0m11:23:13.946354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b164872dc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1648573f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1648ed5d90>]}
[0m11:23:13.946867 [debug] [MainThread]: Flushing usage events
[0m11:23:14.952183 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:26:48.727341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d3e436cfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d3e4405610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d3e4f54230>]}


============================== 11:26:48.730532 | 99bd6c7f-2eab-48d6-a431-c536a7f5b0b8 ==============================
[0m11:26:48.730532 [info ] [MainThread]: Running with dbt=1.11.2
[0m11:26:48.731227 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt ls --profiles-dir .', 'version_check': 'True', 'partial_parse': 'True', 'quiet': 'False', 'printer_width': '80', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'no_print': 'None', 'indirect_selection': 'eager', 'introspect': 'True', 'empty': 'None', 'profiles_dir': '.', 'target_path': 'None', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'static_parser': 'True', 'debug': 'False', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'log_cache_events': 'False', 'use_colors': 'True'}
[0m11:26:48.976033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '99bd6c7f-2eab-48d6-a431-c536a7f5b0b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d3e433d430>]}
[0m11:26:49.046556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '99bd6c7f-2eab-48d6-a431-c536a7f5b0b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d3e531a4e0>]}
[0m11:26:49.048218 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m11:26:49.131851 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m11:26:49.186335 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m11:26:49.186935 [debug] [MainThread]: Partial parsing: added file: modern_stack_banking://models/Vault/hubs/hubs_transactions.sql
[0m11:26:49.187406 [debug] [MainThread]: Partial parsing: added file: modern_stack_banking://models/Vault/sats/sat_txn_features.sql
[0m11:26:49.475410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99bd6c7f-2eab-48d6-a431-c536a7f5b0b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d3d8298e90>]}
[0m11:26:49.529217 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m11:26:49.530859 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m11:26:49.540988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '99bd6c7f-2eab-48d6-a431-c536a7f5b0b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d3d8298dd0>]}
[0m11:26:49.541516 [info ] [MainThread]: Found 2 models, 472 macros
[0m11:26:49.542026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99bd6c7f-2eab-48d6-a431-c536a7f5b0b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d3e431cdd0>]}
[0m11:26:49.542867 [info ] [MainThread]: modern_stack_banking.Vault.hubs.hubs_transactions
[0m11:26:49.543354 [info ] [MainThread]: modern_stack_banking.Vault.sats.sat_txn_features
[0m11:26:49.544327 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.8791244, "process_in_blocks": "0", "process_kernel_time": 0.241887, "process_mem_max_rss": "180232", "process_out_blocks": "1952", "process_user_time": 2.158996}
[0m11:26:49.544946 [debug] [MainThread]: Command `dbt ls` succeeded at 11:26:49.544840 after 0.88 seconds
[0m11:26:49.545425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d3e50ee930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d3e436cfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d3d827cdd0>]}
[0m11:26:49.545924 [debug] [MainThread]: Flushing usage events
[0m11:26:50.704368 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:29:24.808478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788ce9663260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788ce9a83620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788ce9662ea0>]}


============================== 11:29:24.811741 | fe0db6e6-4124-44a0-b019-243bd8d8401a ==============================
[0m11:29:24.811741 [info ] [MainThread]: Running with dbt=1.11.2
[0m11:29:24.812435 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'fail_fast': 'False', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'profiles_dir': '.', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'invocation_command': 'dbt run --select modern_stack_banking.Vault.sats.sat_txn_features --profiles-dir .', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'quiet': 'False', 'no_print': 'None', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'version_check': 'True', 'debug': 'False', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'cache_selected_only': 'False'}
[0m11:29:25.058586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe0db6e6-4124-44a0-b019-243bd8d8401a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788cebb05a60>]}
[0m11:29:25.131334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fe0db6e6-4124-44a0-b019-243bd8d8401a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788ce9660da0>]}
[0m11:29:25.133150 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m11:29:25.218380 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m11:29:25.294843 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 2 files added, 0 files changed.
[0m11:29:25.295475 [debug] [MainThread]: Partial parsing: added file: modern_stack_banking://models/vault/hubs/hubs_transactions.sql
[0m11:29:25.295989 [debug] [MainThread]: Partial parsing: added file: modern_stack_banking://models/vault/sats/sat_txn_features.sql
[0m11:29:25.296406 [debug] [MainThread]: Partial parsing: deleted file: modern_stack_banking://models/Vault/sats/sat_txn_features.sql
[0m11:29:25.296858 [debug] [MainThread]: Partial parsing: deleted file: modern_stack_banking://models/Vault/hubs/hubs_transactions.sql
[0m11:29:25.576431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe0db6e6-4124-44a0-b019-243bd8d8401a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788cdc1ab7d0>]}
[0m11:29:25.629449 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m11:29:25.631085 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m11:29:25.642515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe0db6e6-4124-44a0-b019-243bd8d8401a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788cdc190f20>]}
[0m11:29:25.643079 [info ] [MainThread]: Found 2 models, 472 macros
[0m11:29:25.643561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe0db6e6-4124-44a0-b019-243bd8d8401a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788cdd0a6ff0>]}
[0m11:29:25.644235 [warn ] [MainThread]: The selection criterion 'modern_stack_banking.Vault.sats.sat_txn_features' does not match any enabled nodes
[0m11:29:25.645613 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:29:25.646292 [debug] [MainThread]: Command end result
[0m11:29:25.664402 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m11:29:25.665839 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m11:29:25.668970 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m11:29:25.669977 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.92398024, "process_in_blocks": "0", "process_kernel_time": 0.245795, "process_mem_max_rss": "180556", "process_out_blocks": "2920", "process_user_time": 2.215155}
[0m11:29:25.670564 [debug] [MainThread]: Command `dbt run` succeeded at 11:29:25.670458 after 0.92 seconds
[0m11:29:25.671069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788ce95a9be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788cdc1b50d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788cdd08a450>]}
[0m11:29:25.671540 [debug] [MainThread]: Flushing usage events
[0m11:29:26.846062 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:29:56.585701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772ae2682180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772ae223ec00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772ae223fe30>]}


============================== 11:29:56.589031 | dbf42725-ff4a-4b12-ada7-c339a282569e ==============================
[0m11:29:56.589031 [info ] [MainThread]: Running with dbt=1.11.2
[0m11:29:56.589776 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'debug': 'False', 'static_parser': 'True', 'quiet': 'False', 'fail_fast': 'False', 'log_format': 'default', 'empty': 'False', 'printer_width': '80', 'invocation_command': 'dbt run --select modern_stack_banking.Vault.sats.sat_txn_features --profiles-dir .', 'profiles_dir': '.', 'cache_selected_only': 'False', 'use_colors': 'True', 'version_check': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'no_print': 'None', 'introspect': 'True', 'write_json': 'True'}
[0m11:29:56.839793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dbf42725-ff4a-4b12-ada7-c339a282569e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772ae2989100>]}
[0m11:29:56.911274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dbf42725-ff4a-4b12-ada7-c339a282569e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772ae46250d0>]}
[0m11:29:56.913013 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m11:29:56.998255 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m11:29:57.075330 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 2 files added, 0 files changed.
[0m11:29:57.075963 [debug] [MainThread]: Partial parsing: added file: modern_stack_banking://models/Vault/hubs/hubs_transactions.sql
[0m11:29:57.076434 [debug] [MainThread]: Partial parsing: added file: modern_stack_banking://models/Vault/sats/sat_txn_features.sql
[0m11:29:57.076883 [debug] [MainThread]: Partial parsing: deleted file: modern_stack_banking://models/vault/hubs/hubs_transactions.sql
[0m11:29:57.077317 [debug] [MainThread]: Partial parsing: deleted file: modern_stack_banking://models/vault/sats/sat_txn_features.sql
[0m11:29:57.348692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dbf42725-ff4a-4b12-ada7-c339a282569e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772ad415d5b0>]}
[0m11:29:57.402795 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m11:29:57.404522 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m11:29:57.416440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dbf42725-ff4a-4b12-ada7-c339a282569e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772ad4170a10>]}
[0m11:29:57.417031 [info ] [MainThread]: Found 2 models, 472 macros
[0m11:29:57.417532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbf42725-ff4a-4b12-ada7-c339a282569e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772ad41bf2f0>]}
[0m11:29:57.419264 [info ] [MainThread]: 
[0m11:29:57.419786 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:29:57.420229 [info ] [MainThread]: 
[0m11:29:57.420845 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:29:57.421868 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m11:29:57.682214 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m11:29:57.682828 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m11:29:57.683292 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:30:00.072565 [debug] [ThreadPool]: SQL status: OK in 2.389 seconds
[0m11:30:00.074208 [debug] [ThreadPool]: On list_argus_vault: Close
[0m11:30:00.075080 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m11:30:00.075729 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m11:30:00.082786 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m11:30:00.083276 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m11:30:00.083755 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:30:00.084956 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:30:00.086300 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m11:30:00.086787 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m11:30:00.087418 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:30:00.087888 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m11:30:00.088326 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m11:30:00.089201 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:30:00.090163 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m11:30:00.090633 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m11:30:00.091100 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m11:30:00.091790 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:30:00.092254 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m11:30:00.097412 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m11:30:00.102983 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m11:30:00.103444 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m11:30:00.103879 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:30:00.104551 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:30:00.105005 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m11:30:00.105419 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m11:30:00.115840 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m11:30:00.117083 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m11:30:00.118348 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m11:30:00.118814 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m11:30:00.119492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbf42725-ff4a-4b12-ada7-c339a282569e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772ad4173f20>]}
[0m11:30:00.120238 [debug] [MainThread]: Using duckdb connection "master"
[0m11:30:00.120755 [debug] [MainThread]: On master: BEGIN
[0m11:30:00.121168 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:30:00.122054 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:30:00.122498 [debug] [MainThread]: On master: COMMIT
[0m11:30:00.122942 [debug] [MainThread]: Using duckdb connection "master"
[0m11:30:00.123343 [debug] [MainThread]: On master: COMMIT
[0m11:30:00.123994 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:30:00.124435 [debug] [MainThread]: On master: Close
[0m11:30:00.126741 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_features
[0m11:30:00.127367 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_features ....................... [RUN]
[0m11:30:00.127943 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_features)
[0m11:30:00.128412 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_features
[0m11:30:00.135941 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_features"
[0m11:30:00.136820 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_features
[0m11:30:00.191317 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_features"
[0m11:30:00.192245 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_features"
[0m11:30:00.192754 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_features: BEGIN
[0m11:30:00.193230 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:30:00.194062 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:30:00.194563 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_features"
[0m11:30:00.195086 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_features: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_features"} */

  
    
    

    create  table
      "argus_vault"."main"."sat_txn_features"
  
    as (
      

WITH silver_data AS (
    -- Reading from our Iceberg Silver layer
    SELECT * FROM iceberg_scan('data/warehouse/db/silver_transactions')
)

SELECT
    -- 1. Link to the Hub (Primary Key)
    MD5(CAST(txn_id AS VARCHAR)) as txn_hash_key,

    -- 2. The Features (Context)
    pca_features,
    is_fraud_label,
    amount,
    
    -- 3. Hash Diff (Standard DV 2.0 for detecting state changes)
    MD5(
        CAST(amount AS VARCHAR) || 
        CAST(is_fraud_label AS VARCHAR) || 
        CAST(pca_features AS VARCHAR)
    ) as hash_diff,

    -- 4. Metadata
    txn_ts as load_date,
    'SPARK_ICEBERG_SILVER' as record_source

FROM silver_data


    );
  
  
  
[0m11:30:00.196281 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_features"} */

  
    
    

    create  table
      "argus_vault"."main"."sat_txn_features"
  
    as (
      

WITH silver_data AS (
    -- Reading from our Iceberg Silver layer
    SELECT * FROM iceberg_scan('data/warehouse/db/silver_transactions')
)

SELECT
    -- 1. Link to the Hub (Primary Key)
    MD5(CAST(txn_id AS VARCHAR)) as txn_hash_key,

    -- 2. The Features (Context)
    pca_features,
    is_fraud_label,
    amount,
    
    -- 3. Hash Diff (Standard DV 2.0 for detecting state changes)
    MD5(
        CAST(amount AS VARCHAR) || 
        CAST(is_fraud_label AS VARCHAR) || 
        CAST(pca_features AS VARCHAR)
    ) as hash_diff,

    -- 4. Metadata
    txn_ts as load_date,
    'SPARK_ICEBERG_SILVER' as record_source

FROM silver_data


    );
  
  
  
[0m11:30:00.196823 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m11:30:00.197439 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_features: ROLLBACK
[0m11:30:00.203452 [debug] [Thread-1 (]: Failed to rollback 'model.modern_stack_banking.sat_txn_features'
[0m11:30:00.203993 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_features: Close
[0m11:30:00.206536 [debug] [Thread-1 (]: Runtime Error in model sat_txn_features (models/Vault/sats/sat_txn_features.sql)
  Failed to read iceberg table. No version was provided and no version-hint could be found, globbing the filesystem to locate the latest version is disabled by default as this is considered unsafe and could result in reading uncommitted data. To enable this use 'SET unsafe_enable_version_guessing = true;'
  
  LINE 15:     SELECT * FROM iceberg_scan('data/warehouse/db/silver_transactions')
                             ^
[0m11:30:00.208209 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbf42725-ff4a-4b12-ada7-c339a282569e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772ad4038bc0>]}
[0m11:30:00.208970 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model main.sat_txn_features .............. [[31mERROR[0m in 0.08s]
[0m11:30:00.209729 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_features
[0m11:30:00.210431 [debug] [Thread-4 (]: Marking all children of 'model.modern_stack_banking.sat_txn_features' to be skipped because of status 'error'.  Reason: Runtime Error in model sat_txn_features (models/Vault/sats/sat_txn_features.sql)
  Failed to read iceberg table. No version was provided and no version-hint could be found, globbing the filesystem to locate the latest version is disabled by default as this is considered unsafe and could result in reading uncommitted data. To enable this use 'SET unsafe_enable_version_guessing = true;'
  
  LINE 15:     SELECT * FROM iceberg_scan('data/warehouse/db/silver_transactions')
                             ^.
[0m11:30:00.212434 [debug] [MainThread]: Using duckdb connection "master"
[0m11:30:00.212979 [debug] [MainThread]: On master: BEGIN
[0m11:30:00.213398 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:30:00.214081 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:30:00.214519 [debug] [MainThread]: On master: COMMIT
[0m11:30:00.214954 [debug] [MainThread]: Using duckdb connection "master"
[0m11:30:00.215399 [debug] [MainThread]: On master: COMMIT
[0m11:30:00.216105 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:30:00.216751 [debug] [MainThread]: On master: Close
[0m11:30:00.217511 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:30:00.217964 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_features' was properly closed.
[0m11:30:00.218655 [info ] [MainThread]: 
[0m11:30:00.219495 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 2.80 seconds (2.80s).
[0m11:30:00.220390 [debug] [MainThread]: Command end result
[0m11:30:00.291965 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m11:30:00.293662 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m11:30:00.299780 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m11:30:00.300246 [info ] [MainThread]: 
[0m11:30:00.300805 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:30:00.301279 [info ] [MainThread]: 
[0m11:30:00.301959 [error] [MainThread]: [31mFailure in model sat_txn_features (models/Vault/sats/sat_txn_features.sql)[0m
[0m11:30:00.302550 [error] [MainThread]:   Runtime Error in model sat_txn_features (models/Vault/sats/sat_txn_features.sql)
  Failed to read iceberg table. No version was provided and no version-hint could be found, globbing the filesystem to locate the latest version is disabled by default as this is considered unsafe and could result in reading uncommitted data. To enable this use 'SET unsafe_enable_version_guessing = true;'
  
  LINE 15:     SELECT * FROM iceberg_scan('data/warehouse/db/silver_transactions')
                             ^
[0m11:30:00.303027 [info ] [MainThread]: 
[0m11:30:00.303520 [info ] [MainThread]:   compiled code at target/compiled/modern_stack_banking/models/Vault/sats/sat_txn_features.sql
[0m11:30:00.303970 [info ] [MainThread]: 
[0m11:30:00.304432 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m11:30:00.305488 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.782399, "process_in_blocks": "1848", "process_kernel_time": 0.423924, "process_mem_max_rss": "305672", "process_out_blocks": "206480", "process_user_time": 4.269665}
[0m11:30:00.306114 [debug] [MainThread]: Command `dbt run` failed at 11:30:00.305982 after 3.78 seconds
[0m11:30:00.306843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772ae2347680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772ae2988a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772ae4761a00>]}
[0m11:30:00.307718 [debug] [MainThread]: Flushing usage events
[0m11:30:01.400647 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:31:31.008154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e480d5fa000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e480c7140b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e480cdaa5a0>]}


============================== 11:31:31.011472 | 13d929d1-d804-4d6e-b1bd-497dfe4944ca ==============================
[0m11:31:31.011472 [info ] [MainThread]: Running with dbt=1.11.2
[0m11:31:31.012245 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'indirect_selection': 'eager', 'warn_error': 'None', 'version_check': 'True', 'introspect': 'True', 'empty': 'False', 'static_parser': 'True', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run --select modern_stack_banking.Vault.sats.sat_txn_features --profiles-dir .', 'printer_width': '80', 'log_format': 'default', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'profiles_dir': '.', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'no_print': 'None', 'use_colors': 'True', 'fail_fast': 'False'}
[0m11:31:31.259727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '13d929d1-d804-4d6e-b1bd-497dfe4944ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e480c63e7b0>]}
[0m11:31:31.330653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '13d929d1-d804-4d6e-b1bd-497dfe4944ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e480c716330>]}
[0m11:31:31.332347 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m11:31:31.417125 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m11:31:31.482406 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m11:31:31.483033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '13d929d1-d804-4d6e-b1bd-497dfe4944ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e480ce627b0>]}
[0m11:31:32.595033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '13d929d1-d804-4d6e-b1bd-497dfe4944ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e480011cec0>]}
[0m11:31:32.651277 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m11:31:32.653124 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m11:31:32.665159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '13d929d1-d804-4d6e-b1bd-497dfe4944ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e48007d4d10>]}
[0m11:31:32.665798 [info ] [MainThread]: Found 2 models, 472 macros
[0m11:31:32.666332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13d929d1-d804-4d6e-b1bd-497dfe4944ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4800a4cfb0>]}
[0m11:31:32.668880 [info ] [MainThread]: 
[0m11:31:32.669747 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:31:32.670547 [info ] [MainThread]: 
[0m11:31:32.671606 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:31:32.673152 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m11:31:32.707771 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m11:31:32.708266 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m11:31:32.708723 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:31:32.800575 [debug] [ThreadPool]: SQL status: OK in 0.092 seconds
[0m11:31:32.802324 [debug] [ThreadPool]: On list_argus_vault: Close
[0m11:31:32.803231 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m11:31:32.803850 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m11:31:32.812811 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m11:31:32.813289 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m11:31:32.813737 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:31:32.815479 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m11:31:32.816857 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m11:31:32.817302 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m11:31:32.817926 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:31:32.818359 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m11:31:32.818791 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m11:31:32.819452 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:31:32.820402 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m11:31:32.820869 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m11:31:32.821286 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m11:31:32.821902 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:31:32.822350 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m11:31:32.827612 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m11:31:32.833467 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m11:31:32.833947 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m11:31:32.834360 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:31:32.835217 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:31:32.835657 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m11:31:32.836103 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m11:31:32.846925 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m11:31:32.848345 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m11:31:32.849620 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m11:31:32.850092 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m11:31:32.850781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13d929d1-d804-4d6e-b1bd-497dfe4944ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e480d015670>]}
[0m11:31:32.851373 [debug] [MainThread]: Using duckdb connection "master"
[0m11:31:32.851852 [debug] [MainThread]: On master: BEGIN
[0m11:31:32.852268 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:31:32.853142 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:31:32.853594 [debug] [MainThread]: On master: COMMIT
[0m11:31:32.854065 [debug] [MainThread]: Using duckdb connection "master"
[0m11:31:32.854473 [debug] [MainThread]: On master: COMMIT
[0m11:31:32.855168 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:31:32.855605 [debug] [MainThread]: On master: Close
[0m11:31:32.857620 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_features
[0m11:31:32.858274 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_features ....................... [RUN]
[0m11:31:32.858863 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_features)
[0m11:31:32.859342 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_features
[0m11:31:32.867246 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_features"
[0m11:31:32.868014 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_features
[0m11:31:32.924402 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_features"
[0m11:31:32.925196 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_features"
[0m11:31:32.925709 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_features: BEGIN
[0m11:31:32.926181 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:31:32.927480 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:31:32.927994 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_features"
[0m11:31:32.928481 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_features: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_features"} */

  
    
    

    create  table
      "argus_vault"."main"."sat_txn_features"
  
    as (
      

WITH silver_data AS (
    -- Reading from our Iceberg Silver layer
    SELECT * FROM iceberg_scan('data/warehouse/db/silver_transactions')
)

SELECT
    -- 1. Link to the Hub (Primary Key)
    MD5(CAST(txn_id AS VARCHAR)) as txn_hash_key,

    -- 2. The Features (Context)
    pca_features,
    is_fraud_label,
    amount,
    
    -- 3. Hash Diff (Standard DV 2.0 for detecting state changes)
    MD5(
        CAST(amount AS VARCHAR) || 
        CAST(is_fraud_label AS VARCHAR) || 
        CAST(pca_features AS VARCHAR)
    ) as hash_diff,

    -- 4. Metadata
    txn_ts as load_date,
    'SPARK_ICEBERG_SILVER' as record_source

FROM silver_data


    );
  
  
  
[0m11:31:32.929769 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_features"} */

  
    
    

    create  table
      "argus_vault"."main"."sat_txn_features"
  
    as (
      

WITH silver_data AS (
    -- Reading from our Iceberg Silver layer
    SELECT * FROM iceberg_scan('data/warehouse/db/silver_transactions')
)

SELECT
    -- 1. Link to the Hub (Primary Key)
    MD5(CAST(txn_id AS VARCHAR)) as txn_hash_key,

    -- 2. The Features (Context)
    pca_features,
    is_fraud_label,
    amount,
    
    -- 3. Hash Diff (Standard DV 2.0 for detecting state changes)
    MD5(
        CAST(amount AS VARCHAR) || 
        CAST(is_fraud_label AS VARCHAR) || 
        CAST(pca_features AS VARCHAR)
    ) as hash_diff,

    -- 4. Metadata
    txn_ts as load_date,
    'SPARK_ICEBERG_SILVER' as record_source

FROM silver_data


    );
  
  
  
[0m11:31:32.930299 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m11:31:32.930935 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_features: ROLLBACK
[0m11:31:32.934934 [debug] [Thread-1 (]: Failed to rollback 'model.modern_stack_banking.sat_txn_features'
[0m11:31:32.935446 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_features: Close
[0m11:31:32.937979 [debug] [Thread-1 (]: Runtime Error in model sat_txn_features (models/Vault/sats/sat_txn_features.sql)
  Could not guess Iceberg table version using 'none' compression and format(s): 'v%s%s.metadata.json,%s%s.metadata.json'
  
  LINE 15:     SELECT * FROM iceberg_scan('data/warehouse/db/silver_transactions')
                             ^
[0m11:31:32.939627 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13d929d1-d804-4d6e-b1bd-497dfe4944ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e47d1e98e00>]}
[0m11:31:32.940387 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model main.sat_txn_features .............. [[31mERROR[0m in 0.08s]
[0m11:31:32.941147 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_features
[0m11:31:32.941857 [debug] [Thread-4 (]: Marking all children of 'model.modern_stack_banking.sat_txn_features' to be skipped because of status 'error'.  Reason: Runtime Error in model sat_txn_features (models/Vault/sats/sat_txn_features.sql)
  Could not guess Iceberg table version using 'none' compression and format(s): 'v%s%s.metadata.json,%s%s.metadata.json'
  
  LINE 15:     SELECT * FROM iceberg_scan('data/warehouse/db/silver_transactions')
                             ^.
[0m11:31:32.943767 [debug] [MainThread]: Using duckdb connection "master"
[0m11:31:32.944227 [debug] [MainThread]: On master: BEGIN
[0m11:31:32.944634 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:31:32.945484 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:31:32.945970 [debug] [MainThread]: On master: COMMIT
[0m11:31:32.946383 [debug] [MainThread]: Using duckdb connection "master"
[0m11:31:32.946818 [debug] [MainThread]: On master: COMMIT
[0m11:31:32.947457 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:31:32.947939 [debug] [MainThread]: On master: Close
[0m11:31:32.948431 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:31:32.948886 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_features' was properly closed.
[0m11:31:32.949307 [info ] [MainThread]: 
[0m11:31:32.949801 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m11:31:32.950570 [debug] [MainThread]: Command end result
[0m11:31:32.969124 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m11:31:32.970734 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m11:31:32.976514 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m11:31:32.976996 [info ] [MainThread]: 
[0m11:31:32.977500 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:31:32.977996 [info ] [MainThread]: 
[0m11:31:32.978506 [error] [MainThread]: [31mFailure in model sat_txn_features (models/Vault/sats/sat_txn_features.sql)[0m
[0m11:31:32.979062 [error] [MainThread]:   Runtime Error in model sat_txn_features (models/Vault/sats/sat_txn_features.sql)
  Could not guess Iceberg table version using 'none' compression and format(s): 'v%s%s.metadata.json,%s%s.metadata.json'
  
  LINE 15:     SELECT * FROM iceberg_scan('data/warehouse/db/silver_transactions')
                             ^
[0m11:31:32.979499 [info ] [MainThread]: 
[0m11:31:32.980029 [info ] [MainThread]:   compiled code at target/compiled/modern_stack_banking/models/Vault/sats/sat_txn_features.sql
[0m11:31:32.980458 [info ] [MainThread]: 
[0m11:31:32.980961 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m11:31:32.981982 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.036324, "process_in_blocks": "0", "process_kernel_time": 0.280099, "process_mem_max_rss": "255076", "process_out_blocks": "2960", "process_user_time": 3.965925}
[0m11:31:32.982566 [debug] [MainThread]: Command `dbt run` failed at 11:31:32.982464 after 2.04 seconds
[0m11:31:32.983086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e480ce63050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e480d5699d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e480d5688c0>]}
[0m11:31:32.983571 [debug] [MainThread]: Flushing usage events
[0m11:31:34.141722 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:33:17.420730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f099239be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f09a1833e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f09859a600>]}


============================== 11:33:17.424004 | badc763d-f39b-4749-9212-354af1688f8f ==============================
[0m11:33:17.424004 [info ] [MainThread]: Running with dbt=1.11.2
[0m11:33:17.424802 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'invocation_command': 'dbt run --select modern_stack_banking.Vault.sats.sat_txn_features --profiles-dir .', 'use_experimental_parser': 'False', 'printer_width': '80', 'static_parser': 'True', 'quiet': 'False', 'profiles_dir': '.', 'version_check': 'True', 'empty': 'False', 'cache_selected_only': 'False', 'introspect': 'True', 'fail_fast': 'False', 'log_format': 'default', 'no_print': 'None', 'target_path': 'None', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'use_colors': 'True', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'write_json': 'True'}
[0m11:33:17.671714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'badc763d-f39b-4749-9212-354af1688f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f09833caa0>]}
[0m11:33:17.742712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'badc763d-f39b-4749-9212-354af1688f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f09844da00>]}
[0m11:33:17.744355 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m11:33:17.829196 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m11:33:17.906215 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:33:17.906899 [debug] [MainThread]: Partial parsing: updated file: modern_stack_banking://models/Vault/sats/sat_txn_features.sql
[0m11:33:18.172563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'badc763d-f39b-4749-9212-354af1688f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f08c3e0e00>]}
[0m11:33:18.226171 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m11:33:18.227822 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m11:33:18.239324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'badc763d-f39b-4749-9212-354af1688f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f098225dc0>]}
[0m11:33:18.239889 [info ] [MainThread]: Found 2 models, 472 macros
[0m11:33:18.240398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'badc763d-f39b-4749-9212-354af1688f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f08c3e05f0>]}
[0m11:33:18.242088 [info ] [MainThread]: 
[0m11:33:18.242604 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:33:18.243090 [info ] [MainThread]: 
[0m11:33:18.243713 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:33:18.244745 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m11:33:18.279349 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m11:33:18.279854 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m11:33:18.280299 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:33:18.373779 [debug] [ThreadPool]: SQL status: OK in 0.093 seconds
[0m11:33:18.375444 [debug] [ThreadPool]: On list_argus_vault: Close
[0m11:33:18.376359 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m11:33:18.376979 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m11:33:18.384407 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m11:33:18.384919 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m11:33:18.385361 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:33:18.386545 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:33:18.387902 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m11:33:18.388345 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m11:33:18.388999 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:33:18.389428 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m11:33:18.389865 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m11:33:18.390558 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:33:18.391496 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m11:33:18.391963 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m11:33:18.392381 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m11:33:18.393045 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:33:18.393484 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m11:33:18.398896 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m11:33:18.404573 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m11:33:18.405070 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m11:33:18.405500 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:33:18.406401 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:33:18.406859 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m11:33:18.407275 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m11:33:18.417930 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m11:33:18.419186 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m11:33:18.420436 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m11:33:18.420898 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m11:33:18.421592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'badc763d-f39b-4749-9212-354af1688f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f0982e7740>]}
[0m11:33:18.422328 [debug] [MainThread]: Using duckdb connection "master"
[0m11:33:18.422789 [debug] [MainThread]: On master: BEGIN
[0m11:33:18.423194 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:33:18.424021 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:33:18.424466 [debug] [MainThread]: On master: COMMIT
[0m11:33:18.424907 [debug] [MainThread]: Using duckdb connection "master"
[0m11:33:18.425318 [debug] [MainThread]: On master: COMMIT
[0m11:33:18.425938 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:33:18.426380 [debug] [MainThread]: On master: Close
[0m11:33:18.428376 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_features
[0m11:33:18.429007 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_features ....................... [RUN]
[0m11:33:18.429564 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_features)
[0m11:33:18.430078 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_features
[0m11:33:18.437741 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_features"
[0m11:33:18.438445 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_features
[0m11:33:18.494564 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_features"
[0m11:33:18.495319 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_features"
[0m11:33:18.495832 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_features: BEGIN
[0m11:33:18.496293 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:33:18.497224 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:33:18.497731 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_features"
[0m11:33:18.498225 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_features: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_features"} */

  
    
    

    create  table
      "argus_vault"."main"."sat_txn_features"
  
    as (
      

WITH silver_data AS (
    -- Reading from our Iceberg Silver layer
    SELECT * FROM iceberg_scan('/workspaces/modern-stack-banking/data/warehouse/db/silver_transactions/metadata/v1.metadata.json')
)

SELECT
    -- 1. Link to the Hub (Primary Key)
    MD5(CAST(txn_id AS VARCHAR)) as txn_hash_key,

    -- 2. The Features (Context)
    pca_features,
    is_fraud_label,
    amount,
    
    -- 3. Hash Diff (Standard DV 2.0 for detecting state changes)
    MD5(
        CAST(amount AS VARCHAR) || 
        CAST(is_fraud_label AS VARCHAR) || 
        CAST(pca_features AS VARCHAR)
    ) as hash_diff,

    -- 4. Metadata
    txn_ts as load_date,
    'SPARK_ICEBERG_SILVER' as record_source

FROM silver_data


    );
  
  
  
[0m11:33:20.443892 [debug] [Thread-1 (]: SQL status: OK in 1.945 seconds
[0m11:33:20.458456 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_features: COMMIT
[0m11:33:20.459012 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_features"
[0m11:33:20.459505 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_features: COMMIT
[0m11:33:21.316843 [debug] [Thread-1 (]: SQL status: OK in 0.857 seconds
[0m11:33:21.319121 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_features: Close
[0m11:33:21.320920 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'badc763d-f39b-4749-9212-354af1688f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f08c3ac7a0>]}
[0m11:33:21.321719 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_features .................. [[32mOK[0m in 2.89s]
[0m11:33:21.322451 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_features
[0m11:33:21.328106 [debug] [MainThread]: Using duckdb connection "master"
[0m11:33:21.328790 [debug] [MainThread]: On master: BEGIN
[0m11:33:21.329261 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:33:21.330312 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:33:21.330802 [debug] [MainThread]: On master: COMMIT
[0m11:33:21.331245 [debug] [MainThread]: Using duckdb connection "master"
[0m11:33:21.331693 [debug] [MainThread]: On master: COMMIT
[0m11:33:21.332364 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:33:21.332855 [debug] [MainThread]: On master: Close
[0m11:33:21.333418 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:33:21.333885 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_features' was properly closed.
[0m11:33:21.334338 [info ] [MainThread]: 
[0m11:33:21.334901 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 3.09 seconds (3.09s).
[0m11:33:21.335771 [debug] [MainThread]: Command end result
[0m11:33:21.404453 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m11:33:21.406190 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m11:33:21.412007 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m11:33:21.412454 [info ] [MainThread]: 
[0m11:33:21.413071 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:33:21.413576 [info ] [MainThread]: 
[0m11:33:21.414124 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m11:33:21.415218 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.0571785, "process_in_blocks": "0", "process_kernel_time": 0.562017, "process_mem_max_rss": "933804", "process_out_blocks": "154000", "process_user_time": 8.601662}
[0m11:33:21.415842 [debug] [MainThread]: Command `dbt run` succeeded at 11:33:21.415737 after 4.06 seconds
[0m11:33:21.416321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f098a4b470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f098a49e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f08476bf80>]}
[0m11:33:21.416831 [debug] [MainThread]: Flushing usage events
[0m11:33:22.532064 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:34:50.862216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73cba5b57920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73cba6c92b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73cba5b57830>]}


============================== 11:34:50.865635 | 0657409f-6867-473e-ad50-b25734337e40 ==============================
[0m11:34:50.865635 [info ] [MainThread]: Running with dbt=1.11.2
[0m11:34:50.866334 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'empty': 'False', 'warn_error': 'None', 'target_path': 'None', 'debug': 'False', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'partial_parse': 'True', 'log_format': 'default', 'introspect': 'True', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'profiles_dir': '.', 'use_colors': 'True', 'fail_fast': 'False', 'write_json': 'True', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run --select modern_stack_banking.Vault.hubs.hubs_transactions --profiles-dir .', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True'}
[0m11:34:51.110729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0657409f-6867-473e-ad50-b25734337e40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73cba4b950a0>]}
[0m11:34:51.181564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0657409f-6867-473e-ad50-b25734337e40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73cb9914b470>]}
[0m11:34:51.183208 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m11:34:51.267408 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m11:34:51.344057 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:34:51.344724 [debug] [MainThread]: Partial parsing: updated file: modern_stack_banking://models/Vault/hubs/hubs_transactions.sql
[0m11:34:51.609036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0657409f-6867-473e-ad50-b25734337e40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73cb9816c2c0>]}
[0m11:34:51.662536 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m11:34:51.664197 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m11:34:51.675574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0657409f-6867-473e-ad50-b25734337e40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73cb98f93a40>]}
[0m11:34:51.676137 [info ] [MainThread]: Found 2 models, 472 macros
[0m11:34:51.676638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0657409f-6867-473e-ad50-b25734337e40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73cb9917ffe0>]}
[0m11:34:51.678293 [info ] [MainThread]: 
[0m11:34:51.678824 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:34:51.679294 [info ] [MainThread]: 
[0m11:34:51.679915 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:34:51.680965 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m11:34:51.716044 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m11:34:51.716543 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m11:34:51.717018 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:34:51.804023 [debug] [ThreadPool]: SQL status: OK in 0.087 seconds
[0m11:34:51.805631 [debug] [ThreadPool]: On list_argus_vault: Close
[0m11:34:51.806512 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m11:34:51.807168 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m11:34:51.814353 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m11:34:51.814847 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m11:34:51.815278 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:34:51.816660 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:34:51.817987 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m11:34:51.818423 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m11:34:51.819031 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:34:51.819457 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m11:34:51.819886 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m11:34:51.820505 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:34:51.821428 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m11:34:51.821887 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m11:34:51.822296 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m11:34:51.822968 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:34:51.823413 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m11:34:51.828820 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m11:34:51.834390 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m11:34:51.834867 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m11:34:51.835275 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:34:51.836113 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:34:51.836548 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m11:34:51.836994 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m11:34:51.847970 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m11:34:51.849313 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m11:34:51.850560 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m11:34:51.851027 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m11:34:51.852014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0657409f-6867-473e-ad50-b25734337e40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73cb9819cf80>]}
[0m11:34:51.852662 [debug] [MainThread]: Using duckdb connection "master"
[0m11:34:51.853133 [debug] [MainThread]: On master: BEGIN
[0m11:34:51.853543 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:34:51.854527 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:34:51.855005 [debug] [MainThread]: On master: COMMIT
[0m11:34:51.855428 [debug] [MainThread]: Using duckdb connection "master"
[0m11:34:51.855863 [debug] [MainThread]: On master: COMMIT
[0m11:34:51.856566 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:34:51.857037 [debug] [MainThread]: On master: Close
[0m11:34:51.859026 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.hubs_transactions
[0m11:34:51.859650 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.hubs_transactions ...................... [RUN]
[0m11:34:51.860240 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.hubs_transactions)
[0m11:34:51.860746 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.hubs_transactions
[0m11:34:51.868611 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.hubs_transactions"
[0m11:34:51.869382 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.hubs_transactions
[0m11:34:51.926048 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.hubs_transactions"
[0m11:34:51.926818 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.hubs_transactions"
[0m11:34:51.927314 [debug] [Thread-1 (]: On model.modern_stack_banking.hubs_transactions: BEGIN
[0m11:34:51.927780 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:34:51.928928 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:34:51.929416 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.hubs_transactions"
[0m11:34:51.929924 [debug] [Thread-1 (]: On model.modern_stack_banking.hubs_transactions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.hubs_transactions"} */

  
    
    

    create  table
      "argus_vault"."main"."hubs_transactions"
  
    as (
      

WITH silver_src AS (
    -- Reusing the same Iceberg source we just validated
    SELECT 
        txn_id,
        txn_ts,
        'SPARK_ICEBERG_SILVER' as record_source
    FROM iceberg_scan('/workspaces/modern-stack-banking/data/warehouse/db/silver_transactions/metadata/v1.metadata.json')
)

SELECT
    -- MD5 Hashing the business key (txn_id) to create the unique anchor
    MD5(CAST(txn_id AS VARCHAR)) as txn_hash_key,
    txn_id,
    txn_ts as load_date,
    record_source
FROM silver_src


    );
  
  
  
[0m11:34:52.246307 [debug] [Thread-1 (]: SQL status: OK in 0.316 seconds
[0m11:34:52.260920 [debug] [Thread-1 (]: On model.modern_stack_banking.hubs_transactions: COMMIT
[0m11:34:52.261490 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.hubs_transactions"
[0m11:34:52.261993 [debug] [Thread-1 (]: On model.modern_stack_banking.hubs_transactions: COMMIT
[0m11:34:52.433571 [debug] [Thread-1 (]: SQL status: OK in 0.171 seconds
[0m11:34:52.435914 [debug] [Thread-1 (]: On model.modern_stack_banking.hubs_transactions: Close
[0m11:34:52.437728 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0657409f-6867-473e-ad50-b25734337e40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73cba794cf20>]}
[0m11:34:52.438512 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.hubs_transactions ................. [[32mOK[0m in 0.58s]
[0m11:34:52.439290 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.hubs_transactions
[0m11:34:52.442492 [debug] [MainThread]: Using duckdb connection "master"
[0m11:34:52.443008 [debug] [MainThread]: On master: BEGIN
[0m11:34:52.443428 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:34:52.444459 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:34:52.444929 [debug] [MainThread]: On master: COMMIT
[0m11:34:52.445348 [debug] [MainThread]: Using duckdb connection "master"
[0m11:34:52.445830 [debug] [MainThread]: On master: COMMIT
[0m11:34:52.446496 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:34:52.446986 [debug] [MainThread]: On master: Close
[0m11:34:52.447492 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:34:52.447927 [debug] [MainThread]: Connection 'model.modern_stack_banking.hubs_transactions' was properly closed.
[0m11:34:52.448349 [info ] [MainThread]: 
[0m11:34:52.448835 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.77 seconds (0.77s).
[0m11:34:52.449602 [debug] [MainThread]: Command end result
[0m11:34:52.524474 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m11:34:52.526151 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m11:34:52.531887 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m11:34:52.532346 [info ] [MainThread]: 
[0m11:34:52.532893 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:34:52.533348 [info ] [MainThread]: 
[0m11:34:52.533853 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m11:34:52.534923 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7372911, "process_in_blocks": "0", "process_kernel_time": 0.34586, "process_mem_max_rss": "398196", "process_out_blocks": "30616", "process_user_time": 3.598332}
[0m11:34:52.535488 [debug] [MainThread]: Command `dbt run` succeeded at 11:34:52.535385 after 1.74 seconds
[0m11:34:52.535982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73cba55a6630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73cba57da660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73cba57d8800>]}
[0m11:34:52.536468 [debug] [MainThread]: Flushing usage events
[0m11:34:53.595872 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:36:51.448647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745e6b401f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745e6b421ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745e6b4035c0>]}


============================== 11:36:51.451854 | 98ed191d-4ab9-4509-906b-5bb7b3ac5593 ==============================
[0m11:36:51.451854 [info ] [MainThread]: Running with dbt=1.11.2
[0m11:36:51.452542 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'log_format': 'default', 'cache_selected_only': 'False', 'profiles_dir': '.', 'write_json': 'True', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'no_print': 'None', 'introspect': 'True', 'invocation_command': 'dbt run --select gold_fraud_analysis --profiles-dir .', 'indirect_selection': 'eager', 'target_path': 'None', 'debug': 'False', 'partial_parse': 'True', 'quiet': 'False', 'version_check': 'True', 'use_colors': 'True', 'printer_width': '80', 'use_experimental_parser': 'False', 'static_parser': 'True', 'log_cache_events': 'False'}
[0m11:36:51.699134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '98ed191d-4ab9-4509-906b-5bb7b3ac5593', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745e6a3056a0>]}
[0m11:36:51.770032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '98ed191d-4ab9-4509-906b-5bb7b3ac5593', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745e6aac3320>]}
[0m11:36:51.771604 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m11:36:51.854852 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m11:36:51.931470 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m11:36:51.932102 [debug] [MainThread]: Partial parsing: added file: modern_stack_banking://models/Gold/gold_fraud_analysis.sql
[0m11:36:52.194550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '98ed191d-4ab9-4509-906b-5bb7b3ac5593', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745e5e478920>]}
[0m11:36:52.248940 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m11:36:52.250530 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m11:36:52.261919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '98ed191d-4ab9-4509-906b-5bb7b3ac5593', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745e5e532f00>]}
[0m11:36:52.262468 [info ] [MainThread]: Found 3 models, 472 macros
[0m11:36:52.263027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98ed191d-4ab9-4509-906b-5bb7b3ac5593', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745e6a1b9910>]}
[0m11:36:52.264687 [info ] [MainThread]: 
[0m11:36:52.265239 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:36:52.265755 [info ] [MainThread]: 
[0m11:36:52.266396 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:36:52.267354 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m11:36:52.302388 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m11:36:52.302918 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m11:36:52.303368 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:36:52.392603 [debug] [ThreadPool]: SQL status: OK in 0.089 seconds
[0m11:36:52.394267 [debug] [ThreadPool]: On list_argus_vault: Close
[0m11:36:52.395140 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m11:36:52.395748 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m11:36:52.403155 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m11:36:52.403633 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m11:36:52.404106 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:36:52.405320 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:36:52.406628 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m11:36:52.407100 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m11:36:52.407769 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:36:52.408208 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m11:36:52.408636 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m11:36:52.409365 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:36:52.410303 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m11:36:52.410766 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m11:36:52.411185 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m11:36:52.411819 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:36:52.412260 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m11:36:52.417533 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m11:36:52.423235 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m11:36:52.423792 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m11:36:52.424204 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:36:52.425298 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:36:52.425757 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m11:36:52.426183 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m11:36:52.436948 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m11:36:52.438293 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m11:36:52.439542 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m11:36:52.440014 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m11:36:52.441069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98ed191d-4ab9-4509-906b-5bb7b3ac5593', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745e5e396ab0>]}
[0m11:36:52.441635 [debug] [MainThread]: Using duckdb connection "master"
[0m11:36:52.442091 [debug] [MainThread]: On master: BEGIN
[0m11:36:52.442499 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:36:52.443319 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:36:52.443779 [debug] [MainThread]: On master: COMMIT
[0m11:36:52.444199 [debug] [MainThread]: Using duckdb connection "master"
[0m11:36:52.444608 [debug] [MainThread]: On master: COMMIT
[0m11:36:52.445286 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:36:52.445741 [debug] [MainThread]: On master: Close
[0m11:36:52.447698 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.gold_fraud_analysis
[0m11:36:52.448310 [info ] [Thread-1 (]: 1 of 1 START sql view model main.gold_fraud_analysis ........................... [RUN]
[0m11:36:52.448895 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.gold_fraud_analysis)
[0m11:36:52.449373 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.gold_fraud_analysis
[0m11:36:52.457145 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.gold_fraud_analysis"
[0m11:36:52.457893 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.gold_fraud_analysis
[0m11:36:52.489489 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.gold_fraud_analysis"
[0m11:36:52.490262 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.gold_fraud_analysis"
[0m11:36:52.490770 [debug] [Thread-1 (]: On model.modern_stack_banking.gold_fraud_analysis: BEGIN
[0m11:36:52.491243 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:36:52.492338 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:36:52.492853 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.gold_fraud_analysis"
[0m11:36:52.493341 [debug] [Thread-1 (]: On model.modern_stack_banking.gold_fraud_analysis: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.gold_fraud_analysis"} */

  
  create view "argus_vault"."main"."gold_fraud_analysis__dbt_tmp" as (
    

WITH transactions AS (
    -- Get the unique IDs from the Hub
    SELECT 
        txn_hash_key,
        txn_id,
        record_source
    FROM "argus_vault"."main"."hubs_transactions"
),

fraud_context AS (
    -- Get the latest state (features/label) from the Satellite
    SELECT 
        txn_hash_key,
        amount,
        is_fraud_label,
        pca_features,
        load_date
    FROM "argus_vault"."main"."sat_txn_features"
    QUALIFY ROW_NUMBER() OVER (PARTITION BY txn_hash_key ORDER BY load_date DESC) = 1
)
SELECT
    t.txn_id,
    c.amount,
    c.is_fraud_label,
    c.pca_features,
    c.load_date as analysis_timestamp,
    t.record_source
FROM transactions t
JOIN fraud_context c ON t.txn_hash_key = c.txn_hash_key
  );

[0m11:36:52.494687 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:36:52.500851 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.gold_fraud_analysis"
[0m11:36:52.501369 [debug] [Thread-1 (]: On model.modern_stack_banking.gold_fraud_analysis: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.gold_fraud_analysis"} */
alter view "argus_vault"."main"."gold_fraud_analysis__dbt_tmp" rename to "gold_fraud_analysis"
[0m11:36:52.502187 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:36:52.512750 [debug] [Thread-1 (]: On model.modern_stack_banking.gold_fraud_analysis: COMMIT
[0m11:36:52.513289 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.gold_fraud_analysis"
[0m11:36:52.513780 [debug] [Thread-1 (]: On model.modern_stack_banking.gold_fraud_analysis: COMMIT
[0m11:36:52.527326 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m11:36:52.533719 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.gold_fraud_analysis"
[0m11:36:52.534238 [debug] [Thread-1 (]: On model.modern_stack_banking.gold_fraud_analysis: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.gold_fraud_analysis"} */

      drop view if exists "argus_vault"."main"."gold_fraud_analysis__dbt_backup" cascade
    
[0m11:36:52.535059 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:36:52.537469 [debug] [Thread-1 (]: On model.modern_stack_banking.gold_fraud_analysis: Close
[0m11:36:52.539145 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98ed191d-4ab9-4509-906b-5bb7b3ac5593', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745e6d048e00>]}
[0m11:36:52.539904 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.gold_fraud_analysis ...................... [[32mOK[0m in 0.09s]
[0m11:36:52.540645 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.gold_fraud_analysis
[0m11:36:52.541991 [debug] [MainThread]: Using duckdb connection "master"
[0m11:36:52.542446 [debug] [MainThread]: On master: BEGIN
[0m11:36:52.542896 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:36:52.543846 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:36:52.544294 [debug] [MainThread]: On master: COMMIT
[0m11:36:52.544730 [debug] [MainThread]: Using duckdb connection "master"
[0m11:36:52.545136 [debug] [MainThread]: On master: COMMIT
[0m11:36:52.545732 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:36:52.546163 [debug] [MainThread]: On master: Close
[0m11:36:52.546649 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:36:52.547074 [debug] [MainThread]: Connection 'model.modern_stack_banking.gold_fraud_analysis' was properly closed.
[0m11:36:52.547495 [info ] [MainThread]: 
[0m11:36:52.547977 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m11:36:52.548757 [debug] [MainThread]: Command end result
[0m11:36:52.634285 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m11:36:52.636452 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m11:36:52.642767 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m11:36:52.643267 [info ] [MainThread]: 
[0m11:36:52.643875 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:36:52.644358 [info ] [MainThread]: 
[0m11:36:52.644910 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m11:36:52.646003 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.259822, "process_in_blocks": "0", "process_kernel_time": 0.27914, "process_mem_max_rss": "260912", "process_out_blocks": "3000", "process_user_time": 3.182002}
[0m11:36:52.646611 [debug] [MainThread]: Command `dbt run` succeeded at 11:36:52.646501 after 1.26 seconds
[0m11:36:52.647146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745e6c359c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745e5e388380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745e5e389a60>]}
[0m11:36:52.647685 [debug] [MainThread]: Flushing usage events
[0m11:36:53.794379 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:39:32.866318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2aec8d5f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2aec5a0bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2aeddc1070>]}


============================== 11:39:32.869501 | 0767f581-92ab-4061-ab7d-496b0ce9fe2d ==============================
[0m11:39:32.869501 [info ] [MainThread]: Running with dbt=1.11.2
[0m11:39:32.870221 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt test --select gold_fraud_analysis --profiles-dir .', 'indirect_selection': 'eager', 'no_print': 'None', 'cache_selected_only': 'False', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'introspect': 'True', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'version_check': 'True', 'partial_parse': 'True', 'profiles_dir': '.', 'empty': 'None', 'quiet': 'False', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'target_path': 'None'}
[0m11:39:33.113850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0767f581-92ab-4061-ab7d-496b0ce9fe2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2aeb8f46b0>]}
[0m11:39:33.184539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0767f581-92ab-4061-ab7d-496b0ce9fe2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2aeba3b590>]}
[0m11:39:33.186145 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m11:39:33.271042 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m11:39:33.350583 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m11:39:33.351289 [debug] [MainThread]: Partial parsing: added file: modern_stack_banking://models/Gold/schema.yml
[0m11:39:33.550246 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m11:39:33.550966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0767f581-92ab-4061-ab7d-496b0ce9fe2d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2adf93d5e0>]}
[0m11:39:33.636656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0767f581-92ab-4061-ab7d-496b0ce9fe2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2add90c380>]}
[0m11:39:33.709225 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m11:39:33.710850 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m11:39:33.731876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0767f581-92ab-4061-ab7d-496b0ce9fe2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2add934320>]}
[0m11:39:33.732426 [info ] [MainThread]: Found 3 models, 5 data tests, 472 macros
[0m11:39:33.732936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0767f581-92ab-4061-ab7d-496b0ce9fe2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2add92a8d0>]}
[0m11:39:33.734865 [info ] [MainThread]: 
[0m11:39:33.735395 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:39:33.735859 [info ] [MainThread]: 
[0m11:39:33.736464 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:39:33.741505 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault_main'
[0m11:39:33.775307 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m11:39:33.775807 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m11:39:33.776248 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:39:33.864622 [debug] [ThreadPool]: SQL status: OK in 0.088 seconds
[0m11:39:33.865257 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m11:39:33.865749 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m11:39:33.877132 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m11:39:33.878735 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m11:39:33.880034 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m11:39:33.880479 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m11:39:33.881836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0767f581-92ab-4061-ab7d-496b0ce9fe2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2add90c9e0>]}
[0m11:39:33.882481 [debug] [MainThread]: Using duckdb connection "master"
[0m11:39:33.882987 [debug] [MainThread]: On master: BEGIN
[0m11:39:33.883427 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:39:33.884726 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:39:33.885199 [debug] [MainThread]: On master: COMMIT
[0m11:39:33.885645 [debug] [MainThread]: Using duckdb connection "master"
[0m11:39:33.886121 [debug] [MainThread]: On master: COMMIT
[0m11:39:33.886851 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:39:33.887318 [debug] [MainThread]: On master: Close
[0m11:39:33.889439 [debug] [Thread-1 (]: Began running node test.modern_stack_banking.accepted_values_gold_fraud_analysis_is_fraud_label__0__1.ec1ac9281b
[0m11:39:33.889998 [info ] [Thread-1 (]: 1 of 5 START test accepted_values_gold_fraud_analysis_is_fraud_label__0__1 ..... [RUN]
[0m11:39:33.890558 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now test.modern_stack_banking.accepted_values_gold_fraud_analysis_is_fraud_label__0__1.ec1ac9281b)
[0m11:39:33.891100 [debug] [Thread-1 (]: Began compiling node test.modern_stack_banking.accepted_values_gold_fraud_analysis_is_fraud_label__0__1.ec1ac9281b
[0m11:39:33.950065 [debug] [Thread-1 (]: Writing injected SQL for node "test.modern_stack_banking.accepted_values_gold_fraud_analysis_is_fraud_label__0__1.ec1ac9281b"
[0m11:39:33.950924 [debug] [Thread-1 (]: Began executing node test.modern_stack_banking.accepted_values_gold_fraud_analysis_is_fraud_label__0__1.ec1ac9281b
[0m11:39:33.970742 [debug] [Thread-1 (]: Writing runtime sql for node "test.modern_stack_banking.accepted_values_gold_fraud_analysis_is_fraud_label__0__1.ec1ac9281b"
[0m11:39:33.971521 [debug] [Thread-1 (]: Using duckdb connection "test.modern_stack_banking.accepted_values_gold_fraud_analysis_is_fraud_label__0__1.ec1ac9281b"
[0m11:39:33.972052 [debug] [Thread-1 (]: On test.modern_stack_banking.accepted_values_gold_fraud_analysis_is_fraud_label__0__1.ec1ac9281b: BEGIN
[0m11:39:33.972522 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:33.974371 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:39:33.974918 [debug] [Thread-1 (]: Using duckdb connection "test.modern_stack_banking.accepted_values_gold_fraud_analysis_is_fraud_label__0__1.ec1ac9281b"
[0m11:39:33.975407 [debug] [Thread-1 (]: On test.modern_stack_banking.accepted_values_gold_fraud_analysis_is_fraud_label__0__1.ec1ac9281b: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "test.modern_stack_banking.accepted_values_gold_fraud_analysis_is_fraud_label__0__1.ec1ac9281b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        is_fraud_label as value_field,
        count(*) as n_records

    from "argus_vault"."main"."gold_fraud_analysis"
    group by is_fraud_label

)

select *
from all_values
where value_field not in (
    '0','1'
)



  
  
      
    ) dbt_internal_test
[0m11:39:34.018360 [debug] [Thread-1 (]: SQL status: OK in 0.042 seconds
[0m11:39:34.023107 [debug] [Thread-1 (]: On test.modern_stack_banking.accepted_values_gold_fraud_analysis_is_fraud_label__0__1.ec1ac9281b: ROLLBACK
[0m11:39:34.024236 [debug] [Thread-1 (]: Failed to rollback 'test.modern_stack_banking.accepted_values_gold_fraud_analysis_is_fraud_label__0__1.ec1ac9281b'
[0m11:39:34.024762 [debug] [Thread-1 (]: On test.modern_stack_banking.accepted_values_gold_fraud_analysis_is_fraud_label__0__1.ec1ac9281b: Close
[0m11:39:34.025524 [info ] [Thread-1 (]: 1 of 5 PASS accepted_values_gold_fraud_analysis_is_fraud_label__0__1 ........... [[32mPASS[0m in 0.13s]
[0m11:39:34.026285 [debug] [Thread-1 (]: Finished running node test.modern_stack_banking.accepted_values_gold_fraud_analysis_is_fraud_label__0__1.ec1ac9281b
[0m11:39:34.026827 [debug] [Thread-1 (]: Began running node test.modern_stack_banking.not_null_gold_fraud_analysis_amount.3f91df14ec
[0m11:39:34.027412 [info ] [Thread-1 (]: 2 of 5 START test not_null_gold_fraud_analysis_amount .......................... [RUN]
[0m11:39:34.027990 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.modern_stack_banking.accepted_values_gold_fraud_analysis_is_fraud_label__0__1.ec1ac9281b, now test.modern_stack_banking.not_null_gold_fraud_analysis_amount.3f91df14ec)
[0m11:39:34.028471 [debug] [Thread-1 (]: Began compiling node test.modern_stack_banking.not_null_gold_fraud_analysis_amount.3f91df14ec
[0m11:39:34.035731 [debug] [Thread-1 (]: Writing injected SQL for node "test.modern_stack_banking.not_null_gold_fraud_analysis_amount.3f91df14ec"
[0m11:39:34.036415 [debug] [Thread-1 (]: Began executing node test.modern_stack_banking.not_null_gold_fraud_analysis_amount.3f91df14ec
[0m11:39:34.039227 [debug] [Thread-1 (]: Writing runtime sql for node "test.modern_stack_banking.not_null_gold_fraud_analysis_amount.3f91df14ec"
[0m11:39:34.039940 [debug] [Thread-1 (]: Using duckdb connection "test.modern_stack_banking.not_null_gold_fraud_analysis_amount.3f91df14ec"
[0m11:39:34.040439 [debug] [Thread-1 (]: On test.modern_stack_banking.not_null_gold_fraud_analysis_amount.3f91df14ec: BEGIN
[0m11:39:34.040930 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:34.041910 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:39:34.042413 [debug] [Thread-1 (]: Using duckdb connection "test.modern_stack_banking.not_null_gold_fraud_analysis_amount.3f91df14ec"
[0m11:39:34.042915 [debug] [Thread-1 (]: On test.modern_stack_banking.not_null_gold_fraud_analysis_amount.3f91df14ec: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "test.modern_stack_banking.not_null_gold_fraud_analysis_amount.3f91df14ec"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select amount
from "argus_vault"."main"."gold_fraud_analysis"
where amount is null



  
  
      
    ) dbt_internal_test
[0m11:39:34.044831 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:39:34.046333 [debug] [Thread-1 (]: On test.modern_stack_banking.not_null_gold_fraud_analysis_amount.3f91df14ec: ROLLBACK
[0m11:39:34.047390 [debug] [Thread-1 (]: Failed to rollback 'test.modern_stack_banking.not_null_gold_fraud_analysis_amount.3f91df14ec'
[0m11:39:34.047900 [debug] [Thread-1 (]: On test.modern_stack_banking.not_null_gold_fraud_analysis_amount.3f91df14ec: Close
[0m11:39:34.048551 [info ] [Thread-1 (]: 2 of 5 PASS not_null_gold_fraud_analysis_amount ................................ [[32mPASS[0m in 0.02s]
[0m11:39:34.049264 [debug] [Thread-1 (]: Finished running node test.modern_stack_banking.not_null_gold_fraud_analysis_amount.3f91df14ec
[0m11:39:34.049800 [debug] [Thread-1 (]: Began running node test.modern_stack_banking.not_null_gold_fraud_analysis_is_fraud_label.507c69683c
[0m11:39:34.050359 [info ] [Thread-1 (]: 3 of 5 START test not_null_gold_fraud_analysis_is_fraud_label .................. [RUN]
[0m11:39:34.050925 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.modern_stack_banking.not_null_gold_fraud_analysis_amount.3f91df14ec, now test.modern_stack_banking.not_null_gold_fraud_analysis_is_fraud_label.507c69683c)
[0m11:39:34.051404 [debug] [Thread-1 (]: Began compiling node test.modern_stack_banking.not_null_gold_fraud_analysis_is_fraud_label.507c69683c
[0m11:39:34.055463 [debug] [Thread-1 (]: Writing injected SQL for node "test.modern_stack_banking.not_null_gold_fraud_analysis_is_fraud_label.507c69683c"
[0m11:39:34.056116 [debug] [Thread-1 (]: Began executing node test.modern_stack_banking.not_null_gold_fraud_analysis_is_fraud_label.507c69683c
[0m11:39:34.058714 [debug] [Thread-1 (]: Writing runtime sql for node "test.modern_stack_banking.not_null_gold_fraud_analysis_is_fraud_label.507c69683c"
[0m11:39:34.059377 [debug] [Thread-1 (]: Using duckdb connection "test.modern_stack_banking.not_null_gold_fraud_analysis_is_fraud_label.507c69683c"
[0m11:39:34.059893 [debug] [Thread-1 (]: On test.modern_stack_banking.not_null_gold_fraud_analysis_is_fraud_label.507c69683c: BEGIN
[0m11:39:34.060354 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:34.061283 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:39:34.061791 [debug] [Thread-1 (]: Using duckdb connection "test.modern_stack_banking.not_null_gold_fraud_analysis_is_fraud_label.507c69683c"
[0m11:39:34.062274 [debug] [Thread-1 (]: On test.modern_stack_banking.not_null_gold_fraud_analysis_is_fraud_label.507c69683c: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "test.modern_stack_banking.not_null_gold_fraud_analysis_is_fraud_label.507c69683c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_fraud_label
from "argus_vault"."main"."gold_fraud_analysis"
where is_fraud_label is null



  
  
      
    ) dbt_internal_test
[0m11:39:34.063979 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:39:34.065458 [debug] [Thread-1 (]: On test.modern_stack_banking.not_null_gold_fraud_analysis_is_fraud_label.507c69683c: ROLLBACK
[0m11:39:34.066513 [debug] [Thread-1 (]: Failed to rollback 'test.modern_stack_banking.not_null_gold_fraud_analysis_is_fraud_label.507c69683c'
[0m11:39:34.067037 [debug] [Thread-1 (]: On test.modern_stack_banking.not_null_gold_fraud_analysis_is_fraud_label.507c69683c: Close
[0m11:39:34.067699 [info ] [Thread-1 (]: 3 of 5 PASS not_null_gold_fraud_analysis_is_fraud_label ........................ [[32mPASS[0m in 0.02s]
[0m11:39:34.068390 [debug] [Thread-1 (]: Finished running node test.modern_stack_banking.not_null_gold_fraud_analysis_is_fraud_label.507c69683c
[0m11:39:34.068923 [debug] [Thread-1 (]: Began running node test.modern_stack_banking.not_null_gold_fraud_analysis_txn_id.50e3216c26
[0m11:39:34.069464 [info ] [Thread-1 (]: 4 of 5 START test not_null_gold_fraud_analysis_txn_id .......................... [RUN]
[0m11:39:34.070036 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.modern_stack_banking.not_null_gold_fraud_analysis_is_fraud_label.507c69683c, now test.modern_stack_banking.not_null_gold_fraud_analysis_txn_id.50e3216c26)
[0m11:39:34.070519 [debug] [Thread-1 (]: Began compiling node test.modern_stack_banking.not_null_gold_fraud_analysis_txn_id.50e3216c26
[0m11:39:34.074470 [debug] [Thread-1 (]: Writing injected SQL for node "test.modern_stack_banking.not_null_gold_fraud_analysis_txn_id.50e3216c26"
[0m11:39:34.075119 [debug] [Thread-1 (]: Began executing node test.modern_stack_banking.not_null_gold_fraud_analysis_txn_id.50e3216c26
[0m11:39:34.077751 [debug] [Thread-1 (]: Writing runtime sql for node "test.modern_stack_banking.not_null_gold_fraud_analysis_txn_id.50e3216c26"
[0m11:39:34.078413 [debug] [Thread-1 (]: Using duckdb connection "test.modern_stack_banking.not_null_gold_fraud_analysis_txn_id.50e3216c26"
[0m11:39:34.078926 [debug] [Thread-1 (]: On test.modern_stack_banking.not_null_gold_fraud_analysis_txn_id.50e3216c26: BEGIN
[0m11:39:34.079382 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:34.080321 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:39:34.080842 [debug] [Thread-1 (]: Using duckdb connection "test.modern_stack_banking.not_null_gold_fraud_analysis_txn_id.50e3216c26"
[0m11:39:34.081318 [debug] [Thread-1 (]: On test.modern_stack_banking.not_null_gold_fraud_analysis_txn_id.50e3216c26: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "test.modern_stack_banking.not_null_gold_fraud_analysis_txn_id.50e3216c26"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select txn_id
from "argus_vault"."main"."gold_fraud_analysis"
where txn_id is null



  
  
      
    ) dbt_internal_test
[0m11:39:34.123841 [debug] [Thread-1 (]: SQL status: OK in 0.042 seconds
[0m11:39:34.126750 [debug] [Thread-1 (]: On test.modern_stack_banking.not_null_gold_fraud_analysis_txn_id.50e3216c26: ROLLBACK
[0m11:39:34.127995 [debug] [Thread-1 (]: Failed to rollback 'test.modern_stack_banking.not_null_gold_fraud_analysis_txn_id.50e3216c26'
[0m11:39:34.128864 [debug] [Thread-1 (]: On test.modern_stack_banking.not_null_gold_fraud_analysis_txn_id.50e3216c26: Close
[0m11:39:34.129800 [info ] [Thread-1 (]: 4 of 5 PASS not_null_gold_fraud_analysis_txn_id ................................ [[32mPASS[0m in 0.06s]
[0m11:39:34.130524 [debug] [Thread-1 (]: Finished running node test.modern_stack_banking.not_null_gold_fraud_analysis_txn_id.50e3216c26
[0m11:39:34.131071 [debug] [Thread-1 (]: Began running node test.modern_stack_banking.unique_gold_fraud_analysis_txn_id.4514579242
[0m11:39:34.131645 [info ] [Thread-1 (]: 5 of 5 START test unique_gold_fraud_analysis_txn_id ............................ [RUN]
[0m11:39:34.132229 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.modern_stack_banking.not_null_gold_fraud_analysis_txn_id.50e3216c26, now test.modern_stack_banking.unique_gold_fraud_analysis_txn_id.4514579242)
[0m11:39:34.132731 [debug] [Thread-1 (]: Began compiling node test.modern_stack_banking.unique_gold_fraud_analysis_txn_id.4514579242
[0m11:39:34.142135 [debug] [Thread-1 (]: Writing injected SQL for node "test.modern_stack_banking.unique_gold_fraud_analysis_txn_id.4514579242"
[0m11:39:34.142841 [debug] [Thread-1 (]: Began executing node test.modern_stack_banking.unique_gold_fraud_analysis_txn_id.4514579242
[0m11:39:34.145520 [debug] [Thread-1 (]: Writing runtime sql for node "test.modern_stack_banking.unique_gold_fraud_analysis_txn_id.4514579242"
[0m11:39:34.146216 [debug] [Thread-1 (]: Using duckdb connection "test.modern_stack_banking.unique_gold_fraud_analysis_txn_id.4514579242"
[0m11:39:34.146727 [debug] [Thread-1 (]: On test.modern_stack_banking.unique_gold_fraud_analysis_txn_id.4514579242: BEGIN
[0m11:39:34.147197 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:34.148170 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:39:34.148685 [debug] [Thread-1 (]: Using duckdb connection "test.modern_stack_banking.unique_gold_fraud_analysis_txn_id.4514579242"
[0m11:39:34.149174 [debug] [Thread-1 (]: On test.modern_stack_banking.unique_gold_fraud_analysis_txn_id.4514579242: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "test.modern_stack_banking.unique_gold_fraud_analysis_txn_id.4514579242"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    txn_id as unique_field,
    count(*) as n_records

from "argus_vault"."main"."gold_fraud_analysis"
where txn_id is not null
group by txn_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m11:39:34.224922 [debug] [Thread-1 (]: SQL status: OK in 0.075 seconds
[0m11:39:34.226990 [debug] [Thread-1 (]: On test.modern_stack_banking.unique_gold_fraud_analysis_txn_id.4514579242: ROLLBACK
[0m11:39:34.228086 [debug] [Thread-1 (]: Failed to rollback 'test.modern_stack_banking.unique_gold_fraud_analysis_txn_id.4514579242'
[0m11:39:34.228578 [debug] [Thread-1 (]: On test.modern_stack_banking.unique_gold_fraud_analysis_txn_id.4514579242: Close
[0m11:39:34.229317 [info ] [Thread-1 (]: 5 of 5 PASS unique_gold_fraud_analysis_txn_id .................................. [[32mPASS[0m in 0.10s]
[0m11:39:34.230053 [debug] [Thread-1 (]: Finished running node test.modern_stack_banking.unique_gold_fraud_analysis_txn_id.4514579242
[0m11:39:34.232710 [debug] [MainThread]: Using duckdb connection "master"
[0m11:39:34.233204 [debug] [MainThread]: On master: BEGIN
[0m11:39:34.233649 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:39:34.234696 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:39:34.235167 [debug] [MainThread]: On master: COMMIT
[0m11:39:34.235613 [debug] [MainThread]: Using duckdb connection "master"
[0m11:39:34.236088 [debug] [MainThread]: On master: COMMIT
[0m11:39:34.236734 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:39:34.237196 [debug] [MainThread]: On master: Close
[0m11:39:34.237745 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:39:34.238181 [debug] [MainThread]: Connection 'test.modern_stack_banking.unique_gold_fraud_analysis_txn_id.4514579242' was properly closed.
[0m11:39:34.238641 [info ] [MainThread]: 
[0m11:39:34.239152 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m11:39:34.240426 [debug] [MainThread]: Command end result
[0m11:39:34.260572 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m11:39:34.262308 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m11:39:34.268961 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m11:39:34.269422 [info ] [MainThread]: 
[0m11:39:34.269961 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:39:34.270429 [info ] [MainThread]: 
[0m11:39:34.270964 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m11:39:34.271598 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m11:39:34.272702 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.469003, "process_in_blocks": "0", "process_kernel_time": 0.33598, "process_mem_max_rss": "535120", "process_out_blocks": "3152", "process_user_time": 3.913534}
[0m11:39:34.273301 [debug] [MainThread]: Command `dbt test` succeeded at 11:39:34.273196 after 1.47 seconds
[0m11:39:34.273809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2adcd68b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2adcd69fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2aeddc09b0>]}
[0m11:39:34.274319 [debug] [MainThread]: Flushing usage events
[0m11:39:35.323595 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:46:12.745860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a764e702f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a764e9d160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a764f5e750>]}


============================== 12:46:12.749089 | aa23ea12-447b-40a8-869b-7c700fc4bab7 ==============================
[0m12:46:12.749089 [info ] [MainThread]: Running with dbt=1.11.2
[0m12:46:12.749783 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'fail_fast': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'warn_error': 'None', 'version_check': 'True', 'introspect': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'printer_width': '80', 'profiles_dir': '.', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select gold_fraud_dashboard --profiles-dir .', 'write_json': 'True', 'debug': 'False', 'empty': 'False', 'use_colors': 'True', 'log_format': 'default'}
[0m12:46:12.996933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa23ea12-447b-40a8-869b-7c700fc4bab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a76556ea20>]}
[0m12:46:13.069001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aa23ea12-447b-40a8-869b-7c700fc4bab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a764794fe0>]}
[0m12:46:13.070694 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m12:46:13.155026 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m12:46:13.259131 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m12:46:13.259779 [debug] [MainThread]: Partial parsing: added file: modern_stack_banking://models/Gold/gold_fraud_dashboard.sql
[0m12:46:13.480406 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.modern_stack_banking.gold_fraud_dashboard' (models/Gold/gold_fraud_dashboard.sql) depends on a node named 'sat_txn_ai_insights' which was not found
[0m12:46:13.481634 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.79827714, "process_in_blocks": "16", "process_kernel_time": 0.229911, "process_mem_max_rss": "178924", "process_out_blocks": "16", "process_user_time": 2.101195}
[0m12:46:13.482280 [debug] [MainThread]: Command `dbt run` failed at 12:46:13.482156 after 0.80 seconds
[0m12:46:13.482814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a764baa9f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a7645c5010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a7645c59a0>]}
[0m12:46:13.483315 [debug] [MainThread]: Flushing usage events
[0m12:46:14.556965 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:47:39.149482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77725920c950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7772570c2360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777256608bf0>]}


============================== 12:47:39.152795 | eb833051-f8bc-4fc2-8f88-53e0be4b7d18 ==============================
[0m12:47:39.152795 [info ] [MainThread]: Running with dbt=1.11.2
[0m12:47:39.153488 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'profiles_dir': '.', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select gold_fraud_dashboard --profiles-dir .', 'partial_parse': 'True', 'quiet': 'False', 'write_json': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'static_parser': 'True', 'printer_width': '80', 'empty': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'log_format': 'default', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False'}
[0m12:47:39.397976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb833051-f8bc-4fc2-8f88-53e0be4b7d18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777259363530>]}
[0m12:47:39.468773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb833051-f8bc-4fc2-8f88-53e0be4b7d18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77724a960680>]}
[0m12:47:39.470390 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m12:47:39.554151 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m12:47:39.657606 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m12:47:39.658239 [debug] [MainThread]: Partial parsing: added file: modern_stack_banking://models/Gold/gold_fraud_dashboard.sql
[0m12:47:39.874949 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.modern_stack_banking.gold_fraud_dashboard' (models/Gold/gold_fraud_dashboard.sql) depends on a node named 'sat_txn_ai_insights' which was not found
[0m12:47:39.876193 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.78918564, "process_in_blocks": "0", "process_kernel_time": 0.214128, "process_mem_max_rss": "178664", "process_out_blocks": "16", "process_user_time": 2.099255}
[0m12:47:39.876842 [debug] [MainThread]: Command `dbt run` failed at 12:47:39.876726 after 0.79 seconds
[0m12:47:39.877373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77725ac83e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77724a56dbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77724a56e330>]}
[0m12:47:39.877921 [debug] [MainThread]: Flushing usage events
[0m12:47:41.038744 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:49:51.727918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77165b47bcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77165ac9a5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77165b27d4f0>]}


============================== 12:49:51.731216 | 1e851241-2d2d-47f9-a0b8-f7253217c96b ==============================
[0m12:49:51.731216 [info ] [MainThread]: Running with dbt=1.11.2
[0m12:49:51.731905 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --select gold_fraud_dashboard --profiles-dir .', 'printer_width': '80', 'introspect': 'True', 'target_path': 'None', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'fail_fast': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'empty': 'False', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'static_parser': 'True', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'partial_parse': 'True', 'version_check': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'profiles_dir': '.', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False'}
[0m12:49:51.978421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e851241-2d2d-47f9-a0b8-f7253217c96b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77165aacdcd0>]}
[0m12:49:52.050210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1e851241-2d2d-47f9-a0b8-f7253217c96b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77164ef65010>]}
[0m12:49:52.052053 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m12:49:52.137871 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m12:49:52.251855 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m12:49:52.252524 [debug] [MainThread]: Partial parsing: added file: modern_stack_banking://models/Vault/sats/sat_txn_ai_insights.sql
[0m12:49:52.253109 [debug] [MainThread]: Partial parsing: added file: modern_stack_banking://models/Gold/gold_fraud_dashboard.sql
[0m12:49:52.539498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e851241-2d2d-47f9-a0b8-f7253217c96b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77164cbe3f20>]}
[0m12:49:52.609941 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m12:49:52.611812 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m12:49:52.624536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e851241-2d2d-47f9-a0b8-f7253217c96b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77164ec4b530>]}
[0m12:49:52.625124 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m12:49:52.625608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e851241-2d2d-47f9-a0b8-f7253217c96b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77164cba05f0>]}
[0m12:49:52.627388 [info ] [MainThread]: 
[0m12:49:52.627946 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:49:52.628393 [info ] [MainThread]: 
[0m12:49:52.629043 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:49:52.630080 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m12:49:52.665238 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m12:49:52.665763 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m12:49:52.666207 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:49:52.752260 [debug] [ThreadPool]: SQL status: OK in 0.086 seconds
[0m12:49:52.753924 [debug] [ThreadPool]: On list_argus_vault: Close
[0m12:49:52.754826 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m12:49:52.755439 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m12:49:52.762808 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m12:49:52.763316 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m12:49:52.763800 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:49:52.765260 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:49:52.766610 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m12:49:52.767103 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m12:49:52.767763 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:49:52.768224 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m12:49:52.768705 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m12:49:52.769389 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:49:52.770358 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m12:49:52.770853 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m12:49:52.771306 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m12:49:52.771967 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:49:52.772436 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m12:49:52.777956 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m12:49:52.784036 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m12:49:52.784494 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m12:49:52.784929 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:49:52.785772 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:49:52.786204 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m12:49:52.786621 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m12:49:52.797425 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m12:49:52.798951 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m12:49:52.800212 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m12:49:52.800684 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m12:49:52.802038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e851241-2d2d-47f9-a0b8-f7253217c96b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77164cbeccb0>]}
[0m12:49:52.802723 [debug] [MainThread]: Using duckdb connection "master"
[0m12:49:52.803166 [debug] [MainThread]: On master: BEGIN
[0m12:49:52.803569 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:49:52.804477 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:49:52.804968 [debug] [MainThread]: On master: COMMIT
[0m12:49:52.805391 [debug] [MainThread]: Using duckdb connection "master"
[0m12:49:52.805818 [debug] [MainThread]: On master: COMMIT
[0m12:49:52.806424 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:49:52.806895 [debug] [MainThread]: On master: Close
[0m12:49:52.808861 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.gold_fraud_dashboard
[0m12:49:52.809483 [info ] [Thread-1 (]: 1 of 1 START sql view model main.gold_fraud_dashboard .......................... [RUN]
[0m12:49:52.810071 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.gold_fraud_dashboard)
[0m12:49:52.810548 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.gold_fraud_dashboard
[0m12:49:52.818638 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.gold_fraud_dashboard"
[0m12:49:52.819325 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.gold_fraud_dashboard
[0m12:49:52.907552 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.gold_fraud_dashboard"
[0m12:49:52.908393 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.gold_fraud_dashboard"
[0m12:49:52.908931 [debug] [Thread-1 (]: On model.modern_stack_banking.gold_fraud_dashboard: BEGIN
[0m12:49:52.909402 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:49:52.910630 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:49:52.911151 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.gold_fraud_dashboard"
[0m12:49:52.911663 [debug] [Thread-1 (]: On model.modern_stack_banking.gold_fraud_dashboard: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.gold_fraud_dashboard"} */

  
  create view "argus_vault"."main"."gold_fraud_dashboard__dbt_tmp" as (
    

WITH hubs AS (
    -- Updated to use the full path
    SELECT 
        txn_hash_key, 
        txn_id, 
        load_date as established_date 
    FROM "argus_vault"."main"."hubs_transactions" 
),

features AS (
    -- Updated to use the full path
    SELECT 
        txn_hash_key, 
        amount, 
        is_fraud_label, 
        pca_features,
        load_date as observation_date
    FROM "argus_vault"."main"."sat_txn_features"
    QUALIFY ROW_NUMBER() OVER (PARTITION BY txn_hash_key ORDER BY load_date DESC) = 1
),

ai_insights AS (
    -- THIS IS THE CRITICAL FIX: Match the folder-based naming
    SELECT 
        txn_hash_key, 
        ai_reason_for_flag,
        load_date as insight_date
    FROM "argus_vault"."main"."sat_txn_ai_insights"
    QUALIFY ROW_NUMBER() OVER (PARTITION BY txn_hash_key ORDER BY load_date DESC) = 1
)

SELECT 
    h.txn_id,
    f.amount,
    f.is_fraud_label,
    CASE 
        WHEN f.is_fraud_label = 1 THEN '🚩 FRAUD'
        ELSE '✅ NORMAL'
    END as fraud_status,
    a.ai_reason_for_flag as forensic_explanation,
    f.pca_features,
    h.established_date
FROM hubs h
LEFT JOIN features f ON h.txn_hash_key = f.txn_hash_key
LEFT JOIN ai_insights a ON h.txn_hash_key = a.txn_hash_key
  );

[0m12:49:52.913104 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.gold_fraud_dashboard"} */

  
  create view "argus_vault"."main"."gold_fraud_dashboard__dbt_tmp" as (
    

WITH hubs AS (
    -- Updated to use the full path
    SELECT 
        txn_hash_key, 
        txn_id, 
        load_date as established_date 
    FROM "argus_vault"."main"."hubs_transactions" 
),

features AS (
    -- Updated to use the full path
    SELECT 
        txn_hash_key, 
        amount, 
        is_fraud_label, 
        pca_features,
        load_date as observation_date
    FROM "argus_vault"."main"."sat_txn_features"
    QUALIFY ROW_NUMBER() OVER (PARTITION BY txn_hash_key ORDER BY load_date DESC) = 1
),

ai_insights AS (
    -- THIS IS THE CRITICAL FIX: Match the folder-based naming
    SELECT 
        txn_hash_key, 
        ai_reason_for_flag,
        load_date as insight_date
    FROM "argus_vault"."main"."sat_txn_ai_insights"
    QUALIFY ROW_NUMBER() OVER (PARTITION BY txn_hash_key ORDER BY load_date DESC) = 1
)

SELECT 
    h.txn_id,
    f.amount,
    f.is_fraud_label,
    CASE 
        WHEN f.is_fraud_label = 1 THEN '🚩 FRAUD'
        ELSE '✅ NORMAL'
    END as fraud_status,
    a.ai_reason_for_flag as forensic_explanation,
    f.pca_features,
    h.established_date
FROM hubs h
LEFT JOIN features f ON h.txn_hash_key = f.txn_hash_key
LEFT JOIN ai_insights a ON h.txn_hash_key = a.txn_hash_key
  );

[0m12:49:52.913679 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:49:52.914311 [debug] [Thread-1 (]: On model.modern_stack_banking.gold_fraud_dashboard: ROLLBACK
[0m12:49:52.918038 [debug] [Thread-1 (]: Failed to rollback 'model.modern_stack_banking.gold_fraud_dashboard'
[0m12:49:52.918550 [debug] [Thread-1 (]: On model.modern_stack_banking.gold_fraud_dashboard: Close
[0m12:49:52.920835 [debug] [Thread-1 (]: Runtime Error in model gold_fraud_dashboard (models/Gold/gold_fraud_dashboard.sql)
  Catalog Error: Table with name sat_txn_ai_insights does not exist!
  Did you mean "sat_txn_features"?
  
  LINE 34:     FROM "argus_vault"."main"."sat_txn_ai_insights"
                    ^
[0m12:49:52.922461 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e851241-2d2d-47f9-a0b8-f7253217c96b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77165d5e0830>]}
[0m12:49:52.923208 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.gold_fraud_dashboard ................. [[31mERROR[0m in 0.11s]
[0m12:49:52.923968 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.gold_fraud_dashboard
[0m12:49:52.924752 [debug] [Thread-4 (]: Marking all children of 'model.modern_stack_banking.gold_fraud_dashboard' to be skipped because of status 'error'.  Reason: Runtime Error in model gold_fraud_dashboard (models/Gold/gold_fraud_dashboard.sql)
  Catalog Error: Table with name sat_txn_ai_insights does not exist!
  Did you mean "sat_txn_features"?
  
  LINE 34:     FROM "argus_vault"."main"."sat_txn_ai_insights"
                    ^.
[0m12:49:52.926739 [debug] [MainThread]: Using duckdb connection "master"
[0m12:49:52.927200 [debug] [MainThread]: On master: BEGIN
[0m12:49:52.927608 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:49:52.928569 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:49:52.929131 [debug] [MainThread]: On master: COMMIT
[0m12:49:52.929552 [debug] [MainThread]: Using duckdb connection "master"
[0m12:49:52.929989 [debug] [MainThread]: On master: COMMIT
[0m12:49:52.930752 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:49:52.931208 [debug] [MainThread]: On master: Close
[0m12:49:52.931731 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:49:52.932142 [debug] [MainThread]: Connection 'model.modern_stack_banking.gold_fraud_dashboard' was properly closed.
[0m12:49:52.932555 [info ] [MainThread]: 
[0m12:49:52.933047 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m12:49:52.933843 [debug] [MainThread]: Command end result
[0m12:49:52.953203 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m12:49:52.954812 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m12:49:52.960494 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m12:49:52.960960 [info ] [MainThread]: 
[0m12:49:52.961481 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:49:52.961967 [info ] [MainThread]: 
[0m12:49:52.962492 [error] [MainThread]: [31mFailure in model gold_fraud_dashboard (models/Gold/gold_fraud_dashboard.sql)[0m
[0m12:49:52.963031 [error] [MainThread]:   Runtime Error in model gold_fraud_dashboard (models/Gold/gold_fraud_dashboard.sql)
  Catalog Error: Table with name sat_txn_ai_insights does not exist!
  Did you mean "sat_txn_features"?
  
  LINE 34:     FROM "argus_vault"."main"."sat_txn_ai_insights"
                    ^
[0m12:49:52.963478 [info ] [MainThread]: 
[0m12:49:52.963990 [info ] [MainThread]:   compiled code at target/compiled/modern_stack_banking/models/Gold/gold_fraud_dashboard.sql
[0m12:49:52.964422 [info ] [MainThread]: 
[0m12:49:52.964905 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:49:52.965908 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3006308, "process_in_blocks": "0", "process_kernel_time": 0.28907, "process_mem_max_rss": "255016", "process_out_blocks": "3120", "process_user_time": 3.254755}
[0m12:49:52.966481 [debug] [MainThread]: Command `dbt run` failed at 12:49:52.966371 after 1.30 seconds
[0m12:49:52.966977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77165ac9a5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77165be7c740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77165bb15df0>]}
[0m12:49:52.967446 [debug] [MainThread]: Flushing usage events
[0m12:49:54.045873 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:52:34.504660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727b54f43ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727b54f42120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727b54f42e70>]}


============================== 12:52:34.507951 | bf01e2c3-d966-45db-899f-3d55652066dc ==============================
[0m12:52:34.507951 [info ] [MainThread]: Running with dbt=1.11.2
[0m12:52:34.508627 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'quiet': 'False', 'fail_fast': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'static_parser': 'True', 'use_experimental_parser': 'False', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'partial_parse': 'True', 'debug': 'False', 'write_json': 'True', 'empty': 'False', 'invocation_command': 'dbt run --select sat_txn_ai_insights --profiles-dir .', 'log_format': 'default', 'warn_error': 'None', 'target_path': 'None', 'introspect': 'True', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'printer_width': '80', 'use_colors': 'True'}
[0m12:52:34.754371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf01e2c3-d966-45db-899f-3d55652066dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727b546a4800>]}
[0m12:52:34.826880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf01e2c3-d966-45db-899f-3d55652066dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727b5474ef60>]}
[0m12:52:34.828756 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m12:52:34.912574 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m12:52:35.016736 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:52:35.017235 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m12:52:35.017687 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:52:35.059435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf01e2c3-d966-45db-899f-3d55652066dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727b54715b80>]}
[0m12:52:35.131104 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m12:52:35.132774 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m12:52:35.145094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf01e2c3-d966-45db-899f-3d55652066dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727b488bcf20>]}
[0m12:52:35.145660 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m12:52:35.146181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf01e2c3-d966-45db-899f-3d55652066dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727b48b6ac90>]}
[0m12:52:35.147963 [info ] [MainThread]: 
[0m12:52:35.148462 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:52:35.148941 [info ] [MainThread]: 
[0m12:52:35.149560 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:52:35.150620 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m12:52:35.186507 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m12:52:35.187037 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m12:52:35.187494 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:52:35.273863 [debug] [ThreadPool]: SQL status: OK in 0.086 seconds
[0m12:52:35.275514 [debug] [ThreadPool]: On list_argus_vault: Close
[0m12:52:35.276386 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m12:52:35.277017 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m12:52:35.284426 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m12:52:35.284920 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m12:52:35.285354 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:52:35.286523 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:52:35.287859 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m12:52:35.288308 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m12:52:35.288928 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:52:35.289369 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m12:52:35.289813 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m12:52:35.290467 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:52:35.291417 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m12:52:35.291891 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m12:52:35.292315 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m12:52:35.293021 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:52:35.293477 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m12:52:35.298951 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m12:52:35.304626 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m12:52:35.305103 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m12:52:35.305511 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:52:35.306371 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:52:35.306839 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m12:52:35.307260 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m12:52:35.318029 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m12:52:35.319514 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m12:52:35.320781 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m12:52:35.321228 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m12:52:35.322543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf01e2c3-d966-45db-899f-3d55652066dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727b48b44950>]}
[0m12:52:35.323241 [debug] [MainThread]: Using duckdb connection "master"
[0m12:52:35.323691 [debug] [MainThread]: On master: BEGIN
[0m12:52:35.324111 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:52:35.325175 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:52:35.325631 [debug] [MainThread]: On master: COMMIT
[0m12:52:35.326086 [debug] [MainThread]: Using duckdb connection "master"
[0m12:52:35.326499 [debug] [MainThread]: On master: COMMIT
[0m12:52:35.327150 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:52:35.327591 [debug] [MainThread]: On master: Close
[0m12:52:35.329607 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m12:52:35.330268 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m12:52:35.330856 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m12:52:35.331341 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m12:52:35.339413 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m12:52:35.340102 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m12:52:35.397527 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m12:52:35.398257 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m12:52:35.398785 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m12:52:35.399253 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:52:35.400253 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:52:35.400777 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m12:52:35.401268 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

  
    
    

    create  table
      "argus_vault"."main"."sat_txn_ai_insights"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Pending AI Review' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '0000'
    );
  
  
  
[0m12:52:35.406188 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m12:52:35.420225 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m12:52:35.420793 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m12:52:35.421278 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m12:52:35.430203 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m12:52:35.432156 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m12:52:35.433845 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf01e2c3-d966-45db-899f-3d55652066dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727b5563bad0>]}
[0m12:52:35.434600 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.10s]
[0m12:52:35.435364 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m12:52:35.436793 [debug] [MainThread]: Using duckdb connection "master"
[0m12:52:35.437250 [debug] [MainThread]: On master: BEGIN
[0m12:52:35.437684 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:52:35.438664 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:52:35.439163 [debug] [MainThread]: On master: COMMIT
[0m12:52:35.439591 [debug] [MainThread]: Using duckdb connection "master"
[0m12:52:35.440059 [debug] [MainThread]: On master: COMMIT
[0m12:52:35.440738 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:52:35.441189 [debug] [MainThread]: On master: Close
[0m12:52:35.441712 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:52:35.442135 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m12:52:35.442563 [info ] [MainThread]: 
[0m12:52:35.443053 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m12:52:35.443854 [debug] [MainThread]: Command end result
[0m12:52:35.463114 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m12:52:35.464725 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m12:52:35.470506 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m12:52:35.470987 [info ] [MainThread]: 
[0m12:52:35.471516 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:52:35.471995 [info ] [MainThread]: 
[0m12:52:35.472476 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:52:35.473493 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0313895, "process_in_blocks": "0", "process_kernel_time": 0.285478, "process_mem_max_rss": "265200", "process_out_blocks": "2112", "process_user_time": 2.95159}
[0m12:52:35.474103 [debug] [MainThread]: Command `dbt run` succeeded at 12:52:35.473999 after 1.03 seconds
[0m12:52:35.474578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727b556d8c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727b54835fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727b54835490>]}
[0m12:52:35.475076 [debug] [MainThread]: Flushing usage events
[0m12:52:36.516761 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:52:44.124980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7295bc87dca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7295bca16120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7295bce11d00>]}


============================== 12:52:44.128351 | 3b9cde4e-9e12-4ef2-839e-be0f90ac6dba ==============================
[0m12:52:44.128351 [info ] [MainThread]: Running with dbt=1.11.2
[0m12:52:44.129031 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'fail_fast': 'False', 'debug': 'False', 'profiles_dir': '.', 'indirect_selection': 'eager', 'target_path': 'None', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select gold_fraud_dashboard --profiles-dir .', 'write_json': 'True', 'printer_width': '80', 'no_print': 'None', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'warn_error': 'None', 'empty': 'False', 'version_check': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'quiet': 'False', 'introspect': 'True'}
[0m12:52:44.372997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b9cde4e-9e12-4ef2-839e-be0f90ac6dba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7295bcfaeb70>]}
[0m12:52:44.443472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3b9cde4e-9e12-4ef2-839e-be0f90ac6dba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7295be0bc7d0>]}
[0m12:52:44.445100 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m12:52:44.528290 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m12:52:44.631919 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:52:44.632425 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m12:52:44.632878 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:52:44.674149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3b9cde4e-9e12-4ef2-839e-be0f90ac6dba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7295b044d3d0>]}
[0m12:52:44.745939 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m12:52:44.747620 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m12:52:44.760006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3b9cde4e-9e12-4ef2-839e-be0f90ac6dba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7295b01c4d40>]}
[0m12:52:44.760561 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m12:52:44.761089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b9cde4e-9e12-4ef2-839e-be0f90ac6dba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7295b01b8290>]}
[0m12:52:44.762839 [info ] [MainThread]: 
[0m12:52:44.763361 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:52:44.763846 [info ] [MainThread]: 
[0m12:52:44.764477 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:52:44.765530 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m12:52:44.801622 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m12:52:44.802152 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m12:52:44.802604 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:52:44.889454 [debug] [ThreadPool]: SQL status: OK in 0.087 seconds
[0m12:52:44.891125 [debug] [ThreadPool]: On list_argus_vault: Close
[0m12:52:44.892000 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m12:52:44.892576 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m12:52:44.899896 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m12:52:44.900363 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m12:52:44.900816 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:52:44.902473 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m12:52:44.903820 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m12:52:44.904265 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m12:52:44.904893 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:52:44.905323 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m12:52:44.905747 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m12:52:44.906415 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:52:44.907339 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m12:52:44.907798 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m12:52:44.908209 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m12:52:44.908857 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:52:44.909296 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m12:52:44.914703 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m12:52:44.920309 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m12:52:44.920785 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m12:52:44.921197 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:52:44.922062 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:52:44.922507 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m12:52:44.922953 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m12:52:44.934629 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m12:52:44.936151 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m12:52:44.937391 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m12:52:44.937846 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m12:52:44.939296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b9cde4e-9e12-4ef2-839e-be0f90ac6dba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7295b044d640>]}
[0m12:52:44.939909 [debug] [MainThread]: Using duckdb connection "master"
[0m12:52:44.940338 [debug] [MainThread]: On master: BEGIN
[0m12:52:44.940761 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:52:44.941612 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:52:44.942079 [debug] [MainThread]: On master: COMMIT
[0m12:52:44.942497 [debug] [MainThread]: Using duckdb connection "master"
[0m12:52:44.942933 [debug] [MainThread]: On master: COMMIT
[0m12:52:44.943526 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:52:44.943982 [debug] [MainThread]: On master: Close
[0m12:52:44.945942 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.gold_fraud_dashboard
[0m12:52:44.946553 [info ] [Thread-1 (]: 1 of 1 START sql view model main.gold_fraud_dashboard .......................... [RUN]
[0m12:52:44.947129 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.gold_fraud_dashboard)
[0m12:52:44.947618 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.gold_fraud_dashboard
[0m12:52:44.955739 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.gold_fraud_dashboard"
[0m12:52:44.956437 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.gold_fraud_dashboard
[0m12:52:44.989152 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.gold_fraud_dashboard"
[0m12:52:44.989899 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.gold_fraud_dashboard"
[0m12:52:44.990389 [debug] [Thread-1 (]: On model.modern_stack_banking.gold_fraud_dashboard: BEGIN
[0m12:52:44.990869 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:52:44.991836 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:52:44.992323 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.gold_fraud_dashboard"
[0m12:52:44.992847 [debug] [Thread-1 (]: On model.modern_stack_banking.gold_fraud_dashboard: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.gold_fraud_dashboard"} */

  
  create view "argus_vault"."main"."gold_fraud_dashboard__dbt_tmp" as (
    

WITH hubs AS (
    -- Updated to use the full path
    SELECT 
        txn_hash_key, 
        txn_id, 
        load_date as established_date 
    FROM "argus_vault"."main"."hubs_transactions" 
),

features AS (
    -- Updated to use the full path
    SELECT 
        txn_hash_key, 
        amount, 
        is_fraud_label, 
        pca_features,
        load_date as observation_date
    FROM "argus_vault"."main"."sat_txn_features"
    QUALIFY ROW_NUMBER() OVER (PARTITION BY txn_hash_key ORDER BY load_date DESC) = 1
),

ai_insights AS (
    -- THIS IS THE CRITICAL FIX: Match the folder-based naming
    SELECT 
        txn_hash_key, 
        ai_reason_for_flag,
        load_date as insight_date
    FROM "argus_vault"."main"."sat_txn_ai_insights"
    QUALIFY ROW_NUMBER() OVER (PARTITION BY txn_hash_key ORDER BY load_date DESC) = 1
)

SELECT 
    h.txn_id,
    f.amount,
    f.is_fraud_label,
    CASE 
        WHEN f.is_fraud_label = 1 THEN '🚩 FRAUD'
        ELSE '✅ NORMAL'
    END as fraud_status,
    a.ai_reason_for_flag as forensic_explanation,
    f.pca_features,
    h.established_date
FROM hubs h
LEFT JOIN features f ON h.txn_hash_key = f.txn_hash_key
LEFT JOIN ai_insights a ON h.txn_hash_key = a.txn_hash_key
  );

[0m12:52:44.994122 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:52:45.000247 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.gold_fraud_dashboard"
[0m12:52:45.000774 [debug] [Thread-1 (]: On model.modern_stack_banking.gold_fraud_dashboard: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.gold_fraud_dashboard"} */
alter view "argus_vault"."main"."gold_fraud_dashboard__dbt_tmp" rename to "gold_fraud_dashboard"
[0m12:52:45.001573 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:52:45.011873 [debug] [Thread-1 (]: On model.modern_stack_banking.gold_fraud_dashboard: COMMIT
[0m12:52:45.012386 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.gold_fraud_dashboard"
[0m12:52:45.012874 [debug] [Thread-1 (]: On model.modern_stack_banking.gold_fraud_dashboard: COMMIT
[0m12:52:45.021659 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m12:52:45.027259 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.gold_fraud_dashboard"
[0m12:52:45.027784 [debug] [Thread-1 (]: On model.modern_stack_banking.gold_fraud_dashboard: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.gold_fraud_dashboard"} */

      drop view if exists "argus_vault"."main"."gold_fraud_dashboard__dbt_backup" cascade
    
[0m12:52:45.028598 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:52:45.030993 [debug] [Thread-1 (]: On model.modern_stack_banking.gold_fraud_dashboard: Close
[0m12:52:45.032611 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b9cde4e-9e12-4ef2-839e-be0f90ac6dba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7295bed28da0>]}
[0m12:52:45.033362 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.gold_fraud_dashboard ..................... [[32mOK[0m in 0.08s]
[0m12:52:45.034107 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.gold_fraud_dashboard
[0m12:52:45.035424 [debug] [MainThread]: Using duckdb connection "master"
[0m12:52:45.035903 [debug] [MainThread]: On master: BEGIN
[0m12:52:45.036316 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:52:45.037298 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:52:45.037765 [debug] [MainThread]: On master: COMMIT
[0m12:52:45.038188 [debug] [MainThread]: Using duckdb connection "master"
[0m12:52:45.038688 [debug] [MainThread]: On master: COMMIT
[0m12:52:45.039425 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:52:45.039925 [debug] [MainThread]: On master: Close
[0m12:52:45.040462 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:52:45.040918 [debug] [MainThread]: Connection 'model.modern_stack_banking.gold_fraud_dashboard' was properly closed.
[0m12:52:45.041391 [info ] [MainThread]: 
[0m12:52:45.041909 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m12:52:45.042745 [debug] [MainThread]: Command end result
[0m12:52:45.064854 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m12:52:45.066504 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m12:52:45.072347 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m12:52:45.072824 [info ] [MainThread]: 
[0m12:52:45.073390 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:52:45.073886 [info ] [MainThread]: 
[0m12:52:45.074408 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:52:45.075449 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0131735, "process_in_blocks": "0", "process_kernel_time": 0.285062, "process_mem_max_rss": "255508", "process_out_blocks": "2120", "process_user_time": 2.924599}
[0m12:52:45.076088 [debug] [MainThread]: Command `dbt run` succeeded at 12:52:45.075977 after 1.01 seconds
[0m12:52:45.076586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7295bc11bfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7295bca148c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7295bcf69af0>]}
[0m12:52:45.077120 [debug] [MainThread]: Flushing usage events
[0m12:52:46.133995 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:59:19.896047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5db98b84a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5dbbffdaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5db98b8470>]}


============================== 12:59:19.899349 | adfc5b70-9dfa-464e-bdb9-7828f8e69df1 ==============================
[0m12:59:19.899349 [info ] [MainThread]: Running with dbt=1.11.2
[0m12:59:19.900108 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'debug': 'False', 'cache_selected_only': 'False', 'quiet': 'False', 'partial_parse': 'True', 'write_json': 'True', 'use_colors': 'True', 'version_check': 'True', 'introspect': 'True', 'log_format': 'default', 'warn_error': 'None', 'indirect_selection': 'eager', 'static_parser': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'target_path': 'None', 'profiles_dir': '.', 'log_cache_events': 'False', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "5142e1f7-4873-4cfd-ab71-c1731ad3861e", "ai_explanation": "The transaction is fraud due to a significant anomaly score (-2.3122265423263) indicating suspicious behavior in multiple PCA factors."} --profiles-dir .', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None'}
[0m12:59:20.149295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'adfc5b70-9dfa-464e-bdb9-7828f8e69df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5dad53b4a0>]}
[0m12:59:20.220401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'adfc5b70-9dfa-464e-bdb9-7828f8e69df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5dad43ac60>]}
[0m12:59:20.222016 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m12:59:20.306698 [debug] [MainThread]: checksum: c54556ce5f4b3bcdaa63e85a86dd5e003bc249ee819bd6d4de7b6eb44417b8c3, vars: {'ai_explanation': 'The transaction is fraud due to a significant anomaly '
                   'score (-2.3122265423263) indicating suspicious behavior in '
                   'multiple PCA factors.',
 'txn_id': '5142e1f7-4873-4cfd-ab71-c1731ad3861e'}, profile: , target: , version: 1.11.2
[0m12:59:20.399762 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m12:59:20.400330 [debug] [MainThread]: previous checksum: c54556ce5f4b3bcdaa63e85a86dd5e003bc249ee819bd6d4de7b6eb44417b8c3, current checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b
[0m12:59:20.400851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'adfc5b70-9dfa-464e-bdb9-7828f8e69df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5dad2a62d0>]}
[0m12:59:21.620766 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m12:59:21.621425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'adfc5b70-9dfa-464e-bdb9-7828f8e69df1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5db913d730>]}
[0m12:59:21.713311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'adfc5b70-9dfa-464e-bdb9-7828f8e69df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5dac1f3110>]}
[0m12:59:21.784371 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m12:59:21.786086 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m12:59:21.798275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'adfc5b70-9dfa-464e-bdb9-7828f8e69df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5dac0d1340>]}
[0m12:59:21.798888 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m12:59:21.799405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'adfc5b70-9dfa-464e-bdb9-7828f8e69df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5dac192390>]}
[0m12:59:21.801207 [info ] [MainThread]: 
[0m12:59:21.801765 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:59:21.802239 [info ] [MainThread]: 
[0m12:59:21.802912 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:59:21.803990 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m12:59:21.838762 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m12:59:21.839246 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m12:59:21.839717 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:59:21.931097 [debug] [ThreadPool]: SQL status: OK in 0.091 seconds
[0m12:59:21.932791 [debug] [ThreadPool]: On list_argus_vault: Close
[0m12:59:21.933694 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m12:59:21.934306 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m12:59:21.941516 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m12:59:21.942038 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m12:59:21.942498 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:59:21.943733 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:59:21.945070 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m12:59:21.945541 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m12:59:21.946188 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:59:21.946644 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m12:59:21.947120 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m12:59:21.947797 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:59:21.948768 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m12:59:21.949244 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m12:59:21.949714 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m12:59:21.950344 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:59:21.950834 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m12:59:21.956284 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m12:59:21.961818 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m12:59:21.962397 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m12:59:21.962868 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:59:21.964033 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:59:21.964507 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m12:59:21.965010 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m12:59:21.976581 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m12:59:21.978008 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m12:59:21.979260 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m12:59:21.979721 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m12:59:21.981194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'adfc5b70-9dfa-464e-bdb9-7828f8e69df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5da4585d90>]}
[0m12:59:21.981805 [debug] [MainThread]: Using duckdb connection "master"
[0m12:59:21.982269 [debug] [MainThread]: On master: BEGIN
[0m12:59:21.982727 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:59:21.983587 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:59:21.984080 [debug] [MainThread]: On master: COMMIT
[0m12:59:21.984533 [debug] [MainThread]: Using duckdb connection "master"
[0m12:59:21.984994 [debug] [MainThread]: On master: COMMIT
[0m12:59:21.985638 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:59:21.986130 [debug] [MainThread]: On master: Close
[0m12:59:21.988194 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m12:59:21.988868 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m12:59:21.989468 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m12:59:21.989981 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m12:59:21.997801 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m12:59:21.998534 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m12:59:22.057943 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m12:59:22.058542 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201125922033614"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'The transaction is fraud due to a significant anomaly score (-2.3122265423263) indicating suspicious behavior in multiple PCA factors.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '5142e1f7-4873-4cfd-ab71-c1731ad3861e'
    );
  
  
  
[0m12:59:22.059063 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:59:22.067469 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m12:59:22.074854 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m12:59:22.075368 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m12:59:22.076062 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:59:22.076547 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m12:59:22.077048 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201125922033614'
      
      
      order by ordinal_position

  
[0m12:59:22.079591 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:59:22.084501 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m12:59:22.085049 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m12:59:22.087945 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:59:22.098017 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m12:59:22.098548 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m12:59:22.101039 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:59:22.102550 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m12:59:22.103082 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m12:59:22.103885 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:59:22.120198 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m12:59:22.120975 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m12:59:22.121478 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201125922033614"
    )
  
[0m12:59:22.122617 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:59:22.132972 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m12:59:22.133507 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m12:59:22.134004 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m12:59:22.148256 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m12:59:22.150278 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m12:59:22.151989 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'adfc5b70-9dfa-464e-bdb9-7828f8e69df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5dba123980>]}
[0m12:59:22.152751 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m12:59:22.153494 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m12:59:22.155077 [debug] [MainThread]: Using duckdb connection "master"
[0m12:59:22.155564 [debug] [MainThread]: On master: BEGIN
[0m12:59:22.156047 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:59:22.157091 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:59:22.157566 [debug] [MainThread]: On master: COMMIT
[0m12:59:22.158042 [debug] [MainThread]: Using duckdb connection "master"
[0m12:59:22.158483 [debug] [MainThread]: On master: COMMIT
[0m12:59:22.159143 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:59:22.159618 [debug] [MainThread]: On master: Close
[0m12:59:22.160186 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:59:22.160613 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m12:59:22.161107 [info ] [MainThread]: 
[0m12:59:22.161593 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m12:59:22.162428 [debug] [MainThread]: Command end result
[0m12:59:22.182623 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m12:59:22.184323 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m12:59:22.190090 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m12:59:22.190560 [info ] [MainThread]: 
[0m12:59:22.191125 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:59:22.191597 [info ] [MainThread]: 
[0m12:59:22.192098 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:59:22.192752 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m12:59:22.193816 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.361641, "process_in_blocks": "0", "process_kernel_time": 0.339668, "process_mem_max_rss": "268472", "process_out_blocks": "3128", "process_user_time": 4.266156}
[0m12:59:22.194415 [debug] [MainThread]: Command `dbt run` succeeded at 12:59:22.194297 after 2.36 seconds
[0m12:59:22.194913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5dba102420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5dba1033b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5dba103830>]}
[0m12:59:22.195410 [debug] [MainThread]: Flushing usage events
[0m12:59:23.252567 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:35:39.388554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a0f0907020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a0f2cbf590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a0f1003590>]}


============================== 16:35:39.393687 | d5ef4b8a-37f4-4ab5-9723-4b2f16392edb ==============================
[0m16:35:39.393687 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:35:39.394359 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'partial_parse': 'True', 'log_format': 'default', 'static_parser': 'True', 'cache_selected_only': 'False', 'introspect': 'True', 'profiles_dir': '.', 'log_cache_events': 'False', 'write_json': 'True', 'warn_error': 'None', 'empty': 'False', 'indirect_selection': 'eager', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'printer_width': '80', 'use_colors': 'True', 'quiet': 'False', 'fail_fast': 'False', 'invocation_command': 'dbt run --select gold_fraud_dashboard --profiles-dir .', 'debug': 'False'}
[0m16:35:39.667009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd5ef4b8a-37f4-4ab5-9723-4b2f16392edb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a0efee30b0>]}
[0m16:35:39.739344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd5ef4b8a-37f4-4ab5-9723-4b2f16392edb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a0f1398a70>]}
[0m16:35:39.741140 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m16:35:39.829714 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:35:39.926110 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:35:39.926736 [debug] [MainThread]: previous checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, current checksum: c54556ce5f4b3bcdaa63e85a86dd5e003bc249ee819bd6d4de7b6eb44417b8c3
[0m16:35:39.927233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd5ef4b8a-37f4-4ab5-9723-4b2f16392edb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a0e41a25a0>]}
[0m16:35:41.156134 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m16:35:41.156830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd5ef4b8a-37f4-4ab5-9723-4b2f16392edb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a0e3f83800>]}
[0m16:35:41.249312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd5ef4b8a-37f4-4ab5-9723-4b2f16392edb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a0eff3d490>]}
[0m16:35:41.320221 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m16:35:41.322212 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m16:35:41.340085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd5ef4b8a-37f4-4ab5-9723-4b2f16392edb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a0e01cd8e0>]}
[0m16:35:41.340751 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m16:35:41.341273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5ef4b8a-37f4-4ab5-9723-4b2f16392edb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a0e3f11820>]}
[0m16:35:41.343128 [info ] [MainThread]: 
[0m16:35:41.343639 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:35:41.344169 [info ] [MainThread]: 
[0m16:35:41.344858 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:35:41.345948 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m16:35:41.628349 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m16:35:41.629025 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m16:35:41.629464 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:46.523423 [debug] [ThreadPool]: SQL status: OK in 4.894 seconds
[0m16:35:46.525206 [debug] [ThreadPool]: On list_argus_vault: Close
[0m16:35:46.526218 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m16:35:46.526844 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m16:35:46.534560 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m16:35:46.535057 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m16:35:46.535490 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:35:46.536746 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:35:46.538161 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m16:35:46.538613 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m16:35:46.539304 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:35:46.539743 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m16:35:46.540196 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m16:35:46.540844 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:35:46.541811 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m16:35:46.542284 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m16:35:46.542701 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m16:35:46.543385 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:35:46.543828 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m16:35:46.549587 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m16:35:46.555893 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m16:35:46.556457 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m16:35:46.556870 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:35:46.557810 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:35:46.558274 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m16:35:46.558698 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m16:35:46.569568 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m16:35:46.571038 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m16:35:46.572299 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m16:35:46.572746 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m16:35:46.574575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5ef4b8a-37f4-4ab5-9723-4b2f16392edb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a0e41a28d0>]}
[0m16:35:46.575255 [debug] [MainThread]: Using duckdb connection "master"
[0m16:35:46.575839 [debug] [MainThread]: On master: BEGIN
[0m16:35:46.576368 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:35:46.577539 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:35:46.578005 [debug] [MainThread]: On master: COMMIT
[0m16:35:46.578432 [debug] [MainThread]: Using duckdb connection "master"
[0m16:35:46.578838 [debug] [MainThread]: On master: COMMIT
[0m16:35:46.579484 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:35:46.579949 [debug] [MainThread]: On master: Close
[0m16:35:46.582412 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.gold_fraud_dashboard
[0m16:35:46.583146 [info ] [Thread-1 (]: 1 of 1 START sql view model main.gold_fraud_dashboard .......................... [RUN]
[0m16:35:46.583740 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.gold_fraud_dashboard)
[0m16:35:46.584266 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.gold_fraud_dashboard
[0m16:35:46.592498 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.gold_fraud_dashboard"
[0m16:35:46.593241 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.gold_fraud_dashboard
[0m16:35:46.624500 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.gold_fraud_dashboard"
[0m16:35:46.625307 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.gold_fraud_dashboard"
[0m16:35:46.625801 [debug] [Thread-1 (]: On model.modern_stack_banking.gold_fraud_dashboard: BEGIN
[0m16:35:46.626284 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:35:46.627646 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:35:46.628156 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.gold_fraud_dashboard"
[0m16:35:46.628656 [debug] [Thread-1 (]: On model.modern_stack_banking.gold_fraud_dashboard: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.gold_fraud_dashboard"} */

  
  create view "argus_vault"."main"."gold_fraud_dashboard__dbt_tmp" as (
    

WITH hubs AS (
    SELECT txn_hash_key, txn_id, load_date as established_date 
    FROM "argus_vault"."main"."hubs_transactions"
),
features AS (
    SELECT txn_hash_key, amount, is_fraud_label, pca_features, load_date
    FROM "argus_vault"."main"."sat_txn_features"
    QUALIFY ROW_NUMBER() OVER (PARTITION BY txn_hash_key ORDER BY load_date DESC) = 1
),
ai_insights AS (
    SELECT txn_hash_key, ai_reason_for_flag, load_date
    FROM "argus_vault"."main"."sat_txn_ai_insights"
    QUALIFY ROW_NUMBER() OVER (PARTITION BY txn_hash_key ORDER BY load_date DESC) = 1
)

SELECT 
    h.txn_id,
    f.amount,
    f.is_fraud_label,
    CASE WHEN f.is_fraud_label = 1 THEN '🚩 FRAUD' ELSE '✅ NORMAL' END as fraud_status,
    a.ai_reason_for_flag as forensic_explanation,
    -- ADD THESE COLUMNS FOR THE GOVERNANCE SCRIPT
    h.established_date,
    a.load_date as insight_date, 
    f.pca_features
FROM hubs h
LEFT JOIN features f ON h.txn_hash_key = f.txn_hash_key
LEFT JOIN ai_insights a ON h.txn_hash_key = a.txn_hash_key
  );

[0m16:35:46.629993 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:35:46.636239 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.gold_fraud_dashboard"
[0m16:35:46.636746 [debug] [Thread-1 (]: On model.modern_stack_banking.gold_fraud_dashboard: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.gold_fraud_dashboard"} */
alter view "argus_vault"."main"."gold_fraud_dashboard" rename to "gold_fraud_dashboard__dbt_backup"
[0m16:35:46.637583 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:35:46.640573 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.gold_fraud_dashboard"
[0m16:35:46.641088 [debug] [Thread-1 (]: On model.modern_stack_banking.gold_fraud_dashboard: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.gold_fraud_dashboard"} */
alter view "argus_vault"."main"."gold_fraud_dashboard__dbt_tmp" rename to "gold_fraud_dashboard"
[0m16:35:46.641927 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:35:46.654376 [debug] [Thread-1 (]: On model.modern_stack_banking.gold_fraud_dashboard: COMMIT
[0m16:35:46.654883 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.gold_fraud_dashboard"
[0m16:35:46.655369 [debug] [Thread-1 (]: On model.modern_stack_banking.gold_fraud_dashboard: COMMIT
[0m16:35:46.659120 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:35:46.665201 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.gold_fraud_dashboard"
[0m16:35:46.665720 [debug] [Thread-1 (]: On model.modern_stack_banking.gold_fraud_dashboard: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.gold_fraud_dashboard"} */

      drop view if exists "argus_vault"."main"."gold_fraud_dashboard__dbt_backup" cascade
    
[0m16:35:46.667731 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:35:46.670241 [debug] [Thread-1 (]: On model.modern_stack_banking.gold_fraud_dashboard: Close
[0m16:35:46.671935 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5ef4b8a-37f4-4ab5-9723-4b2f16392edb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a0e3f28f80>]}
[0m16:35:46.672692 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.gold_fraud_dashboard ..................... [[32mOK[0m in 0.09s]
[0m16:35:46.673437 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.gold_fraud_dashboard
[0m16:35:46.674907 [debug] [MainThread]: Using duckdb connection "master"
[0m16:35:46.675436 [debug] [MainThread]: On master: BEGIN
[0m16:35:46.675954 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:35:46.677291 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:35:46.677747 [debug] [MainThread]: On master: COMMIT
[0m16:35:46.678200 [debug] [MainThread]: Using duckdb connection "master"
[0m16:35:46.678607 [debug] [MainThread]: On master: COMMIT
[0m16:35:46.679273 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:35:46.679713 [debug] [MainThread]: On master: Close
[0m16:35:46.680337 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:35:46.680741 [debug] [MainThread]: Connection 'model.modern_stack_banking.gold_fraud_dashboard' was properly closed.
[0m16:35:46.681208 [info ] [MainThread]: 
[0m16:35:46.681678 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.34 seconds (5.34s).
[0m16:35:46.682489 [debug] [MainThread]: Command end result
[0m16:35:46.702636 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m16:35:46.704401 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m16:35:46.710145 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m16:35:46.710583 [info ] [MainThread]: 
[0m16:35:46.711129 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:35:46.711568 [info ] [MainThread]: 
[0m16:35:46.712055 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:35:46.712681 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:35:46.714083 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.3889704, "process_in_blocks": "246368", "process_kernel_time": 0.439777, "process_mem_max_rss": "259620", "process_out_blocks": "3144", "process_user_time": 4.221061}
[0m16:35:46.714685 [debug] [MainThread]: Command `dbt run` succeeded at 16:35:46.714578 after 7.39 seconds
[0m16:35:46.715201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a0f021eba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a0f0e55610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a0f074aab0>]}
[0m16:35:46.715691 [debug] [MainThread]: Flushing usage events
[0m16:35:47.813757 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:44:01.389871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a11556f6930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1157c45af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1155b137a0>]}


============================== 16:44:01.393279 | 5add57a0-4f14-4eec-97a4-eff364ac9c4d ==============================
[0m16:44:01.393279 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:44:01.393940 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'warn_error': 'None', 'debug': 'False', 'introspect': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'fail_fast': 'False', 'quiet': 'False', 'partial_parse': 'True', 'profiles_dir': '.', 'no_print': 'None', 'version_check': 'True', 'log_format': 'default', 'use_colors': 'True', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "5c6a2982-6fa4-4dcb-89ac-d7d90dd3bc33", "ai_explanation": "Based on PCA factors, this transaction exhibits extreme values in V1-V3 and V13-V16, indicating fraudulent activity."} --profiles-dir .', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m16:44:01.638965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5add57a0-4f14-4eec-97a4-eff364ac9c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1155c68cb0>]}
[0m16:44:01.710022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5add57a0-4f14-4eec-97a4-eff364ac9c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1157854bf0>]}
[0m16:44:01.711761 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m16:44:01.797220 [debug] [MainThread]: checksum: 7acfa76432ee7ad17f3ea5348588822be40c91cb0c492f5a6713cf20f34c8cdb, vars: {'ai_explanation': 'Based on PCA factors, this transaction exhibits extreme '
                   'values in V1-V3 and V13-V16, indicating fraudulent '
                   'activity.',
 'txn_id': '5c6a2982-6fa4-4dcb-89ac-d7d90dd3bc33'}, profile: , target: , version: 1.11.2
[0m16:44:01.891861 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:44:01.892503 [debug] [MainThread]: previous checksum: 7acfa76432ee7ad17f3ea5348588822be40c91cb0c492f5a6713cf20f34c8cdb, current checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b
[0m16:44:01.892990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5add57a0-4f14-4eec-97a4-eff364ac9c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1148f996d0>]}
[0m16:44:03.127712 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m16:44:03.128420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5add57a0-4f14-4eec-97a4-eff364ac9c4d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1148f71760>]}
[0m16:44:03.221527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5add57a0-4f14-4eec-97a4-eff364ac9c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1149124d40>]}
[0m16:44:03.290678 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m16:44:03.292475 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m16:44:03.304846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5add57a0-4f14-4eec-97a4-eff364ac9c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1148116360>]}
[0m16:44:03.305453 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m16:44:03.305941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5add57a0-4f14-4eec-97a4-eff364ac9c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1148052b40>]}
[0m16:44:03.307672 [info ] [MainThread]: 
[0m16:44:03.308183 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:44:03.308611 [info ] [MainThread]: 
[0m16:44:03.309233 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:44:03.310229 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m16:44:03.346013 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m16:44:03.346581 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m16:44:03.347045 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:44:03.434319 [debug] [ThreadPool]: SQL status: OK in 0.087 seconds
[0m16:44:03.435984 [debug] [ThreadPool]: On list_argus_vault: Close
[0m16:44:03.436829 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m16:44:03.437464 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m16:44:03.444804 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m16:44:03.445314 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m16:44:03.445732 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:44:03.447381 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m16:44:03.448758 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m16:44:03.449219 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m16:44:03.449831 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:44:03.450278 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m16:44:03.450685 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m16:44:03.451385 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:44:03.452312 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m16:44:03.452744 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m16:44:03.453183 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m16:44:03.453764 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:44:03.454213 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m16:44:03.459977 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m16:44:03.466126 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m16:44:03.466670 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m16:44:03.467103 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:44:03.468604 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:44:03.469073 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m16:44:03.469494 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m16:44:03.481075 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m16:44:03.482837 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m16:44:03.484200 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m16:44:03.484657 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m16:44:03.486528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5add57a0-4f14-4eec-97a4-eff364ac9c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1148dd3d10>]}
[0m16:44:03.487196 [debug] [MainThread]: Using duckdb connection "master"
[0m16:44:03.487674 [debug] [MainThread]: On master: BEGIN
[0m16:44:03.488141 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:44:03.489162 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:44:03.489619 [debug] [MainThread]: On master: COMMIT
[0m16:44:03.490091 [debug] [MainThread]: Using duckdb connection "master"
[0m16:44:03.490519 [debug] [MainThread]: On master: COMMIT
[0m16:44:03.491168 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:44:03.491624 [debug] [MainThread]: On master: Close
[0m16:44:03.493761 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m16:44:03.494510 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m16:44:03.495161 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m16:44:03.495640 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m16:44:03.503932 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m16:44:03.504706 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m16:44:03.561678 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m16:44:03.562336 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201164403537119"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Based on PCA factors, this transaction exhibits extreme values in V1-V3 and V13-V16, indicating fraudulent activity.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '5c6a2982-6fa4-4dcb-89ac-d7d90dd3bc33'
    );
  
  
  
[0m16:44:03.562823 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:44:03.571665 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m16:44:03.579294 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m16:44:03.579806 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m16:44:03.580809 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:44:03.581322 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m16:44:03.581802 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201164403537119'
      
      
      order by ordinal_position

  
[0m16:44:03.584298 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:44:03.589384 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m16:44:03.589899 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m16:44:03.593170 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:44:03.603352 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m16:44:03.603878 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m16:44:03.606327 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:44:03.608185 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m16:44:03.608713 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m16:44:03.609526 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:44:03.625880 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m16:44:03.626689 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m16:44:03.627214 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201164403537119"
    )
  
[0m16:44:03.628640 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:44:03.639123 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m16:44:03.639642 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m16:44:03.640135 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m16:44:03.655716 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m16:44:03.657898 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m16:44:03.659699 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5add57a0-4f14-4eec-97a4-eff364ac9c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a112bfa7500>]}
[0m16:44:03.660487 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m16:44:03.661227 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m16:44:03.662844 [debug] [MainThread]: Using duckdb connection "master"
[0m16:44:03.663417 [debug] [MainThread]: On master: BEGIN
[0m16:44:03.663948 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:44:03.665051 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:44:03.665532 [debug] [MainThread]: On master: COMMIT
[0m16:44:03.665994 [debug] [MainThread]: Using duckdb connection "master"
[0m16:44:03.666430 [debug] [MainThread]: On master: COMMIT
[0m16:44:03.667099 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:44:03.667564 [debug] [MainThread]: On master: Close
[0m16:44:03.668122 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:44:03.668558 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m16:44:03.669027 [info ] [MainThread]: 
[0m16:44:03.669513 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m16:44:03.670334 [debug] [MainThread]: Command end result
[0m16:44:03.690961 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m16:44:03.692660 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m16:44:03.698449 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m16:44:03.698904 [info ] [MainThread]: 
[0m16:44:03.699466 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:44:03.699949 [info ] [MainThread]: 
[0m16:44:03.700450 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:44:03.701113 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:44:03.702207 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3830264, "process_in_blocks": "0", "process_kernel_time": 0.284528, "process_mem_max_rss": "278992", "process_out_blocks": "3112", "process_user_time": 4.361122}
[0m16:44:03.702804 [debug] [MainThread]: Command `dbt run` succeeded at 16:44:03.702698 after 2.38 seconds
[0m16:44:03.703316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a11554498e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1155cb5dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1154c96de0>]}
[0m16:44:03.703814 [debug] [MainThread]: Flushing usage events
[0m16:44:04.927501 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:44:25.996112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797244a02690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7972443b92e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797244a00d40>]}


============================== 16:44:25.999454 | 5f523cc3-c2f0-4c69-8ea5-84fc2e064855 ==============================
[0m16:44:25.999454 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:44:26.000155 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'introspect': 'True', 'use_experimental_parser': 'False', 'printer_width': '80', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "3020034b-dcc5-4997-a717-b8baf7e7cae4", "ai_explanation": "Based on PCA factors, this transaction is fraud due to extreme V12 and V17 values (-6.56 and -4.78, respectively)."} --profiles-dir .', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'warn_error': 'None', 'version_check': 'True', 'no_print': 'None', 'quiet': 'False', 'fail_fast': 'False', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'log_cache_events': 'False', 'write_json': 'True', 'empty': 'False', 'debug': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'profiles_dir': '.', 'target_path': 'None', 'log_format': 'default'}
[0m16:44:26.245479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f523cc3-c2f0-4c69-8ea5-84fc2e064855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797243a393d0>]}
[0m16:44:26.317843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f523cc3-c2f0-4c69-8ea5-84fc2e064855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7972448e6360>]}
[0m16:44:26.319763 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m16:44:26.404418 [debug] [MainThread]: checksum: ce50d21f1c1aabe4bcdf1732e057561620373ce2af482804f75ff604ab4abc72, vars: {'ai_explanation': 'Based on PCA factors, this transaction is fraud due to '
                   'extreme V12 and V17 values (-6.56 and -4.78, '
                   'respectively).',
 'txn_id': '3020034b-dcc5-4997-a717-b8baf7e7cae4'}, profile: , target: , version: 1.11.2
[0m16:44:26.498715 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:44:26.499332 [debug] [MainThread]: previous checksum: ce50d21f1c1aabe4bcdf1732e057561620373ce2af482804f75ff604ab4abc72, current checksum: 7acfa76432ee7ad17f3ea5348588822be40c91cb0c492f5a6713cf20f34c8cdb
[0m16:44:26.499818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5f523cc3-c2f0-4c69-8ea5-84fc2e064855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79724414a510>]}
[0m16:44:27.727225 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m16:44:27.727906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5f523cc3-c2f0-4c69-8ea5-84fc2e064855', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797237961d60>]}
[0m16:44:27.819778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f523cc3-c2f0-4c69-8ea5-84fc2e064855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79723419a780>]}
[0m16:44:27.889164 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m16:44:27.890850 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m16:44:27.903062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f523cc3-c2f0-4c69-8ea5-84fc2e064855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797237927fb0>]}
[0m16:44:27.903610 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m16:44:27.904099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f523cc3-c2f0-4c69-8ea5-84fc2e064855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7972437a2ab0>]}
[0m16:44:27.905808 [info ] [MainThread]: 
[0m16:44:27.906326 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:44:27.906753 [info ] [MainThread]: 
[0m16:44:27.907367 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:44:27.908362 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m16:44:27.943492 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m16:44:27.944009 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m16:44:27.944464 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:44:28.031597 [debug] [ThreadPool]: SQL status: OK in 0.087 seconds
[0m16:44:28.033285 [debug] [ThreadPool]: On list_argus_vault: Close
[0m16:44:28.034128 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m16:44:28.034710 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m16:44:28.042051 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m16:44:28.042514 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m16:44:28.042953 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:44:28.044310 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:44:28.045644 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m16:44:28.046105 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m16:44:28.047022 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:44:28.047458 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m16:44:28.047867 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m16:44:28.048521 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:44:28.049456 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m16:44:28.049898 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m16:44:28.050340 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m16:44:28.051234 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:44:28.051682 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m16:44:28.057342 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m16:44:28.063257 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m16:44:28.063791 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m16:44:28.064290 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:44:28.065244 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:44:28.065679 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m16:44:28.066135 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m16:44:28.077168 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m16:44:28.078688 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m16:44:28.079976 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m16:44:28.080418 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m16:44:28.081975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f523cc3-c2f0-4c69-8ea5-84fc2e064855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7971cf7004d0>]}
[0m16:44:28.082592 [debug] [MainThread]: Using duckdb connection "master"
[0m16:44:28.083070 [debug] [MainThread]: On master: BEGIN
[0m16:44:28.083500 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:44:28.084481 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:44:28.084971 [debug] [MainThread]: On master: COMMIT
[0m16:44:28.085426 [debug] [MainThread]: Using duckdb connection "master"
[0m16:44:28.085858 [debug] [MainThread]: On master: COMMIT
[0m16:44:28.086510 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:44:28.086989 [debug] [MainThread]: On master: Close
[0m16:44:28.089067 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m16:44:28.089776 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m16:44:28.090392 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m16:44:28.090872 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m16:44:28.099068 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m16:44:28.099787 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m16:44:28.156502 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m16:44:28.157156 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201164428132008"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Based on PCA factors, this transaction is fraud due to extreme V12 and V17 values (-6.56 and -4.78, respectively).' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '3020034b-dcc5-4997-a717-b8baf7e7cae4'
    );
  
  
  
[0m16:44:28.157647 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:44:28.166283 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m16:44:28.174225 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m16:44:28.174763 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m16:44:28.175525 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:44:28.176017 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m16:44:28.176487 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201164428132008'
      
      
      order by ordinal_position

  
[0m16:44:28.179443 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:44:28.184623 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m16:44:28.185162 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m16:44:28.187871 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:44:28.198305 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m16:44:28.198861 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m16:44:28.201742 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:44:28.203328 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m16:44:28.203834 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m16:44:28.204938 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:44:28.221463 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m16:44:28.222306 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m16:44:28.222807 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201164428132008"
    )
  
[0m16:44:28.224255 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:44:28.234786 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m16:44:28.235350 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m16:44:28.235813 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m16:44:28.258150 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m16:44:28.260515 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m16:44:28.262337 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f523cc3-c2f0-4c69-8ea5-84fc2e064855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797246628cb0>]}
[0m16:44:28.263148 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.17s]
[0m16:44:28.263870 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m16:44:28.265655 [debug] [MainThread]: Using duckdb connection "master"
[0m16:44:28.266170 [debug] [MainThread]: On master: BEGIN
[0m16:44:28.266589 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:44:28.267658 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:44:28.268142 [debug] [MainThread]: On master: COMMIT
[0m16:44:28.268558 [debug] [MainThread]: Using duckdb connection "master"
[0m16:44:28.269001 [debug] [MainThread]: On master: COMMIT
[0m16:44:28.269612 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:44:28.270094 [debug] [MainThread]: On master: Close
[0m16:44:28.270593 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:44:28.271023 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m16:44:28.271455 [info ] [MainThread]: 
[0m16:44:28.271932 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m16:44:28.272718 [debug] [MainThread]: Command end result
[0m16:44:28.292123 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m16:44:28.293883 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m16:44:28.299738 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m16:44:28.300209 [info ] [MainThread]: 
[0m16:44:28.300732 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:44:28.301198 [info ] [MainThread]: 
[0m16:44:28.301671 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:44:28.302320 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:44:28.303399 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3701522, "process_in_blocks": "0", "process_kernel_time": 0.303328, "process_mem_max_rss": "278880", "process_out_blocks": "3104", "process_user_time": 4.294182}
[0m16:44:28.304012 [debug] [MainThread]: Command `dbt run` succeeded at 16:44:28.303885 after 2.37 seconds
[0m16:44:28.304498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7972437befc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797244854710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7972444d8ef0>]}
[0m16:44:28.305005 [debug] [MainThread]: Flushing usage events
[0m16:44:29.284360 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:44:49.555901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e2a1cd4e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e2a46d9eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e2a2062870>]}


============================== 16:44:49.559264 | a9dd9ad9-39e5-4fc5-9b41-02607e4f52b6 ==============================
[0m16:44:49.559264 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:44:49.559979 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'quiet': 'False', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'empty': 'False', 'printer_width': '80', 'debug': 'False', 'cache_selected_only': 'False', 'target_path': 'None', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "0b2ff67a-e912-49eb-89b6-46a2e0cf9af6", "ai_explanation": "Fraudulent transaction based on significantly negative PCA scores (V1: -4.40, V10: -4.80)."} --profiles-dir .', 'profiles_dir': '.', 'static_parser': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'fail_fast': 'False'}
[0m16:44:49.804762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9dd9ad9-39e5-4fc5-9b41-02607e4f52b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e2a26aa780>]}
[0m16:44:49.875541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a9dd9ad9-39e5-4fc5-9b41-02607e4f52b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e2a15ccd10>]}
[0m16:44:49.877292 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m16:44:49.962453 [debug] [MainThread]: checksum: 423c9108391d130300c7cf083b11f5c9d3b287318e5693d84928d7e882f2b963, vars: {'ai_explanation': 'Fraudulent transaction based on significantly negative PCA '
                   'scores (V1: -4.40, V10: -4.80).',
 'txn_id': '0b2ff67a-e912-49eb-89b6-46a2e0cf9af6'}, profile: , target: , version: 1.11.2
[0m16:44:50.054873 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:44:50.055488 [debug] [MainThread]: previous checksum: 423c9108391d130300c7cf083b11f5c9d3b287318e5693d84928d7e882f2b963, current checksum: ce50d21f1c1aabe4bcdf1732e057561620373ce2af482804f75ff604ab4abc72
[0m16:44:50.055980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a9dd9ad9-39e5-4fc5-9b41-02607e4f52b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e2959b9880>]}
[0m16:44:51.294330 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m16:44:51.295017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a9dd9ad9-39e5-4fc5-9b41-02607e4f52b6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e2957721b0>]}
[0m16:44:51.386407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a9dd9ad9-39e5-4fc5-9b41-02607e4f52b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e2957794c0>]}
[0m16:44:51.455394 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m16:44:51.457167 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m16:44:51.469499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a9dd9ad9-39e5-4fc5-9b41-02607e4f52b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e294134290>]}
[0m16:44:51.470074 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m16:44:51.470544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9dd9ad9-39e5-4fc5-9b41-02607e4f52b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e295785850>]}
[0m16:44:51.472302 [info ] [MainThread]: 
[0m16:44:51.472792 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:44:51.473257 [info ] [MainThread]: 
[0m16:44:51.473866 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:44:51.474972 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m16:44:51.510448 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m16:44:51.510964 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m16:44:51.511417 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:44:51.600604 [debug] [ThreadPool]: SQL status: OK in 0.089 seconds
[0m16:44:51.602330 [debug] [ThreadPool]: On list_argus_vault: Close
[0m16:44:51.603207 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m16:44:51.603788 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m16:44:51.611192 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m16:44:51.611654 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m16:44:51.612094 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:44:51.613442 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:44:51.614741 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m16:44:51.615198 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m16:44:51.615805 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:44:51.616256 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m16:44:51.616671 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m16:44:51.617329 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:44:51.618252 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m16:44:51.618686 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m16:44:51.619112 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m16:44:51.619694 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:44:51.620152 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m16:44:51.625709 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m16:44:51.631352 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m16:44:51.631883 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m16:44:51.632313 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:44:51.633439 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:44:51.633882 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m16:44:51.634340 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m16:44:51.646350 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m16:44:51.647791 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m16:44:51.649070 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m16:44:51.649512 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m16:44:51.651041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9dd9ad9-39e5-4fc5-9b41-02607e4f52b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e29406bd70>]}
[0m16:44:51.651653 [debug] [MainThread]: Using duckdb connection "master"
[0m16:44:51.652101 [debug] [MainThread]: On master: BEGIN
[0m16:44:51.652501 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:44:51.653370 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:44:51.653811 [debug] [MainThread]: On master: COMMIT
[0m16:44:51.654257 [debug] [MainThread]: Using duckdb connection "master"
[0m16:44:51.654659 [debug] [MainThread]: On master: COMMIT
[0m16:44:51.655347 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:44:51.655782 [debug] [MainThread]: On master: Close
[0m16:44:51.657841 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m16:44:51.658614 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m16:44:51.659246 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m16:44:51.659724 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m16:44:51.667769 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m16:44:51.668526 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m16:44:51.724421 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m16:44:51.725005 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201164451700206"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Fraudulent transaction based on significantly negative PCA scores (V1: -4.40, V10: -4.80).' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '0b2ff67a-e912-49eb-89b6-46a2e0cf9af6'
    );
  
  
  
[0m16:44:51.725499 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:44:51.733789 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m16:44:51.741838 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m16:44:51.742474 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m16:44:51.743304 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:44:51.743808 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m16:44:51.744336 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201164451700206'
      
      
      order by ordinal_position

  
[0m16:44:51.748084 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:44:51.755426 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m16:44:51.756025 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m16:44:51.760392 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:44:51.772130 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m16:44:51.772663 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m16:44:51.775598 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:44:51.777149 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m16:44:51.777652 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m16:44:51.778462 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:44:51.794724 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m16:44:51.795505 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m16:44:51.796016 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201164451700206"
    )
  
[0m16:44:51.797869 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:44:51.808355 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m16:44:51.808860 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m16:44:51.809381 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m16:44:51.824129 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m16:44:51.826182 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m16:44:51.827950 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9dd9ad9-39e5-4fc5-9b41-02607e4f52b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e254cd4980>]}
[0m16:44:51.829167 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.17s]
[0m16:44:51.830203 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m16:44:51.831797 [debug] [MainThread]: Using duckdb connection "master"
[0m16:44:51.832353 [debug] [MainThread]: On master: BEGIN
[0m16:44:51.832817 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:44:51.833809 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:44:51.834269 [debug] [MainThread]: On master: COMMIT
[0m16:44:51.834668 [debug] [MainThread]: Using duckdb connection "master"
[0m16:44:51.835084 [debug] [MainThread]: On master: COMMIT
[0m16:44:51.835690 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:44:51.836142 [debug] [MainThread]: On master: Close
[0m16:44:51.836618 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:44:51.837034 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m16:44:51.837446 [info ] [MainThread]: 
[0m16:44:51.837881 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m16:44:51.838661 [debug] [MainThread]: Command end result
[0m16:44:51.857500 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m16:44:51.859127 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m16:44:51.864712 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m16:44:51.865176 [info ] [MainThread]: 
[0m16:44:51.865691 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:44:51.866154 [info ] [MainThread]: 
[0m16:44:51.866618 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:44:51.867259 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:44:51.868309 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.374693, "process_in_blocks": "0", "process_kernel_time": 0.30822, "process_mem_max_rss": "291040", "process_out_blocks": "3112", "process_user_time": 4.29631}
[0m16:44:51.868890 [debug] [MainThread]: Command `dbt run` succeeded at 16:44:51.868786 after 2.38 seconds
[0m16:44:51.869400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e2a5fcfd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e2a199d220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e2a15b3b00>]}
[0m16:44:51.869881 [debug] [MainThread]: Flushing usage events
[0m16:44:52.760370 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:10:28.231394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ae3ec2f080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ae3ec2efc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ae3ecc6e40>]}


============================== 17:10:28.234758 | 0c46305a-3f9c-4392-a8c6-bc9e83d335d4 ==============================
[0m17:10:28.234758 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:10:28.235475 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "8ad558a6-50e8-4b5d-bb27-abd496a6e397", "ai_explanation": "Fraud detected: V7 and V17 values significantly higher than expected norms."} --profiles-dir .', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'fail_fast': 'False', 'warn_error': 'None', 'version_check': 'True', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'profiles_dir': '.', 'empty': 'False', 'debug': 'False', 'printer_width': '80', 'quiet': 'False', 'no_print': 'None'}
[0m17:10:28.482339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c46305a-3f9c-4392-a8c6-bc9e83d335d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ae3e321fa0>]}
[0m17:10:28.554272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c46305a-3f9c-4392-a8c6-bc9e83d335d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ae3e22c0b0>]}
[0m17:10:28.556147 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:10:28.640612 [debug] [MainThread]: checksum: 245383a282619d00ae374cc9abd1d9629147666434911eec239c44ff6347cfc4, vars: {'ai_explanation': 'Fraud detected: V7 and V17 values significantly higher '
                   'than expected norms.',
 'txn_id': '8ad558a6-50e8-4b5d-bb27-abd496a6e397'}, profile: , target: , version: 1.11.2
[0m17:10:28.733473 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:10:28.734116 [debug] [MainThread]: previous checksum: 245383a282619d00ae374cc9abd1d9629147666434911eec239c44ff6347cfc4, current checksum: 423c9108391d130300c7cf083b11f5c9d3b287318e5693d84928d7e882f2b963
[0m17:10:28.734599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0c46305a-3f9c-4392-a8c6-bc9e83d335d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ae3ec2eae0>]}
[0m17:10:29.966971 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m17:10:29.967655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0c46305a-3f9c-4392-a8c6-bc9e83d335d4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ae3016b080>]}
[0m17:10:30.060113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c46305a-3f9c-4392-a8c6-bc9e83d335d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ae32487ec0>]}
[0m17:10:30.130127 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:10:30.131939 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:10:30.144346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c46305a-3f9c-4392-a8c6-bc9e83d335d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79adf201f3b0>]}
[0m17:10:30.144901 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m17:10:30.145407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c46305a-3f9c-4392-a8c6-bc9e83d335d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79adf21ce5a0>]}
[0m17:10:30.147176 [info ] [MainThread]: 
[0m17:10:30.147673 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:10:30.148134 [info ] [MainThread]: 
[0m17:10:30.148756 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:10:30.149858 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m17:10:30.186450 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m17:10:30.187027 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m17:10:30.187470 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:10:30.275685 [debug] [ThreadPool]: SQL status: OK in 0.088 seconds
[0m17:10:30.277416 [debug] [ThreadPool]: On list_argus_vault: Close
[0m17:10:30.278294 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m17:10:30.278880 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m17:10:30.286373 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:10:30.286846 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m17:10:30.287304 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:10:30.289032 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m17:10:30.290376 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:10:30.290817 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m17:10:30.291468 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:10:30.291893 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:10:30.292357 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m17:10:30.293021 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:10:30.293963 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:10:30.294408 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:10:30.294829 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:10:30.295465 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:10:30.295905 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m17:10:30.301683 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m17:10:30.307680 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:10:30.308254 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m17:10:30.308673 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:10:30.309587 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:10:30.310292 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:10:30.311071 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m17:10:30.324168 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m17:10:30.326084 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m17:10:30.327515 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m17:10:30.328140 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m17:10:30.329992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c46305a-3f9c-4392-a8c6-bc9e83d335d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79adf21eb500>]}
[0m17:10:30.330680 [debug] [MainThread]: Using duckdb connection "master"
[0m17:10:30.331226 [debug] [MainThread]: On master: BEGIN
[0m17:10:30.331785 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:10:30.332865 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:10:30.333344 [debug] [MainThread]: On master: COMMIT
[0m17:10:30.333770 [debug] [MainThread]: Using duckdb connection "master"
[0m17:10:30.334206 [debug] [MainThread]: On master: COMMIT
[0m17:10:30.334822 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:10:30.335284 [debug] [MainThread]: On master: Close
[0m17:10:30.337348 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:10:30.338150 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m17:10:30.338774 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m17:10:30.339305 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m17:10:30.347615 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:10:30.348367 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m17:10:30.405217 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:10:30.405817 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201171030380626"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Fraud detected: V7 and V17 values significantly higher than expected norms.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '8ad558a6-50e8-4b5d-bb27-abd496a6e397'
    );
  
  
  
[0m17:10:30.406351 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:30.415300 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m17:10:30.422986 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:10:30.423513 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m17:10:30.424242 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:10:30.424729 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:10:30.425260 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201171030380626'
      
      
      order by ordinal_position

  
[0m17:10:30.428034 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:10:30.433398 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:10:30.433950 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:10:30.436820 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:10:30.447279 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:10:30.447810 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:10:30.450302 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:10:30.451842 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:10:30.452373 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m17:10:30.453153 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:10:30.469624 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:10:30.470412 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:10:30.470943 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201171030380626"
    )
  
[0m17:10:30.472293 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:10:30.482669 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:10:30.483215 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:10:30.483693 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:10:30.486901 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:10:30.488869 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m17:10:30.490619 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c46305a-3f9c-4392-a8c6-bc9e83d335d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ae30124620>]}
[0m17:10:30.491405 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.15s]
[0m17:10:30.492141 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:10:30.493887 [debug] [MainThread]: Using duckdb connection "master"
[0m17:10:30.494495 [debug] [MainThread]: On master: BEGIN
[0m17:10:30.494995 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:10:30.495949 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:10:30.496517 [debug] [MainThread]: On master: COMMIT
[0m17:10:30.497071 [debug] [MainThread]: Using duckdb connection "master"
[0m17:10:30.497587 [debug] [MainThread]: On master: COMMIT
[0m17:10:30.498255 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:10:30.498696 [debug] [MainThread]: On master: Close
[0m17:10:30.499219 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:10:30.499625 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m17:10:30.500072 [info ] [MainThread]: 
[0m17:10:30.500525 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m17:10:30.501314 [debug] [MainThread]: Command end result
[0m17:10:30.520475 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:10:30.522124 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:10:30.527781 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m17:10:30.528248 [info ] [MainThread]: 
[0m17:10:30.528769 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:10:30.529240 [info ] [MainThread]: 
[0m17:10:30.529707 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:10:30.530347 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:10:30.531388 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3623025, "process_in_blocks": "0", "process_kernel_time": 0.316425, "process_mem_max_rss": "277072", "process_out_blocks": "3104", "process_user_time": 4.290099}
[0m17:10:30.531999 [debug] [MainThread]: Command `dbt run` succeeded at 17:10:30.531872 after 2.36 seconds
[0m17:10:30.532476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ae3e3dd940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ae3e2df200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ae3e2dc830>]}
[0m17:10:30.532977 [debug] [MainThread]: Flushing usage events
[0m17:10:31.519170 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:10:47.272220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2e2f9f3230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2e2f2fd880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2e2f2fea50>]}


============================== 17:10:47.275687 | 9d2e2ab1-99d6-460f-8eb9-300dc49ee942 ==============================
[0m17:10:47.275687 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:10:47.276372 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'target_path': 'None', 'warn_error': 'None', 'cache_selected_only': 'False', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'debug': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "829bd17a-c64c-49a1-b100-c9fb9e8e8145", "ai_explanation": "This transaction is fraud based on anomalous PCA factors exceeding 2x standard deviations."} --profiles-dir .', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'static_parser': 'True', 'no_print': 'None', 'printer_width': '80', 'empty': 'False', 'write_json': 'True', 'profiles_dir': '.', 'introspect': 'True', 'version_check': 'True'}
[0m17:10:47.525965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d2e2ab1-99d6-460f-8eb9-300dc49ee942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2e2ef8ff80>]}
[0m17:10:47.597246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d2e2ab1-99d6-460f-8eb9-300dc49ee942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2e2f686060>]}
[0m17:10:47.599025 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:10:47.682832 [debug] [MainThread]: checksum: b917e49a4aee5352fe649d6cfff8946dcbb4532cd7a4d6115270de0efc8710c0, vars: {'ai_explanation': 'This transaction is fraud based on anomalous PCA factors '
                   'exceeding 2x standard deviations.',
 'txn_id': '829bd17a-c64c-49a1-b100-c9fb9e8e8145'}, profile: , target: , version: 1.11.2
[0m17:10:47.775113 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:10:47.775711 [debug] [MainThread]: previous checksum: b917e49a4aee5352fe649d6cfff8946dcbb4532cd7a4d6115270de0efc8710c0, current checksum: 245383a282619d00ae374cc9abd1d9629147666434911eec239c44ff6347cfc4
[0m17:10:47.776218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9d2e2ab1-99d6-460f-8eb9-300dc49ee942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2e2f9f2ab0>]}
[0m17:10:49.017691 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m17:10:49.018395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9d2e2ab1-99d6-460f-8eb9-300dc49ee942', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2e20176db0>]}
[0m17:10:49.110118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d2e2ab1-99d6-460f-8eb9-300dc49ee942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2e0aefc470>]}
[0m17:10:49.178655 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:10:49.180379 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:10:49.192588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d2e2ab1-99d6-460f-8eb9-300dc49ee942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2e0aefd520>]}
[0m17:10:49.193173 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m17:10:49.193640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d2e2ab1-99d6-460f-8eb9-300dc49ee942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2e0afc4a40>]}
[0m17:10:49.195405 [info ] [MainThread]: 
[0m17:10:49.195898 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:10:49.196358 [info ] [MainThread]: 
[0m17:10:49.196973 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:10:49.198037 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m17:10:49.233348 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m17:10:49.233846 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m17:10:49.234331 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:10:49.319824 [debug] [ThreadPool]: SQL status: OK in 0.085 seconds
[0m17:10:49.321601 [debug] [ThreadPool]: On list_argus_vault: Close
[0m17:10:49.322575 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m17:10:49.323219 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m17:10:49.331140 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:10:49.331617 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m17:10:49.332069 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:10:49.333813 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m17:10:49.335230 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:10:49.335670 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m17:10:49.336342 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:10:49.336770 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:10:49.337212 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m17:10:49.337889 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:10:49.338845 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:10:49.339321 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:10:49.339738 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:10:49.340375 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:10:49.340817 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m17:10:49.346581 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m17:10:49.352608 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:10:49.353168 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m17:10:49.353576 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:10:49.354498 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:10:49.354955 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:10:49.355384 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m17:10:49.366465 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m17:10:49.367953 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m17:10:49.369229 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m17:10:49.369676 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m17:10:49.371361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d2e2ab1-99d6-460f-8eb9-300dc49ee942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2e0ae27d70>]}
[0m17:10:49.371997 [debug] [MainThread]: Using duckdb connection "master"
[0m17:10:49.372439 [debug] [MainThread]: On master: BEGIN
[0m17:10:49.372845 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:10:49.373816 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:10:49.374292 [debug] [MainThread]: On master: COMMIT
[0m17:10:49.374709 [debug] [MainThread]: Using duckdb connection "master"
[0m17:10:49.375132 [debug] [MainThread]: On master: COMMIT
[0m17:10:49.375722 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:10:49.376179 [debug] [MainThread]: On master: Close
[0m17:10:49.378197 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:10:49.378834 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m17:10:49.379420 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m17:10:49.379930 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m17:10:49.388058 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:10:49.388801 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m17:10:49.445767 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:10:49.446364 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201171049421143"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'This transaction is fraud based on anomalous PCA factors exceeding 2x standard deviations.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '829bd17a-c64c-49a1-b100-c9fb9e8e8145'
    );
  
  
  
[0m17:10:49.446868 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:49.455239 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m17:10:49.462799 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:10:49.463335 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m17:10:49.464053 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:10:49.464547 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:10:49.465048 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201171049421143'
      
      
      order by ordinal_position

  
[0m17:10:49.467734 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:10:49.472773 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:10:49.473323 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:10:49.476801 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:10:49.486956 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:10:49.487486 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:10:49.490146 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:10:49.491662 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:10:49.492201 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m17:10:49.492999 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:10:49.509387 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:10:49.510200 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:10:49.510717 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201171049421143"
    )
  
[0m17:10:49.512009 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:10:49.522422 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:10:49.523015 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:10:49.523491 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:10:49.538224 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m17:10:49.540376 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m17:10:49.542149 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d2e2ab1-99d6-460f-8eb9-300dc49ee942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2e31c84e90>]}
[0m17:10:49.542928 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m17:10:49.543646 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:10:49.545163 [debug] [MainThread]: Using duckdb connection "master"
[0m17:10:49.545712 [debug] [MainThread]: On master: BEGIN
[0m17:10:49.546222 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:10:49.547304 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:10:49.547760 [debug] [MainThread]: On master: COMMIT
[0m17:10:49.548209 [debug] [MainThread]: Using duckdb connection "master"
[0m17:10:49.548614 [debug] [MainThread]: On master: COMMIT
[0m17:10:49.549242 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:10:49.549678 [debug] [MainThread]: On master: Close
[0m17:10:49.550204 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:10:49.550608 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m17:10:49.551054 [info ] [MainThread]: 
[0m17:10:49.551504 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m17:10:49.552277 [debug] [MainThread]: Command end result
[0m17:10:49.571194 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:10:49.572977 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:10:49.578691 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m17:10:49.579168 [info ] [MainThread]: 
[0m17:10:49.579699 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:10:49.580168 [info ] [MainThread]: 
[0m17:10:49.580637 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:10:49.581291 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:10:49.582330 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3725371, "process_in_blocks": "0", "process_kernel_time": 0.325678, "process_mem_max_rss": "278800", "process_out_blocks": "3104", "process_user_time": 4.27837}
[0m17:10:49.582940 [debug] [MainThread]: Command `dbt run` succeeded at 17:10:49.582816 after 2.37 seconds
[0m17:10:49.583445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2e300d23c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2e300d3830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2e300d0a40>]}
[0m17:10:49.583962 [debug] [MainThread]: Flushing usage events
[0m17:10:50.470715 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:11:05.614531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7256fdc083e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7256fd30ff20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7256fdf1f0e0>]}


============================== 17:11:05.618726 | e9d53757-0244-46d8-8d32-2b698a349d60 ==============================
[0m17:11:05.618726 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:11:05.619688 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_format': 'default', 'no_print': 'None', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'printer_width': '80', 'debug': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select sat_txn_ai_insights --vars {"txn_id": "393d0456-b718-4cbb-9475-8203b721cd1b", "ai_explanation": "Highly anomalous PCA scores across multiple factors indicate fraudulent transaction."} --profiles-dir .', 'write_json': 'True', 'indirect_selection': 'eager', 'log_path': '/workspaces/modern-stack-banking/Transform/logs', 'version_check': 'True', 'cache_selected_only': 'False', 'quiet': 'False'}
[0m17:11:05.867372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e9d53757-0244-46d8-8d32-2b698a349d60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7256fd35fec0>]}
[0m17:11:05.938159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e9d53757-0244-46d8-8d32-2b698a349d60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7256fda43170>]}
[0m17:11:05.939934 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:11:06.023373 [debug] [MainThread]: checksum: 50ccc20daa05df1faaa26a50c692d26c21867446666fa0d00f79106134670745, vars: {'ai_explanation': 'Highly anomalous PCA scores across multiple factors '
                   'indicate fraudulent transaction.',
 'txn_id': '393d0456-b718-4cbb-9475-8203b721cd1b'}, profile: , target: , version: 1.11.2
[0m17:11:06.115453 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:11:06.116110 [debug] [MainThread]: previous checksum: 50ccc20daa05df1faaa26a50c692d26c21867446666fa0d00f79106134670745, current checksum: b917e49a4aee5352fe649d6cfff8946dcbb4532cd7a4d6115270de0efc8710c0
[0m17:11:06.116577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e9d53757-0244-46d8-8d32-2b698a349d60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7256f14ae540>]}
[0m17:11:07.350603 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'gold_fraud_analysis' in package 'modern_stack_banking'
(models/Gold/schema.yml). Arguments to generic tests should be nested under the
`arguments` property.
[0m17:11:07.351318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e9d53757-0244-46d8-8d32-2b698a349d60', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7256fd20be60>]}
[0m17:11:07.443369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e9d53757-0244-46d8-8d32-2b698a349d60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7256f1752240>]}
[0m17:11:07.513196 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:11:07.515001 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:11:07.527369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e9d53757-0244-46d8-8d32-2b698a349d60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7256f0019760>]}
[0m17:11:07.527957 [info ] [MainThread]: Found 5 models, 5 data tests, 472 macros
[0m17:11:07.528436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9d53757-0244-46d8-8d32-2b698a349d60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7256f00e6480>]}
[0m17:11:07.530189 [info ] [MainThread]: 
[0m17:11:07.530687 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:11:07.531149 [info ] [MainThread]: 
[0m17:11:07.531756 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:11:07.532759 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_argus_vault'
[0m17:11:07.568493 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault"
[0m17:11:07.568994 [debug] [ThreadPool]: On list_argus_vault: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"argus_vault"'
    
  
  
[0m17:11:07.569448 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:11:07.657590 [debug] [ThreadPool]: SQL status: OK in 0.088 seconds
[0m17:11:07.659289 [debug] [ThreadPool]: On list_argus_vault: Close
[0m17:11:07.660178 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_argus_vault, now create_argus_vault_main)
[0m17:11:07.660761 [debug] [ThreadPool]: Creating schema "database: "argus_vault"
schema: "main"
"
[0m17:11:07.668072 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:11:07.668535 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='argus_vault'
        and type='sqlite'
    
  
[0m17:11:07.668973 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:11:07.670409 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:11:07.671729 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:11:07.672193 [debug] [ThreadPool]: On create_argus_vault_main: BEGIN
[0m17:11:07.672786 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:11:07.673233 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:11:07.673641 [debug] [ThreadPool]: On create_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "create_argus_vault_main"} */

    
    
        create schema if not exists "argus_vault"."main"
    
[0m17:11:07.674293 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:11:07.675220 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:11:07.675675 [debug] [ThreadPool]: Using duckdb connection "create_argus_vault_main"
[0m17:11:07.676117 [debug] [ThreadPool]: On create_argus_vault_main: COMMIT
[0m17:11:07.676755 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:11:07.677228 [debug] [ThreadPool]: On create_argus_vault_main: Close
[0m17:11:07.682833 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_argus_vault_main, now list_argus_vault_main)
[0m17:11:07.688976 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:11:07.689519 [debug] [ThreadPool]: On list_argus_vault_main: BEGIN
[0m17:11:07.689951 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:11:07.691217 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:11:07.691657 [debug] [ThreadPool]: Using duckdb connection "list_argus_vault_main"
[0m17:11:07.692123 [debug] [ThreadPool]: On list_argus_vault_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "connection_name": "list_argus_vault_main"} */
select
      'argus_vault' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'argus_vault'
  
[0m17:11:07.703326 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m17:11:07.704799 [debug] [ThreadPool]: On list_argus_vault_main: ROLLBACK
[0m17:11:07.706106 [debug] [ThreadPool]: Failed to rollback 'list_argus_vault_main'
[0m17:11:07.706553 [debug] [ThreadPool]: On list_argus_vault_main: Close
[0m17:11:07.708194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9d53757-0244-46d8-8d32-2b698a349d60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7256f00d6a80>]}
[0m17:11:07.708830 [debug] [MainThread]: Using duckdb connection "master"
[0m17:11:07.709288 [debug] [MainThread]: On master: BEGIN
[0m17:11:07.709695 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:11:07.710572 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:11:07.711041 [debug] [MainThread]: On master: COMMIT
[0m17:11:07.711461 [debug] [MainThread]: Using duckdb connection "master"
[0m17:11:07.711867 [debug] [MainThread]: On master: COMMIT
[0m17:11:07.712482 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:11:07.712929 [debug] [MainThread]: On master: Close
[0m17:11:07.715015 [debug] [Thread-1 (]: Began running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:11:07.715643 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.sat_txn_ai_insights .................... [RUN]
[0m17:11:07.716402 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_argus_vault_main, now model.modern_stack_banking.sat_txn_ai_insights)
[0m17:11:07.716932 [debug] [Thread-1 (]: Began compiling node model.modern_stack_banking.sat_txn_ai_insights
[0m17:11:07.724994 [debug] [Thread-1 (]: Writing injected SQL for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:11:07.725710 [debug] [Thread-1 (]: Began executing node model.modern_stack_banking.sat_txn_ai_insights
[0m17:11:07.783106 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:11:07.783655 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

    
  
    
    

    create temporary table
      "sat_txn_ai_insights__dbt_tmp20260201171107758436"
  
    as (
      

-- This model acts as the landing zone for our Python AI script
-- It grabs the specific transaction from the Hub and attaches the explanation passed via variables
SELECT
    h.txn_hash_key,
    'Highly anomalous PCA scores across multiple factors indicate fraudulent transaction.' as ai_reason_for_flag,
    CURRENT_TIMESTAMP as load_date,
    'LLAMA3_OLLAMA_FORENSIC' as record_source
FROM "argus_vault"."main"."hubs_transactions" h
WHERE h.txn_id = '393d0456-b718-4cbb-9475-8203b721cd1b'
    );
  
  
  
[0m17:11:07.784175 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:11:07.792277 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m17:11:07.799986 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:11:07.800494 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: BEGIN
[0m17:11:07.801202 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:11:07.801684 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:11:07.802174 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights__dbt_tmp20260201171107758436'
      
      
      order by ordinal_position

  
[0m17:11:07.805328 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:11:07.810384 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:11:07.810900 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:11:07.813424 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:11:07.823522 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:11:07.824073 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'sat_txn_ai_insights'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'argus_vault'
      
      order by ordinal_position

  
[0m17:11:07.826708 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:11:07.828235 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:11:07.828742 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */
SELECT version()
[0m17:11:07.829572 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:11:07.845855 [debug] [Thread-1 (]: Writing runtime sql for node "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:11:07.846657 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:11:07.847178 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "modern_stack_banking", "target_name": "dev", "node_id": "model.modern_stack_banking.sat_txn_ai_insights"} */


    insert into "argus_vault"."main"."sat_txn_ai_insights" ("txn_hash_key", "ai_reason_for_flag", "load_date", "record_source")
    (
        select "txn_hash_key", "ai_reason_for_flag", "load_date", "record_source"
        from "sat_txn_ai_insights__dbt_tmp20260201171107758436"
    )
  
[0m17:11:07.848350 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:11:07.858817 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:11:07.859356 [debug] [Thread-1 (]: Using duckdb connection "model.modern_stack_banking.sat_txn_ai_insights"
[0m17:11:07.859821 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: COMMIT
[0m17:11:07.874199 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m17:11:07.876266 [debug] [Thread-1 (]: On model.modern_stack_banking.sat_txn_ai_insights: Close
[0m17:11:07.878015 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9d53757-0244-46d8-8d32-2b698a349d60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7256f14505c0>]}
[0m17:11:07.878768 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.sat_txn_ai_insights ............... [[32mOK[0m in 0.16s]
[0m17:11:07.879510 [debug] [Thread-1 (]: Finished running node model.modern_stack_banking.sat_txn_ai_insights
[0m17:11:07.880956 [debug] [MainThread]: Using duckdb connection "master"
[0m17:11:07.881491 [debug] [MainThread]: On master: BEGIN
[0m17:11:07.881986 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:11:07.882928 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:11:07.883392 [debug] [MainThread]: On master: COMMIT
[0m17:11:07.883814 [debug] [MainThread]: Using duckdb connection "master"
[0m17:11:07.884248 [debug] [MainThread]: On master: COMMIT
[0m17:11:07.884822 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:11:07.885282 [debug] [MainThread]: On master: Close
[0m17:11:07.885777 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:11:07.886198 [debug] [MainThread]: Connection 'model.modern_stack_banking.sat_txn_ai_insights' was properly closed.
[0m17:11:07.886616 [info ] [MainThread]: 
[0m17:11:07.887095 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m17:11:07.887852 [debug] [MainThread]: Command end result
[0m17:11:07.906701 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/modern-stack-banking/Transform/target/manifest.json
[0m17:11:07.908367 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/modern-stack-banking/Transform/target/semantic_manifest.json
[0m17:11:07.914016 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/modern-stack-banking/Transform/target/run_results.json
[0m17:11:07.914457 [info ] [MainThread]: 
[0m17:11:07.914986 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:11:07.915430 [info ] [MainThread]: 
[0m17:11:07.915907 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:11:07.916545 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:11:07.917585 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3672693, "process_in_blocks": "0", "process_kernel_time": 0.321537, "process_mem_max_rss": "275124", "process_out_blocks": "3104", "process_user_time": 4.27199}
[0m17:11:07.918195 [debug] [MainThread]: Command `dbt run` succeeded at 17:11:07.918084 after 2.37 seconds
[0m17:11:07.918666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7256fd2ed880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7256fd2089e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7256f132d5e0>]}
[0m17:11:07.919167 [debug] [MainThread]: Flushing usage events
[0m17:11:08.900489 [debug] [MainThread]: An error was encountered while trying to flush usage events
